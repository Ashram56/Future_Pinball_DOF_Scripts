
' ********************************************************************
' **                                                                **
' **                        FUTURE PINBALL                          **
' **                                                                **
' **                           and the                              **
' **                                                                **
' **           (90% complete) INDIANA JONES PINBALL GAME            **
' **                                                                **
' ********************************************************************

' THIS VERY SPECIAL EDITION IS A FUTURE PINBALL EXCLUSIVE. NO OTHER VERSIONS PLEASE.
' BUT MODS ARE PERMITTED FOR ANY OTHER FUTURE PINBALL VERSIONS - SO GO CRAZY!

' Based on Stern's Indiana Jones with new code, mew rules, new audio, new LCD animations and improved artwork.


' *** THE GAME IS STILL INCOMPLETE, MORE SCENES ARE NEEDED AND SOME SCENES NEED MORE CONTENT ***


' Who made it?

' GLXB & Highlnder00 - original WIP build
' SLAMT1LT - ULTIMATE Pro edition (code, rules, audio, art, LCD)

' DOF v0.1 by Ashram56
' DOF functions implemented: targets, bumpers, slingers, shaker for Ark hit
' Functions to be implemented: side ramp targets, special game events triggers, SSF

' ** ULTIMATE Pro Version 1.06 **

'- fixed crash bug when game tilted and ball search starts
'- fixed plane animation glitch when Grail scoop hit during 'Dogfight'
'- fixed ball miscount during Mine Cart Multiball
'- adjusted some timers
'- improved Crystal Skull Scene 3: Mind Control
'- added new lighting effects
'- improved dynamic shadowing
'- fixed some movie clips not playing or being interrupted
'- improved playfield geometry: right loop return now less likely to hit right slingshot
'- improved general lighting
'- added plastic 'gloss' effect to all remaining plastics
'- rule change: Double Scoring timer can only be extened once when running
'- added new perk: failed ramp shots resulting in SDTM drains return the ball
'- added new movie clips to 'Truck Hijack' and 'Mind Control' 
'- improved Raiders Scene 3: Truck Hijack
'- improved Temple Scene 3: Mine Cart Chase
'- added more quotes


' ** ULTIMATE Pro Version 1.05 **

' Rule Change: 'Shooting' the Cairo Swordsman now resets the Hurry Up Value
' added more quotes
' fixed bumpers not advancing thrust if right loop hit in Crystal Skull Scene 1: Rocket Car
' fixed music stopping if time extended during certain scenes
' added more Mystery awards
' improved one shot, one time bonus
' added 2 new clips of tank firing at Indy in Crusade Scene 3: Tank Resuce
' fixed some values not assigned for multiplayer
' fixed some objects not reflecting on playfield surface
' improved rules for Crusade Scene 2: Dogfight
' improved some LCD graphics
' added new scene: Crystal Skull Scene 3: Mind Control


' ** ULTIMATE Pro Version 1.04 **

' fixed FREE SHOT not working for Raiders Scene 1 when running from bolder
' fixed Extra Ball for 15m score not working for more than 1 player during multiplayer
' added new Player Perk: When Special is lit, it lights on both outlanes at the same time
' fixed Raiders Scene 3 win awarding Movie Jackpot twice
' improved Raiders Scene 3: Truck Hijack
' fixed ball sticking hazard between flippers and wire rail
' Rule Change: If Mystery is lit and hit during a scene, it will extened the timer (when applicable)
' added more quotes
' improved lighting effects
' nudging to engage Map Room captive balls deactivates the Map Room slingshots
' Rule Change: Successful shots during some scenes extends the timer
' Rule Change: Cairo Swordsman win increases the Hurry Up value each time and he will taunt the player
' by moving in and out after a certain number of wins
' fixed Cairo Swordsman value not doubling up if Double Scoring active
' fixed 4 player multiplayer not showing correct DMD score information
' fixed Thrusters sometimes not advancing with bumper hits in Crystal Skull Scene 1
' added more LCD graphics
' added colour-changing lights for Crusade Scene 4: Choose Wisely


' ** ULTIMATE Pro Version 1.03 **

' - fixed Bar Shootout scene not showing correct LCD information
' - improved Bar Shootout scene with better scoring and lighting
' - fixed FREE SHOT ending Raiders Scene 1 (FREE SHOTS are disabled for the last shot of any scene)
' - fixed Monkey Brain graphic during Mystery Award
' - fixed Choose Wisely scene not calculating correct score total
' - fixed some movie clips not playing at certain times
' - Rule Change: Left InLane now advances a Ball Saver. Right InLane Mystery only (6 hits to each)
' - added a new Player Perk: Ball Saver timer will increase by 1 second each time it's activated
' - fixed Match sequence not playing for next game
' - fixed InLanes sometimes not registering a hit
' - added movie clips to attract sequence
' - added more sound fx
' - fixed Next Scene not working when awarded from Mystery
' - added more movie clips
' - Improved Rule: The one time, one shot bonus now plays out the scene where Indy grabs the idol
'   There's a 50/50 chance Indy will set off the deadly poison dartÂ traps (Ark Targets) and lose the bonus
' - fixed movie clips pausing when scenes completed successfully
' - fixed some quotes overlapping each other
' - New Rule: Making a 4-way Combo lights the SPECIAL
' - added grace timer to Ball Saver
' - fixed some scoring issues in certain scenes
' - improved DMD functionality for more clarity
' - added more quotes and music
' - finished Crystal Skull Scene 1: Rocket Car
' - improved Last Crusade Scene 2: Dogfight
' - added new Player Perk: Double Scoring timer is extended by 30 seconds
' - improved Last Crusade Scene 4: Choose Wisely
' - improved Ark Magnet functionality
' - improved INDY, JONES and INDY JONES Fast Scoring
' - added more Player Perks
' - added 'Free Shot' light to apron
' - pressing Special 1 Key during attract now turns HUD on/off
' - improved Raiders Scene 4: Opening The Ark
' - added cabside art
' - numerous other tweaks




' SKILL SHOT
' ----------

' Launch the ball on the lit SKILL SHOT feature to start it.


' CAIRO SWORDSMAN
' ---------------

' Shoot the Map Rooom CAPTIVE BALL 6 times to start, then quickly shoot it again to fight the Swordsman and collect the value
' before time runs out. 

' Press the plunger button to shoot the Swordsman at anytime during the feature to kill him instantly, but this will award no points.

' Beat the Swordsman 3 times to light the EXTRA BALL at the ramp.

' Can also be started as part of the SKILL SHOT.


' MAP ROOM
' --------

' Hit all MAP ROOM targets to advance the end of ball multiplier, which is limitless. 
' Get the ball in the kicker 3 times to activate DOUBLE SCORING for a limited time.

' Perk: The Map Room multiplier increases by X 4 instead of X 2 each time.
' Perk: Double Scoring timer is increased by 30 seconds.


' INDY or JONES FAST SCORING
' --------------------------

' Can only be started as part of the Skill Shot. 

' INDY Scoring: Indy will hide Marion in a basket.  Find the basket 3 times.

' JONES Scoring: Hit the strobing letter to collect the value which starts at 55k.


' INDY JONES FAST SCORING
' -----------------------

' Complete INDY and JONES to start INDY JONES Fast Scoring.  

' All INDY JONES targets score 210k for a limited time.

' Perk: 5 hits during INDY JONES Scoring wins an EXTRA BALL.


' MYSTERY
' -------

' Can also be started as part of the Skill Shot.

' Hit the right inlane 6 times to light the Mystery feature at the Grail scoop.


' ANTS, RATS, SNAKES HURRY UP
' ---------------------------

' Awarded only from the Mystery feature.

' Make the left, right or both loop shots to collect the hurry up value and light the Super Spinner.  Super Spinner will increase
' the value of the hurry up next time it starts.


' GRAIL CHALLENGES
' ----------------

' Awarded only from the Mystery feature.

' Shoot the left loop when the grail insert is flashing to make it safely through.
' Complete all 3 challenges succesfully for an EXTRA BALL.

' For now, only 1 challenge is completed - the Breath Of God.


' SPECIAL AWARD
' -------------

' Awarded from the Mystery feature or when a 4-way Combo is made.

' Awards an EXTRA BALL, an extended BALL SAVER and the combined total of all movie JACKPOTS.

' The SPECIAL light rotates when the SLINGSHOTS are hit - left or right outlanes.

' Perk: Lights both outlanes at the same time.


' SUPER POPS
' ----------

' Bumpers increase the movie JACKPOT values.
' After a certain number of hits, the SUPER POPS will activate adding more value to the movie JACKPOTS.

' Movie JACKPOTS are collected when each movie scene is completed successfully.

' Perk: Super Pops timer is extended by 7 seconds and resets with each hit.


' SUPER SPINNER
' -------------

' There are 2 spinners on the loops.
' After 100 spins each spinner will become a SUPER SPINNER and increse the Hurry UP value and award 5 x the normal Spinner value.

' Perk: Super Spinner also increases a random Movie Jackpot.


' BONUS BALL
' ----------

' Qualified when a certain number of end of ball bonus objectives are completed.

' For a limited time at the end of the game, a ball is ejected into play. 
' Shoot the lit shots to complete the light matrix on the lower playfield.


' PLAYER PERKS
' ------------

' Complete any scene successfully to gain a special perk for the rest of the game.
' Some have 1 use, like the Bonus Held (SDTM Perk).


' MOVIE SCENES
' ------------


' Raiders of the Lost Ark
' -----------------------

' Shoot the Ark and spell R-A-I-D-E-R-S to start each scene.

' Only a shot directly to the Ark qualifies. 
' If the ball hits any of the Ark Targets (traps), the magnet will activate and deflect the shot.


' SCENE 1:
' --------

' The Boulder Run.  
' The ball is held on the magnet and a timer starts and shows the giant stone boulder rolling towards Indy.
' Shoot either spinner to run as fast as possible.
' Then shoot the Ark to crash though the wall.  This then starts the chase to the plane.
' Shoot the ramp TWICE to esape in the plane (SHORT VERSION).


' SCENE 2:
' --------

' The Bar Shootout. 
' The ball is held on the magnet, which depicts the scene in the movie where Marion is held by the Nazi.
' A new ball is auto-launched into play - this is Indy. Hit the held ball as quickly as possible to release it and get a high Nazi kill value.
' Shoot the INDY JONES targets to kill Nazis at that value. When all INDY JONES targets are clear, they will reset for double the value.


' SCENE 3:
' --------

' The Truck Hijack. 
' After the ball is held at the Ark for the intro, shoot either loop to jump onto the truck. 
' Then hit any INDY JONES target to fight a guard. At least 1 hit to INDY and 1 hit to JONES is required to throw a guard from the truck.  
' Repeat until 4 guards are thrown off the truck
' Then shoot the Ark to hide the truck and complete the mode. (SHORT VERSION)

' Survive being thrown under the truck, get back and punch the shit out of the Nazi scumbag (UNFINISHED)


' SCENE 4:
' --------

' The Ark. 
' The Ark opens and 4 balls are ejected into play, another 2 are auto-launched from the plunger lane, for a total of 6 balls.
' Hit 50 swiches to activate the Jackpot at the Ark.
' Shoot the Ark to collect the Jackpots.


' Temple of Doom
' --------------

' Shoot the Shankara Stone CAPTIVE BALL a number of times to reveal the Temple.
' Shoot into the hole to start the next scene.
' The required number of shots will increase after each movie scene has been played.


' SCENE 1:
' --------

' The Antidote.
' Shoot the roving ARROW (random position start) to collect the antidote.
' Then shoot the roving INDY JONES TARGETS to collect the diamond.
' Then shoot the ramp to get to the plane and escape. (SHORT VERSION)

' Now shoot the loops to race through the streets of Shanghai to the airport (UNFINISHED)


' SCENE 2:
' --------

' The Plane Jump.
' Shoot the Ark to grab the life raft.
' Then shoot the ramp to jump from the plane. (SHORT VERSION)

' Now hit the bumpers to natigate through the rapids and finish the scene (UNFINISHED)


' SCENE 3:
' --------  

' Mine Cart Chase.
' You are instructed to shoot the 'left tunnel' but in the movie you go through the right tunnel, so this is the shot needed.
' Shoot the RIGHT LOOP to start the chase (this adds 2 more balls in play), then shoot the spinners to make turns and jumps.  
' Shoot the INDY JONES targets to fight off the bad guys. When all INDY JONES targets are cleared, the jackpot will be lit at the Ark.


' SCENE 4:
' --------

' The Rope Bridge.
' Make a COMBO shot to the RAMP or RIGHT LOOP to start cutting the bridge.
' Then shoot the Ark to cut the bridge and make it fall.
' Finish by shooting the Temple to get the stone. (SHORT VERSION)

' Now shoot the INDY JONES targets to fight with Mola Ram for the last remaining stone (UNFINISHED)


' The Last Crusade
' ----------------

' Shoot the Grail scoop a number of times to start the next scene.
' The required number of shots will increase after each movie scene has been played.


' SCENE 1:
' --------

' Young Indy.
' Shoot the Ark to grab the cross.
' Then shoot the orbits to catch up to the train.
' Then shoot the ramp to run across the train.
' Then shoot the GRAIL SCOOP to disappear in the trunk and escape. (SHORT VERSION)


' SCENE 2:
' --------

' Dogfight.
' Get Jones Snr on the Machine Gun.
' Shoot down the plane.
' Crash land. (SHORT VERSION)


' SCENE 3:
' --------

' Tank Chase.
' Quickly shoot the lit shots before the tank elimiates them.

' Save Jones Snr (and Marcus I suppose). (UNFINISHED)


' SCENE 4:
' --------

' The Holy Grail.
' All main shots are now lit.
' Shoot only the lit shots to pick them off one by one and choose wisely.
' Hit an unlit shot to choose poorly and fail to win the jackpot.


' The Crystal Skull
' -----------------

' Shoot the small stand up targets at the ramp entrance to light the torches and activate the Crystal Skull.
' Shoot the ramp when the skull is lit a number of times to start the next scene.
' The required number of shots will increase after each movie scene has been played.


' SCENE 1:
' --------

' The Rocket Sled.
' Shoot the bumpers to power up the Rocket Sled's thrust.
' Shoot the Grail Scoop to hang on and launch it.


' SCENE 2:
' --------

' The Nuclear Test.
' Shoot the Sankara Stone captive ball to open the fridge.
' Shoot the hole to get into the fridge and survive the nuke.


' SCENE 3:
' --------

' Mind Control.
' Shoot the ramp to reduce the power of the skull and regain control of the flippers


' SCENE 4: (INCOMPLETE)
' --------

' Return
' escape the chamber and get to the water chute
' go up the water chute



' EXTRA SCENES
' ------------

' When all 4 scenes in a movie are completed successfully, as a reward this will unlock an extra scene.

' Raiders - Nazi Fist Fight or Escape the Well Of Souls
' Temple - Crushing Room Trap or Temple Sacrifice
' Crusade - Bike Chase or Mansion Fire
' Skull - Jungle Chase or 3 Times It Falls


' FINAL WIZARD MODE
' -----------------

' Complete all 16 (or 20) scenes to start.  Frankly, if you made it this far....you CHEATED DR JONES!

' Might not need one, the game is very challenging and fully packed already.  A lot of work for something less than 1% of players will ever see.
' Get the Bonus Ball instead, it's pretty much the same idea I had for the Wizard Mode anyway.



Option Explicit



xBAM.CreateAllExt



' *** DELETE THIS CODE AND ALL 'XBAM.CAMERA' LINES IF YOU HAVE A PINCAB OR HATE THE POP UP THAT APPEARS WHEN THE TABLE IS LOADED ***

If (xBAM.Camera.ScriptControl = FALSE) Then
   xBAM.Camera.RequestForControl
End If


' ** BEEF UP THE NUDGE IMPULSE VALUE TO MAKE THE GAME A BIT EASIER - DEFAULT 245 **


'=============================== PHYSICS XML ===========================
'<?xml version="1.0" encoding="utf-8"?>
'<document>
'  <!âCustom Physics for Indy -->
'  <physics fps="296" threaded="1"></physics>
'  <ball newtonDamping="0" mass="80" gravity="7000" damping="0.65"></ball>
'  <flipper releaseOmega="18" rotationSpeedChart="{0.0,100.0}[0.0,100.0]" newtonDamping="1" mass="20150" omega="43" moeMethod="0" 
'           leftXoff="0" leftYoff="1500" leftZoff="0" 
'           rightXoff="0" rightYoff="1500" rightZoff="0"></flipper>
'  <bumper impulse="90.0" impulseRandomness="0" vectorRandomness="6"></bumper>
'  <autoplunger mass="20000.0" force="60000.0"></autoplunger>
'  <diverter mass="10000.0" omega="33.0"></diverter>
'  <gate mass="0.5" gravity="3000.0" damping="1.0"></gate>
'  <kicker impulse="1000.0" vukImpulse="1400.0" impulseRandomness="2" vectorRandomness="1"></kicker>
'  <plunger mass="20000.0" force="30000.0"></plunger>
'  <slingshot impulse="650.0" impulseRandomness="15" vectorRandomness="3"></slingshot>
'  <spindisk mass="10000.0" angularDamp="0.33" linearDamp="0.25"></spindisk>
'  <spinner mass="50000.0" gravity="9800.0" angularDamp="0.5" angularAccel="5.25" 
'           spinDampLoose="0.30" spinBackLoose="0.90"
'           spinDampNorm="0.40" spinBackNorm="0.65"
'           spinDampTight="0.70" spinBackTight="0.65"></spinner>
'  <emkicker mass="10000.0" omega="80.0"></emkicker>
'  <varitarget mass="500.0" damping="0.9" tension="3.0" return="15.0"></varitarget>
'  <magnet impulse="10.0" impulseRandomness="2"></magnet>
'  <nudge impulse="245.0" impulseRandomness="25.0" warningLevel="300" leftAngle="60" upAngle="0" rightAngle="320"
'         vectorRandomness="5" visualDistance="3" waitPeriod="300" maxBallVelocity="500.0"></nudge>
'  <defaultMat softnessCoef="0.03" elasticCoef="0.1" staticFriction="0.01" kineticFriction="0.02"></defaultMat>
'  <playfieldMat softnessCoef="0.02" elasticCoef="0.1" staticFriction="0.01" kineticFriction="0.02"></playfieldMat>
'  <metalMat softnessCoef="0.01" elasticCoef="0.15" staticFriction="0.02" kineticFriction="0.02"></metalMat>
'  <woodMat softnessCoef="0.03" elasticCoef="0.15" staticFriction="0.03" kineticFriction="0.02"></woodMat>
'  <plasticMat softnessCoef="0.02" elasticCoef="0.2" staticFriction="0.02" kineticFriction="0.01"></plasticMat>
'  <rubberHardMat softnessCoef="0.08" elasticCoef="0.50" staticFriction="0.04" kineticFriction="0.055"></rubberHardMat>
'  <rubberIntMat softnessCoef="0.1" elasticCoef="0.72" staticFriction="0.05" kineticFriction="0.065"></rubberIntMat>
'  <rubberSoftMat softnessCoef="0.12" elasticCoef="0.90" staticFriction="0.06" kineticFriction="0.075"></rubberSoftMat>
'  <gateMat softnessCoef="0.05" elasticCoef="0.65" staticFriction="0" kineticFriction="0"></gateMat>
'  <kickerMat softnessCoef="0.01" elasticCoef="0.05" staticFriction="0.8" kineticFriction="0.8"></kickerMat>
'  <rampMat softnessCoef="0.01" elasticCoef="0.01" staticFriction="0.01" kineticFriction="0.01"></rampMat>
'  <plungerMat softnessCoef="0.04" elasticCoef="0.55" staticFriction="0.02" kineticFriction="0.02"></plungerMat>
'  <spindiskMat softnessCoef="0.05" elasticCoef="0.5" staticFriction="1.5" kineticFriction="2"></spindiskMat>
'</document>
'=============================== PHYSICS XML ===========================
	


ExecuteGlobal LoadExternalScript ("ZBRrollingballsoundslib.vbs")

ZRBrampHeight = 27
ZRBtablewide = 560

ZRBsoundballchan = 7
ZRBvolNormLevel = 0.5

ZRBrampSoundballchan = -1  'set to -1 to disable rampsound roll
ZRBrampVolNormLevel = 0.1



' === Dynamic Flipper Settings ===

Const BAM_VERSION = 0
AddDebugText BAM_VERSION



Sub BAM_Init()
   xBAM.ShadowMap "bulb23", 1000 , 1    ,   2.5,        1,        5,     0.15,        0
   xBAM.ShadowMap "bulb26", 1000 , 1    ,   2.5,        1,        3,     0.15,        0
   xBAM.ShadowMap "bulb29", 1000 , 1    ,   2.5,        1,        5,     0.15,        0
   xBAM.ShadowMap "bulb30", 1000 , 1    ,   2.5,        2,      1.5,     0.15,        0
   xBAM.ShadowMap "bulb34", 1000 , 1    ,   2.5,        2,      1.5,      0.5,        0
   xBAM.ShadowMap "bulb35", 1000 , 1    ,   2.5,        2,        2,      0.5,        0
   xBAM.ShadowMap "bulb37", 1000 , 1    ,   2.5,        2,        2,     0.15,        0
   xBAM.ShadowMap "leftslingshotbulb1", 1000 , 1    ,   2.5,        1,        5,     0.15,        0
   xBAM.ShadowMap "leftslingshotbulb2", 1000 , 1    ,   2.5,        2,        3,     0.15,        0
   xBAM.ShadowMap "lightbumpflash2", 1000 , 1    ,   2.5,        2,        5,        1,        0
   xBAM.ShadowMap "rightslingshotbulb1", 1000 , 1    ,   2.5,        1,        5,     0.15,        0
   xBAM.ShadowMap "rightslingshotbulb2", 1000 , 1    ,   2.5,        2,        3,     0.15,        0
End Sub




Sub SetLightsParamsInBAM()
   xBAM.Lights.EnableNewRenderer             = TRUE
   xBAM.Lights.MainLightLock                 = TRUE
' --- SetMainLightPosition not used because MainLightLock = FALSE
'  xBAM.Lights.SetMainLightPosition                 0,    650,    500
   xBAM.Lights.SetMainLightProperties               1,    0.3,      1,  0.045
   xBAM.Lights.SetMainLightAttenuation              1,      0,      0
   xBAM.Lights.SetOtherLightsAttenuation        0.066,      0,  0.333
   xBAM.Lights.EnablePostprocessing          = FALSE
   xBAM.Lights.SetPostprocessing                    1,      0,      1,      1
   xBAM.Lights.SetPostprocessingForNewRenderer      1,      0,      1,      1,    2.2,      1,      1,      1,    0.2
End Sub


SetLightsParamsInBAM()


If BAM_VERSION => 233 then
	Dim RightFlipperExt,LeftFlipperExt
	Dim omegaCorrectionR
	Dim omegaCorrectionL
	xBAM.BallSpeedLimit = 3000
End If


Sub OnPreHitFlipperSettings(FlipperExt)
   If BAM_VERSION < 233 then Exit Sub
 OnPreHitFlipperSettings_bounceControl(FlipperExt)
End Sub


If BAM_VERSION => 233 then
   const MaxOmega  = 47  ' Omega at base of flipper.  Must be > MinOmega. Default = 45
   const MinOmega  = 32  ' Omega at tip of flipper. Must be < MaxOmega. Default = 32
End If


Sub RightFlipper_prehit()
   If BAM_VERSION < 233 then Exit Sub
   OnPreHitFlipperSettings(RightFlipperExt)
   omegaCorrectionR = MaxOmega - (RightFlipperExt.ContactPoint * ((MaxOmega - MinOmega)/1.2)) 
      If RightFlipperExt.ContactPoint < 0.0 then RightFlipperExt.Omega = MaxOmega
      If RightFlipperExt.ContactPoint > 1.2 then RightFlipperExt.Omega = MinOmega
      If (RightFlipperExt.ContactPoint => 0.0) And (RightFlipperExt.ContactPoint =< 1.2) then 
         RightFlipperExt.Omega = omegaCorrectionR
      End if
End Sub


Sub LeftFlipper_prehit()
   If BAM_VERSION < 233 then Exit Sub
   OnPreHitFlipperSettings(LeftFlipperExt)
      omegaCorrectionL = MaxOmega - (LeftFlipperExt.ContactPoint * ((MaxOmega - MinOmega)/1.2))
      If LeftFlipperExt.ContactPoint < 0.0 then LeftFlipperExt.Omega = MaxOmega
      If LeftFlipperExt.ContactPoint > 1.2 then LeftFlipperExt.Omega = MinOmega
      If (LeftFlipperExt.ContactPoint => 0.0) And (LeftFlipperExt.ContactPoint =< 1.2) then 
         LeftFlipperExt.Omega = omegaCorrectionL
      End if
End Sub


Sub OnPreHitFlipperSettings_bounceControl(FlipperExt)
   If BAM_VERSION < 233 then Exit Sub
   const base_elasticCoef                        = 0.90 ' very bouncy flipper rubber
   const expected_ball_speed_after_hit           = 350  ' calc elasticCoef to get desired ball speed after ball hit flipper
   const minimum_elasticCoef_to_scale_fast_balls = 0.15 ' we will add this to calculated elastiCoef, so ball after hit will have aditional 5% of speed before hit
   const reduction_for_flipper_in_motion         = 0.17 ' if flipper is not in starting point, reduce elasticCoef by 20%
  
   If FlipperExt.Hit Then
      Dim elasticCoef 
      Dim maxElasticCoef
      Dim ballSpeed
      ballSpeed = (FlipperExt.BallVSpeed + xBAM.Ball.Speed) * 0.5 ' averge speed of 

      maxElasticCoef = base_elasticCoef
      If FlipperExt.AngleDiff > 1 Then maxElasticCoef = maxElasticCoef - reduction_for_flipper_in_motion

      elasticCoef = base_elasticCoef
      If ballSpeed > 1 Then elasticCoef = expected_ball_speed_after_hit / ballSpeed
      elasticCoef = elasticCoef + minimum_elasticCoef_to_scale_fast_balls

      If elasticCoef > maxElasticCoef Then elasticCoef = maxElasticCoef

      FlipperExt.SetMaterial elasticCoef 
   End If
End Sub

' === End of Dynamic Flipper Settings ===


xBAM.Lights.Brightness = 1.60 ' slightly increase the brightness of the playfield inserts...


   DispDMD1.AddFont 1, "dmd05x05p"
	DispDMD1.AddFont 2, "dmd06x07p"
	DispDMD1.AddFont 3, "dmd08x09p"
	DispDMD1.AddFont 4, "dmd08x13p"
	DispDMD1.AddFont 5, "dmd09x11po"
	DispDMD1.AddFont 6, "BigFont"
	DispDMD1.AddFont 7, "IndyScore"
	DispDMD1.AddFont 9, "IndyNumbers"
	DispDMD1.AddFont 10, "dmd07x09po"
	DispDMD1.AddFont 11, "JackpotFont"
	DispDMD1.AddFont 12, "Score"
	DispDMD1.AddFont 13, "dmd15x32p"

   DispDMD2.AddFont 1, "dmd05x05p"
	DispDMD2.AddFont 2, "dmd06x07p"
	DispDMD2.AddFont 3, "dmd08x09p"
	DispDMD2.AddFont 4, "dmd08x13p"
	DispDMD2.AddFont 5, "dmd09x11po"
	DispDMD2.AddFont 6, "BigFont"
	DispDMD2.AddFont 7, "IndyScore"
	DispDMD2.AddFont 9, "IndyNumbers"
	DispDMD2.AddFont 10, "dmd07x09po"
	DispDMD2.AddFont 11, "JackpotFont"
	DispDMD2.AddFont 12, "Score"
	DispDMD2.AddFont 13, "dmd15x32p"

Const constMaxPlayers 		= 4

Dim BallsRemaining(4)
Dim ExtraBallsAwards(4)
Dim ReOpen(4)
Dim GrailHitsRemain(4),StoneHitsRemain(4),ArkHitsRemain(4),SkullHitsRemain(4)
Dim StonesCollected(4)
Dim Temp1(4),Temp2(4),Temp3(4),Temp4(4),Temp5(4),Temp6(4),Temp7(4),Temp8(4),Temp9(4),Temp10(4),Temp11(4)
Dim Temp12(4),Temp13(4),Temp14(4),Temp15(4),Temp16(4),Temp17(4),Temp18(4),Temp19(4),Temp20(4),TempEB(4)
Dim TempCrusade(4),TempDoom(4),TempRaiders(4),TempSkull(4)
Dim RaidersJP(4),TempleJP(4),CrusadeJP(4),SkullJP(4)
Dim SkullNeeded(4),TempleNeeded(4),CrusadeNeeded(4)
Dim RROn(4),LROn(4)
Dim FreeShot(4),EB(4)
Dim ChallengeVal(4),Challenge(4)
Dim GrabIdol(4),NoHit(4),BSTime(4)
Dim BBArk(4),BBTemple(4),BBGrail(4),BBSkull(4),BBTotal(4),BBVal(4)
Dim LastBonus(4)
Dim IndyFSVal(4),JonesFSVal(4)
Dim HurryVal(4),RampVal(4)
Dim EBScore15(4),EBScore40(4)
dim Swordhit(4),SwordScore(4),SwordWin(4),SwordHUVal(4),SwordNeeded(4)

Dim PlayersPlayingGame,CP
Dim ComboTotal
Dim ShowMe,StatusActive
Dim ItemReward
Dim BOG
Dim P1Score,P2Score,P3Score,P4Score
Dim BonusBall
Dim LastSwitchHit
Dim BallsOnPlayfield		
Dim bOnTheFirstBall
Dim bBallInPlungerLane
Dim bBallSaverActive
Dim bMultiBallMode		
Dim bEnteringAHighScore
dim ScoreUpdate
dim ModeName
dim mapmulti
dim jpscore
dim indyscoring,jonesscoring
dim indyhitsleft,joneshitsleft
dim TotalBonus
dim ArkHit
dim templehit,grailhit,skullhit
dim MysteryMode
dim HurryTotal
dim xmarks,xmarkshits
dim BallFromStone
dim IndyMatch,RndMatch
dim rjackpothits,rJackpotHitsLeft,jackpotanim
dim templeopen
Dim PropSpeed
Dim Saw
Dim BallSaved
Dim NewBall
Dim StoneQ
Dim FlashLight
Dim BallLaunched
Dim FromRightOrbit,FromLeftOrbit
Dim ChooseJP
Dim QuoteBusy
Dim Flash
Dim LeftComing,RightComing
Dim RandomSpin
Dim ModeHit
Dim TempleScene
Dim SlingStop
Dim INDY,JONES
Dim HurryTime
Dim TempL1,TempL2,TempL3,TempL4,TempL5,TempL6,TempL7,TempL8,TempL9
Dim BRHigh,BRLow
Dim Antidote
Dim RotateL,RotateL2
Dim JHit
Dim Nazi,NaziVal,NaziTime
Dim Ants,Snakes,Rats
Dim SuperPops
Dim NaziTgt
Dim NoRtn
Dim TiltCheck
Dim QPlay
Dim SPop,SPopStart
Dim MatchPlayed,MatchWin
Dim SpinFxR
Dim AttPlay
Dim ItemSpin,SpinStop
Dim RS
Dim PlaneOn
Dim MQ
Dim IgnoreMe
Dim Demon
Dim Run
Dim SpinsL,SpinsR,SpinFx
Dim JPHit
Dim CairoSwordsman
Dim NaziTotal
Dim INDYThrow,JONESThrow
Dim Guard
Dim MagnetActive,ArkMagnet,Pulse,TrigHit
Dim FadeTime
Dim GF
Dim IgnoreMe2
Dim Diamond
Dim HurryUpMode
Dim ComboVal
Dim IHit,LOut,ROut
Dim DoomTime
Dim Clip,Escape
Dim IJScoring,HU,IJTotal
Dim IndyComplete,JonesComplete
Dim ComboX
Dim Gallop
Dim PreKick
Dim SceneTotal,SceneVal
Dim INDYTotal,JONESTotal
Dim PName,P1Play,P2Play,P3Play,P4Play
Dim BonusActive
Dim JLights,BonusHeld,LastShot
Dim TFire
Dim ChooseTotal
Dim MoviePick
Dim Thrust
Dim Trap,IdolBonus
Dim ArkOpen,Nuke,JustSkill
Dim BallHeld,EBPlay,SpecialPlay
Dim ShowHUD,WinVal,Flipped


OverlayMovie.UpdateInterval = 68
OverlayMovie2.UpdateInterval = 68
LCD.UpdateInterval = 68

ExecuteGlobal LoadExternalScript("DOFLinx.vbs")

' when the machine is first powered on, play something fun (first time only)...

Sub FuturePinball_BeginPlay()

FF_Init
	FF_DOFLinx=1  ' Set this to 0 to manually disable the link to DOFLinx.
                 ' DOFLinx must be active and set to link for this to make a difference

	Randomize

	Swordsman.anglexz = 245 ' make sure he's not out and ready to attack (sneaky sod)...

	' INDY JONES lights...
	TempL1 = BulbOff
	TempL2 = BulbOff
	TempL3 = BulbOff
	TempL4 = BulbOff
	TempL5 = BulbOff
	TempL6 = BulbOff
	TempL7 = BulbOff
	TempL8 = BulbOff
	TempL9 = BulbOff

	' captive balls in the Map Room...
	Kicker3.CreateCaptiveBall
	Kicker4.CreateCaptiveBall
	Kicker5.CreateCaptiveBall

	' first time start? (resets when fpRAM is cleared)
	If (nvR1 = 0) Then
		PlayMusic 1, "Music_Start", FALSE, 0.7
		PlayMusic 2, "vo_IndyJones", FALSE, 1, 1000
		PlayMusic 3, "vo_CallHimDrJones", FALSE, 1, 2600
		nvR1 = 1
		DispDMD1.Text = "[edge3][f2][y5]WELCOME[f4][y15]INDIANA JONES"
 		DispDMD2.Text = "[edge3][f2][y5]WELCOME[f4][y15]INDIANA JONES"
		DelayStartUp.Set TRUE, 4400
	Else
		EndOfGame()
	End If

	set LastSwitchHit = LeftSlingShotRubber
	nvCredits = 0
	bOnTheFirstBall = FALSE
	bEnteringAHighScore	= FALSE
	BallsOnPlayfield = 0
End Sub



Sub DelayStartUp_Expired()
	DelayStartUp.Enabled = FALSE
	EndOfGame()
End Sub



nvBallsPerGame = 3


ShowHUD = 0

Sub HUDSwitch()
	PlaySound "fx_1"
	Select Case ShowHUD
		Case 0:
			LCD.FadeOut
			LCD2.FadeOut
			LCD3.FadeOut
			OverlayFrameHUD.FadeOut
			DispDMD1.FadeOut
			ShowHUD = 1
		Case 1:
			LCD.FadeIn
			LCD2.FadeIn
			LCD3.FadeIn
			OverlayFrameHUD.FadeIn
			DispDMD1.FadeIn
			ShowHUD = 0
	End Select
End Sub




Sub FuturePinball_KeyPressed(ByVal KeyCode)

     FF_Button BUT_CN,BA_OFF,0,0   'DOFLinx - Coin Light - OFF
		FF_DEV DV_SR,30  'DOFLinx - STROBE - Coin inserted
		FF_Button BUT_ST,BA_FL,1000,50   'DOFLinx - Start Button - Flashing - Coin inserted


	' *** TEST STUFF ***

	If (KeyCode = 19) Then
	End If

	If (KeyCode = 20) Then
	End If

	If (KeyCode = 21) Then
	End If




	' The ACTION BUTTON, is gently pressed or hit hard (depending on your mood).
	' If the ACTION BUTTON is lit, then this action will automatically create a FREE SHOT - automatically hit the lit shot.
	' A FREE SHOT can only be used once per Scene and cannot be used as the final shot to win the scene.

	If (KeyCode = GetKeyCode(Special1Key)) Then

		PlaySound "fx_FlipperButton", 0.8

		If (fpGameInPlay = FALSE) Then HUDSwitch(): Exit Sub

		' check if lit and if a movie scene is active...
		If (FreeShot(CP) =>1) and (ModeName <>"") and (BulbFS.State = BulbBlink) Then

			FreeShot(CP) = FreeShot(CP) - 1

			If (FreeShot(CP) = 0) Then BulbFS.State = BulbOff: LightFS.State = BulbOff
			
			set LastSwitchHit = LeftSlingShotRubber
			
			' Raiders SCENE 1: ACT 1 will make any spinner shot...

			If (ModeName = "RScene1") Then
				If (LightOrbitL.State = BulbBlink) or (LightOrbitR.State = BulbBlink) Then
					' running from the boulder in Raiders scene 1..
					LightOrbitL.State = BulbOff
					LightOrbitR.State = BulbOff
					PlayMusic 3, "Music_Cue3"
					Flash = 2: FlashPFTimer.Set TRUE, 75 
					LightArk.State = BulbBlink
					BulbFS.State = BulbOff: LightFS.State = BulbOff
					Clip = 8: PlayClip()
					ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
					DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
					DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
					SceneHit()
				Exit Sub
				End If

				' Raiders SCENE 1: ACT 2 will make the ramp shot during the chase (first shot only)...

				If (LightSkull.State = BulbBlink) and (LastShot = FALSE) Then RampTrigger_Hit():	Exit Sub
			End If

			' Raiders SCENE 2: ACT 1 will release Marion...really? it's an easy shot, come on now...

			If (ModeName = "RScene2") Then
				If (LightArk.State = BulbBlink) Then MagnetRelease_Hit(): Exit Sub
			End If

			' Raiders SCENE 3: ACT 1 will make any loop shot...
			' Raiders SCENE 3: ACT 2 will throw a bad guy from the truck...

			If (ModeName = "RScene3") Then
				If (LightOrbitL.State = BulbBlink) or (LightOrbitR.State = BulbBlink) Then
					TriggerRightOrbit_Hit()
				Exit Sub
				Else
					If (INDYThrow = FALSE) Then INDYThrow = TRUE: GuardThrow(): Exit Sub
					If (JONESThrow = FALSE) Then JONESThrow = TRUE: GuardThrow(): Exit Sub
				End If
			End If

			' Temple SCENE 1: ACT 1 will grab the DIAMOND or ANTITODE...

			If (ModeName = "TScene1") Then
				If (Antidote = FALSE) Then GetAntidote():	Exit Sub
				If (Diamond = FALSE) Then GetDiamond(): Exit Sub
			End If

			' Temple SCENE 2: ACT 1 will make a ramp shot...

			If (ModeName = "TScene2") Then ' jump from plane...(FOR LONGER VERSION)
				If (LightSkull.State = BulbBlink) Then	RampTrigger_Hit(): Exit Sub
			End If

			' Temple SCENE 3: ACT 1 will make the loop shot to start the chase...

			If (ModeName = "TScene3") Then
				If (LightOrbitR.State = BulbBlink) Then TriggerRightOrbit_Hit(): Exit Sub
			End If

			' Temple SCENE 4: ACT 1 will make a COMBO shot to start cutting the rope...

			If (ModeName = "TScene4") Then
				If (LightOrbitR.State = BulbBlink) Then
					ComboTimer.Set TRUE, 1000
					TriggerRightOrbit_Hit()
				Exit Sub
				End If
			End If

			' Crusade SCENE 1: ACT 1 will make the Ark shot to grab the Cross...

			If (ModeName = "CScene1") Then ' get cross/get to train/run across train...
				If (LightArk.State = BulbBlink) Then TriggerArk_Hit(): Exit Sub
				If (LightOrbitL.State = BulbBlink) or (LightOrbitR.State = BulbBlink) Then
					TriggerLeftOrbit_Hit()
				Exit Sub
				End If
				' run across the train roof...
				If (LightSkull.State = BulbBlink) Then RampTrigger_Hit(): Exit Sub
			End If

			' Crusade SCENE 2: Make a lit shot...

			If (ModeName = "CScene2") Then
				If (LightOrbitL.State = BulbBlink) Then TriggerLeftOrbit_Hit(): Exit Sub
				If (LightArk.State = BulbBlink) Then TriggerArk_Hit(): Exit Sub
			End If

			' Crusade SCENE 3: Make a lit shot...

			If (ModeName = "CScene3") Then
				If (LightOrbitL.State = BulbBlink) Then TriggerLeftOrbit_Hit(): Exit Sub
				If (LightOrbitR.State = BulbBlink) Then TriggerRightOrbit_Hit(): Exit Sub
				If (LightSkull.State = BulbBlink) Then RampTrigger_Hit(): Exit Sub
				If (LightArk.State = BulbBlink) Then TriggerArk_Hit(): Exit Sub
				If (LightDoom.State = BulbBlink) Then StoneTarget_Hit(): Exit Sub
				If (LightCrusade.State = BulbBlink) Then GrailKicker_Hit(): GrailKickerTimer.Set FALSE: Exit Sub
			End If

			' Crusade SCENE 4: will choose wisely...

			If (ModeName = "CScene4") Then
				If (LightOrbitL.State = BulbBlink) Then TriggerLeftOrbit_Hit(): Exit Sub
				If (LightOrbitR.State = BulbBlink) Then TriggerRightOrbit_Hit(): Exit Sub
				If (LightSkull.State = BulbBlink) Then RampTrigger_Hit(): Exit Sub
				If (LightArk.State = BulbBlink) Then TriggerArk_Hit(): Exit Sub
				If (LightDoom.State = BulbBlink) Then StoneTarget_Hit(): Exit Sub
				If (LightCrusade.State = BulbBlink) Then GrailKicker_Hit(): GrailKickerTimer.Set FALSE: Exit Sub
			End If

			' Crystal Skull SCENE 1 will add 50% power to the thruster...

			If (ModeName = "SScene1") and (LightOrbitR.State = BulbBlink) Then
				Thrust = Thrust + 50: RocketHit()
			End If

			' Crystal Skull SCENE 2: ACT 1 will open the fridge...

			If (ModeName = "SScene2") Then ' open the fridge...
				If (LightDoom.State = BulbBlink) and (TempleOpen = FALSE) Then
					StoneTarget_Hit()
				Exit Sub
				End If
			End If

			' Crystal Skull SCENE 3 will make a ramp shot reducing power of the skull...

			If (ModeName = "SScene3") Then
				SkullPowerHit()
			End If
	
			' all shots are lit so just hit one of them...
			If (ModeName = "SScene4") Then
				If (LightOrbitL.State = BulbBlink) Then TriggerLeftOrbit_Hit(): Exit Sub
			End If
		Exit Sub
		End If

		' Player has control over which movie scene to start next, no longer in a forced order.
		' Pressing the ACTION BUTTON (when not lit) will rotate all the lights in sequence, apart from the Scenes already played.
		' If the ACTION BUTTON is not pressed at anytime, the game will play all the scenes in order.

		If (ModeName = "") Then
			RaidersSceneSwap()
			TempleSceneSwap()
			CrusadeSceneSwap()
			SkullSceneSwap()
		End If
	End If

	If (KeyCode = GetKeyCode(InsertCoinKey)) Then
		nvCredits = nvCredits + 1
		If (fpGameInPlay = FALSE) Then
			FF_Button BUT_ST,BA_FL,0,0 
			Select Case nvCredits
				Case 1,2,3,4: PlaySound "fx_CoinIn"
				Case 5: PlayMusic 2, "fx_IndyCoin"
				Case else: PlaySound "fx_CoinIn"
			End Select
			DispDMD1.Text = "[edge3][f6][xc][yc]CREDITS " & nvCredits
			DispDMD2.Text = "[edge3][f6][xc][yc]CREDITS " & nvCredits
			AttractTimer.Enabled = FALSE
			StopMusic 3: Tune = 1: MusicPlay()
			MovieTimer_Expired()
		Else
			PlaySound "fx_CoinIn"
		End If
	End If

	If (fpGameInPlay = TRUE) Then

		If (fpTilted = FALSE) Then

			If (KeyCode = GetKeyCode(PlungerKey)) Then

				If (CairoSwordsman = TRUE) and (bBallInPlungerLane = FALSE) Then
					SwordsmanShot()
				Exit Sub
				End If

				If (BallsOnPlayfield =>1) Then
					PlungerTimer.Enabled = FALSE
					Plunger.SolenoidPulse
					If (bBallInPlungerLane = TRUE) Then
						PlaySound "fx_BallLaunch"
						' playsound "fx_GunShot2"
						FF_Sound DV_RS,-1,"fx_GunShot2"
						BulbArkL.FlashForMs 300, 150, BulbOff
						BulbArkR.FlashForMs 300, 150, BulbOff
						FlasherRed.FlashForMs 300, 150, BulbOff
						PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 300
					Else
						PlaySound "fx_EmptyGun"
					End If
				End If
			End If

			If (KeyCode = GetKeyCode(LeftFlipperKey)) Then
				If (BallsOnPlayfield =>1) Then
					If (Flipped = TRUE) Then
						RightFlipper.SolenoidOn
						FF_Sound DV_RF,1000,"Flipper"    ' Turn on the right flipper for upto 10 seconds (realistically until thge key is lifted
						FF_Flasher DV_FLIR,FL_FL,2,20,100,"Random"  'DOFLinx - Flipper Flasher - Random
					Else
						LeftFlipper.SolenoidOn
						FF_Sound DV_LF,1000,"Flipper"    ' Turn on the left flipper for upto 10 seconds (realistically until thge key is lifted
						FF_Flasher DV_FLIL,FL_FL,2,20,100,"Random"  'DOFLinx - Flipper Flasher - Random
					End If
					If (StatusActive = TRUE) Then
						ShowStatusTimer_Expired()
					End If
				End If
				' skip the end of ball bonus...
				If (BonusActive = TRUE) and (LastBonus(CP) = FALSE) Then
					EOBTotal.Enabled = FALSE
					EOBArk.Enabled = FALSE
					EOBTemple.Enabled = FALSE
					EOBGrail.Enabled = FALSE
					EOBSkull.Enabled = FALSE
					EOBMulti.Enabled = FALSE
					BonusActive = FALSE
					If (MapMulti = 0) Then MapMulti = 1
					TotalBonus = (TotalBonus*MapMulti)
					NoS(): OverlayLCD.Frame 66: LCD.Frame 66 
					BulbArkL.Set BulbBlink, 	"00001100000000000000", 75
					BulbArkR.Set BulbBlink, 	"00001100000000000000", 75
					FlasherRed.Set BulbBlink, 	"00001100000000000000", 75
					PlaySound "fx_Whip6"
					DispDMD1.FlushQueue: DispDMD2.FlushQueue
					DispDMD1.QueueText "[edge3][f4][xc][y3]TOTAL BONUS[bf][xc][y17]" & formatscore(TotalBonus), deNone, 1000, FALSE
					DispDMD2.QueueText "[edge3][f4][xc][y3]TOTAL BONUS[bf][xc][y17]" & formatscore(TotalBonus), deNone, 1000, FALSE
					ScoreUpdate = FALSE
					AddScore(TotalBonus)
					If (BBArk(CP) = TRUE) and (BBTemple(CP) = TRUE) and (BBGrail(CP) = TRUE) and (BBSkull(CP) = TRUE) Then
						DispDMD1.QueueText "[edge3][f4][xc][y3][bf]BONUS BALL[xc][y17]QUALIFIED", deNone, 1000, TRUE
						DispDMD2.QueueText "[edge3][f4][xc][y3][bf]BONUS BALL[xc][y17]QUALIFIED", deNone, 1000, TRUE
						PlayMusic 1, "Music_Cue16", FALSE, 1, 1000
						EndOfBallTimer.Set TRUE, 3800
					Else
						EndOfBallTimer.Set TRUE, 1500
					End If
				End If
			End If

			If (KeyCode = GetKeyCode(RightFlipperKey)) Then
				If (BallsOnPlayfield =>1) Then
					If (Flipped = TRUE) Then
						LeftFlipper.SolenoidOn
						FF_Sound DV_LF,1000,"Flipper"    ' Turn on the left flipper for upto 10 seconds (realistically until thge key is lifted
						FF_Flasher DV_FLIL,FL_FL,2,20,100,"Random"  'DOFLinx - Flipper Flasher - Random
					Else
						RightFlipper.SolenoidOn
						FF_Sound DV_RF,1000,"Flipper"    ' Turn on the right flipper for upto 10 seconds (realistically until thge key is lifted
						FF_Flasher DV_FLIR,FL_FL,2,20,100,"Random"  'DOFLinx - Flipper Flasher - Random
					End If
					ShowMe = 0: ShowStatusTimer.Set TRUE, 5000
				End If
			End If

			If (KeyCode = GetKeyCode(StartGameKey)) Then
				If ((PlayersPlayingGame < constMaxPlayers) and (bOnTheFirstBall = TRUE)) Then
					If (nvCredits > 0) Then
						PlayersPlayingGame = PlayersPlayingGame + 1
						DispDMD1.FlushQueue: DispDMD2.FlushQueue
						Select Case PlayersPlayingGame
							Case 2: ' Jones Snr
								If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_ImHere"
								PlaySound "fx_Jungle5"
								DispDMD1.QueueText "[f12][y3][xc]WELCOME[y17][xc]JONES SNR", deNone, 1000, FALSE
								DispDMD2.QueueText "[f12][y3][xc]WELCOME[y17][xc]JONES SNR", deNone, 1000, FALSE
							Case 3: ' Marcus
								If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_YourServant"
								PlaySound "fx_Jungle6"
								DispDMD1.QueueText "[f12][y3][xc]WELCOME[y17][xc]MARCUS", deNone, 1000, FALSE
								DispDMD2.QueueText "[f12][y3][xc]WELCOME[y17][xc]MARCUS", deNone, 1000, FALSE
							Case 4: ' Sallah
								If (QuoteBusy = FALSE) Then
									'QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3300
									'MusicFade(3300): PlayMusic 2, "vo_Visitors"
									If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_SallahLaugh"
								Else
									PlaySound "fx_Jungle7"
								End If
								DispDMD1.QueueText "[f12][y3][xc]WELCOME[y17][xc]SALLAH", deNone, 3300, FALSE
								DispDMD2.QueueText "[f12][y3][xc]WELCOME[y17][xc]SALLAH", deNone, 3300, FALSE
						End Select
						nvCredits = nvCredits - 1
					Else
						PlaySound "fx_Belch"
						LightSeqPF.Play SeqBlinking, , 2, 50
						PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 300
					End If
				End If
			End If
		End If
	Else
		If (KeyCode = GetKeyCode(RightFlipperKey)) Then
			NoS()
			nvBallsPerGame = nvBallsPerGame + 1
			If (nvBallsPerGame > 6) Then
				nvBallsPerGame = 6: PlaySound "fx_Bad": OverlayLCD.Frame 266: LCD.Frame 266
			Else
				PlaySound "fx_Punch"
				Select Case nvBallsPerGame
					Case 3: OverlayLCD.Frame 261: LCD.Frame 261
					Case 4: OverlayLCD.Frame 262: LCD.Frame 262
					Case 5: OverlayLCD.Frame 263: LCD.Frame 263
					Case 6: OverlayLCD.Frame 264: LCD.Frame 264
				End Select
			End If
		End If
		If (KeyCode = GetKeyCode(LeftFlipperKey)) Then
			NoS()
			nvBallsPerGame = nvBallsPerGame - 1
			If (nvBallsPerGame < 3) Then
				nvBallsPerGame = 3: PlaySound "fx_Bad": OverlayLCD.Frame 265: LCD.Frame 265
			Else
				PlaySound "fx_Punch"
				Select Case nvBallsPerGame
					Case 3: OverlayLCD.Frame 261: LCD.Frame 261
					Case 4: OverlayLCD.Frame 262: LCD.Frame 262
					Case 5: OverlayLCD.Frame 263: LCD.Frame 263
					Case 6: OverlayLCD.Frame 264: LCD.Frame 264
				End Select
			End If
		End If
      If (KeyCode = GetKeyCode(StartGameKey)) Then
			If (nvCredits > 0) Then
				If (BallsOnPlayfield = 0) Then
					nvCredits = nvCredits - 1
					ResetForNewGame()
				End If
			Else
				LightSeqPF.Play SeqBlinking, , 1, 150
				Flash = 5: FlashPFTimer.Set TRUE, 150
				BulbArkL.FlashForMs 150, 150, BulbOff
				BulbArkR.FlashForMs 150, 150, BulbOff
				FlasherRed.FlashForMs 150, 150, BulbOff
				Clip = 7: PlayClip() ' show the monkey clip, he's not happy...
				PlayMusic 1, "Music_Cue2"
				PlayMusic 2, "vo_NoTicket"
				DispDMD1.Text = "[edge3][f6][xc][y3][b]INSERT COINS[f2][y20]NO CHEATING"
				DispDMD2.Text = "[edge3][f6][xc][y3][b]INSERT COINS[f2][y20]NO CHEATING"
			End If
		End If
	End If
End Sub



Sub FuturePinball_KeyReleased(ByVal KeyCode)
	If (KeyCode = GetKeyCode(PlungerKey)) Then
	End If
	If (fpGameInPlay = TRUE) Then
		If (fpTilted = FALSE) Then
			If (KeyCode = GetKeyCode(LeftFlipperKey)) Then
				If (Flipped = TRUE) Then
					RightFlipper.SolenoidOff
		            FF_Dev DV_RF,0    ' Turn the flipper solenoids off
					
				Else
					LeftFlipper.SolenoidOff
					FF_Dev DV_LF,0    ' Turn the flipper solenoids off

				End If
			End If
			If (KeyCode = GetKeyCode(RightFlipperKey)) Then
				If (Flipped = TRUE) Then
					LeftFlipper.SolenoidOff
					FF_Dev DV_LF,0    ' Turn the flipper solenoids off

				Else
					RightFlipper.SolenoidOff
		            FF_Dev DV_RF,0    ' Turn the flipper solenoids off

				End If
				ShowMe = 0: ShowStatusTimer.Enabled = FALSE: StatusActive = FALSE
			End If
		End If
	End If
End Sub



Sub FuturePinball_Paused()
	PlayMusic 8, "Music_ShortRound", TRUE, 1
End Sub



Sub FuturePinball_UnPaused()
	StopMusic 8
End Sub


Sub SlingBlockTimer_Expired()
	SlingBlockTimer.Enabled = FALSE
	SlingStop = FALSE
End Sub



Sub FuturePinball_TiltWarning(ByVal Warnings)
	dim tq
	FF_Colour "Red",RGB_FL,150  ' DOFLinx - RGB Lighting - Flash - Red
	PlaySound "fx_Nudge": SlingBlockTimer.Set TRUE, 2000: SlingStop = TRUE
	Select Case Warnings
		Case 1:
		Case 2:
			DispDMD1.FlushQueue: DispDMD2.FlushQueue
			DispDMD1.QueueText "[edge3][f6][xc][yc]W A R N I N G", deNone, 800, TRUE
			DispDMD2.QueueText "[edge3][f6][xc][yc]W A R N I N G", deNone, 800, TRUE
			FlushDMDTimer.Set TRUE, 800
			If (QuoteBusy = FALSE) and (ResumeVol.Enabled = FALSE) Then
				QuoteBusy = TRUE
				Select Case RandomNumber(12)
					Case 1: PlayMusic 2, "vo_Crazy": tq = 800 
					Case 2: PlayMusic 2, "vo_ThinkAgain": tq = 1000
					Case 3: PlayMusic 2, "vo_TakeItEasy": tq = 800
					Case 4: PlayMusic 2, "vo_Jnr": tq = 600
					Case 5: PlayMusic 2, "vo_ToldYou": tq = 800
					Case 6: PlayMusic 2, "vo_Complaining": tq = 1000
					Case 7: PlayMusic 2, "vo_Jnr2": tq = 600
					Case 8: PlayMusic 2, "vo_Genargh3": tq = 600
					Case 9: PlayMusic 2, "vo_Civ": tq = 1800
					Case 10: PlayMusic 2, "vo_StopStop": tq = 1000
					Case 11: PlayMusic 2, "vo_Hey": tq = 500
					Case 12: PlayMusic 2, "vo_HeyDrJones": tq = 1000
				End Select
				MusicFade(tq)
			End If
		Case 3:
			If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: PlayMusic 2, "vo_StopIt": tq = 600: MusicFade(tq)
			DispDMD1.FlushQueue: DispDMD2.FlushQueue
			DispDMD1.QueueText "[edge3][box2,8,6,120,25][f6][xc][yc]W A R N I N G", deNone, 100, FALSE
			DispDMD2.QueueText "[edge3][box2,8,6,120,25][f6][xc][yc]W A R N I N G", deNone, 100, FALSE
			DispDMD1.QueueText "[edge3]", deNone, 100, FALSE
			DispDMD2.QueueText "[edge3]", deNone, 100, FALSE
			FlushDMDTimer.Set TRUE, 1000
		Case 4:
			If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: PlayMusic 2, "vo_CutItOut": tq = 1800: MusicFade(tq)
			DispDMD1.FlushQueue: DispDMD2.FlushQueue
			DispDMD1.QueueText "[edge3][box2,8,6,120,25][f6][xc][yc]W A R N I N G", deNone, 50, FALSE
			DispDMD2.QueueText "[edge3][box2,8,6,120,25][f6][xc][yc]W A R N I N G", deNone, 50, FALSE
			DispDMD1.QueueText "[edge3]", deNone, 50, FALSE
			DispDMD2.QueueText "[edge3]", deNone, 50, FALSE
			FlushDMDTimer.Set TRUE, 1000
	End Select
End Sub



Sub FuturePinball_Tilted()
	PlayMusic 1, "Music_Drain2"
	StopMusic 4: StopMusic 5: StopMusic 8 
	If (QuoteBusy = FALSE) Then
		Select Case RandomNumber(5)
			Case 1: PlayMusic 2, "vo_Tilt"
			Case 2: PlayMusic 2, "vo_KillYouNow"
			Case 3: PlayMusic 2, "vo_BigMistake"
			Case 4: PlayMusic 2, "vo_DidWhatIDid"
			Case 5: PlayMusic 2, "vo_Sorry"
		End Select
	End If
	DispDMD1.Text = "[edge3][box2,8,6,120,25][f6][xc][yc][b]T I L T"
	DispDMD2.Text = "[edge3][box2,8,6,120,25][f6][xc][yc][b]T I L T"
	LightCrusadeExt.SetLitColor 94, 203, 255
	LightDoomExt.SetLitColor 255, 164, 72
	LightArkExt.SetLitColor 219, 192, 241
	LightSkullExt.SetLitColor 156, 233, 131
	LightOrbitRExt.SetLitColor 243, 117, 63
	xBAM.Camera.DesktopRelease 500
	LeftFlipper.SolenoidOff
	RightFlipper.SolenoidOff
		FF_Dev DV_LF,0    ' Turn the flipper solenoids off
		FF_Dev DV_RF,0    ' Turn the flipper solenoids off

	FlushDMDTimer_Expired(): ShowMe = 0
	SpotArk.State = BulbOff
	FlasherArkSpot.State = BulbOff
	BulbFS.State = BulbOff: LightFS.State = BulbOff
	BallStopper.Collidable = FALSE
	If (PlaneOn = TRUE) Then 
		PlaneOn = FALSE
		PropStop.Set TRUE, 500
	End If
	BallSaverTimer.Enabled = FALSE
	bBallSaverActive = FALSE
	StoneLightsOff()
	BulbDoom.State = BulbOff
	SkullBulb.State = BulbOff
	TorchesOff()
	SlingStop = TRUE
	OneBallTimer.Enabled = FALSE
	TwoBallTimer.Enabled = FALSE
	ThreeBallTimer.Enabled = FALSE
	FourBallTimer.Enabled = FALSE
	NaziTimer.Enabled = FALSE: NaziTgt = FALSE
	MagnetRelease.Collidable = FALSE
	Magnet.Collidable = FALSE
	StartRovingLights.Enabled = FALSE
	StartRovingINDYJONES.Enabled = FALSE
	PlayMovie.Enabled = FALSE
	TankFire.Enabled = FALSE
	If (ModeName = "RScene1") Then SceneRAIDERSComplete()
	If (ModeName = "RScene2") Then SceneRAIDERSComplete()
	If (ModeName = "RScene3") Then SceneRAIDERSComplete()
	If (ModeName = "RScene4") Then SceneRAIDERSComplete()
	If (ModeName = "TScene1") Then SceneTEMPLEComplete()
	If (ModeName = "TScene2") Then SceneTEMPLEComplete()
	If (ModeName = "TScene3") Then SceneTEMPLEComplete()
	If (ModeName = "TScene4") Then SceneTEMPLEComplete()
	If (ModeName = "CScene1") Then SceneCRUSADEComplete()
	If (ModeName = "CScene2") Then SceneCRUSADEComplete()
	If (ModeName = "CScene3") Then SceneCRUSADEComplete()
	If (ModeName = "CScene4") Then SceneCRUSADEComplete()
	If (ModeName = "SScene1") Then SceneSKULLComplete()
	If (ModeName = "SScene2") Then SceneSKULLComplete()
	If (ModeName = "SScene3") Then SceneSKULLComplete()
	If (ModeName = "SScene4") Then SceneSKULLComplete()
	ModeName = ""
	Flipped = FALSE
	If (CairoSwordsman = TRUE) Then StopSwordsman()
	StopHurryUps(): StopFastScoring()
	DoomTimer.Enabled = FALSE
	LightCrusade.State = BulbOff
	LightDoom.State = BulbOff
	LightArk.State = BulbOff
	LightSkull.State = BulbOff
	LightOrbitR.State = BulbOff
	LightOrbitL.State = BulbOff
	FlasherStone.State = BulbOff
	ModeTimer.Enabled = FALSE
	RampDiverter.SolenoidOff
	PopUpLane.SolenoidOff
	ShowMe = 0: ShowStatusTimer.Enabled = FALSE: StatusActive = FALSE
	MovieTimer.Enabled = FALSE
	NoS(): OverlayLCD.Frame 542: LCD.Frame 542
	FlashPFTimer.Enabled = FALSE
	ClearSeq()
	PlasDarkOn()
	LightSeqPF.Play SeqAllOff
	TiltCheck = 0: TiltRecoveryTimer.Set TRUE, 5000
End Sub



Sub TiltRecoveryTimer_Expired()
	TiltRecoveryTimer.Enabled	= FALSE
	If (BallsOnPlayfield = 0) Then
		BallStopper.Collidable = TRUE
		SlingStop = FALSE
		LightSeqPF.StopPlay
		EndOfBall()
	Else
		TiltCheck = TiltCheck + 1
		Select Case TiltCheck
			Case 1:
				' ok, where's the damn ball?...
				DispDMD1.Text = "[edge3][f4][xc][y3]BALL MISSING[b][y16]SEARCHING..."
				DispDMD2.Text = "[edge3][f4][xc][y3]BALL MISSING[b][y16]SEARCHING..."
				PlayMusic 2, "vo_Hello"
				TiltRecoveryTimer.Set TRUE, 3000
			Case 2:
				' is it hidding in the Grail Kicker?...
				DispDMD1.Text = "[edge3][f4][xc][y3]BALL MISSING[bf][y16]SEARCHING..."
				DispDMD2.Text = "[edge3][f4][xc][y3]BALL MISSING[bf][y16]SEARCHING..."
				GrailKicker.SolenoidPulse: Playsound "fx_ScoopExit"
				PlayMusic 2, "vo_GetOut"
			Case 3:
				KickerMapX.SolenoidPulse
				PlayMusic 3, "vo_WhatWeDo", FALSE, 1, 500
			Case 4:
				Clip = 7: PlayClip() ' show the monkey, he doen't like a lost ball...
				' can't find it, so add a virtual replacement...
				DispDMD1.Text = "[edge3][f4][xc][y3]BALL LOST[b][y16]REPLACING..."
				DispDMD2.Text = "[edge3][f4][xc][y3]BALL LOST[b][y16]REPLACING..."
				BallsOnPlayfield = 0
				BallsRemaining(CP) = BallsRemaining(CP) + 1
		End Select
		TiltRecoveryTimer.Set TRUE, 5000
	End If
End Sub



Sub FuturePinball_MusicFinished(ByVal Channel)
	Select Case Channel
		Case 2: QuoteBusy = FALSE
	End Select
End Sub



Sub FuturePinball_NameEntryComplete(ByVal Position, ByVal Special)
	Select Case Position
		Case 1:
			NoS(): OverlayLCD.Frame 184: LCD.Frame 184 
			DelayHS.Set TRUE, 6700
			PlayMusic 1, "Music_HighScore", FALSE, 0.8
			PlaySound "fx_GunQuad"
			PlayMusic 2, "vo_WowHolySmoke", FALSE, 1, 1000
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 200, FALSE
			DispDMD1.QueueText "[edge3][f6][xc][yc][b]HIGHEST SCORE", deFlip, 2000, FALSE
			DispDMD1.QueueText "[edge3][f4][xc][y3]FINAL SCORE[y17]" & FormatScore(nvScore(CP)), deNone, 1000, TRUE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(1)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(1)), deNone, 200, FALSE
			DispDMD2.QueueText "[edge3][f6][xc][yc][b]HIGHEST SCORE", deFlip, 2000, FALSE
			DispDMD2.QueueText "[edge3][f4][xc][y3]FINAL SCORE[y17]" & FormatScore(nvScore(CP)), deNone, 1000, TRUE
			BigReward()
		Case 2:
			NoS(): OverlayLCD.Frame 184: LCD.Frame 184 
			DelayHS.Set TRUE, 3800
			PlayMusic 1, "Music_BigWin", FALSE, 0.8
			PlaySound "fx_GunQuad"
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 200, FALSE
			DispDMD1.QueueText "[edge3][f6][xc][yc][b]2ND POSITION", deFlip, 1300, FALSE
			DispDMD1.QueueText "[edge3][f4][xc][y3]FINAL SCORE[y17]" & FormatScore(nvScore(CP)), deNone, 1000, TRUE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(2)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(2)), deNone, 200, FALSE
			DispDMD2.QueueText "[edge3][f6][xc][yc][b]2ND POSITION", deFlip, 1300, FALSE
			DispDMD2.QueueText "[edge3][f4][xc][y3]FINAL SCORE[y17]" & FormatScore(nvScore(CP)), deNone, 1000, TRUE
			BigReward()
		Case 3:
			NoS(): OverlayLCD.Frame 184: LCD.Frame 184
			DelayHS.Set TRUE, 3800
			PlayMusic 1, "Music_BigWin", FALSE, 0.8
			PlaySound "fx_GunQuad"
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD1.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 200, FALSE
			DispDMD1.QueueText "[edge3][f6][xc][yc][b]3RD POSITION", deFlip, 1300, FALSE
			DispDMD1.QueueText "[edge3][f4][xc][y3]FINAL SCORE[y17]" & FormatScore(nvScore(CP)), deNone, 1000, TRUE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[box3,1,1,126,30][f13][xc][yc]" & (nvhighscorename(3)), deNone, 50, FALSE
			DispDMD2.QueueText "[f13][xc][yc]" & (nvhighscorename(3)), deNone, 200, FALSE
			DispDMD2.QueueText "[edge3][f6][xc][yc][b]3RD POSITION", deFlip, 1300, FALSE
			DispDMD2.QueueText "[edge3][f4][xc][y3]FINAL SCORE[y17]" & FormatScore(nvScore(CP)), deNone, 1000, TRUE
			BigReward()
		Case 4,5,6,7,8,9:
			DispDMD1.Text = "[edge3][f4][xc][y3]FINAL SCORE[y17]" & FormatScore(nvScore(CP))
			DispDMD2.Text = "[edge3][f4][xc][y3]FINAL SCORE[y17]" & FormatScore(nvScore(CP))
			Select Case RandomNumber(6)
				Case 1: PlayMusic 2, "vo_YourAdventures":	DelayHS.Set TRUE, 3200
				Case 2: PlayMusic 2, "vo_WhatIsThat": DelayHS.Set TRUE, 1800
				Case 3: PlayMusic 2, "vo_Adure": DelayHS.Set TRUE, 2000
				Case 4: PlayMusic 2, "vo_SeeYou": DelayHS.Set TRUE, 2500
				Case 5: PlayMusic 2, "vo_NotFromHere": DelayHS.Set TRUE, 2000
				Case 6: PlayMusic 2, "vo_MisjudgedYou": DelayHS.Set TRUE, 1000
			End Select
		Case else:
			DispDMD1.Text = "[edge3][f4][xc][y3]FINAL SCORE[y17]" & FormatScore(nvScore(CP))
			DispDMD2.Text = "[edge3][f4][xc][y3]FINAL SCORE[y17]" & FormatScore(nvScore(CP))
			Select Case RandomNumber(3)
				Case 1: PlayMusic 2, "vo_YourAdventures":	DelayHS.Set TRUE, 3200
				Case 2: PlayMusic 2, "vo_Adure": DelayHS.Set TRUE, 2000
				Case 3: PlayMusic 2, "vo_SeeYou": DelayHS.Set TRUE, 2500
			End Select
	End Select
End Sub



Sub DelayHS_Expired()
	DelayHS.Enabled = FALSE
	bEnteringAHighScore = FALSE
	BigRewardStop()
	EndOfBallComplete()
End Sub


Sub BigReward()
	PlasDarkOn()
	LightSeqPF.Play SeqBlinking, , 4, 50
	LightSeqPF.Play SeqUpOn, 20, 5
	BulbGrail.Set BulbBlink, "1000", 100
	FlasherStone.Set BulbBlink, "0100", 100
	StoneBulb8.Set BulbBlink, "0100", 100
	FlasherRed.Set BulbBlink, "0010", 100
	BulbArkL.Set BulbBlink, "0010", 100
	BulbArkR.Set BulbBlink, "0010", 100
	SkullBulb.Set BulbBlink, "0001", 100
	Bumper1.Set BulbBlink, "10", 100
	Bumper3.Set BulbBlink, "10", 100
	Bumper2.Set BulbBlink, "01", 100
	Bumper4.Set BulbBlink, "01", 100
	SpotFlashTimer.Set TRUE, 100
End Sub



Sub BigRewardStop()
	LightSeqPF.StopPlay
	BulbGrail.Set BulbOff, "10", 150
	FlasherStone.Set BulbOff, "10", 150
	StoneBulb8.Set BulbOff, "10", 150
	FlasherRed.Set BulbOff, "10", 150
	BulbArkL.Set BulbOff, "10", 150
	BulbArkR.Set BulbOff, "10", 150
	SkullBulb.Set BulbOff, "10", 150
	Bumper1.Set BulbOff, "10", 125
	Bumper3.Set BulbOff, "10", 125
	Bumper2.Set BulbOff, "10", 125
	Bumper4.Set BulbOff, "10", 125
	SpotFlashTimer.Enabled = FALSE: SpotOn(0)
End Sub




' ****************************************************************
' **                                                            **
' **                 THE DANGERS OF THE SCRIPT                  **
' **                                                            **
' ****************************************************************


Sub ResetForNewGame()

	Dim	i
	MovieTimer_Expired()
	AttractTimer.Enabled = FALSE
	StopMusic 3: Tune = 1: MusicPlay()
	
	SemiLitOff()
	
	BGReflect.Render = TRUE

	BallFromStone = FALSE
	jackpotanim = FALSE

	MatchPlayed = FALSE

	TempleScene = 0

	ComboX = 1
	ComboTotal = 0
	SpinVal = 510

	If (TempleOpen = TRUE) Then
		CloseChamber()
		LightDoom.State = BulbOff
	End If

	BonusHeld = FALSE

	P1Play = 1
	P2Play = 1
	P3Play = 1
	P4Play = 1
	P1Score = 0
	P2Score = 0
	P3Score = 0
	P4Score = 0
	DoubleScoreLight.State = BulbOff
	ResetXMarks.set FALSE

	BulbArkL.State = BulbOff
	BulbArkR.State = BulbOff
	FlasherRed.State = BulbOff

	LightSeqAtt.StopPlay
	LightSeqPF.StopPlay

	LightChallenge.State = BulbOff

	LightXMarks.Set BulbOff, "10", 125
	LightCrusade.Set BulbOff, "10", 125
	LightDoom.Set BulbOff, "10", 125
	LightArk.Set BulbOff, "10", 125
	LightSkull.Set BulbOff, "10", 125
	LightOrbitR.Set BulbOff, "10", 125
	LightOrbitL.Set BulbOff, "10", 125

	' reset the INDY JONES lights...
	LightINDY1.Set BulbBlink, "10", 150
	LightINDY2.Set BulbBlink, "10", 150
	LightINDY3.Set BulbBlink, "10", 150
	LightINDY4.Set BulbBlink, "10", 150
	LightJONES1.Set BulbBlink, "10", 150
	LightJONES2.Set BulbBlink, "10", 150
	LightJONES3.Set BulbBlink, "10", 150
	LightJONES4.Set BulbBlink, "10", 150
	LightJONES5.Set BulbBlink, "10", 150

	LightRaidersMain.Set BulbOff, "10", 150
	LightRaidS4.Set BulbOff, "10", 150
	LightRaidS3.Set BulbOff, "10", 150
	LightRaidS2.Set BulbOff, "10", 150
	LightRaidS1.Set BulbBlink, "10", 150
	LightDoomMain.Set BulbOff, "10", 150
	LightDoomS4.Set BulbOff, "10", 150
	LightDoomS3.Set BulbOff, "10", 150
	LightDoomS2.Set BulbOff, "10", 150
	LightDoomS1.Set BulbBlink, "10", 150
	LightCrusadeMain.Set BulbOff, "10", 150
	LightCrusadeS4.Set BulbOff, "10", 150
	LightCrusadeS3.Set BulbOff, "10", 150
	LightCrusadeS2.Set BulbOff, "10", 150
	LightCrusadeS1.Set BulbBlink, "10", 150
	LightSkullMain.Set BulbOff, "10", 150
	LightSkullS4.Set BulbOff, "10", 150
	LightSkullS3.Set BulbOff, "10", 150
	LightSkullS2.Set BulbOff, "10", 150
	LightSkullS1.Set BulbBlink, "10", 150

	LightExtraBall.State = BulbOff
	LightLastCrusade.State = BulbOff
	LightTempleOfDoom.State = BulbOff
	LightRaidersArk.State = BulbOff
	LightCrystalSkull.State = BulbOff
	ScoreUpdate = TRUE
	Wng = FALSE
	ModeName = ""
	Indyscoring = FALSE
	Jonesscoring = FALSE
	TotalBonus = 0
	SkullBulb.State = BulbOff
	RampSkullOff()
	SPopStart = 30
	TempleHit = 0: ArkHit = 0: GrailHit = 0: SkullHit = 0
	mysterymode = ""
	xmarks = 1

	BeginGame()
   nvTotalGamesPlayed = nvTotalGamesPlayed + 1
	CP = 1
	PlayersPlayingGame = 1
	bOnTheFirstBall = TRUE

	For i = 1 To 4
		BallsRemaining(i) = nvBallsPerGame 
		ExtraBallsAwards(i) = 0
		StonesCollected(i) = 0

		' the required number of hits for each scene to start...(start value)
		GrailHitsRemain(i) = 4 ' hit the GRAIL Scoop 4 times...
		ArkHitsRemain(i) = 8 ' hit the ARK 8 times (spell 'RAIDERS')...
		StoneHitsRemain(i) = 6 ' hit the STONE Captive Ball 6 times....
		SkullHitsRemain(i) = 2 ' hit the CRYSTAL SKULL Ramp (when Skull is lit) 2 times...
		
		LastBonus(i) = FALSE
		FreeShot(i) = 1 ' give 1 free shot on easy mode....
		EB(i) = 0 ' Cairo Swordsman wins towards Extra Ball...

		' when a scene is completed, increase the number of hits required by 1 each time...
		SkullNeeded(i) = 2
		TempleNeeded(i) = 6
		CrusadeNeeded(i) = 4

		' Bonus Ball check...
		BBArk(i) = FALSE
		BBTemple(i) = FALSE
		BBGrail(i) = FALSE
		BBSkull(i) = FALSE

		EBScore15(i) = FALSE ' win EB for score of 15m
		EBScore40(i) = FALSE ' win EB for score of 40m

		IndyFSVal(i) = 550000 ' start value of Indy Fast Scoring win...
		JonesFSVal(i) = 550000 ' start value of JONES Fast Scoring win...
		RampVal(i) = 10000
		HurryVal(i) = 2000000 ' can be increased with the Super Spinner...

		NoHit(i) = TRUE ' track the one shot, one time bonus...
		GrabIdol(i) = TRUE ' the very first shot to the Ark doesn't hit any of the Ark Targets...

		' base value for completing any scene successfully, increases with each bumper hit...
		TempleJP(i) = 2000000
		SkullJP(i) = 2000000
		CrusadeJP(i) = 2000000
		RaidersJP(i) = 2000000

		SwordScore(i) = 0 
		SwordWin(i) = 0 ' count towards Swordsman trying some very fancy moves to beat you (he never will bless him)...
		SwordHUVal(i) = 5000000 ' Cairo Swordsman hurry up starts at 5 million (increases by 200k after each win)...
		SwordNeeded(i) = 4 ' 4 hits to start the Cairo Swordsman first time (you will get tired of this guy)...

		PerkSDTM(i) = FALSE: PerkX4(i) = FALSE: PerkSS(i) = FALSE: PerkIJ(i) = FALSE: PerkBS(i) = FALSE: PerkLuck(i) = FALSE
		PerkPops(i) = FALSE: PerkDS(i) = FALSE: PerkLoop(i) = FALSE: PerkCombo(i) = FALSE: PerkSpecial(i) = FALSE: PerkSword(i) = FALSE
		PerkRamp(i) = FALSE
		IJHit(i) = 0

		ChallengeVal(i) = 5000000 ' big points for beating a Grail Challenge
		Challenge(i) = 8 ' shots towards starting Grail Challenge (left loop)...
		BSTime(i) = 10000 ' start the BALL SAVER timer at 10 seconds...
	
		SwordHit(i) = 0 ' hits to start fight with the Cairo Swordman (never take a sword to a gun fight)...

		ReOpen(i) = FALSE
		RROn(i) = FALSE
		LROn(i) = FALSE

		Temp1(i) = LightRaidS1.State 
		Temp2(i) = LightRaidS2.State 
		Temp3(i) = LightRaidS3.State 
		Temp4(i) = LightRaidS4.State 
		Temp5(i) = LightRaidersMain.State
		Temp6(i) = LightDoomS1.State 
		Temp7(i) = LightDoomS2.State 
		Temp8(i) = LightDoomS3.State 
		Temp9(i) = LightDoomS4.State 
		Temp10(i) = LightDoomMain.State
		Temp11(i) = LightCrusadeS1.State 
		Temp12(i) = LightCrusadeS2.State 
		Temp13(i) = LightCrusadeS3.State 
		Temp14(i) = LightCrusadeS4.State
		Temp15(i) = LightCrusadeMain.State
		Temp16(i) = LightSkullS1.State 
		Temp17(i) = LightSkullS2.State 
		Temp18(i) = LightSkullS3.State 
		Temp19(i) = LightSkullS4.State 
		Temp20(i) = LightSkullMain.State
		TempEB(i) = LightExtraBall.State 
		TempCrusade(i) = LightLastCrusade.State 
		TempDoom(i) = LightTempleOfDoom.State 
		TempRaiders(i) = LightRaidersArk.State 
		TempSkull(i) = LightCrystalSkull.State 
	Next

	DispDMD1.UpdateInterval = 6: DispDMD2.UpdateInterval = 6
	
	Select Case RandomNumber(4)
		Case 1,4:
			NoS(): OverlayMovie2.Frame 299,325: LCD3.Frame 299,325: PlayMusic 2, "vo_IndianaJones"
			FirstBallDelayTimer.Interval = 1500
		Case 2:
			PlayMusic 2, "vo_OkeyDokey": FirstBallDelayTimer.Interval = 2600
		Case 3:
			PlayMusic 2, "vo_Indiana":	FirstBallDelayTimer.Interval = 1000
	End Select
	
	bMultiBallMode = FALSE
	FirstBallDelayTimer.Enabled = TRUE
End Sub



Sub FirstBallDelayTimer_Expired()
	FirstBallDelayTimer.Enabled = FALSE
	ResetForNewPlayerBall()
	CreateNewBall()
End Sub



Sub ResetForNewPlayerBall()
	InitTrakedSoundBalls()
	OverlayBG.FadeOut
	Dim i
	LightSeqPF.UpdateInterval = 8
	
	TorchesOff()

	If (bOnTheFirstBall = FALSE) Then
		' switch table state to current player...
		LightRaidS1.State = Temp1(CP) 
		LightRaidS2.State = Temp2(CP) 
		LightRaidS3.State = Temp3(CP) 
		LightRaidS4.State = Temp4(CP) 
		LightRaidersMain.State = Temp5(CP) 
	 
		LightDoomS1.State = Temp6(CP) 
		LightDoomS2.State = Temp7(CP) 
		LightDoomS3.State = Temp8(CP) 
		LightDoomS4.State = Temp9(CP) 
		LightDoomMain.State = Temp10(CP) 
	 
		LightCrusadeS1.State = Temp11(CP) 
		LightCrusadeS2.State = Temp12(CP) 
		LightCrusadeS3.State = Temp13(CP) 
		LightCrusadeS4.State = Temp14(CP) 
		LightCrusadeMain.State = Temp15(CP) 
		
		LightSkullS1.State = Temp16(CP) 
		LightSkullS2.State = Temp17(CP) 
		LightSkullS3.State = Temp18(CP) 
		LightSkullS4.State = Temp19(CP) 
		LightSkullMain.State = Temp20(CP) 

		LightExtraBall.State = TempEB(CP)
	
		LightLastCrusade.State = TempCrusade(CP)
		LightTempleOfDoom.State = TempDoom(CP)
		LightRaidersArk.State = TempRaiders(CP)
		LightCrystalSkull.State = TempSkull(CP)
	Else
		For i = 1 To 4
			Temp1(i) = LightRaidS1.State
			Temp6(i) = LightDoomS1.State
			Temp11(i) = LightCrusadeS1.State
			Temp16(i) = LightSkullS1.State
		Next
	End If

	NewBall = TRUE
	ClearSeq()
	BallSaved = FALSE

	' bonus held...
	If (BonusHeld = FALSE) Then
		MapMulti = 0
		ArkHit = 0:	TempleHit = 0:	GrailHit = 0: SkullHit = 0
		' for now, SPECIAL is lost if not collected...(unless bonus held)
		LightSpecialL.State = BulbOff
		LightSpecialR.State = BulbOff
	End If

	ScoreUpdate = TRUE
	LightSuperSpinL.State = BulbOff
	LightSuperSpinR.State = BulbOff
	ModeHit = 0
	TotalBonus = 0

	xMarksHits = 3: xMarks = 1

	' pops, spinners and loops all reset back to zero for each new ball...
	SPop = 0 ' super pops
	Gallop = 0 ' loop shots
	SpinsL = 0: SpinsR = 0 ' super spinner

	MQ = 3 ' mystery count
	BS = 5 ' ball saver count

	' reset the INDY JONES lights...
	LightINDY1.Set BulbBlink, "10", 125
	LightINDY2.Set BulbBlink, "10", 125
	LightINDY3.Set BulbBlink, "10", 125
	LightINDY4.Set BulbBlink, "10", 125
	LightJONES1.Set BulbBlink, "10", 125
	LightJONES2.Set BulbBlink, "10", 125
	LightJONES3.Set BulbBlink, "10", 125
	LightJONES4.Set BulbBlink, "10", 125
	LightJONES5.Set BulbBlink, "10", 125
	IndyComplete = FALSE
	JonesComplete = FALSE

	' reset MAP ROOM...
	MapRoomReset_Expired()

	JHit = 0
	IHit = 0

	BallFromStone = FALSE

	BulbMystery.State = BulbOff
	LightMystery.State = BulbOff

	MagnetActive = FALSE
	JackpotAnim = FALSE

	If (BonusHeld = TRUE) Then
		PerkSDTM(CP) = FALSE
		BonusHeld = FALSE
		PlayMusic 2, "Music_Cue15"
		JustSkill = TRUE: StartSkillTimer.Set TRUE, 1400
		DispDMD1.FlushQueue: DispDMD2.FlushQueue
		DispDMD1.QueueText "[edge3][f6][yc][xc][bf]BONUS HELD", deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f6][yc][xc][bf]BONUS HELD", deNone, 1000, TRUE
		LightSeqPF.Play SeqBlinking, , 3, 75
		If (BallsRemaining(CP) = 1) Then
			PlayMusic 1, "Music_PlungerWait3", TRUE, 1, 1400
		Else
			PlayMusic 1, "Music_PlungerWait", TRUE, 1, 1400
		End If
	Else
		' shot a quick prompt before a new ball starts...
		Select Case RandomNumber(4)
			Case 1,4: StartSkill()
			Case 2: 
				MovieTimer_Expired()
				JustSkill = TRUE: StartSkillTimer.Set TRUE, 1300
				If (nvScore(CP) < 15000000) Then
					DispDMD1.QueueText "[edge3][f4][y3]EXTRA BALL AT[y17]15 MILLION", deFlip, 1000, TRUE
					DispDMD2.QueueText "[edge3][f4][y3]EXTRA BALL AT[y17]15 MILLION", deFlip, 1000, TRUE, "fx_Whip"
				Else
					DispDMD1.QueueText "[edge3][f4][y3]EXTRA BALL AT[y17]40 MILLION", deFlip, 1000, TRUE
					DispDMD2.QueueText "[edge3][f4][y3]EXTRA BALL AT[y17]40 MILLION", deFlip, 1000, TRUE, "fx_Whip"
				End If
			Case 3:
				If (FreeShot(CP) =>1) Then
					If (BallsRemaining(CP) = 1) Then
						PlayMusic 2, "vo_WantHelp", FALSE, 1, 800
						DispDMD1.QueueText "[edge3][f4][y3][b]YOU HAVE " & FreeShot(CP) & "[y17]FREE SHOTS", deNone, 800, FALSE
						DispDMD2.QueueText "[edge3][f4][y3][b]YOU HAVE " & FreeShot(CP) & "[y17]FREE SHOTS", deNone, 800, FALSE, "fx_DMDPrompt"
						DispDMD1.QueueText "[edge3][f4][y3]YOU HAVE " & FreeShot(CP) & "[y17]FREE SHOTS", deNone, 1000, TRUE
						DispDMD2.QueueText "[edge3][f4][y3]YOU HAVE " & FreeShot(CP) & "[y17]FREE SHOTS", deNone, 1000, TRUE
						StartSkillTimer.Set TRUE, 2700
					Else
						DispDMD1.QueueText "[edge3][f4][y3]YOU HAVE " & FreeShot(CP) & "[y17]FREE SHOTS", deFlip, 1000, TRUE, "fx_Whip"
						DispDMD2.QueueText "[edge3][f4][y3]YOU HAVE " & FreeShot(CP) & "[y17]FREE SHOTS", deFlip, 1000, TRUE
						StartSkillTimer.Set TRUE, 1300
					End If
					MovieTimer_Expired()
					JustSkill = TRUE
				Else
					StartSkill()
				End If
		End Select
		If (BallsRemaining(CP) = 1) Then
			PlayMusic 1, "Music_PlungerWait3", TRUE
		Else
			PlayMusic 1, "Music_PlungerWait", TRUE
		End If
	End If
	ShootAgainLight.State = BulbOff
End Sub



Sub CreateNewBall()
	
	PlungerKicker.CreateBall: AddTrackedBall(PlungerKicker)
	
	If (bOnTheFirstBall = TRUE) Then	PlaySound "fx_Whip2": LightSeqPF.Play SeqBlinking, , 1, 200 : FF_Sound DV_RS,-1, "fx_Whip2" 'Trigger right slinger solenoid on ball launch

	'If (NewBall = TRUE) and (BallSaved = FALSE) Then NewBall = FALSE: RestartMusic.set TRUE, 100
	LOut = FALSE: ROut = FALSE
	BallLaunched = FALSE
	BallsOnPlayfield = BallsOnPlayfield + 1
	PlungerKicker.SolenoidPulse
End Sub


Sub Trig24_Hit()
	set LastSwitchHit = Trig24
End Sub


Sub StartSkillTimer_Expired()
	StartSkillTimer.Set FALSE
	If (JustSkill = TRUE) Then StartSkill(): JustSkill = FALSE: Exit Sub
	If (ArkOpen = TRUE) Then ArkOpen = FALSE: OpenArk() ' closes Ark after Shoot Again...
	TorchesOff()
	StartSkill()
	CreateNewBall()
End Sub




' ******************************************
' **                                      **
' **           THE DRAIN OF DOOM          **
' **                                      **
' ******************************************

' avoid this dark and evil hole, for it harbors nothing but nasties.

' normally, when the drain is hit, the end of ball sequence will start immediately. But I add a controlled
' delay here to allow a little more drama at certain times. 


Sub WaitASec_Expired()
	If (SpinMe.Enabled = FALSE) and (RewardSpin.Enabled = FALSE) Then
		WaitASec.Enabled = FALSE
		Drain_Hit()
	End If
End Sub


Dim BallWaiting


Sub Drain_Hit()

	If (BallWaiting >0) Then Drained_Expired(): Exit Sub

	Drain.DestroyBall: DeleteTrackedBall(Drain)

	' ball drained down the outlanes and a new ball has already been ejected
	' the count doesn't change...
	If (IgnoreMe = TRUE) Then IgnoreMe = FALSE: Exit Sub

	' wait for the reward to stop first...
	If (SpinMe.Enabled = TRUE) or (RewardSpin.Enabled = TRUE) Then
		WaitASec.Set TRUE, 2000
	Exit Sub
	End If

	BallsOnPlayfield = BallsOnPlayfield - 1
	If (BallsOnPlayfield <0) Then BallsOnPlayfield = 0

	PlaySound "fx_Drain"

	' ball drained from failed ramp shot...give it back...
	If (RampRtn = TRUE) Then
		RampRtn = FALSE
		PlaySound "fx_DMDPrompt"
		MusicFade(1200): PlayMusic 2, "vo_TheHellYouWill"
		DispDMD1.Text = "[edge3][f6][xc][yc][bf]RAMP SAVE"
		DispDMD2.Text = "[edge3][f6][xc][yc][bf]RAMP SAVE"
      PlungerKicker.CreateBall: AddTrackedBall(PlungerKicker)
		PlungerKicker.SolenoidPulse
		BallsOnPlayfield = BallsOnPlayfield + 1
		PlungerTimer.Set TRUE, 1000
	Exit Sub
	End If

	If (BonusBall = TRUE) Then
		DoubleScoreLight.State = BulbOff
		ResetxMarks.Enabled = FALSE
		xMarks = 1
		If (BonusBallTimer.Enabled = TRUE) Then
			BonusBallTimer_Expired()
			PlayMusic 1, "Music_Drain", FALSE, 0.8
			LightSeqPF.UpdateInterval = 4
			LightSeqPF.Play SeqDownOn, 20, 1
			Drained.Set TRUE, 4500
		Else
			Drained.Set TRUE, 2000
		End If
	Exit Sub
	End If

	If (fpTilted = TRUE) Then
		If (Nuke = TRUE) Then Drained.Set TRUE, 3000: Exit Sub
		Drained_Expired()
	Exit Sub
	End If
	
	If (bMultiballMode = TRUE) or (bBallSaverActive = TRUE) Then
		Drained_Expired()
	Exit Sub
	Else
		ScoreUpdate = TRUE: FlushDMDTimer.Enabled = FALSE
		BigRewardStop()
		StopMusic 3: StopMusic 8 
		ModeTimer.Enabled = FALSE: NoS(): OverlayLCD.Frame 184: LCD.Frame 184: OverlayMovie.Frame 1 ' immediately cease all activity on the LCD...
		If (ExtraBallsAwards(CP) = 0) and (BallsRemaining(CP) = 1) Then ' twas the very last ball...
			If (ModeName = "") and (JonesScoring = FALSE) and (IndyScoring = FALSE) and (IJScoring = FALSE) Then
				PlayMusic 1, "Music_Drain2", FALSE, 0.8
				If (QuoteBusy = FALSE) Then
					Select Case RandomNumber(2)
						Case 1: PlayMusic 2, "vo_BeloqLaugh"
						Case 2: PlayMusic 2, "vo_Laugh"
					End Select
				End If
				QuoteBusy = FALSE
				Drained.Set TRUE, 2100
				DispDMD1.QueueText "[edge3][xc][y4][f3]YOU HAVE[f6][y14][b]NO BALLS", deNone, 2000, FALSE
				DispDMD2.QueueText "[edge3][xc][y4][f3]YOU HAVE[f6][y14][b]NO BALLS", deNone, 2000, FALSE
			Else
				Drained_Expired()
			End If
		Else
			If (ModeName = "") and (JonesScoring = FALSE) and (IndyScoring = FALSE) and (IJScoring = FALSE) Then
				PlayMusic 1, "Music_Drain", FALSE, 0.7
				Drained.Set TRUE, 1200 ' eobdelay will also add 1200...
				If (QuoteBusy = FALSE) and (LastSwitchHit.Name = "TriggerArk") Then
					PlayMusic 2, "vo_BetweenThem"
					DispDMD1.Text = "[edge3][f4][xc][y3]DON'T GO BETWEEN[xc][y17]THE FLIPPERS"
					DispDMD2.Text = "[edge3][f4][xc][y3]DON'T GO BETWEEN[xc][y17]THE FLIPPERS"
				Else
					DispDMD1.Text = "[edge3][f6][xc][yc][b]BALL LOST"
					DispDMD2.Text = "[edge3][f6][xc][yc][b]BALL LOST"
				End If
				QuoteBusy = FALSE
			Else
				Drained_Expired()
			End If
		End If
		DoubleScoreLight.State = BulbOff
		ResetxMarks.Enabled = FALSE
		xMarks = 1
		DoomTimer.Enabled = FALSE
		StopHurryUps()
		StopFastScoring()
		SwordModeTimer.Enabled = FALSE
		SwordModeTimer2.Enabled = FALSE
		RestartMusic.Enabled = FALSE
	End If
End Sub


Sub Drained_Expired()
	Drained.Enabled = FALSE

	If (BonusBall = TRUE) Then
		fpTilted = FALSE: BonusBall = FALSE
	Exit Sub
	End If

	' ball drained after Nuke went off (Skull Scene 2)...
	If (Nuke = TRUE) Then
		fpTilted = FALSE
		Nuke = FALSE
		SpotOn(0)
		PlasDarkOff()
		LightSeqPF.StopPlay
		LightDoom.State = BulbOff
		SceneCheck()
		RestartMusic.Set TRUE, 1000
      PlungerKicker.CreateBall: AddTrackedBall(PlungerKicker)
		PlungerKicker.SolenoidPulse
		BallsOnPlayfield = 1
      PlungerTimer.Set TRUE, 1000
		BallSaved = FALSE
		PlayMusic 2, "vo_GameNotOver"
		AddScore(0)
		DoubleScoreLight.State = BulbOff
		ResetxMarks.Enabled = FALSE
		xMarks = 1
	Exit Sub
	End If

	If (fpGameInPlay = TRUE) and (fpTilted = FALSE) Then

		If (bBallSaverActive = TRUE) or (BallWaiting >0) Then
			If (bBallInPlungerLane = FALSE) Then
				BallWaiting = BallWaiting - 1
				If (BallWaiting >0) Then WaitASec.Set TRUE, 1200
				If (BallWaiting <0) Then BallWaiting = 0
				bBallInPlungerLane = TRUE
				PlungerKicker.CreateBall: AddTrackedBall(PlungerKicker): PlungerKicker.SolenoidPulse
				BallsOnPlayfield = BallsOnPlayfield + 1
				PlungerTimer.Set TRUE, 1000
				If (bMultiballMode = FALSE) Then
					LOut = FALSE: ROut = FALSE
					If (ScoreUpdate = TRUE) Then
						DispDMD1.Text = "[edge3][f6][xc][yc][bf]BALL SAVED"
						DispDMD2.Text = "[edge3][f6][xc][yc][bf]BALL SAVED"
					End If
					BallSaved = TRUE
				End If
				If (QuoteBusy = FALSE) and (ModeName = "") Then
					Select Case RandomNumber(5)
						Case 1: PlayMusic 2, "vo_AnythingHappen2": MusicFade(2000)
						Case 2: PlayMusic 2, "vo_Jnr": MusicFade(600)
						Case 3,4: PlayMusic 2, "vo_DontMove": MusicFade(700)
							DispDMD1.Text = "[edge3][f6][xc][yc][bf]DON'T MOVE"
							DispDMD2.Text = "[edge3][f6][xc][yc][bf]DON'T MOVE"
						Case 5: PlayMusic 2, "vo_Jnr": MusicFade(2200): PlayMusic 3, "vo_DontCallMe", FALSE, 1, 1000
					End Select
				End If
			Else
				BallWaiting = BallWaiting + 1
				WaitASec.Set TRUE, 1200
			End If
		Else

			If (LOut = FALSE) and (ROut = FALSE) and (PerkSDTM(CP) = TRUE) Then
				BonusHeld = TRUE
			End If
	
			If (BallsOnPlayfield = 1) Then
				xBAM.Camera.DesktopRelease 500
				If (bMultiBallMode = TRUE) Then
               StopMusic 1
               FlushDMDTimer.Set TRUE, 500
					TorchesOff()
					' end Ark Ceremony...
					If (ModeName = "RScene4") Then
						BallStopper.Collidable = TRUE
						LightArk.State = BulbOff
						LightRaidersArk.State = BulbOff
						SceneRAIDERSComplete()
						DispDMD1.FlushQueue: DispDMD2.FlushQueue
						NoPlay = TRUE: ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2200
						DispDMD1.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6][bf]"&FormatScore(ArkTotal), deNone, 1000, FALSE
						DispDMD2.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6][bf]"&FormatScore(ArkTotal), deNone, 1000, FALSE
						DispDMD1.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6]"&FormatScore(ArkTotal), deNone, 1000, TRUE
						DispDMD2.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6]"&FormatScore(ArkTotal), deNone, 1000, TRUE
						If (QuoteBusy = FALSE) Then
							Select Case RandomNumber(2)
								Case 1: PlayMusic 2, "vo_Understand", FALSE, 1, 500
								Case 2: PlayMusic 2, "vo_WipedClean", FALSE, 1, 500
							End Select
							QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2000
						End If
						If (JPHit >2) Then 
							RS = 2100: SpinMe_Expired() ' player made 3 jackpots so awards special movie item...
						End If
						Clip = 3: PlayClip()
						RestartMusic.Set TRUE, 2000
						JPHit = 0
					End If
					' end Bar Shootout...
					If (ModeName = "RScene2") Then 
						SceneRAIDERSComplete()
						SpotArk.State = BulbOff
						FlasherArkSpot.State = BulbOff
						NaziTimer.Enabled = FALSE: NaziTgt = FALSE
						AddScore(Nazi*1000)
						NoPlay = TRUE: ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2200
						DispDMD1.QueueText "[edge2][f2][xc][y2]NAZI KILLED = " & Nazi & "[y11]KILL VALUE = " & FormatScore(NaziVal) & "[f4][y19][bf]" & FormatScore(NaziTotal), deNone, 1000, FALSE
						DispDMD2.QueueText "[edge2][f2][xc][y2]NAZI KILLED = " & Nazi & "[y11]KILL VALUE = " & FormatScore(NaziVal) & "[f4][y19][bf]" & FormatScore(NaziTotal), deNone, 1000, FALSE
						DispDMD1.QueueText "[edge2][f2][xc][y2]NAZI KILLED = " & Nazi & "[y11]KILL VALUE = " & FormatScore(NaziVal) & "[f4][y19]" & FormatScore(NaziTotal), deNone, 1000, TRUE
						DispDMD2.QueueText "[edge2][f2][xc][y2]NAZI KILLED = " & Nazi & "[y11]KILL VALUE = " & FormatScore(NaziVal) & "[f4][y19]" & FormatScore(NaziTotal), deNone, 1000, TRUE
						QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2500:	PlayMusic 2, "vo_MyPlace"
						LightArk.Set BulbOff, "10", 125
						MagnetRelease.Collidable = FALSE
						Magnet.Collidable = FALSE
						CoolDownTimer_Expired() ' turn off the magnet...
						BulbMagnet.State = BulbOff
						RevertINDYJONES()
						If (Nazi =>10) Then 
							RS = 2000: SpinMe_Expired() ' player killed at least 10 Nazi so awards special movie item...
						End If
						RestartMusic.Set TRUE, 2000
						MovieTimer.Set TRUE, 10
					End If
					' end of Mine Cart Chase...
					If (ModeName = "TScene3") Then
						SceneTEMPLEComplete()
						NoPlay = TRUE: ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2000
						DispDMD1.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6][bf]"&FormatScore(SceneTotal), deNone, 1000, TRUE
						DispDMD2.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6][bf]"&FormatScore(SceneTotal), deNone, 1000, TRUE
						'PlaySound "fx_MineCartJump"
						QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1600:	PlayMusic 2, "vo_Brake"
						RevertINDYJONES()
						If (Nazi =>10) Then
							RS = 2000: SpinMe_Expired() ' player killed at least 10 enemy so awards special movie item...
						End If
						MovieTimer.Set TRUE, 10
						RestartMusic.Set TRUE, 1500
					End If
					LastShot = FALSE 
					ModeName = ""
					bMultiBallMode = FALSE
					LightCrusade.State = BulbOff
					LightDoom.State = BulbOff
					LightArk.State = BulbOff
					LightSkull.State = BulbOff
					LightOrbitR.State = BulbOff
					LightOrbitL.State = BulbOff
					SceneCheck()
				End If
			End If

			' if the ball drains during an active scene, the player is alterted to the fail and any points
			' scored during that scene are displayed. The player does not get the movie jackpot for the win.
			If (BallsOnPlayfield = 0) Then

				If (CairoSwordsman = TRUE) Then StopSwordsman()

				EOBDelay.Set TRUE, 1200

				If (INDYScoring = TRUE) Then
					INDYScoring = FALSE
					DispDMD1.Text = "[edge3][f2][xc][y2]INDY SCORING[y10]TOTAL COLLECTED[f4][y18][bf]" & FormatScore(INDYTotal)
					DispDMD2.Text = "[edge3][f2][xc][y2]INDY SCORING[y10]TOTAL COLLECTED[f4][y18][bf]" & FormatScore(INDYTotal)
					If (QuoteBusy = FALSE) Then PlayMusic 1, "vo_Indy2"
				End If

				If (JONESScoring = TRUE) Then
					JONESScoring = FALSE
					DispDMD1.Text = "[edge3][f2][xc][y2]JONES SCORING[y10]TOTAL COLLECTED[f4][y18][bf]" & FormatScore(JONESTotal)
					DispDMD2.Text = "[edge3][f2][xc][y2]JONES SCORING[y10]TOTAL COLLECTED[f4][y18][bf[" & FormatScore(JONESTotal)
					If (QuoteBusy = FALSE) Then PlayMusic 1, "vo_Jones"
				End If

				If (IJScoring = TRUE) Then
					IJScoring = FALSE
					DispDMD1.Text = "[edge3][f2][xc][y2]INDY JONES[y10]TOTAL COLLECTED[f4][y18][bf]" & FormatScore(IJTotal)
					DispDMD2.Text = "[edge3][f2][xc][y2]INDY JONES[y10]TOTAL COLLECTED[f4][y18][bf]" & FormatScore(IJTotal)
					If (QuoteBusy = FALSE) Then PlayMusic 1, "vo_IndyJones"
				End If

				If (BOG = TRUE) Then
					If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_Challenge", FALSE, 1, 1500: EOBDelay.Set TRUE, 2000
				End If

				StopHurryUps()
				StopFastScoring()
				StartRovingLights.Enabled = FALSE
				StartRovingINDYJONES.Enabled = FALSE

				' the nuke goes off...
				If (ModeName = "SScene2") Then
					SceneSKULLComplete()
					StopMusic 1: StopMusic 2: StopMusic 3: StopMusic 4
					Clip = 44: PlayClip()
					PlasDarkOn(): LightSeqPF.Play SeqRandom, 30, 1: SpotOn(7)
					FlasherOff.Set TRUE, 4500
					DispDMD1.QueueText "[edge3][f6][xc][yc][b]OUT OF TIME", deNone, 2000, FALSE
					DispDMD2.QueueText "[edge3][f6][xc][yc][b]OUT OF TIME", deNone, 2000, FALSE
					DispDMD1.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6]"&FormatScore(SceneTotal), deFlip, 1000, TRUE
					DispDMD2.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6]"&FormatScore(SceneTotal), deFlip, 1000, TRUE
					If (TempleOpen = TRUE) Then
						TempleOpen = FALSE
						BulbDoom.State = BulbOff
						StoneTarget.Collidable = TRUE
						TempleOpen = FALSE: Captive.Rotateyz -25,0
					End If
					LightDoom.State = BulbOff
					ModeName = ""
					EOBDelay.Set TRUE, 5000
				Exit Sub
				End If

				If (ModeName<>"") Then
					PlayMusic 1, "Music_Drain", FALSE, 0.7
					DispDMD1.FlushQueue: DispDMD2.FlushQueue
					DispDMD1.QueueText "[edge3][f6][xc][yc]BALL LOST", deNone, 900, FALSE
					DispDMD2.QueueText "[edge3][f6][xc][yc]BALL LOST", deNone, 900, FALSE
					DispDMD1.QueueText "[edge3][f3][xc][y4]SCENE TOTAL", deNone, 700, FALSE
					DispDMD2.QueueText "[edge3][f3][xc][y4]SCENE TOTAL", deNone, 700, FALSE
					DispDMD1.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6][bf]"&FormatScore(SceneTotal), deNone, 1000, TRUE
					DispDMD2.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6][bf]"&FormatScore(SceneTotal), deNone, 1000, TRUE
				End If

				If (ModeName = "RScene1") Then
					SceneRAIDERSComplete()
					RevertINDYJONES()
					If (QuoteBusy = FALSE) Then
						PlayMusic 2, "vo_ManIKnew", FALSE, 1, 1800: EOBDelay.Set TRUE, 3500
					End If
				End If

				If (ModeName = "RScene2") Then
					SceneRAIDERSComplete()
					If (QuoteBusy = FALSE) Then
						PlayMusic 2, "vo_ManIKnew", FALSE, 1, 1800: EOBDelay.Set TRUE, 3500
					End If
				End If

				If (ModeName = "RScene3") Then
					StopMusic 4
					NaziTgt = FALSE
					SceneRAIDERSComplete()
					RevertINDYJONES()
					If (QuoteBusy = FALSE) Then
						PlayMusic 2, "vo_ManIKnew", FALSE, 1, 1800: EOBDelay.Set TRUE, 3500
					End If
				End If

				If (ModeName = "TScene1") Then
					SceneTEMPLEComplete()
					RevertINDYJONES()
					If (QuoteBusy = FALSE) Then
						PlayMusic 1, "vo_AnythingGoes": EOBDelay.Set TRUE, 2700
					End If
				End If

				If (ModeName = "TScene2") Then
					SceneTEMPLEComplete()
					If (QuoteBusy = FALSE) Then
						PlayMusic 2, "vo_NoFun", FALSE, 1, 1800: EOBDelay.Set TRUE, 2800
					End If
				End If

				' the ball drained during the single ball stage...
				If (ModeName = "TScene3") Then
					SceneTEMPLEComplete()
					RevertINDYJONES()
					If (QuoteBusy = FALSE) Then
						PlayMusic 2, "vo_NoFun", FALSE, 1, 1800: EOBDelay.Set TRUE, 3200
					End If
				End If

				If (ModeName = "TScene4") Then
					SceneTEMPLEComplete()
					If (QuoteBusy = FALSE) Then
						PlayMusic 2, "vo_DrJonesLaugh", FALSE, 1, 1000: EOBDelay.Set TRUE, 3200
					End If
				End If

				If (ModeName = "CScene1") Then
					SceneCRUSADEComplete()
					If (QuoteBusy = FALSE) Then
						Select Case RandomNumber(3)
							Case 1: PlayMusic 2, "vo_Interesting", FALSE, 1, 1500: EOBDelay.Set TRUE, 3800
							Case 2: PlayMusic 2, "vo_Lost", FALSE, 1, 1500: EOBDelay.Set TRUE, 2800
							Case 3: PlayMusic 2, "vo_Museum", FALSE, 1, 1500: EOBDelay.Set TRUE, 4400
						End Select
					End If
				End If
				
				If (ModeName = "CScene2") Then
					SceneCRUSADEComplete()
					If (QuoteBusy = FALSE) Then
						Select Case RandomNumber(2)
							Case 1: PlayMusic 2, "vo_NiceLanding": EOBDelay.Set TRUE, 2800
							Case 2: PlayMusic 2, "vo_TheyGotUs": EOBDelay.Set TRUE, 2500
						End Select
					End If
				End If

				If (ModeName = "CScene3") Then
					StopMusic 4
					SceneCRUSADEComplete()
					TankFire.Enabled = FALSE
					LightSeqPF.StopPlay
					If (QuoteBusy = FALSE) Then
						Select Case RandomNumber(3)
							Case 1,2: PlayMusic 2, "vo_CameToSave", FALSE, 1, 1800: EOBDelay.Set TRUE, 6000
							Case 3: PlayMusic 2, "vo_Morons", FALSE, 1, 1800: EOBDelay.Set TRUE, 6000
						End Select
					End If
				End If

				If (ModeName = "CScene4") Then
					SceneCRUSADEComplete()
					If (QuoteBusy = FALSE) Then
						PlayMusic 2, "vo_ChosenPoorly", FALSE, 1, 1500
					End If
					LightCrusadeExt.SetLitColor 94, 203, 255
					LightDoomExt.SetLitColor 255, 164, 72
					LightArkExt.SetLitColor 219, 192, 241
					LightSkullExt.SetLitColor 156, 233, 131
					LightOrbitRExt.SetLitColor 243, 117, 63
					MovieTimer.Enabled = FALSE
					ArkFlash(1000)
					Clip = 64: PlayClip()
					EOBDelay.Set TRUE, 3800
				End If

				If (ModeName = "SScene1") Then
					SceneSKULLComplete()
					If (QuoteBusy = FALSE) Then
						PlayMusic 2, "vo_ThroughWorse", FALSE, 1, 1000: EOBDelay.Set TRUE, 2200
					End If
				End If

				If (ModeName = "SScene3") Then
					SceneSKULLComplete()
					SkullBulb.Set BulbOff, "10", 150
					If (QuoteBusy = FALSE) Then
						PlayMusic 2, "vo_HardToRead", FALSE, 1, 500: EOBDelay.Set TRUE, 3000
					End If
				End If

				If (ModeName = "SScene4") Then
					SceneSKULLComplete()
					If (QuoteBusy = FALSE) Then
						PlayMusic 2, "vo_LastWords", FALSE, 1, 500: EOBDelay.Set TRUE, 3000
					End If
				End If

				If (PlaneOn = TRUE) Then 
					PlaneOn = FALSE
					PropStop.Set TRUE, 500
				End If
				
				Flipped = FALSE
				PlayMovie.Enabled = FALSE
				StoneLightsOff()
				NoHit(CP) = FALSE
				GrabIdol(CP) = FALSE
				LastShot = FALSE 
				DoubleScoreLight.State = BulbOff
				ResetxMarks.Enabled = FALSE
				xMarks = 1
				QuoteBusy = FALSE
				LightXMarks.Set BulbOff, "10", 125
				LightCrusade.Set BulbOff, "10", 125
				LightDoom.Set BulbOff, "10", 125
				LightArk.Set BulbOff, "10", 125
				LightSkull.Set BulbOff, "10", 125
				LightOrbitR.Set BulbOff, "10", 125
				LightOrbitL.Set BulbOff, "10", 125
				SceneTotal = 0
				BulbFS.State = BulbOff: LightFS.State = BulbOff
				StopMusic 5
				NaziTimer.Enabled = FALSE
				ModeTimer.Enabled = FALSE
				RestartMusic.Enabled = FALSE
				ModeName = ""
			End If
		End If
	End If
End Sub


Sub EOBDelay_Expired()
	EOBDelay.Enabled = FALSE
	EndOfBall()
End Sub


Sub RevertINDYJONES()
	LightINDY1.State = TempL1 
	LightINDY2.State = TempL2
	LightINDY3.State = TempL3 
	LightINDY4.State = TempL4 
	LightJONES1.State = TempL5
	LightJONES2.State = TempL6 
	LightJONES3.State = TempL7 
	LightJONES4.State = TempL8
	LightJONES5.State = TempL9
End Sub



Sub ShowStatusTimer_Expired()
	ShowStatusTimer.Enabled = FALSE
	StatusActive = TRUE
	ShowMe = ShowMe + 1 
	PlaySound "fx_Ricochet7"
	BulbArkL.FlashForMs 200, 200, BulbOff
	BulbArkR.FlashForMs 200, 200, BulbOff
	FlasherRed.FlashForMs 200, 200, BulbOff
	Select Case ShowMe
		Case 1: 
			DispDMD1.Text = "[edge3][f2][xc][y4]PLAYER " & CP & "[y14][f6]BALLS REMAIN = " & BallsRemaining(CP)
			DispDMD1.Text = "[edge3][f2][xc][y4]PLAYER " & CP & "[y14][f6]BALLS REMAIN = " & BallsRemaining(CP)
		Case 2: 
			DispDMD1.Text = "[edge3][f6][xc][yc]FREE SHOTS = " & FreeShot(CP)
			DispDMD1.Text = "[edge3][f6][xc][yc]FREE SHTOS = " & FreeShot(CP)
		Case 3: 
			DispDMD1.Text = "[edge3][f2][xc][y4]GRAIL HITS[y14][f6]REMAIN = " & GrailHitsRemain(CP)
			DispDMD1.Text = "[edge3][f2][xc][y4]GRAIL HITS[y14][f6]REMAIN = " & GrailHitsRemain(CP)
		Case 4:
			DispDMD1.Text = "[edge3][f2][xc][y4]STONE HITS[y14][f6]REMAIN = " & StoneHitsRemain(CP)
			DispDMD1.Text = "[edge3][f2][xc][y4]STONE HITS[y14][f6]REMAIN = " & StoneHitsRemain(CP)
		Case 5:
			DispDMD1.Text = "[edge3][f2][xc][y4]ARK HITS[y14][f6]REMAIN = " & ArkHitsRemain(CP)
			DispDMD1.Text = "[edge3][f2][xc][y4]ARK HITS[y14][f6]REMAIN = " & ArkHitsRemain(CP)
		Case 6:
			DispDMD1.Text = "[edge3][f2][xc][y4]SKULL HITS[y14][f6]REMAIN = " & SkullHitsRemain(CP)
			DispDMD1.Text = "[edge3][f2][xc][y4]SKULL HITS[y14][f6]REMAIN = " & SkullHitsRemain(CP)
		Case 7:
			DispDMD1.Text = "[edge3][f2][xc][y4]CRUSADE JACKPOT[y14][f6]" & FormatScore(CrusadeJP(CP))
			DispDMD2.Text = "[edge3][f2][xc][y4]CRUSADE JACKPOT[y14][f6]" & FormatScore(CrusadeJP(CP))
		Case 8:
			DispDMD1.Text = "[edge3][f2][xc][y4]TEMPLE JACKPOT[y14][f6]" & FormatScore(TempleJP(CP))
			DispDMD2.Text = "[edge3][f2][xc][y4]TEMPLE JACKPOT[y14][f6]" & FormatScore(TempleJP(CP))
		Case 9:
			DispDMD1.Text = "[edge3][f2][xc][y4]RAIDERS JACKPOT[y14][f6]" & FormatScore(RaidersJP(CP))
			DispDMD2.Text = "[edge3][f2][xc][y4]RAIDERS JACKPOT[y14][f6]" & FormatScore(RaidersJP(CP))
		Case 10:
			DispDMD1.Text = "[edge3][f2][xc][y4]SKULL JACKPOT[y14][f6]" & FormatScore(SkullJP(CP))
			DispDMD2.Text = "[edge3][f2][xc][y4]SKULL JACKPOT[y14][f6]" & FormatScore(SkullJP(CP))
		Case 11:
			DispDMD1.Text = "[edge3][f2][xc][y3]GRAIL BONUS = "&GrailHit&"[y12]TEMPLE BONUS = "&TempleHit&"[y21]ARK BONUS = "&ArkHit
			DispDMD2.Text = "[edge3][f2][xc][y3]GRAIL BONUS = "&GrailHit&"[y12]TEMPLE BONUS = "&TempleHit&"[y21]ARK BONUS = "&ArkHit
		Case 12:
			DispDMD1.Text = "[edge3][f2][xc][y3]SKULL BONUS = "&SkullHit
			DispDMD2.Text = "[edge3][f2][xc][y3]SKULL BONUS = "&SkullHit
			ShowMe = 0
	End Select
End Sub



' **********************************
' **                              **
' **          END OF BALL         **
' **                              **
' **********************************

' When the balls drains, a bonus will surely follow...BUT, I make it slightly more interesting:
' Collect a certain amount of bonuses and qualify for the BONUS BALL at the end of the game.


Sub EndOfBall()
	StopMusic 4
	DoomTimer.Set FALSE
	bOnTheFirstBall = FALSE
	DoomTimer.Enabled = FALSE
	OverlayBG.FadeIn
	TorchesOn()
	LightSeqPF.Play SeqAllOff
	xBAM.Camera.DesktopRelease 500
	LightSeqPF.StopPlay
	If (TempleOpen = TRUE) Then CloseChamber() ' close it...
	If (fpTilted = FALSE) Then
      StartEOB()
	Else
		EndOfBallTimer.Set TRUE, 100
	End If
End Sub



' *****************************************
' **                                     **
' **          END OF BALL BONUS          **
' **                                     **
' *****************************************

' Standard End of Ball baloney...you get bonuses for temple hits, grail hits, skull hits and ark hits.

' BONUS BALL qualification: 8 Ark Hits, 8 Temple Hits, 5 Grail Hits, 5 Ramps Hits, all in a single ball but not
' necessarily in the same single ball.  For example: get 10 ark hits in ball 1, then 10 temple hits in ball 2, then
' 5 grail hits and 5 ramps hits in ball 3.

' Hold any flipper up for 5 seconds to see the status.


Sub StartEOB()
	BonusActive = TRUE
	NoS(): OverlayLCD.Frame 66: LCD.Frame 66
	DispDMD1.FlushQueue: DispDMD2.FlushQueue
	If (BallsRemaining(CP) = 1) and (ExtraBallsAwards(CP) = 0) Then
		LastBonus(CP) = TRUE
		DispDMD1.QueueText "[edge3][f6][xc][yc]LAST BONUS", deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][yc]LAST BONUS", deNone, 1000, TRUE
		PlayMusic 1, "Music_LastBonus", FALSE, 1, 100
	Else
		DispDMD1.QueueText "[edge3][f6][xc][yc]BONUS", deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][yc]BONUS", deNone, 1000, TRUE
		Select Case RandomNumber(6)
			Case 1: Playmusic 1, "Music_Bonus2", FALSE, 1, 100
			Case 2: PlayMusic 1, "Music_Bonus3", FALSE, 1, 100
			Case 3: PlayMusic 1, "Music_Bonus4", FALSE, 1, 100
			Case 4: PlayMusic 1, "Music_Bonus5", FALSE, 1, 100
			Case 5: PlayMusic 1, "Music_Bonus6", FALSE, 1, 100
			Case 6: PlayMusic 1, "Music_Bonus8", FALSE, 1, 100
		End Select
	End If

	TotalBonus = (ArkHit*12500) + (TempleHit*12500) + (GrailHit*12500) + (SkullHit*12500)

	' if you hit the Ark at any time during the ball (impossible to miss)...
	If (Arkhit > 0) or (LastBonus(CP) = TRUE) Then EOBArk.set TRUE, 1200: Exit Sub

	' did you, by any chance, happen to hit the temple?...
	If (TempleHit > 0) or (LastBonus(CP) = TRUE) Then	EOBTemple.set TRUE, 1200: Exit Sub

	' you hit the grail a fair few times, well good for you...
	If (GrailHit > 0) or (LastBonus(CP) = TRUE) Then EOBGrail.set TRUE, 1200: Exit Sub

	' you hit the ramp too?  Well I never...
	If (SkullHit > 0) or (LastBonus(CP) = TRUE) Then EOBSkull.set TRUE, 1200: Exit Sub

	EOBMulti.Set TRUE, 1200
End Sub


Sub EOBArk_Expired()
	EOBArk.set FALSE
	PlaySound "fx_Whip"
	
	If (ArkHit>7) or (BBArk(CP) = TRUE) Then
		DispDMD1.Text = "[edge3][f4][xc][y3]ARK QUALIFIED[xc][y17]" & formatscore(ArkHit*12500)
		DispDMD2.Text = "[edge3][f4][xc][y3]ARK QUALIFIED[xc][y17]" & formatscore(ArkHit*12500)
		PlaySound "fx_6": BBArk(CP) = TRUE
	Else
		DispDMD1.Text = "[edge3][f4][xc][y3]" & arkhit & " ARK HITS[xc][y17]" & formatscore(ArkHit*12500)
		DispDMD2.Text = "[edge3][f4][xc][y3]" & arkhit & " ARK HITS[xc][y17]" & formatscore(ArkHit*12500)
	End If

	' let's continue dishing out these delightful bonus points....

	If (TempleHit > 0) or (LastBonus(CP) = TRUE) Then	EOBTemple.set TRUE, 1200: Exit Sub
	If (GrailHit > 0) or (LastBonus(CP) = TRUE) Then EOBGrail.set TRUE, 1200: Exit Sub
	If (SkullHit > 0) or (LastBonus(CP) = TRUE) Then EOBSkull.set TRUE, 1200: Exit Sub

	EOBMulti.Set TRUE, 1200
End Sub



Sub EOBTemple_Expired()
	EOBTemple.set FALSE
	PlaySound "fx_Whip"

	' Temple Challenge Complete: The player has qualified for part of the Bonus Ball
	If (TempleHit>7) or (BBTemple(CP) = TRUE) Then
		DispDMD1.Text = "[edge3][f4][xc][y3]TEMPLE QUALIFIED[xc][y17]" & formatscore(templehit*12500)
		DispDMD2.Text = "[edge3][f4][xc][y3]TEMPLE QUALIFIED[xc][y17]" & formatscore(templehit*12500)
		PlaySound "fx_6": BBTemple(CP) = TRUE
	Else
		DispDMD1.Text = "[edge3][f4][xc][y3]" & templehit & " STONE HITS[xc][y17]" & formatscore(templehit*12500)
		DispDMD2.Text = "[edge3][f4][xc][y3]" & templehit & " STONE HITS[xc][y17]" & formatscore(templehit*12500)
	End If

	If (GrailHit > 0) or (LastBonus(CP) = TRUE) Then EOBGrail.set TRUE, 1200: Exit Sub
	If (SkullHit > 0) or (LastBonus(CP) = TRUE) Then EOBSkull.set TRUE, 1200: Exit Sub

	EOBMulti.Set TRUE, 1200
End Sub



Sub EOBGrail_Expired()
	eobgrail.set FALSE
	PlaySound "fx_Whip"

	If (GrailHit>4) or (BBGrail(CP) = TRUE) Then
		DispDMD1.Text = "[edge3][f4][xc][y3]GRAIL QUALIFIED[xc][y17]" & formatscore(grailhit*12500)
		DispDMD2.Text = "[edge3][f4][xc][y3]GRAIL QUALIFIED[xc][y17]" & formatscore(grailhit*12500)
		PlaySound "fx_6": BBGrail(CP) = TRUE
	Else
		DispDMD1.Text = "[edge3][f4][xc][y3]" & grailhit & " GRAIL HITS[xc][y17]" & formatscore(grailhit*12500)
		DispDMD2.Text = "[edge3][f4][xc][y3]" & grailhit & " GRAIL HITS[xc][y17]" & formatscore(grailhit*12500)
	End If

	If (SkullHit > 0) or (LastBonus(CP) = TRUE) Then EOBSkull.Set TRUE, 1200: Exit Sub

	EOBMulti.Set TRUE, 1200
End Sub



Sub EOBSkull_Expired()
	EOBSkull.Set FALSE
	PlaySound "fx_Whip"

	If (SkullHit>4) or (BBSkull(CP) = TRUE) Then
		DispDMD1.Text =  "[edge3][f4][xc][y3]SKULL QUALIFIED[xc][y17]" & formatscore(skullhit*12500)
		DispDMD2.Text =  "[edge3][f4][xc][y3]SKULL QUALIFIED[xc][y17]" & formatscore(skullhit*12500)
		PlaySound "fx_6": BBSkull(CP) = TRUE
	Else
		DispDMD1.Text =  "[edge3][f4][xc][y3]" & skullhit & " SKULL HITS[xc][y17]" & formatscore(skullhit*12500)
		DispDMD2.Text =  "[edge3][f4][xc][y3]" & skullhit & " SKULL HITS[xc][y17]" & formatscore(skullhit*12500)
	End If

	EOBMulti.Set TRUE, 1200
End Sub



Sub EOBMulti_Expired()
	PlaySound "fx_Whip"
	DispDMD1.Text = "[edge3][f6][xc][yc]BONUS X " & MapMulti
	DispDMD2.Text = "[edge3][f6][xc][yc]BONUS X " & MapMulti
	EOBMulti.Set FALSE
	EOBTotal.Set TRUE, 1200
End Sub



Sub EOBTotal_Expired()
	EOBTotal.Enabled = FALSE
	BonusActive = FALSE
	If (MapMulti = 0) Then MapMulti = 1
	TotalBonus = (TotalBonus*MapMulti)
	BulbArkL.Set BulbBlink, 	"00001100000000000000", 75
	BulbArkR.Set BulbBlink, 	"00001100000000000000", 75
	FlasherRed.Set BulbBlink, 	"00001100000000000000", 75
	DispDMD1.QueueText "[edge3][f4][xc][y3]TOTAL BONUS[bf][xc][y17]" & Formatscore(TotalBonus), deFlip, 1500, FALSE
	DispDMD2.QueueText "[edge3][f4][xc][y3]TOTAL BONUS[bf][xc][y17]" & Formatscore(TotalBonus), deFlip, 1500, FALSE, "fx_Whip6"
	ScoreUpdate = FALSE
	AddScore(TotalBonus)
	If (BBArk(CP) = TRUE) and (BBTemple(CP) = TRUE) and (BBGrail(CP) = TRUE) and (BBSkull(CP) = TRUE) Then
		DispDMD1.QueueText "[edge3][f4][xc][y3][bf]BONUS BALL[xc][y17]QUALIFIED", deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f4][xc][y3][bf]BONUS BALL[xc][y17]QUALIFIED", deNone, 1000, TRUE
		EndOfBallTimer.Set TRUE, 3000
	Else
		If (LastBonus(CP) = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y3]BONUS BALL[xc][y17]QUALIFICATION", deNone, 800, FALSE
			DispDMD2.QueueText "[edge3][f4][xc][y3]BONUS BALL[xc][y17]QUALIFICATION", deNone, 800, FALSE
			DispDMD1.QueueText "[edge3][f2][xc][y3]8 HITS TO ARK[y12]AND TEMPLE, 5 HITS[y21]TO GRAIL AND SKULL", deFLIP, 1000, TRUE
			DispDMD2.QueueText "[edge3][f2][xc][y3]8 HITS TO ARK[y12]AND TEMPLE, 5 HITS[y21]TO GRAIL AND SKULL", deFlip, 1000, TRUE, "fx_Whip6"
			EndOfBallTimer.Set TRUE, 5000
		Else
			EndOfBallTimer.Set TRUE, 1500
		End If
	End If
End Sub




Sub EndOfBallTimer_Expired()
	EndOfBallTimer.Enabled = FALSE
	dim skilldelay

	BulbArkL.State = BulbOff
	BulbArkR.State = BulbOff
	FlasherRed.State = BulbOff

	SkillDelay = 100
	fpTilted = FALSE

	' Extra Ball for score of over 15m...
	If (nvScore(CP) => 15000000) and (EBScore15(CP) = FALSE) Then
		EBScore15(CP) = TRUE
		StopMusic 1: PlayMusic 2, "Music_EB"
		OverlayLCD.UpdateInterval = 125
		NoS(): OverlayLCD.Frame 117, 118, 117: LCD.Frame 117,118,117
		LightSeqJP.Play SeqBlinking, , 10, 100
		LightSeqPF.Play SeqBlinking, , 10, 100
		DispDMD1.Text = "[edge3][f6][xc][yc][bf]EXTRA BALL"
		DispDMD2.Text = "[edge3][f6][xc][yc][bf]EXTRA BALL"
		ExtraBallsAwards(CP) = ExtraBallsAwards(CP) + 1
		ShootAgainLight.State = BulbOn
		EndOfBallTimer.Set TRUE, 4000
	Exit Sub
	End If

	' Extra Ball for score of over 40m...
	If (nvScore(CP) => 40000000) and (EBScore40(CP) = FALSE) Then
		EBScore40(CP) = TRUE
		StopMusic 1: PlayMusic 2, "Music_EB"
		OverlayLCD.UpdateInterval = 125
		NoS(): OverlayLCD.Frame 117, 118, 117: LCD.Frame 117,118,117
		LightSeqJP.Play SeqBlinking, , 10, 100
		LightSeqPF.Play SeqBlinking, , 10, 100
		DispDMD1.Text = "[edge3][f6][xc][yc][bf]EXTRA BALL"
		DispDMD2.Text = "[edge3][f6][xc][yc][bf]EXTRA BALL"
		ExtraBallsAwards(CP) = ExtraBallsAwards(CP) + 1
		ShootAgainLight.State = BulbOn
		EndOfBallTimer.Set TRUE, 4000
	Exit Sub
	End If

	MovieTimer_Expired()
	EffectMusic 2, FadeOutAndStop, 0, 500
	LightSeqJP.StopPlay
	LightSeqPF.StopPlay

	If (ExtraBallsAwards(CP) <> 0) Then
		ExtraBallsAwards(CP) = ExtraBallsAwards(CP) - 1
		Skilldelay = Skilldelay + 2000
		If (ExtraBallsAwards(CP) = 0) Then
			ShootAgainLight.State = BulbOff
		End If
		NewBall = TRUE
		Select Case RandomNumber(4)
			Case 1:
				Clip = 39: PlayClip()
				DispDMD1.QueueText "[edge3][f6][xc][yc]PLAYER " & CP, deNone, 2000, FALSE
				DispDMD2.QueueText "[edge3][f6][xc][yc]PLAYER " & CP, deNone, 2000, FALSE
				DispDMD1.QueueText "[edge3][f6][xc][yc][bf]SHOOT AGAIN", deFlip, 1000, TRUE
				DispDMD2.QueueText "[edge3][f6][xc][yc][bf]SHOOT AGAIN", deFlip, 1000, TRUE
				PlayMusic 3, "Music_Cue14", FALSE, 1, 2000
				PlayMusic 1, "Music_PlungerWait", TRUE, 1, 3000
				LightSeqPF.Play SeqDoNothing, , , 2000
				LightSeqPF.Play SeqBlinking, , 4, 75
				StartSkillTimer.Set TRUE, 3000
			Case 2:
				BallStopper.Collidable = FALSE
				PlayMusic 1, "Music_Ark"
				Lid.rotateyz 10,30
				PlaySound "fx_IdolMove"
				BulbArk1.State = BulbOn
				BulbArk2.State = BulbOn
				BulbArk3.State = BulbOn
				' after 2 second, create a ball from the Ark...
				ArkBall = 0: GimmeArkBall.Set TRUE, 3000
				DispDMD1.QueueText "[edge3][f6][xc][yc]PLAYER " & CP, deNone, 3000, FALSE
				DispDMD2.QueueText "[edge3][f6][xc][yc]PLAYER " & CP, deNone, 3000, FALSE
				DispDMD1.QueueText "[edge3][f6][xc][yc][bf]LIVE AGAIN", deFlip, 1000, TRUE
				DispDMD2.QueueText "[edge3][f6][xc][yc][bf]LIVE AGAIN", deFlip, 1000, TRUE
				PlayMusic 3, "Music_Cue14", FALSE, 1, 3000
				LightSeqPF.Play SeqDoNothing, , , 3000
				LightSeqPF.Play SeqBlinking, , 4, 75
			Case 3:
				'NoS(): OverlayLCD.Frame 63, 64, 63
				MovieTimer_Expired()
				PlayMusic 2, "vo_WorkToDo", FALSE, 1, 800
				DispDMD1.QueueText "[edge3][f6][xc][yc][bf]SHOOT AGAIN", deFlip, 1000, TRUE
				DispDMD2.QueueText "[edge3][f6][xc][yc][bf]SHOOT AGAIN", deFlip, 1000, TRUE
				PlayMusic 3, "Music_Cue14"
				PlayMusic 1, "Music_PlungerWait", TRUE, 1, 1600
				LightSeqPF.Play SeqBlinking, , 4, 75
				StartSkillTimer.Set TRUE, 1600
			Case 4:
				MovieTimer_Expired()
				PlayMusic 2, "vo_Continue"
				DispDMD1.QueueText "[edge3][f6][xc][yc]PLAYER " & CP, deNone, 4500, FALSE
				DispDMD2.QueueText "[edge3][f6][xc][yc]PLAYER " & CP, deNone, 4500, FALSE
				DispDMD1.QueueText "[edge3][f6][xc][yc][bf]SHOOT AGAIN", deFlip, 1000, TRUE
				DispDMD2.QueueText "[edge3][f6][xc][yc][bf]SHOOT AGAIN", deFlip, 1000, TRUE
				PlayMovie.Set TRUE, 3700
				PlayMusic 1, "Music_PlungerWait", TRUE, 1, 5800
				PlayMusic 3, "Music_Cue14", FALSE, 1, 4500
				LightSeqPF.Play SeqDoNothing, , , 4500
				LightSeqPF.Play SeqBlinking, , 4, 75
				StartSkillTimer.Set TRUE, 5800
		End Select
	Else
		BallsRemaining(CP) = BallsRemaining(CP) - 1
		If (BallsRemaining(CP) <= 0) Then

			' First, do a check to see if the player qualifies for a Bonus Ball after scoring enough end of ball bonuses...
			If (BBArk(CP) = TRUE) and (BBTemple(CP) = TRUE) and (BBGrail(CP) = TRUE) and (BBSkull(CP) = TRUE) Then
				StartBonusBall()
			Else
				' enter thy name if you have a score worthy of recognition...
				StopMusic 1
				Select Case RandomNumber(4)
					Case 1: PlayMusic 2, "vo_Forget", FALSE, 1, 200
					Case 2: PlayMusic 2, "vo_NotToday", FALSE, 1, 200
					Case 3: PlayMusic 2, "vo_GoodTime", FALSE, 1, 200
					Case 4: PlayMusic 2, "vo_GoDownHistory", FALSE, 1, 200
				End Select
				NoS(): OverlayLCD.Frame 184: LCD.Frame 184 
				bEnteringAHighScore = TRUE
				EnterHighScore(CP)
				DispDMD1.FlushQueue: DispDMD2.FlushQueue
				DispDMD1.QueueText "[edge3] ", deNone, 200, FALSE
				DispDMD2.QueueText "[edge3] ", deNone, 200, FALSE
				DispDMD1.QueueText "[edge3][f12][xc][yc]ENTER NAME", deNone, 1000, TRUE
				DispDMD2.QueueText "[edge3][f12][xc][yc]ENTER NAME", deNone, 1000, TRUE
			End If
		Else
			EndOfBallComplete()
		End If
	End If
End Sub


Dim ArkBall


Sub GimmeArkBall_Expired()
	GimmeArkBall.Set TRUE, 1000
	ArkBall = ArkBall + 1
	Select Case ArkBall
		Case 1:
			PlaySound "fx_Belch"
			StopMusic 1
			PlaySound "BDCentre"
			Kicker9.CreateBall: AddTrackedBall(Kicker9)
			BallsOnPlayfield = 1
			BulbArk1.State = BulbOff
			BulbArk2.State = BulbOff
			BulbArk3.State = BulbOff
		Case 2:
			TorchesOff()
			Lid.rotateyz -150,0
			PlaySound "fx_LidClose"
			GimmeArkBall.Enabled = FALSE
			RestartMusic_Expired()
			NewBall = FALSE
			SceneCheck()
			MovieTimer_Expired()
			BallStopper.Collidable = TRUE
			FlushDMDTimer_Expired()
	End Select
End Sub



' *********************************
' **                             **
' **          BONUS BALL         **
' **                             **
' *********************************

' The objective is to complete the lower matrix within the time limit by making the associated shots:

' Raiders = 5 Ark Shots
' Temple = 5 Shankara Stone Shots
' Crusade = 5 Holy Grail Shots
' Kingdom = 5 Crystal Skull Shots

' Each shot is worth 125k. Complete a full set from any movie for an additional 350k. Complete any 2 sets for
' an Extra Ball and return to the main game (or free game if it was a real machine).

' Complete all 4 movies and you truley are a Pinball Wizard and will be showered in gold.  Impossible, I only you
' 36 seconds (length of the music track) so grab what you can, kinda like a supermarket sweep.


Sub StartBonusBall()
	ClearSeq()
	BBArk(CP) = FALSE: BBTemple(CP) = FALSE: BBGrail(CP) = FALSE: BBSkull(CP) = FALSE
	ArkHit=0: TempleHit=0: GrailHit=0: SkullHit=0: BBTotal(CP) = 0: BBVal(CP) = 125000
	DispDMD1.FlushQueue: DispDMD2.FlushQueue
	DispDMD1.QueueText "[edge3][f11][xc][yc][bf]BONUS BALL", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][f11][xc][yc][bf]BONUS BALL", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f4][y3]SHOOT ARROWS TO[y17]COMPLETE SCENES", deFlip, 2000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3]SHOOT ARROWS TO[y17]COMPLETE SCENES", deFlip, 2000, TRUE
	BonusBall = TRUE
	ScoreUpdate = TRUE
	' light all major shots for bonus points...
	LightCrusade.Set BulbBlink, "10", 125
	LightDoom.Set BulbBlink, "10", 125
	LightArk.Set BulbBlink, "10", 125
	LightSkull.Set BulbBlink, "10", 125
	Bumper1.State = BulbBlink
	Bumper2.State = BulbBlink
	Bumper3.State = BulbBlink
	Bumper4.State = BulbBlink
	MovieTimer_Expired()
	' and turn off this lot...
	TorchesOff()
	SkullBulb.State = BulbOff
	RampSkullOff()
	LightXMarks.Set BulbOff, "10", 125
	LightOrbitR.Set BulbOff, "10", 125
	LightOrbitL.Set BulbOff, "10", 125
	LightRaidersMain.Set BulbOff, "10", 150
	LightRaidS4.Set BulbOff, "10", 150
	LightRaidS3.Set BulbOff, "10", 150
	LightRaidS2.Set BulbOff, "10", 150
	LightRaidS1.Set BulbBlink, "10", 150
	LightDoomMain.Set BulbOff, "10", 150
	LightDoomS4.Set BulbOff, "10", 150
	LightDoomS3.Set BulbOff, "10", 150
	LightDoomS2.Set BulbOff, "10", 150
	LightDoomS1.Set BulbBlink, "10", 150
	LightCrusadeMain.Set BulbOff, "10", 150
	LightCrusadeS4.Set BulbOff, "10", 150
	LightCrusadeS3.Set BulbOff, "10", 150
	LightCrusadeS2.Set BulbOff, "10", 150
	LightCrusadeS1.Set BulbBlink, "10", 150
	LightSkullMain.Set BulbOff, "10", 150
	LightSkullS4.Set BulbOff, "10", 150
	LightSkullS3.Set BulbOff, "10", 150
	LightSkullS2.Set BulbOff, "10", 150
	LightSkullS1.Set BulbBlink, "10", 150
	BulbMystery.State = BulbOff
	LightMystery.State = BulbOff
	LightLastCrusade.State = BulbOff
	LightTempleOfDoom.State = BulbOff
	LightRaidersArk.State = BulbOff
	LightCrystalSkull.State = BulbOff
	LightExtraBall.State = BulbOff
	LightSwordsman.State = BulbOff
	LightSuperSpinL.State = BulbOff
	LightSuperSpinR.State = BulbOff
	LightSpecialL.State = BulbOff
	LightSpecialR.State = BulbOff
	MapRoomReset_Expired()
	LightINDY1.Set BulbOff, "10", 125
	LightINDY2.Set BulbOff, "10", 125
	LightINDY3.Set BulbOff, "10", 125
	LightINDY4.Set BulbOff, "10", 125
	LightJONES1.Set BulbOff, "10", 125
	LightJONES2.Set BulbOff, "10", 125
	LightJONES3.Set BulbOff, "10", 125
	LightJONES4.Set BulbOff, "10", 125
	LightJONES5.Set BulbOff, "10", 125
	BallSaved = FALSE
	PlayMusic 3, "Music_Cue11"
	PlayMusic 1, "Music_BonusBall", FALSE, 0.8, 1500
	PlayMusic 2, "vo_ImBack", FALSE, 1, 500
	PlungerKicker.CreateBall: AddTrackedBall(PlungerKicker)
	PlungerKicker.SolenoidPulse: BallsOnPlayfield = 1
	PlungerTimer.Set TRUE, 1500
	BallsRemaining(CP) = 1
	BonusBallTimer.Set TRUE, 36500 ' 15500 old track..
End Sub


' now let's add all those beautiful points...if you got any..

Sub BonusBallTimer_Expired()
	BonusBallTimer.Enabled = FALSE
	fpTilted = TRUE
	AddScore(BBTotal(CP))
	DispDMD1.FlushQueue: DispDMD2.FlushQueue
	DispDMD1.QueueText "[edge3][f6][xc][yc][bf]BONUS END", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][f6][xc][yc][bf]BONUS END", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f4][xc][y3]BONUS TOTAL[y17]" & FormatScore(BBTotal(CP)), deScrollIn, 1500, FALSE
	DispDMD2.QueueText "[edge3][f4][xc][y3]BONUS TOTAL[y17]" & FormatScore(BBTotal(CP)), deScrollIn, 1500, FALSE
	DispDMD1.QueueText "[edge3][f4][xc][y3]FINAL SCORE[y17]" & FormatScore(nvscore(CP)), deFlip, 1500, TRUE, "fx_Whip"
	DispDMD2.QueueText "[edge3][f4][xc][y3]FINAL SCORE[y17]" & FormatScore(nvscore(CP)), deFlip, 1500, TRUE
	If (BBTotal(CP) = 0) Then
		' you didn't hit anything....stupid...
		PlayMusic 2, "vo_Stupid", FALSE, 1, 1200
	Else
		PlayMusic 2, "vo_WasntBad", FALSE, 1, 1200
	End If
	StopMusic 3: StopMusic 4: StopMusic 5: StopMusic 6
	ClearSeq()
	PlasDarkOn()

	' light all major shots for bonus points...
	LightCrusade.Set BulbOff, "10", 125
	LightDoom.Set BulbOff, "10", 125
	LightArk.Set BulbOff, "10", 125
	LightSkull.Set BulbOff, "10", 125
	Bumper1.State = BulbOff
	Bumper2.State = BulbOff
	Bumper3.State = BulbOff
	Bumper4.State = BulbOff

	'LightSeqPF.Play SeqAllOff
	LeftFlipper.SolenoidOff
	RightFlipper.SolenoidOff
		FF_Dev DV_LF,0    ' Turn the flipper solenoids off
		FF_Dev DV_RF,0    ' Turn the flipper solenoids off

	FlushDMDTimer_Expired(): ShowMe = 0
	SpotArk.State = BulbOff
	FlasherArkSpot.State = BulbOff
	BulbFS.State = BulbOff: LightFS.State = BulbOff
	BallStopper.Collidable = FALSE
	If (PlaneOn = TRUE) Then 
		PlaneOn = FALSE
		PropStop.Set TRUE, 500
	End If
	' Stop all timers...
	SlingStop = TRUE
	OneBallTimer.Enabled = FALSE
	TwoBallTimer.Enabled = FALSE
	ThreeBallTimer.Enabled = FALSE
	FourBallTimer.Enabled = FALSE
	NaziTimer.Enabled = FALSE: NaziTgt = FALSE
	MagnetRelease.Collidable = FALSE
	Magnet.Collidable = FALSE
	StartRovingLights.Enabled = FALSE
	StartRovingINDYJONES.Enabled = FALSE
	ModeName = ""
	If (CairoSwordsman = TRUE) Then StopSwordsman()
	StopHurryUps(): StopFastScoring()
	ModeTimer.Enabled = FALSE
	EndOfBallTimer.Set TRUE, 4000
End Sub



Sub EndOfBallComplete()
  Dim NextPlayer

	' save table state for each player...
	Temp1(CP) = LightRaidS1.State 
	Temp2(CP) = LightRaidS2.State 
	Temp3(CP) = LightRaidS3.State 
	Temp4(CP) = LightRaidS4.State 
	Temp5(CP) = LightRaidersMain.State
 
	Temp6(CP) = LightDoomS1.State 
	Temp7(CP) = LightDoomS2.State 
	Temp8(CP) = LightDoomS3.State 
	Temp9(CP) = LightDoomS4.State 
	Temp10(CP) = LightDoomMain.State
 
	Temp11(CP) = LightCrusadeS1.State 
	Temp12(CP) = LightCrusadeS2.State 
	Temp13(CP) = LightCrusadeS3.State 
	Temp14(CP) = LightCrusadeS4.State 
	Temp15(CP) = LightCrusadeMain.State
	
	Temp16(CP) = LightSkullS1.State 
	Temp17(CP) = LightSkullS2.State 
	Temp18(CP) = LightSkullS3.State 
	Temp19(CP) = LightSkullS4.State 
	Temp20(CP) = LightSkullMain.State
 
	TempEB(CP) = LightExtraBall.State 

	TempCrusade(CP) = LightLastCrusade.State 
	TempDoom(CP) = LightTempleOfDoom.State 
	TempRaiders(CP) = LightRaidersArk.State 
	TempSkull(CP) = LightCrystalSkull.State 

	Select Case CP
		Case 1: P1Score = nvScore(CP)
		Case 2: P2Score = nvScore(CP)
		Case 3: P3Score = nvScore(CP)
		Case 4: P4Score = nvScore(CP)
	End Select

	If (PlayersPlayingGame > 1) Then
		NextPlayer = CP + 1
		If (NextPlayer > PlayersPlayingGame) Then
			NextPlayer = 1
		End If
	Else
		NextPlayer = CP
	End If

	If ((BallsRemaining(CP) <= 0) and (BallsRemaining(NextPlayer) <= 0)) Then
		If (MatchPlayed = FALSE) and (PlayersPlayingGame = 1) Then MatchGame(): Exit Sub ' if not Match and win last time...
		Select Case RandomNumber(2)
			Case 1: PlayMusic 2, "vo_Adure"
			Case 2: PlayMusic 2, "vo_SeeYou"
		End Select
		nvTotalGamesPlayed = nvTotalGamesPlayed + 1
		EndOfGame()
		EffectMusic 1, SetVolume, 0, 0: ResumeVol.Set TRUE, 1500
	Else
		CP = NextPlayer
		ResetForNewPlayerBall()
		CreateNewBall()
	End If
End Sub




' **********************************
' **                              **
' **          END OF GAME         **
' **                              **
' **********************************

' Good things always come to an end. But don't be depressed, just start another game....yay!

Sub EndOfGame()
	EndGame()
	BGReflect.Render = FALSE
	Select Case RandomNumber(4)
		Case 1,4: PlayMusic 2, "Music_GameOver", FALSE, 0.8
		Case 2: PlayMusic 2, "Music_GameOver2", FALSE, 0.8
		Case 3: PlayMusic 2, "Music_TheEnd", FALSE, 1
	End Select
	OverlayBG.FadeIn

	SemiLitPFArk()
	TorchesOn()

	FlushDMDTimer.Enabled = FALSE
	DispDMD1.FlushQueue: DispDMD2.FlushQueue

	DispDMD1.QueueText "[edge3][box1,23,6,105,25][f6][xc][yc]GAME OVER", deScrollIn, 2000, FALSE
	DispDMD1.QueueText "[edge3][f2][y5]GRAND CHAMPION[f4][y15][bf]" & left(nvHighScore1Name,3) & " - " & FormatScore(nvHighScore1), deFlip, 2000, FALSE
	DispDMD1.QueueText "[edge3][f2][y5]2ND PLACE[f4][y15]" & left(nvHighScore2Name,3) & " - " & FormatScore(nvHighScore2), deScrollLeft, 1500, FALSE
	DispDMD1.QueueText "[edge3][f2][y5]3RD PLACE[f4][y15]" & left(nvHighScore3Name,3) & " - " & FormatScore(nvHighScore3), deScrollRight, 1500, FALSE
	DispDMD1.QueueText "[edge3][f2][y5]LAST ADVENTURER[f4][y15]" & FormatScore(nvScore(CP)), deScrollUp, 1800, FALSE
	DispDMD1.QueueText "[edge3][f6][yc]INDIANA JONES", deScrollIn, 2000, FALSE
	DispDMD1.QueueText "[edge3][f3][y6]ORIGINAL BUILD[f2][y19][xc]GLXB, HIGHLNDER00", deFlip, 2000, FALSE
	DispDMD1.QueueText "[edge3][f3][y6]ULTIMATE PRO[f2][y19][xc]BY SLAMT1LT", deFlip, 2000, FALSE
	DispDMD1.QueueText "[edge3][f3][y6]SPECIAL THANKS[f2][y19][xc]TERRYRED, RAVARCADE", deFlip, 2000, FALSE ' thanks Terry for your efforts in getting FP the respect it deserves!
	DispDMD1.QueueText "[edge3][f2][xc][y4]FREE SHOT AWARDS[y13]NEXT LIT SHOT[y22]WHEN ACTIVATED", deNone, 3000, FALSE
	DispDMD1.QueueText "[edge3][f2][xc][y4]ROTATE SCENES[y13]WITH ACTION BUTTON[y22]WHEN NOT READY", deFlip, 3000, FALSE
	DispDMD1.QueueText "[edge3][f2][xc][y4]HOLD RIGHT FLIPPER[y13]FOR STATUS, LEFT[y22]FLIPPER TO NAVIGATE", deFlip, 3000, FALSE
	DispDMD1.QueueText "[edge3][f4][xc][y3]BONUS BALL[y17]QUALIFICATION", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f2][xc][y3]8 HITS TO ARK[y12]AND TEMPLE, 5 HITS[y21]TO GRAIL AND SKULL", deFlip, 3000, FALSE

	DispDMD2.QueueText "[edge3][box1,23,6,105,25][f6][xc][yc]GAME OVER", deScrollIn, 2000, FALSE
	DispDMD2.QueueText "[edge3][f2][y5]GRAND CHAMPION[f4][y15][bf]" & left(nvHighScore1Name,3) & " - " & FormatScore(nvHighScore1), deFlip, 2000, FALSE
	DispDMD2.QueueText "[edge3][f2][y5]2ND PLACE[f4][y15]" & left(nvHighScore2Name,3) & " - " & FormatScore(nvHighScore2), deScrollLeft, 1500, FALSE
	DispDMD2.QueueText "[edge3][f2][y5]3RD PLACE[f4][y15]" & left(nvHighScore3Name,3) & " - " & FormatScore(nvHighScore3), deScrollRight, 1500, FALSE
	DispDMD2.QueueText "[edge3][f2][y5]LAST ADVENTURER[f4][y15]" & FormatScore(nvScore(CP)), deScrollUp, 1800, FALSE
	DispDMD2.QueueText "[edge3][f6][yc]INDIANA JONES", deScrollIn, 2000, FALSE
	DispDMD2.QueueText "[edge3][f3][y6]ORIGINAL BUILD[f2][y19][xc]GLXB, HIGHLNDER00", deFlip, 2000, FALSE
	DispDMD2.QueueText "[edge3][f3][y6]ULTIMATE PRO[f2][y19][xc]BY SLAMT1LT", deFlip, 2000, FALSE
	DispDMD2.QueueText "[edge3][f3][y6]SPECIAL THANKS[f2][y19][xc]TERRYRED, RAVARCADE", deFlip, 2000, FALSE
	DispDMD2.QueueText "[edge3][f2][xc][y4]FREE SHOT AWARDS[y13]NEXT LIT SHOT[y22]WHEN ACTIVATED", deNone, 3000, FALSE
	DispDMD2.QueueText "[edge3][f2][xc][y4]ROTATE SCENES[y13]WITH ACTION BUTTON[y22]WHEN NOT READY", deFlip, 3000, FALSE
	DispDMD2.QueueText "[edge3][f2][xc][y4]HOLD RIGHT FLIPPER[y13]FOR STATUS, LEFT[y22]FLIPPER TO NAVIGATE", deFlip, 3000, FALSE
	DispDMD2.QueueText "[edge3][f4][xc][y3]BONUS BALL[y17]QUALIFICATION", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][f2][xc][y3]8 HITS TO ARK[y12]AND TEMPLE, 5 HITS[y21]TO GRAIL AND SKULL", deFlip, 3000, FALSE

	LightRaidersMain.Set BulbBlink, "00001", 150
	LightRaidS4.Set BulbBlink, "00010", 150
	LightRaidS3.Set BulbBlink, "00100", 150
	LightRaidS2.Set BulbBlink, "01000", 150
	LightRaidS1.Set BulbBlink, "10000", 150

	LightDoomMain.Set BulbBlink, "00001", 150
	LightDoomS4.Set BulbBlink, "00010", 150
	LightDoomS3.Set BulbBlink, "00100", 150
	LightDoomS2.Set BulbBlink, "01000", 150
	LightDoomS1.Set BulbBlink, "10000", 150

	LightCrusadeMain.Set BulbBlink, "00001", 150
	LightCrusadeS4.Set BulbBlink, "00010", 150
	LightCrusadeS3.Set BulbBlink, "00100", 150
	LightCrusadeS2.Set BulbBlink, "01000", 150
	LightCrusadeS1.Set BulbBlink, "10000", 150

	LightSkullMain.Set BulbBlink, "00001", 150
	LightSkullS4.Set BulbBlink, "00010", 150
	LightSkullS3.Set BulbBlink, "00100", 150
	LightSkullS2.Set BulbBlink, "01000", 150
	LightSkullS1.Set BulbBlink, "10000", 150

	' INDY JONES lights...
	LightINDY1.Set BulbBlink,  "100000000", 250
	LightINDY2.Set BulbBlink,  "010000000", 250
	LightINDY3.Set BulbBlink,  "001000000", 250
	LightINDY4.Set BulbBlink,  "000100000", 250
	LightJONES1.Set BulbBlink, "000010000", 250
	LightJONES2.Set BulbBlink, "000001000", 250
	LightJONES3.Set BulbBlink, "000000100", 250
	LightJONES4.Set BulbBlink, "000000010", 250
	LightJONES5.Set BulbBlink, "000000001", 250

	LightXMarks.Set BulbBlink, "10", 125

	LightCrusade.Set BulbBlink, "100000", 500
	LightOrbitL.Set BulbBlink, "010000", 500
	LightDoom.Set BulbBlink, "001000", 500
	LightArk.Set BulbBlink, "000100", 500
	LightSkull.Set BulbBlink, "000010", 500
	LightOrbitR.Set BulbBlink, "000001", 500

	LightLastCrusade.State = BulbOn
	LightTempleOfDoom.State = BulbOn
	LightRaidersArk.State = BulbOn
	LightCrystalSkull.State = BulbOn

	Bumper1.State = BulbOff
	Bumper2.State = BulbOff
	Bumper3.State = BulbOff
	Bumper4.State = BulbOff

	LeftFlipper.SolenoidOff
	RightFlipper.SolenoidOff
		FF_Dev DV_LF,0    ' Turn the flipper solenoids off
		FF_Dev DV_RF,0    ' Turn the flipper solenoids off


	AttPlay = 0: AttractTimer.Set TRUE, 5000
End Sub


' I always like to add something during the attract sequence...

Sub AttractTimer_Expired()
	AttPlay = AttPlay + 1
	Select Case AttPlay
		Case 1:
			Select Case RandomNumber(3)
				Case 1:
					Tune = 0: MusicPlay()
					PlayMusic 3, "Music_Bonus7", FALSE, 0.7
					MoviePick = 1: PlayClipAttract()
					AttractTimer.Set TRUE, 2100: AttPlay = 8
				Case 2,3:
					NoS(): OverlayLCD.Frame 23: LCD.Frame 23  ' Indiana Jones and the...
					LightSeqPF.StopPlay
					LightSeqAtt.Play SeqAllOff ' turn off all light except scene inserts...
					LightRaidersMain.Set BulbOff, "10", 150
					LightRaidS4.Set BulbOff, "10", 150
					LightRaidS3.Set BulbOff, "10", 150
					LightRaidS2.Set BulbOff, "10", 150
					LightRaidS1.Set BulbOff, "10", 150
					LightDoomMain.Set BulbOff, "10", 200
					LightDoomS4.Set BulbOff, "10", 200
					LightDoomS3.Set BulbOff, "10", 200
					LightDoomS2.Set BulbOff, "10", 200
					LightDoomS1.Set BulbOff, "10", 200
					LightCrusadeMain.Set BulbOff, "10", 125
					LightCrusadeS4.Set BulbOff, "10", 125
					LightCrusadeS3.Set BulbOff, "10", 125
					LightCrusadeS2.Set BulbOff, "10", 125
					LightCrusadeS1.Set BulbOff, "10", 125
					LightSkullMain.Set BulbOff, "10", 125
					LightSkullS4.Set BulbOff, "10", 125
					LightSkullS3.Set BulbOff, "10", 125
					LightSkullS2.Set BulbOff, "10", 125
					LightSkullS1.Set BulbOff, "10", 125
					AttractTimer.Set TRUE, 1500
			End Select
		Case 2: 
			NoS(): OverlayLCD.Frame 24: LCD.Frame 24: PlaySound "fx_Whip5": WhipFlash()
			LightRaidersMain.Set BulbBlink, "10", 200
			LightRaidS4.Set BulbBlink, "10", 200
			LightRaidS3.Set BulbBlink, "10", 200
			LightRaidS2.Set BulbBlink, "10", 200
			LightRaidS1.Set BulbBlink, "10", 200
			AttractTimer.Set TRUE, 2000
		Case 3:
			NoS(): OverlayLCD.Frame 25: LCD.Frame 25: PlaySound "fx_Whip5": WhipFlash()
			LightDoomMain.Set BulbBlink, "10", 200
			LightDoomS4.Set BulbBlink, "10", 200
			LightDoomS3.Set BulbBlink, "10", 200
			LightDoomS2.Set BulbBlink, "10", 200
			LightDoomS1.Set BulbBlink, "10", 200
			LightRaidersMain.Set BulbOff, "10", 150
			LightRaidS4.Set BulbOff, "10", 150
			LightRaidS3.Set BulbOff, "10", 150
			LightRaidS2.Set BulbOff, "10", 150
			LightRaidS1.Set BulbOff, "10", 150
		Case 4: 
			NoS(): OverlayLCD.Frame 26: LCD.Frame 26: PlaySound "fx_Whip5": WhipFlash()
			LightCrusadeMain.Set BulbBlink, "10", 200
			LightCrusadeS4.Set BulbBlink, "10", 200
			LightCrusadeS3.Set BulbBlink, "10", 200
			LightCrusadeS2.Set BulbBlink, "10", 200
			LightCrusadeS1.Set BulbBlink, "10", 200
			LightDoomMain.Set BulbOff, "10", 200
			LightDoomS4.Set BulbOff, "10", 200
			LightDoomS3.Set BulbOff, "10", 200
			LightDoomS2.Set BulbOff, "10", 200
			LightDoomS1.Set BulbOff, "10", 200
		Case 5:
			NoS(): OverlayLCD.Frame 27: LCD.Frame 27: PlaySound "fx_Whip5": WhipFlash()
			LightSkullMain.Set BulbBlink, "10", 200
			LightSkullS4.Set BulbBlink, "10", 200
			LightSkullS3.Set BulbBlink, "10", 200
			LightSkullS2.Set BulbBlink, "10", 200
			LightSkullS1.Set BulbBlink, "10", 200
			LightCrusadeMain.Set BulbOff, "10", 125
			LightCrusadeS4.Set BulbOff, "10", 125
			LightCrusadeS3.Set BulbOff, "10", 125
			LightCrusadeS2.Set BulbOff, "10", 125
			LightCrusadeS1.Set BulbOff, "10", 125
		Case 6:
			LightSkullMain.Set BulbOff, "10", 125
			LightSkullS4.Set BulbOff, "10", 125
			LightSkullS3.Set BulbOff, "10", 125
			LightSkullS2.Set BulbOff, "10", 125
			LightSkullS1.Set BulbOff, "10", 125
			NoS(): OverlayLCD.Frame 184: LCD.Frame 184 
			LightSeqAtt.StopPlay
			BulbArkL.State = BulbOff
			BulbArkR.State = BulbOff
			FlasherRed.State = BulbOff
		Case 7:
			LightRaidersMain.Set BulbBlink, "00001", 150
			LightRaidS4.Set BulbBlink, "00010", 150
			LightRaidS3.Set BulbBlink, "00100", 150
			LightRaidS2.Set BulbBlink, "01000", 150
			LightRaidS1.Set BulbBlink, "10000", 150
			LightDoomMain.Set BulbBlink, "00001", 150
			LightDoomS4.Set BulbBlink, "00010", 150
			LightDoomS3.Set BulbBlink, "00100", 150
			LightDoomS2.Set BulbBlink, "01000", 150
			LightDoomS1.Set BulbBlink, "10000", 150
			LightCrusadeMain.Set BulbBlink, "00001", 150
			LightCrusadeS4.Set BulbBlink, "00010", 150
			LightCrusadeS3.Set BulbBlink, "00100", 150
			LightCrusadeS2.Set BulbBlink, "01000", 150
			LightCrusadeS1.Set BulbBlink, "10000", 150
			LightSkullMain.Set BulbBlink, "00001", 150
			LightSkullS4.Set BulbBlink, "00010", 150
			LightSkullS3.Set BulbBlink, "00100", 150
			LightSkullS2.Set BulbBlink, "01000", 150
			LightSkullS1.Set BulbBlink, "10000", 150
		Case 8:
			Select Case RandomNumber(3)
				Case 1: Clip = 7: PlayClip(): AttPlay = 0
				Case 2:
					Tune = 0: MusicPlay()
					PlayMusic 3, "Music_Bonus7", FALSE, 0.7
					MoviePick = 1: PlayClipAttract()
					AttractTimer.Set TRUE, 2100
				Case 3: Clip = 59: PlayClip(): PlayMusic 3, "vo_Genargh3": AttPlay = 0
			End Select
		Case 9
			MoviePick = 2: PlayClipAttract()
		Case 10:
			MoviePick = 3: PlayClipAttract()
		Case 11
			MoviePick = 4: PlayClipAttract()
		Case 12:
			MoviePick = 5: PlayClipAttract()
		Case 13:
			Tune = 1: MusicPlay()
			AttPlay = 0
			NoS()
			If (nvCredits > 0) Then 
				OverlayLCD.Frame 543,544,543: LCD.Frame 543,544,543
			Else
				OverlayLCD.Frame 543: LCD.Frame 543
			End If
			AttractTimer.Set TRUE, 4000
	End Select
End Sub


Dim Tune


Sub MusicPlay()
	Select Case Tune
		Case 1: EffectMusic 2, SetVolume, 0.8, 500
		Case 0: EffectMusic 2, SetVolume, 0, 500
	End Select
End Sub



Sub WhipFlash()
	BulbArkL.Set BulbBlink, 	"00000100000000000000", 85
	BulbArkR.Set BulbBlink, 	"00000100000000000000", 85
	FlasherRed.Set BulbBlink, 	"00000100000000000000", 85
End Sub




' *********************************
' **                             **
' **         PLUNGER LANE        **
' **                             **
' *********************************


Sub PlungerLaneTrigger_Hit()
	bBallInPlungerLane = TRUE
	PlungerWaiting.Set TRUE, 7000
	set LastSwitchHit = PlungerLaneTrigger
End Sub


' don't fanny about in the plunger lane...
Sub PlungerWaiting_Expired()
	MusicFade(1000)
	Select Case RandomNumber(2)
		Case 1: PlayMusic 2, "vo_Hello"
		Case 2: PlayMusic 2, "vo_GoAhead"
	End Select
End Sub


Sub PlungerLaneTrigger_UnHit()
	PlungerWaiting.Enabled = FALSE
	bBallInPlungerLane = FALSE
	BallLaunched = TRUE
	SkillTimer.Set FALSE
	JustSkill = FALSE
	StartSkillTimer.Enabled = FALSE
End Sub


Sub PlungerKicker_Hit()
	PlungerKicker.SolenoidPulse
	'PlaySound "fx_Belch"
End Sub


' Start of plunger lane plastic ramp.

Sub RampFX_Hit()
	If (LastSwitchHit.Name = "RampFX") Then StopMusic 3: Exit Sub
	PlayMusic 6, "fx_PlasticRamp2"
	If (bBallSaverActive = FALSE) and (bMultiballMode = FALSE) and (BonusBall = FALSE) and (NewBall = TRUE) Then
		If (LastSwitchHit.Name = "PlungerLaneTrigger") Then
			bBallSaverActive = TRUE
			BallSaverTimer.Set TRUE, BSTime(CP)
			ShootAgainLight.State = BulbBlink
		End If
	End If
	Set LastSwitchHit = RampFX
End Sub


Sub RampFX2_Hit()
	PlaySound "fx_BallDropL"
	If (bMultiballMode = FALSE) Then IgnoreMe = TRUE
	set LastSwitchHit = RampFX2
End Sub



' **********************************
' **                              **
' **          BALL SAVER          **
' **                              **
' **********************************

' The Ball Save timer is variable and be increased with a player perk.
' When it runs out, I allow a small grace period of 1.5 seconds...I know, too generous


Sub BallSaverTimer_Expired()
	BallSaverTimer.Enabled = FALSE
	If (ExtraBallsAwards(CP) =< 0) Then
		ShootAgainLight.State = BulbOff
	Else
		ShootAgainLight.State = BulbOn
	End If
	Grace = Grace - 1
	Select Case Grace
		Case 0:
			Grace = 2
			bBallSaverActive = FALSE
		Case 1:
			If (PerkLuck(CP) = TRUE) Then
				BallSaverTimer.Set TRUE, 3000
			Else
				BallSaverTimer.Set TRUE, 1500
			End If
	End Select
End Sub



Dim Grace
Grace = 2



' *************************************************
' **                                             **
' **             Score Functions                 **
' **                                             **
' *************************************************

' The old DMD is still the best way to get vital information to the player in the clearest and fastest way possible.
' LCDs can be a confusing mess and so I will always use DMDs in my games - there isn't anything better.

' The DMD scoring display will prioritise what is most important at the time, so basic scoring is at the bottom of the list.


Sub AddScore(Points)
	dim Info
	RampRtn = FALSE
	If (fpTilted = FALSE) Then
		nvScore(CP) = nvScore(CP) + (Points*xMarks)

		If (BallsOnPlayfield =< 0) Then Exit Sub

		' the DMD is used for a fast updating score countdown...
		If (CairoSwordsman = TRUE) or (HurryUpMode = TRUE) Then Exit Sub

		If (ScoreUpdate = TRUE) Then
			If (BonusBall = TRUE) Then
				DispDMD1.Text="[edge3][xc][f1][y2]BONUS BALL[f6][yc][bf]COMPLETE MOVIES[/bf][f1][y25]SHOOT LIT SHOTS" 
				DispDMD2.Text="[edge3][xc][f1][y2]BONUS BALL[f6][yc][bf]COMPLETE MOVIES[/bf][f1][y25]SHOOT LIT SHOTS"
			Exit Sub
			End If
			If (ModeName = "RScene1") Then
				DispDMD1.Text="[edge3][f1][y2]RAIDERS OF THE LOST ARK[y8]BOULDER RUN[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
				DispDMD2.Text="[edge3][f1][y2]RAIDERS OF THE LOST ARK[y8]BOULDER RUN[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
			Exit Sub
			End If
			If (ModeName = "RScene2") Then
				DispDMD1.Text="[edge3][f1][y2]RAIDERS OF THE LOST ARK[y8]BAR SHOOTOUT[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]NAZI KILLED = "& Nazi
				DispDMD2.Text="[edge3][f1][y2]RAIDERS OF THE LOST ARK[y8]BAR SHOOTOUT[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]NAZI KILLED = "& Nazi
			Exit Sub
			End If
			If (ModeName = "RScene3") Then
				If (LightArk.State = BulbOff) Then Info = "HIT EACH TARGET BANK"
				If (LightArk.State = BulbBlink) Then Info = "SHOOT THE ARK"
				Select Case RandomNumber(3)
					Case 1,2:
						DispDMD1.Text="[edge3][f1][y2]RAIDERS OF THE LOST ARK[y8]TRUCK HIJACK[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
						DispDMD2.Text="[edge3][f1][y2]RAIDERS OF THE LOST ARK[y8]TRUCK HIJACK[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
					Case 3:
						DispDMD1.Text="[edge3][f1][y2]RAIDERS OF THE LOST ARK[y8]TRUCK HIJACK[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]" & Info
						DispDMD2.Text="[edge3][f1][y2]RAIDERS OF THE LOST ARK[y8]TRUCK HIJACK[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]" & Info
				End Select
			Exit Sub
			End If
			If (ModeName = "RScene4") Then
				If (LightArk.State = BulbBlink) Then
					DispDMD1.Text="[edge3][f1][y2]RAIDERS OF THE LOST ARK[y8]ARK CEREMONY[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26][b]SHOOT ARK"
					DispDMD2.Text="[edge3][f1][y2]RAIDERS OF THE LOST ARK[y8]ARK CEREMONY[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26][b]SHOOT ARK"
				Else
					DispDMD1.Text="[edge3][f1][y2]RAIDERS OF THE LOST ARK[y8]ARK CEREMONY[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]SWITCHES = " & rJackpotHitsLeft
					DispDMD2.Text="[edge3][f1][y2]RAIDERS OF THE LOST ARK[y8]ARK CEREMONY[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]SWITCHES = " & rJackpotHitsLeft
				End If
			Exit Sub
			End If
			If (ModeName = "TScene1") Then
				DispDMD1.Text="[edge3][f1][y2]TEMPLE OF DOOM[y8]THE ANTIDOTE[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
				DispDMD2.Text="[edge3][f1][y2]TEMPLE OF DOOM[y8]THE ANTIDOTE[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
			Exit Sub
			End If
			If (ModeName = "TScene2") Then
				DispDMD1.Text="[edge3][f1][y2]TEMPLE OF DOOM[y8]PLANE JUMP[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
				DispDMD2.Text="[edge3][f1][y2]TEMPLE OF DOOM[y8]PLANE JUMP[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
			Exit Sub
			End If
			If (ModeName = "TScene3") Then
				DispDMD1.Text="[edge3][f1][y2]TEMPLE OF DOOM[y8]MINECART CHASE[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]ENEMY KILLED: "& Nazi
				DispDMD2.Text="[edge3][f1][y2]TEMPLE OF DOOM[y8]MINDCART CHASE[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]ENEMY KILLED: "& Nazi
			Exit Sub
			End If
			If (ModeName = "TScene4") Then
				If (LightSkull.State = BulbBlink) Then Info = "MAKE COMBO"
				If (LightArk.State = BulbBlink) Then Info = "SHOOT ARK"
				If (LightDoom.State = BulbBlink) Then Info = "SHOOT TEMPLE"
				DispDMD1.Text="[edge3][f1][y2]TEMPLE OF DOOM[y8]ROPE BRIDGE[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26][b]" & Info
				DispDMD2.Text="[edge3][f1][y2]TEMPLE OF DOOM[y8]ROPE BRIDGE[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26][b]" & Info
			Exit Sub
			End If
			If (ModeName = "CScene1") Then
				DispDMD1.Text="[edge3][f1][y2]LAST CRUSADE[y8]YOUNG INDY[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
				DispDMD2.Text="[edge3][f1][y2]LAST CRUSADE[y8]YOUNG INDY[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
			Exit Sub
			End If
			If (ModeName = "CScene2") Then
				DispDMD1.Text="[edge3][f1][y2]LAST CRUSADE[y8]DOGFIGHT[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
				DispDMD2.Text="[edge3][f1][y2]LAST CRUSADE[y8]DOGFIGHT[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
			Exit Sub
			End If
			If (ModeName = "CScene3") Then
				DispDMD1.Text="[edge3][f1][y2]LAST CRUSADE[y8]TANK RESCUE[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]SHOTS REMAIN = " & ModeHit
				DispDMD2.Text="[edge3][f1][y2]LAST CRUSADE[y8]TANK RESCUE[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]SHOTS REMAIN = " & ModeHit
			Exit Sub
			End If
			If (ModeName = "CScene4") Then
				DispDMD1.Text="[edge3][f1][y2]LAST CRUSADE[y8]CHOOSE WISELY[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
				DispDMD2.Text="[edge3][f1][y2]LAST CRUSADE[y8]CHOOSE WISELY[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
			Exit Sub
			End If
			If (ModeName = "SScene1") Then
				Select Case RandomNumber(3)
					Case 1,2:
						DispDMD1.Text="[edge3][f1][y2]CRYSTAL SKULL[y8]ROCKET SLED[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
						DispDMD2.Text="[edge3][f1][y2]CRYSTAL SKULL[y8]ROCKET SLED[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
					Case 3:
						DispDMD1.Text="[edge3][f1][y2]CRYSTAL SKULL[y8]ROCKET SLED[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]THRUST = "& Thrust & " %"
						DispDMD2.Text="[edge3][f1][y2]CRYSTAL SKULL[y8]ROCKET SLED[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]THRUST = "& Thrust & " %"
				End Select
			Exit Sub
			End If
			If (ModeName = "SScene2") Then
				DispDMD1.Text="[edge3][f1][y2]CRYSTAL SKULL[y8]NUKE TOWN[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
				DispDMD2.Text="[edge3][f1][y2]CRYSTAL SKULL[y8]NUKE TOWN[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
			Exit Sub
			End If
			If (ModeName = "SScene3") Then
				Select Case RandomNumber(3)
					Case 1,2:
						DispDMD1.Text="[edge3][f1][y2]CRYSTAL SKULL[y8]MIND CONTROL[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
						DispDMD2.Text="[edge3][f1][y2]CRYSTAL SKULL[y8]MIND CONTROL[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
					Case 3:
						DispDMD1.Text="[edge3][f1][y2]CRYSTAL SKULL[y8]MIND CONTROL[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]SHOOT THE SKULL"
						DispDMD2.Text="[edge3][f1][y2]CRYSTAL SKULL[y8]MIND CONTROL[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]SHOOT THE SKULL"
				End Select
			Exit Sub
			End If
			If (ModeName = "SScene4") Then
				DispDMD1.Text="[edge3][f1][y2]CRYSTAL SKULL[y8]SKULL RETURN[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
				DispDMD2.Text="[edge3][f1][y2]CRYSTAL SKULL[y8]SKULL RETURN[xc][y15][f3]"&FormatScore(nvscore(CP))&"[f1][y26]TIME REMAIN: "& HurryTime
			Exit Sub
			End If
			If (IJScoring = TRUE) Then
				DispDMD1.Text="[edge3][xc][f1][y2]INDY JONES[f6][yc]"&formatscore(nvscore(CP))&"[f1][y25][bf]ALL LETTERS 200K EACH" 
				DispDMD2.Text="[edge3][xc][f1][y2]INDY JONES[f6][yc]"&formatscore(nvscore(CP))&"[f1][y25][bf]ALL LETTERS 200K EACH" 
			Exit Sub
			End If
			If (JONESScoring = TRUE) Then
				DispDMD1.Text="[edge3][xc][f1][y2]JONES SCORING[f6][yc]"&formatscore(nvscore(CP))&"[f1][y25][bf]SHOOT LIT LETTER" 
				DispDMD2.Text="[edge3][xc][f1][y2]JONES SCORING[f6][yc]"&formatscore(nvscore(CP))&"[f1][y25][bf]SHOOT LIT LETTER" 
			Exit Sub
			End If
			If (INDYScoring = TRUE) Then
				DispDMD1.Text="[edge3][xc][f1][y2]INDY SCORING[f6][yc]"&formatscore(nvscore(CP))&"[f1][y25][bf]SHOOT LIT LETTER" 
				DispDMD2.Text="[edge3][xc][f1][y2]INDY SCORING[f6][yc]"&formatscore(nvscore(CP))&"[f1][y25][bf]SHOOT LIT LETTER"
			Exit Sub
			End If
			If (BOG = TRUE) Then
				DispDMD1.Text="[edge3][xc][f1][y2]CHALLENGE VALUE[f6][yc][bf]"&FormatScore(ChallengeVal(CP))&"[f1][y25][/bf]SHOOT LEFT LOOP" 
				DispDMD2.Text="[edge3][xc][f1][y2]CHALLENGE VALUE[f6][yc][bf]"&FormatScore(ChallengeVal(CP))&"[f1][y25][/bf]SHOOT LEFT LOOP" 
			Exit Sub
			End If
			If (xMarks = 2) Then
				DispDMD1.Text="[edge3][xc][f1][y2][bf]DOUBLE SCORING[/bf][f6][yc]"&formatscore(nvscore(CP))&"[f1][y25]TIME REMAIN: " & xMarksTime 
				DispDMD2.Text="[edge3][xc][f1][y2][bf]DOUBLE SCORING[/bf][f6][yc]"&formatscore(nvscore(CP))&"[f1][y25]TIME REMAIN: " & xMarksTime 
			Exit Sub
			End If
			If (TempleOpen = TRUE) Then
				DispDMD1.Text="[edge3][xc][f1][y2]TEMPLE OF DOOM[y8]IS READY[f3][y14]"&formatscore(nvscore(CP))&"[f1][y25]TEMPLE CLOSE: " & DoomTime 
				DispDMD2.Text="[edge3][xc][f1][y2]TEMPLE OF DOOM[y8]IS READY[f3][y14]"&formatscore(nvscore(CP))&"[f1][y25]TEMPLE CLOSE: " & DoomTime
			Exit Sub
			End If
			Select Case PlayersPlayingGame
				Case 1:
					DispDMD1.Text="[edge3][xc][y3][f7]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti 
					DispDMD2.Text="[edge3][xc][y3][f7]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti
				Case 2:
					Select Case CP
						Case 1:
							DispDMD1.Text="[edge3][xc][f1][y2]JONES SNR - "&FormatScore(P2Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti 
							DispDMD2.Text="[edge3][xc][f1][y2]JONES SNR - "&FormatScore(P2Score)& "[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti
						Case 2:
							DispDMD1.Text="[edge3][xc][f1][y2]INDIANA - "&FormatScore(P1Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti 
							DispDMD2.Text="[edge3][xc][f1][y2]INDIANA - "&FormatScore(P1Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti
					End Select
				Case 3:
					Select Case CP
						Case 1:
							DispDMD1.Text="[edge3][xc][f1][y2]MARCUS - "&FormatScore(P3Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti 
							DispDMD2.Text="[edge3][xc][f1][y2]MARCUS - "&FormatScore(P3Score)& "[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti
						Case 2:
							DispDMD1.Text="[edge3][xc][f1][y2]INDIANA - "&FormatScore(P1Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti 
							DispDMD2.Text="[edge3][xc][f1][y2]INDIANA - "&FormatScore(P1Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti
						Case 3:
							DispDMD1.Text="[edge3][xc][f1][y2]JONES SNR - "&FormatScore(P2Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti 
							DispDMD2.Text="[edge3][xc][f1][y2]JONES SNR - "&FormatScore(P2Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti
					End Select
				Case 4: ' ok, stop showing off....you have at least 4 friends...
					Select Case CP
						Case 1:
							DispDMD1.Text="[edge3][xc][f1][y2]SALLAH - "&FormatScore(P4Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti 
							DispDMD2.Text="[edge3][xc][f1][y2]SALLAH - "&FormatScore(P4Score)& "[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti
						Case 2:
							DispDMD1.Text="[edge3][xc][f1][y2]INDIANA - "&FormatScore(P1Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti 
							DispDMD2.Text="[edge3][xc][f1][y2]INDIANA - "&FormatScore(P1Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti
						Case 3:
							DispDMD1.Text="[edge3][xc][f1][y2]JONES SNR - "&FormatScore(P2Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti 
							DispDMD2.Text="[edge3][xc][f1][y2]JONES SNR - "&FormatScore(P2Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti
						Case 4:
							DispDMD1.Text="[edge3][xc][f1][y2]MARCUS - "&FormatScore(P3Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti 
							DispDMD2.Text="[edge3][xc][f1][y2]MARCUS - "&FormatScore(P3Score)&"[yc][f12]"&formatscore(nvscore(CP))&"[f1][x1][y25]BALL: "&(BallsRemaining(CP))&"[x45]SHOT: "&FreeShot(CP)&"[x87][y25]MAP X: "&MapMulti
					End Select
			End Select
		End If
	End If
End Sub



' ************************************************
' **                                            **
' **                SLINGSHOTS                  **
' **                                            **
' ************************************************

' Smack these buggers and the ball will fly uncontrollably towards it's doom...they also
' rotate the SPECIAL light when lit.


Sub LeftSlingshotRubber_Hit()
	If (fpTilted = TRUE) Then Exit Sub
	'PlaySound "fx_BulletHit2"
	FF_Sound DV_LS,-1,"fx_BulletHit2"   'Left Slingshot
	FF_Flasher DV_FLOL,FL_FL,2,20,100,"Random"  'DOFLinx - Outer Left Flasher - Random
	
	LeftSlingshotBulb1.FlashForMs 250, 125, BulbOn
	LeftSlingshotBulb2.FlashForMs 250, 125, BulbOn
	Bulb63.FlashForMs 250, 125, BulbOn
	Bulb64.FlashForMs 250, 125, BulbOn
	Flasher3.FlashForMs 250, 125, BulbOff
	
	If (FlashPFTimer.Enabled = FALSE) Then PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 250

	If (ModeName = "RScene4") Then RaidersHit():	Exit Sub

	AddScore(220)

	If (PerkSpecial(CP) = TRUE) Then Exit Sub
	
	If (LightSpecialL.State = BulbOn) Then 
		LightSpecialL.State = BulbOff
		LightSpecialR.State = BulbOn
	Exit Sub
	End If
	If (LightSpecialR.State = BulbOn) Then
		LightSpecialR.State = BulbOff
		LightSpecialL.State = BulbOn
	End If
	set LastSwitchHit = LeftSlingShotRubber
End Sub


Sub RightSlingshotRubber_Hit()
	If (fpTilted = TRUE) Then Exit Sub
	'PlaySound "fx_BulletHit4"
	FF_Sound DV_RS,-1,"fx_BulletHit4"   'DOFLinx Right Slingshot
	FF_Flasher DV_FLOR,FL_FL,2,20,100,"Random"  'DOFLinx - Outer Right Flasher - Random
	
	RightSlingshotBulb1.FlashForMs 250, 125, BulbOn
	RightSlingshotBulb2.FlashForMs 250, 125, BulbOn
	Bulb1.FlashForMs 250, 125, BulbOn
	Bulb65.FlashForMs 250, 125, BulbOn
	Flasher2.FlashForMs 250, 125, BulbOff

	If (FlashPFTimer.Enabled = FALSE) Then PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 250

	If (ModeName = "RScene4") Then RaidersHit():	Exit Sub

	AddScore(220)

	If (PerkSpecial(CP) = TRUE) Then Exit Sub

	If LightSpecialL.State = BulbOn then 
		LightSpecialL.State = BulbOff
		LightSpecialR.State = BulbOn
	Exit Sub
	End If
	If LightSpecialR.State = BulbOn then
		LightSpecialR.State = BulbOff
		LightSpecialL.State = BulbOn
	End If
	set LastSwitchHit = RightSlingShotRubber
End Sub


Dim StopIt,BS


' ************************************************
' **                                            **
' **                IN/OUTLANES                 **
' **                                            **
' ************************************************

' The In Lanes advance towards lighting the MYSTERY at the GRAIL SCOOP and BALL SAVER.

' The Out Lanes will collect a rather nice SPECIAL if lit, or claim your ball if the BALL SAVER is not active.


Sub LeftInLaneTrigger_Hit()

	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub

	If (StopIt = TRUE) Then StopIt = FALSE: Exit Sub

	If (LastSwitchHit.Name = "LeftInLaneTrigger") or (ModeName = "SScene1") Then PlaySound "fx_EmptyGun", 0.6: Exit Sub

	If (ModeName = "RScene4") Then RaidersHit():	Exit Sub

	If (bMultiballMode = FALSE) Then
		BS = BS - 1
		If (BS =< 0) Then
			AddScore(7500)
			bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, BSTime(CP): ShootAgainLight.State = BulbBlink
			If (PerkBS(CP) = TRUE) Then BSTime(CP) = BSTime(CP) + 1000
			If (ScoreUpdate = TRUE) Then
				FlushDMDTimer.Set TRUE, 1000
				DispDMD1.QueueText "[edge3][box3,1,1,126,30][f5][y2]BALL SAVER[f6][y14]ACTIVATED", deNone, 50, FALSE
				DispDMD2.QueueText "[edge3][box3,1,1,126,30][f5][y2]BALL SAVER[f6][y14]ACTIVATED", deNone, 50, FALSE
				DispDMD1.QueueText "[edge3][f5][y2]BALL SAVER[f6][y14]ACTIVATED", deNone, 50, FALSE
				DispDMD2.QueueText "[edge3][f5][y2]BALL SAVER[f6][y14]ACTIVATED", deNone, 50, FALSE
			End If
			PlaySound "fx_GunTriple"
			Flash = 2: FlashPFTimer.Set TRUE, 100
			BS = 5
		Else
			AddScore(1000)
			PlaySound "fx_MachineGun"
			Flash = 0: FlashPFTimer.Set TRUE, 70
			If (ScoreUpdate = TRUE) Then
				ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1000
				DispDMD1.Text = "[edge3][f2][xc][y5]BALL SAVER IN[y13][f6]" & BS & " OF 5 HITS"
				DispDMD2.Text = "[edge3][f2][xc][y5]BALL SAVER IN[y13][f6]" & BS & " OF 5 HITS"
			End If
		End If
	Else
		AddScore(1000)
		PlaySound "fx_Ricochet5"
	End If
	set LastSwitchHit = LeftInLaneTrigger
End Sub




Sub RightInLaneTrigger_Hit()
	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub
	If (LastSwitchHit.Name = "RightInLaneTrigger") Then PlaySound "fx_EmptyGun", 0.6: Exit Sub ' no double hits Dr Jones...

	If (ModeName = "RScene4") Then RaiderShit(): Exit Sub

	If (LightMystery.State = BulbOn) Then
		LightMystery.State = BulbOff
		BulbMystery.FlashForMs 250, 125, BulbOn
		If (bMultiballMode = FALSE) Then
			If (QuoteBusy = FALSE) Then
				EffectMusic 1, SetVolume, 0, 0: ResumeVol.Set TRUE, 1200
				QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1800: PlayMusic 2, "vo_WhoAreYou"
			Else
				PlaySound "fx_12"
			End If
			If (MovieTimer.Enabled = FALSE) Then NoS(): OverlayLCD.Frame 49: LCD.Frame 49: MovieTimer.Set TRUE, 1200
			LightSeqPF.Play SeqBlinking, , 2,50
		End If
	Exit Sub 
	End If

	'If (ModeName = "") Then ' no mystery during any active mode...
		MQ = MQ - 1
		If (MQ =< 0) Then
			LightMystery.State = BulbOn
			AddScore(5000)
			If (ScoreUpdate = TRUE) Then
				FlushDMDTimer.Set TRUE, 1000
				DispDMD1.QueueText "[edge3][box3,1,1,126,30][f5][y2]MYSTERY[f6][y14]IS LIT", deNone, 50, FALSE
				DispDMD2.QueueText "[edge3][box3,1,1,126,30][f5][y2]MYSTERY[f6][y14]IS LIT", deNone, 50, FALSE
				DispDMD1.QueueText "[edge3][f5][y2]MYSTERY[f6][y14]IS LIT", deNone, 50, FALSE
				DispDMD2.QueueText "[edge3][f5][y2]MYSTERY[f6][y14]IS LIT", deNone, 50, FALSE
			End If
			PlaySound "fx_GunTriple"
			Flash = 2: FlashPFTimer.Set TRUE, 100
			MQ = 3
		Else
			AddScore(1000)
			PlaySound "fx_MachineGun"
			Flash = 0: FlashPFTimer.Set TRUE, 70
			LightMystery.FlashForMs 500, 100, BulbOff
			If (ScoreUpdate = TRUE) Then
				ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1000
				DispDMD1.Text = "[edge3][f2][xc][y4]MYSTERY LIT IN[y14][f6]" & MQ & " OF 5 HITS"
				DispDMD2.Text = "[edge3][f2][xc][y4]MYSTERY LIT IN[y14][f6]" & MQ & " OF 5 HITS"
			End If
		End If
	'Else
	'	AddScore(1000)
	'	PlaySound "fx_Ricochet5"
	'End If
	set LastSwitchHit = RightInLaneTrigger
End Sub


' Lane flash if needed...

Sub LeftLaneFlash()
	Bulb2.FlashForMs 500, 70, BulbOn
	Bulb3.FlashForMs 500, 70, BulbOn
	Bulb44.FlashForMs 500, 70, BulbOn
	Bulb45.FlashForMs 500, 70, BulbOn
	GIFlash1.FlashForMs 500, 70, BulbOn
End Sub


Sub RightLaneFlash()
	Bulb20.FlashForMs 500, 70, BulbOn
	Bulb21.FlashForMs 500, 70, BulbOn
	Bulb46.FlashForMs 500, 70, BulbOn
	Bulb47.FlashForMs 500, 70, BulbOn
	GIFlash2.FlashForMs 500, 70, BulbOn
End Sub



Sub LeftOutLaneTrigger_Hit()
	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub
	If (LastSwitchHit.Name = "LeftOutLaneTrigger") Then Exit Sub

	If ModeName = "RScene4" Then RaidersHit(): Exit Sub

	AddScore(10000)

	If (LightSpecialL.State = BulbOn) Then GetSpecial(): Exit Sub

	' save the ball and some time before the ball reaches the drain...
	If (bBallSaverActive = TRUE) and (bMultiballMode = FALSE) Then
		PlungerKicker.CreateBall: AddTrackedBall(PlungerKicker)
		PlungerKicker.SolenoidPulse
		IgnoreMe = TRUE
      PlungerTimer.Set TRUE, 1000 ' auto fire the ball into play...
		If (QuoteBusy = FALSE) and (ResumeVol.Enabled = FALSE) Then
			QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2000
			Select Case RandomNumber(3)
				Case 1: PlayMusic 2, "vo_AnythingHappen": MusicFade(2000)
				Case 2: PlayMusic 2, "vo_AnythingHappen2": MusicFade(2000)
				Case 3: PlayMusic 2, "vo_Jnr": MusicFade(1000)
			End Select
		End If
		If (ScoreUpdate = TRUE) Then
			FlushDMDTimer.Set TRUE, 2000
			DispDMD1.Text = "[edge3][box2,20,6,108,25][f6][xc][yc][bf]BALL SAVED"
			DispDMD2.Text = "[edge3][box2,20,6,108,25][f6][xc][yc][bf]BALL SAVED"
		End If
		BallSaved = TRUE
	Exit Sub
	End If

	If (ModeName = "SScene2") Then Exit Sub ' Nuke Town scene - drain will set of nuke...

	If (bMultiballMode = FALSE) Then
		LOut = TRUE
		PlasDarkOn(): LightSeqPF.Play SeqDownOn, 20, 1
		If (ModeName = "CScene3") Then
			Select Case RandomNumber(2)
				Case 1: PlayMusic 2, "vo_GettingAway"
				Case 2: PlayMusic 2, "vo_Jnr4"
			End Select
		End If
		If (ModeName = "") and (JonesScoring = FALSE) and (IndyScoring = FALSE) and (IJScoring = FALSE) Then
			If (QuoteBusy = FALSE) Then
				QuoteBusy = TRUE: EffectMusic 1, FadeOutAndStop, 0, 500

				If (BallsRemaining(CP) = 1) Then
					PlayMusic 2, "vo_WhooshGone"
				Else
					Select Case RandomNumber(10)
						Case 1: PlayMusic 2, "vo_VeryFunny"
						Case 2: PlayMusic 2, "vo_Laugh"
						Case 3: PlayMusic 2, "vo_DoingHere"
						Case 4: PlayMusic 2, "vo_BreaksHeart"
						Case 5: PlayMusic 2, "vo_Stupid"
						Case 6: PlayMusic 2, "vo_Jesus"
						Case 7: PlayMusic 2, "vo_Kidding"
						Case 8: PlayMusic 2, "vo_OnceAgain"
						Case 9: PlayMusic 2, "vo_Whoops"
						Case 10: PlayMusic 2, "vo_AreYouKidding"
					End Select
				End If
			End If
		End If
		StopMusic 1: PlayMusic 6, "Music_Cue4", FALSE, 0.8
	End If
	set LastSwitchHit = LeftOutLaneTrigger
End Sub


Sub RightOutLaneTrigger_Hit()
	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub
	If (LastSwitchHit.Name = "RightOutLaneTrigger") Then Exit Sub

	If (ModeName = "RScene4") Then RaidersHit():	Exit Sub

	AddScore(10000)

	If (LightSpecialR.State = BulbOn) Then GetSpecial(): Exit Sub

	' when the BALL SAVER is active, the ball will be diverted back to the plunger lane...
	' doesn't always work so the ball may continue it's journey to the drain of death...them's the breaks kid...
	If (bBallSaverActive = TRUE) and (bMultiballMode = FALSE) Then
		PopUpSave.SolenoidPulse(1000): PlaySound "fx_Punch7"
		If (ScoreUpdate = TRUE) Then
			FlushDMDTimer.Set TRUE, 2000
			DispDMD1.Text = "[edge3][box2,20,6,108,25][f6][xc][yc][bf]BALL SAVED"
			DispDMD2.Text = "[edge3][box2,20,6,108,25][f6][xc][yc][bf]BALL SAVED"
		End If
		BallSaved = TRUE
	Exit Sub
	End If

	If (ModeName = "SScene2") Then Exit Sub ' Nuke Town scene - drain will set of nuke...

	' the ball drains, so play a fun quote...
	If (bMultiballMode = FALSE) Then
		ROut = TRUE
		PlasDarkOn(): LightSeqPF.Play SeqDownOn, 20, 1
		If (ModeName = "CScene3") Then
			Select Case RandomNumber(2)
				Case 1: PlayMusic 2, "vo_GettingAway"
				Case 2: PlayMusic 2, "vo_Jnr4"
			End Select
		End If
		If (ModeName = "") and (JonesScoring = FALSE) and (IndyScoring = FALSE) and (IJScoring = FALSE) Then
			If (QuoteBusy = FALSE) Then
				QuoteBusy = TRUE: EffectMusic 1, FadeOutAndStop, 0, 500
				If (BallsRemaining(CP) = 1) Then
					PlayMusic 2, "vo_Laughing" ' last ball, let's all laugh at the player....ha ha ha ha ha...
				Else
					Select Case RandomNumber(10)
						Case 1: PlayMusic 2, "vo_Going"
						Case 2: PlayMusic 2, "vo_WhereYouGoing"
						Case 3: PlayMusic 2, "vo_Bastards"
						Case 4: PlayMusic 2, "vo_OMG2", FALSE, 0.6
						Case 5: PlayMusic 2, "vo_OnceAgain"
						Case 6: PlayMusic 2, "vo_IndyLaugh"
						Case 7: PlayMusic 2, "vo_Whoops"
						Case 8: PlayMusic 2, "vo_Intollerable"
						Case 9: PlayMusic 2, "vo_Rubbish"
						Case 10: PlayMusic 2, "vo_EmbarassingUs"
					End Select
				End If
			End If
		End If
		StopMusic 1: PlayMusic 6, "Music_Cue4", FALSE, 0.8
	End If
	set LastSwitchHit = RightOutLaneTrigger
End Sub



' the ball was diverted to the PLUNGER LANE because the BALL SAVER was active...

Sub Cheat_Hit()
	If (QuoteBusy = FALSE) and (ModeName = "") Then
		QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2000
		MusicFade(1500)
		Select Case RandomNumber(3)
			Case 1: PlayMusic 2, "vo_YouCheat"
			Case 2: PlayMusic 2, "vo_CheatBig"
			Case 3: PlayMusic 2, "vo_IndyLaugh"
		End Select
	End If
	ROut = FALSE
	If (ScoreUpdate = TRUE) Then
		ScoreUpdate = TRUE: FlushDMDTimer.Set TRUE, 1500
		DispDMD1.QueueText "[edge3][box2,20,6,108,25][f6][f6][xc][yc][bf]RETURN FIRE", deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][box2,20,6,108,25][f6][f6][xc][yc][bf]RETURN FIRE", deNone, 1000, TRUE
	End If
	'PlungerTimer.Set TRUE, 1000 ' auto fire the ball or let the player do it? 
End Sub



' Only used when the ARK TARGETS are hit for the first time in the game to set off the ARK MAGNET...

Sub OpenArk()
	If (lid.angleyz = 0) Then ' it's closed so we open it...
		PlasDarkOn()
		PlayMusic 2, "Music_Ark", TRUE, 0.8
		lid.rotateyz 5,10
		PlaySound "fx_IdolMove"
		BulbArk1.Set BulbBlink, "11011000101101", 70
		BulbArk2.Set BulbBlink, "11011000101101", 70
		BulbArk3.Set BulbBlink, "11011000101101", 70
		SpotBulbLS.Set BulbBlink, "11011000101101", 70
		FlasherAmb1.Set BulbBlink, "11011000101101", 70
		SpotBulbRS.Set BulbBlink, "11011000101101", 70
		FlasherAmb2.Set BulbBlink, "11011000101101", 70
	End If
	If (lid.angleyz = 10) Then ' it's open so we close it...
		PlasDarkOff()
		LightSeqPF.Play SeqBlinking, , 1, 500
		StopMusic 2: RestartMusic.Set TRUE, 1000
		lid.rotateyz -150,0
		PlaySound "fx_LidClose"
		PlaySound "fx_Lightning"
		BulbArk1.State = BulbOff
		BulbArk2.State = BulbOff
		BulbArk3.State = BulbOff
		SpotBulbLS.State = BulbOff
		FlasherAmb1.State = BulbOff
		SpotBulbRS.State = BulbOff
		FlasherAmb2.State = BulbOff
	End If
End Sub


' Opens the Ark at the start of ARK MULTIBALL...

Sub OpenArk2()
	If (lid.angleyz = 0) Then ' it's closed so we open it...
		lid.rotateyz 5,10
		PlaySound "fx_IdolMove"
		BulbArk1.Set BulbBlink, "11011000101101", 70
		BulbArk2.Set BulbBlink, "11011000101101", 70
		BulbArk3.Set BulbBlink, "11011000101101", 70
	End If
	If (lid.angleyz = 10) Then ' open it a bit more to release the demons...
		lid.rotateyz 10,30
		PlaySound "fx_IdolMove"
		BulbArk1.State = BulbOff
		BulbArk2.State = BulbOff
		BulbArk3.State = BulbOff
	End If
	If (lid.angleyz = 30) Then ' it's open so we close it...
		lid.rotateyz -150,0
		PlaySound "fx_LidClose"
		PlaySound "fx_Lightning"
	End If
End Sub




' ************************************************
' **                                            **
' **                SKILL SHOT                  **
' **                                            **
' ************************************************

' You have 5 different 'SKILL SHOTS' but there's no skill involved. 
' Just launch when the one that tickles your fancy is lit.

' The options will start at a random position to avoid bored players
' just lauching the ball and always having the same one.


Sub SkillShotTrigger_Hit()

	' skip the Skill Shot if there is a mode already running...
	If (ModeName <>"") or (BonusBall = TRUE) Then Exit Sub

	If (NewBall = TRUE) Then
		NewBall = FALSE
		RestartMusic_Expired()
		SceneCheck()
		MovieTimer.Set TRUE, 10
	End If

	' a SPECIAL was collected from the OUTLANES and the ball returned to play...
	If (SpecialPlay = TRUE) Then
		SpecialPlay = FALSE
		ResumeTimers_Expired()
		PlasDarkOff()
	End If

	SkillTimer.Set FALSE
	AddScore(1020)

	If (bBallSaverActive = FALSE) Then
		bBallSaverActive = TRUE
		BallSaverTimer.Set TRUE, BSTime(CP)
		ShootAgainLight.State = BulbBlink
	End If

	'INDY or JONES scoring will start...	

	If (LightScoring.State = BulbOn) Then
		Select case RandomNumber(2)
			Case 1: StartIndy()
			Case 2: StartJones()
		End select
	End If

	' the Cairo Swordsman will pop out for a Hurry Up shot...

	If (LightSwordsmanSS.State = BulbOn) Then
		StartSword()
	End If

	' Mystery will be lit at the Grail Scoop...

	If (LightMysterySS.State = BulbOn) Then
		PlaySound "fx_Mystery"
		NoS(): OverlayLCD.Frame 49: LCD.Frame 49: MovieTimer.Set TRUE, 2000
		BulbMystery.State = BulbOn
		MQ = 3
	End If

	' the Bumpers will light for Super Pops...(each hit will increase the Movie Jackpots)...

	If (LightPops.State = BulbOn) Then
		SuperPops = TRUE
		PlaySound "fx_Elephant"		
		NoS(): OverlayLCD.Frame 48: LCD.Frame 48: MovieTimer.Set TRUE, 2000
		Bumper1.State = BulbBlink
		Bumper2.State = BulbBlink
		Bumper3.State = BulbBlink
		Bumper4.State = BulbBlink
		If (ModeName = "") Then RampDiverter.SolenoidOn ' not during a mode...
	End If

	' next scene will get the next scene lined up to start immediately (in order)...

	If (LightNextScene.State = BulbOn) Then
		ScoreUpdate = TRUE
		EffectMusic 1, SetVolume, 0, 0: ResumeVol.Set TRUE, 1800
		PlaySound "fx_MovieScene", 0.8
		NoS(): OverlayLCD.UpdateInterval = 150: LCD.UpdateInterval = 150
		OverlayLCD.Frame 29, 30, 29: LCD.Frame 29,30,29: MovieTimer.Set TRUE, 3000
		NextScene()
	End If

	LightScoring.State = BulbOff
	LightSwordsmanSS.State = BulbOff
	LightMysterySS.State = BulbOff
	LightPops.State = BulbOff
	LightNextScene.State = BulbOff
End Sub



Sub StartSkill()
	'CreateNewBall()
	LightSwordsmanSS.State = BulbOff
	LightMysterySS.State = BulbOff
	LightPops.State = BulbOff
	LightNextScene.State = BulbOff
	LightScoring.State = BulbOff
	DispDMD1.FlushQueue: DispDMD2.FlushQueue
	If (BallsRemaining(CP) = 1) Then ' it's the last ball, let the player know...
		If (PlayersPlayingGame > 1) Then
			DispDMD1.QueueText "[edge3][xc][y4][f3]LAST BALL[f6][y14][bf]MAKE IT COUNT", deNone, 1800, FALSE
			DispDMD2.QueueText "[edge3][xc][y4][f3]LAST BALL[f6][y14][bf]MAKE IT COUNT", deNone, 1800, FALSE
		Else
			DispDMD1.QueueText "[edge3][xc][y4][f3]LAST BALL[f6][y14][bf]COME ON INDY", deNone, 1800, FALSE
			DispDMD2.QueueText "[edge3][xc][y4][f3]LAST BALL[f6][y14][bf]COME ON INDY", deNone, 1800, FALSE
		End If
		SkillTimer.Set TRUE, 1200
		DispDMD1.QueueText "[edge3][f6][xc][y4]SKILL SHOT[f2][y21][b]PRESS PLUNGER", deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][y4]SKILL SHOT[f2][y21][b]PRESS PLUNGER", deNone, 1000, TRUE
	Else
		If (PlayersPlayingGame >1) Then ' not playing with yourself? Which is never a bad thing...
			Select Case CP
				Case 1: PName = "INDIANA": If (P1Play = 1) Then PlayMusic 2, "vo_AfterYou": MusicFade(1000): P1Play = 0: 'OverlayLCD.Frame : LCD.Frame
				Case 2: PName = "JONES SNR": If (P2Play = 1) Then PlayMusic 2, "vo_YesSir": MusicFade(700): P2Play = 0
				Case 3: PName = "MARCUS": If (P3Play = 1) Then PlayMusic 2, "vo_Marcus": MusicFade(2600): P3Play = 0
				Case 4: PName = "SALLAH": If (P4Play = 1) Then PlayMusic 2, "vo_SallahSong2": MusicFade(2700): P4Play = 0
			End Select
			DispDMD1.QueueText "[edge3][xc][y4][f3]" & PName & "[y14][f6][bf]GET READY", deNone, 1800, FALSE
			DispDMD2.QueueText "[edge3][xc][y4][f3]" & PName & "[y14][f6][bf]GET READY", deNone, 1800, FALSE
			SkillTimer.Set TRUE, 1200
		Else
			SkillTimer.Set TRUE, 100
		End If
		DispDMD1.QueueText "[edge3][f6][xc][y4]SKILL SHOT[f2][y21][b]PRESS PLUNGER", deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][y4]SKILL SHOT[f2][y21][b]PRESS PLUNGER", deNone, 1000, TRUE
	End If
	Select Case RandomNumber(5)
		Case 1: SSMove = 0
		Case 2: SSMove = 1
		Case 3: SSMove = 2
		Case 4: SSMove = 3
		Case 5: SSMove = 4
	End Select
End Sub


Dim SSMove


Sub SkillTimer_Expired()
	SkillTimer.Set TRUE, 600
	SSMove = SSMove + 1
	Select Case SSMove
		Case 1:
			NoS(): OverlayLCD.Frame 36: LCD.Frame 36
			LightScoring.State = BulbOff
			LightSwordsmanSS.State = BulbOn
		Case 2:
			NoS(): OverlayLCD.Frame 37: LCD.Frame 37
			LightSwordsmanSS.State = BulbOff
			LightMysterySS.State = BulbOn
		Case 3:
			NoS(): OverlayLCD.Frame 38: LCD.Frame 38
			LightMysterySS.State = BulbOff
			LightPops.State = BulbOn
		Case 4:
			NoS(): OverlayLCD.Frame 39: LCD.Frame 39
			LightPops.State = BulbOff
			LightNextScene.State = BulbOn
		Case 5:
			NoS(): OverlayLCD.Frame 35: LCD.Frame 35
			LightNextScene.State = BulbOff
			LightScoring.State = BulbOn
			SSMove = 0
	End Select
End Sub




' ************************************************
' **                                            **
' **           THE ARK OF THE COVENENT          **
' **                                            **
' ************************************************

' Starts each RAIDERS scene but only a direct hit will count. Any hits to the Ark
' targets first will activate the magnet and deflect the ball away.

' Scene 1: The Boulder Run
' Scene 2: Bar Shootout
' Scene 3: Truck Chase
' Scene 4: Ark Ceremony

' extra scenes (possible future update)

' Plane Fight
' Well Of Souls Escape


Sub TriggerArk_Hit() ' opto trigger...

	If (fpTilted = TRUE) Then Exit Sub
	If (LastSwitchHit.Name = "TriggerArk") Then Exit Sub

	If (BonusBall = TRUE) Then
		If (LightArk.State = BulbOff) Then Exit Sub
		BBTotal(CP) = BBTotal(CP) + BBVal(CP)
		ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1000
		DispDMD1.Text = "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(BBVal(CP))
		DispDMD2.Text = "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(BBVal(CP))
		ArkHit = ArkHit + 1
		Select Case ArkHit
			Case 1: LightRaidS1.State = BulbOn
			Case 2: LightRaidS2.State = BulbOn
			Case 3: LightRaidS3.State = BulbOn
			Case 4: LightRaidS4.State = BulbOn
			Case 5: LightRaidersMain.State = BulbOn: BBTotal(CP) = BBTotal(CP) + 350000: LightArk.State = BulbOff
				MusicFade(1000): PlayMusic 3, "Music_Cue14"
				Flash = 0: FlashPFTimer.Set TRUE, 75
				DispDMD1.Text = "[edge3][f4][y3][bf]MOVIE COMPLETE[y17]COMPLETE"
				DispDMD2.Text = "[edge3][f4][y3][bf]MOVIE COMPLETE[y17]COMPLETE"
		End Select
		SpotBulbLS.FlashForMs 600, 75, BulbOff
		FlasherAmb1.FlashForMs 600, 75, BulbOff
		SpotBulbRS.FlashForMs 600, 75, BulbOff
		FlasherAmb2.FlashForMs 600, 75, BulbOff
		PlaySound "fx_Lightning"
		ClearSeq()
		LightSeqPF.Play SeqAllOff:	PlasDarkOn(): ArkFlashTimer.Set TRUE, 800
	Exit Sub
	End If

	If (MagnetTimer.Enabled = TRUE) and (ArkOpen = FALSE) Then MagnetTimer_Expired(): Exit Sub

	If (StartRaiderScene.Enabled = TRUE) or (DartTimer.Enabled = TRUE) or (Magnet.Collidable = TRUE) Then Exit Sub ' don't double hit...

	ArkHit = ArkHit + 1

	' first shot to the Ark in a new game didn't hit any of the Ark targets, nice shooting Tex...
	If (GrabIdol(CP) = TRUE) and (NoHit(CP) = TRUE) and (ModeName = "") and (LightRaidersArk.State = BulbOff) Then
		NoHit(CP) = FALSE
		GrabIdol(CP) = FALSE
		ArkHitsRemain(CP) = ArkHitsRemain(CP) - 1
		PauseTimers()
		AddScore(1000000)
		' PlaySound "fx_Impact"
		FF_Sound DV_SH,100,"fx_Impact"
		
		PlaySound "fx_IdolTrap2"
		PauseTimers(): ResumeTimers.Set TRUE, 4300
		EffectMusic 1, SetVolume, 0, 100

		PlasDarkOn(): Flash = 0: FlashPFTimer.Set TRUE, 75
		LightSeqPF.Play SeqBlinking, , 3, 75

		Clip = 57: PlayClip()

		' turn the magnet on for the rebound and wait for the trap...

		PlaySound "fx_Hum"
		BulbMagnet.State = BulbOn
		ArkMagnet.MaxForce = 10
		ArkMagnet.Strength = 80
		Magnet.Collidable = TRUE
		CoolDownTimer.Set TRUE, 3300 ' use this timer to play the trap sequence...

		ScoreUpdate = FALSE
		DispDMD1.QueueText "[edge3][f4][y3]BONUS SHOT[y17][bf]1,000,000", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f4][y3]BONUS SHOT[y17][bf]1,000,000", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f4][y3]BONUS SHOT[y17]1,000,000", deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f4][y3]BONUS SHOT[y17]1,000,000", deNone, 1000, TRUE
		IdolBonus = TRUE
		Select Case RandomNumber(2)
			Case 1: Trap = TRUE
			Case 2: Trap = FALSE
		End Select
	Exit Sub
	End If

	If (LightArk.State = BulbBlink) Then

		If (ModeName = "RScene1") Then BoulderEscape():	Exit Sub ' Indy escapes, start chase to plane...

		' eliminate the last guard...
		If (ModeName = "RScene3") Then
			EndMode()
		Exit Sub
		End If

		' raiders JACKPOT for scene 4 only...get 2 JACKPOTS to light SUPER JACKPOT (and collect movie item Perk when multiball ends)...
		If (ModeName = "RScene4") Then
			NoPlay = TRUE: ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1000
			DispDMD1.FlushQueue: DispDMD2.FlushQueue
			Select Case JPHit
				Case 0: ' 1 x JACKPOT value
					DispDMD1.QueueText "[edge3][box3,1,1,126,30][f4][xc][y3]JACKPOT[xc][y16]" & FormatScore(RaidersJP(CP)*xMarks), deNone, 75, FALSE
					DispDMD2.QueueText "[edge3][box3,1,1,126,30][f4][xc][y3]JACKPOT[xc][y16]" & FormatScore(RaidersJP(CP)*xMarks), deNone, 75, FALSE
					DispDMD1.QueueText "[edge3][f4][xc][y3]JACKPOT[xc][y16]" & FormatScore(RaidersJP(CP)*xMarks), deNone, 75, FALSE
					DispDMD2.QueueText "[edge3][f4][xc][y3]JACKPOT[xc][y16]" & FormatScore(RaidersJP(CP)*xMarks), deNone, 75, FALSE
					AddScore(RaidersJP(CP))
					ArkTotal = ArkTotal + (RaidersJP(CP)*xMarks)
				Case 1: ' 2 x JACKPOT value
					SuperJPVal = (RaidersJP(CP)*2)
					DispDMD1.QueueText "[edge3][box3,1,1,126,30][f4][xc][y3]SUPER JACKPOT[xc][y16]" & FormatScore(SuperJPVal*xMarks), deNone, 75, FALSE
					DispDMD2.QueueText "[edge3][box3,1,1,126,30][f4][xc][y3]SUPER JACKPOT[xc][y16]" & FormatScore(SuperJPVal*xMarks), deNone, 75, FALSE
					DispDMD1.QueueText "[edge3][f4][xc][y3]SUPER JACKPOT[xc][y16]" & FormatScore(SuperJPVal*xMarks), deNone, 75, FALSE
					DispDMD2.QueueText "[edge3][f4][xc][y3]SUPER JACKPOT[xc][y16]" & FormatScore(SuperJPVal*xMarks), deNone, 75, FALSE
					AddScore(SuperJPVal)
					ArkTotal = ArkTotal + (SuperJPVal*xMarks)
				Case 2: ' 4 x JACKPOT value
					SuperJPVal = (RaidersJP(CP)*4)
					DispDMD1.QueueText "[edge3][box3,1,1,126,30][f4][xc][y3]DOUBLE SUPER[xc][y16]JACKPOT", deNone, 75, FALSE
					DispDMD2.QueueText "[edge3][box3,1,1,126,30][f4][xc][y3]DOUBLE SUPER[xc][y16]JACKPOT", deNone, 75, FALSE
					DispDMD1.QueueText "[edge3][f4][xc][y3]DOUBLE SUPER[xc][y16]JACKPOT", deNone, 75, FALSE
					DispDMD2.QueueText "[edge3][f4][xc][y3]DOUBLE SUPER[xc][y16]JACKPOT", deNone, 75, FALSE
					AddScore(SuperJPVal)
					ArkTotal = ArkTotal + (SuperJPVal*xMarks)
				Case 3: ' 6 x JACKPOT value
					SuperJPVal = (RaidersJP(CP)*6)
					DispDMD1.QueueText "[edge3][box3,1,1,126,30][f4][xc][y3]TRIPLE SUPER[xc][y16]JACKPOT", deNone, 75, FALSE
					DispDMD2.QueueText "[edge3][box3,1,1,126,30][f4][xc][y3]TRIPLE SUPER[xc][y16]JACKPOT", deNone, 75, FALSE
					DispDMD1.QueueText "[edge3][f4][xc][y3]TRIPLE SUPER[xc][y16]JACKPOT", deNone, 75, FALSE
					DispDMD2.QueueText "[edge3][f4][xc][y3]TRIPLE SUPER[xc][y16]JACKPOT", deNone, 75, FALSE
					AddScore(SuperJPVal)
					ArkTotal = ArkTotal + (SuperJPVal*xMarks)
					JPHit = 0 ' ok, that's enough, reset...
			End Select

			ClearSeq()
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1000
			SpotBulbLS.FlashForMs 1000, 75, BulbOff
			FlasherAmb1.FlashForMs 1000, 75, BulbOff
			SpotBulbRS.FlashForMs 1000, 75, BulbOff
			FlasherAmb2.FlashForMs 1000, 75, BulbOff
			PlaySound "fx_Lightning"

			' the JACKPOT animation...
			NoS(): LCD.UpdateInterval = 100: OverlayLCD.UpdateInterval = 100
			OverlayLCD.Frame 68,72: LCD.Frame 68,72: MovieTimer.Set TRUE, 1000

			rJackpotHitsLeft = 50 ' reduce the number to 50 (because by now, the player doesn't have 6 balls anymore)

			LightArk.State = BulbOff ' turn off the jackpot, now hit more switches to relight it...ya bastard...
			JPHit = JPHit + 1
		Exit Sub
		End If
	
		If (ModeName = "TScene1") Then
			GetAntidote()
			'BulbArkL.FlashForMs 200, 75, BulbOff
			'BulbArkR.FlashForMs 200, 75, BulbOff
			'FlasherRed.FlashForMs 200, 75, BulbOff
			'LightSeqPF.Play SeqBlinking, , 2, 75
			ArkHitFlash()
		Exit Sub
		End If

		' grab the raft...
		If (ModeName = "TScene2") Then
			' PlaySound "fx_Impact"
			FF_Sound DV_SH,100,"fx_Impact"

			ModeHit = ModeHit + 1: TempleSceneHit()
			ArkHitFlash()
		Exit Sub
		End If

		If (ModeName = "CScene1") Then
			LightArk.State = BulbOff
			' PlaySound "fx_Impact"
			FF_Sound DV_SH,100,"fx_Impact"

			MusicFade(1000): PlayMusic 3, "Music_Cue11"
			NoS(): OverlayLCD.UpdateInterval = 150
			OverlayLCD.Frame 89, 90, 89: LCD.Frame 89,90,89: MovieTimer.Set TRUE, 2000
			HurryTime = HurryTime + 10 ' add more time... 
			DispDMD1.FlushQueue: DispDMD2.FlushQueue
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 3000
			DispDMD1.QueueText "[edge3][f4][xc][y2]GOT THE CROSS[f6][y15][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
			DispDMD2.QueueText "[edge3][f4][xc][y2]GOT THE CROSS[f6][y15][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
			DispDMD1.QueueText "[edge3][f4][y3][bf]SHOOT ANY LOOP[y17]TO CATCH TRAIN", deNone, 1000, TRUE
			DispDMD2.QueueText "[edge3][f4][y3][bf]SHOOT ANY LOOP[y17]TO CATCH TRAIN", deNone, 1000, TRUE
			SceneHit()
			' you got the cross, now get to the train (ramp shot)...
			LightOrbitL.State = BulbBlink
			LightOrbitR.State = BulbBlink
			'BulbArkL.FlashForMs 200, 75, BulbOff
			'BulbArkR.FlashForMs 200, 75, BulbOff
			'FlasherRed.FlashForMs 200, 75, BulbOff
			'PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 200
			'LightSeqPF.Play SeqBlinking, , 2, 75
			ArkHitFlash()
		Exit Sub
		End If

		' the rope bridge falls...ball is held for clip, then released. Now shoot the temple to finish...
		If (ModeName = "TScene4") Then
			LightArk.State = BulbOff
			PlasDarkOn()
			LightSeqPF.Play SeqBlinking, , 1, 500
			
			' activate the magnet...
			SpotArk.FlashForMs 800, 75, BulbOff
			FlasherArkSpot.FlashForMs 800, 75, BulbOff

			BulbMagnet.State = BulbOn
			PlaySound "fx_Hum"
			ArkMagnet.MaxForce = 10
			ArkMagnet.Strength = 90
			'Pulse = 2: MagnetTimer.Set TRUE, 1000
			Magnet.Collidable = TRUE
			DartTimer.Set TRUE, 4500
			
			Clip = 47: PlayClip()
			DispDMD1.FlushQueue: DispDMD2.FlushQueue
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 6000
			DispDMD1.QueueText "[edge3][f4][xc][y2]BRIDGE CUT[f6][y15][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, FALSE
			DispDMD2.QueueText "[edge3][f4][xc][y2]BRIDGE CUT[f6][y15][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, FALSE
			DispDMD1.QueueText "[edge3][f4][xc][y2]BRIDGE CUT[f6][y15]"&FormatScore(SceneVal*xMarks), deNone, 3000, FALSE
			DispDMD2.QueueText "[edge3][f4][xc][y2]BRIDGE CUT[f6][y15]"&FormatScore(SceneVal*xMarks), deNone, 3000, FALSE
			DispDMD1.QueueText "[edge3][f4][xc][y2]GRAB THE STONE[f6][y15][bf]SHOOT TEMPLE", deNone, 1000, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y2]GRAB THE STONE[f6][y15][bf]SHOOT TEMPLE", deNone, 1000, TRUE
			SceneHit()
			PlayMusic 3, "Music_Cue3"
			StopMusic 1: RestartMusic.Set TRUE, 5000
			HurryTime = 22: ModeTimer.Set TRUE, 5700
		Exit Sub
		End If

		' dogfight CRUSADE SCENE 2...
		If (ModeName = "CScene2") Then
			'LightArk.State = BulbOff
			PlaySound "fx_PlaneShoot3"
			If (MovieTimer.Enabled = FALSE) Then
				NoS()
				OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100
				LCD.Frame 591,592,591: OverlayLCD.Frame 591,592,591: MovieTimer.Set TRUE, 1000
			End If
			DogFightHit()
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1000
			BulbArkL.FlashForMs 1000, 75, BulbOff
			BulbArkR.FlashForMs 1000, 75, BulbOff
			FlasherRed.FlashForMs 1000, 75, BulbOff
			LightSeqPF.Play SeqBlinking, , 7, 75
		Exit Sub
		End If

		' tank CRUSADE shot...
		If (ModeName = "CScene3") Then
			TankHit()
		Exit Sub
		End If

		' mind control SKULL SCENE 3...
		If (ModeName = "SScene3") Then
			LightArk.State = BulbOff
			SkullPowerHit()
		Exit Sub
		End If

		If (ModeName = "SScene4") Then
			LightArk.State = BulbOff
			ModeHit = ModeHit + 1
			If (ModeHit = 4) Then EndMode(): Exit Sub
			ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
			DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			SceneHit()
			MusicFade(1000): PlayMusic 3, "Music_Cue3"
			LightSeqPF.Play SeqBlinking, , 3, 75
			Flash = 0: FlashPFTimer.Set TRUE, 75
		Exit Sub
		End If

	End If


	If (ModeName = "RScene1") Then
		PlaySound "fx_4"
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 200
	Exit Sub
	End If

	If (ModeName = "RScene2") Then
		ModeHit = ModeHit + 1
		
		Nazi = Nazi + 1

		Select Case RandomNumber(4)
			Case 1: PlaySound "fx_MachineGun1", 0.8
			Case 2: PlaySound "fx_MachineGun2", 0.8
			Case 3: PlaySound "fx_Ricochet", 0.8
			Case 4: PlaySound "fx_Ricochet10", 0.8
		End Select

		BulbArkL.FlashForMs 400, 75, BulbOff
		BulbArkR.FlashForMs 400, 75, BulbOff
		FlasherRed.FlashForMs 400, 75, BulbOff
		LightSeqPF.Play SeqBlinking, , 4, 75

		' turns off plas and GI for duration of flash...
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 400

		Select Case ModeHit
			Case 5:
				If (QuoteBusy = FALSE) Then
					QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3000
					MusicFade(2500): PlayMusic 2, "vo_TellMeNow", FALSE, 1, 800
				End If
			Case 3:
				If (QuoteBusy = FALSE) Then
					QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3000
					MusicFade(2200): PlayMusic 2, "vo_BargainedFor", FALSE, 1, 1000
				End If
		End Select
	Exit Sub
	End If

	If (ModeName = "TScene3") and (LightOrbitR.State = BulbOff) Then
		MineKill()
		BulbArkL.FlashForMs 150, 75, BulbOff
		BulbArkR.FlashForMs 150, 75, BulbOff
		FlasherRed.FlashForMs 150, 75, BulbOff
		LightSeqPF.Play SeqBlinking, , 4, 75
		' turns off plas and GI for duration of flash...
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 150
	Exit Sub
	End If

	If (ModeName = "CScene4") Then
		If (LightArk.State = BulbBlink) Then
			LightArkExt.SetLitColor 255, 0, 0
			LightArk.State = BulbOn
			CheckChooseLights()
			PlaySound "fx_4"
		Else
			ChooseEnd()
		End If
	Exit Sub
	End If

	If (ModeName ="rfinal") Then RFinalJackpot(): Exit Sub

	' hit the Ark directly during any Raiders Multiball to collect the current Jackpot value...

	If (ModeName = "RScene4") Then RaidersHit(): Exit Sub

	If (ModeName <>"") Then ' If Cairo Swordsman is running, starting any mode will immediately stop it...
		PlaySound "fx_4"
		AdvMovieJP()
	Exit Sub
	End If

	' hitting the ark out of mode will advance towards the next RAIDERS scene...

	ArkHitsRemain(CP) = ArkHitsRemain(CP) - 1
	AddScore(10000)

	If (ArkHitsRemain(CP) = 0) Then
		PlaySound "fx_Lightning4"
	Else
		PlaySound "fx_Lightning"
	End If

	ArkHitFlash()

	If (MovieTimer.Enabled = FALSE) Then
		OverlayLCD.UpdateInterval = 150
		If (ArkHitsRemain(CP) = 7) Then
			NoS(): OverlayLCD.Frame 55: LCD.Frame 55: MovieTimer.Set TRUE, 1500
		End If
		If (ArkHitsRemain(CP) = 6) Then
			NoS(): OverlayLCD.Frame 55,56,55: LCD.Frame 55,56,55: MovieTimer.Set TRUE, 1500
		End If
		If (ArkHitsRemain(CP) = 5) Then
			NoS(): OverlayLCD.Frame 56,57,56: LCD.Frame 55,56,55: MovieTimer.Set TRUE, 1500
		End If
		If (ArkHitsRemain(CP) = 4) Then
			NoS(): OverlayLCD.Frame 57,58,57: LCD.Frame 57,58,57: MovieTimer.Set TRUE, 1500
		End If
		If (ArkHitsRemain(CP) = 3) Then
			NoS(): OverlayLCD.Frame 58,59,58: LCD.Frame 58,59,58: MovieTimer.Set TRUE, 1500
		End If
		If (ArkHitsRemain(CP) = 2) Then
			NoS(): OverlayLCD.Frame 59,60,59: LCD.Frame 59,60,59: MovieTimer.Set TRUE, 1500
		End If
		If (ArkHitsRemain(CP) = 1) Then
			NoS(): OverlayLCD.Frame 180,181,180: LCD.Frame 180,181,180: MovieTimer.Set TRUE, 2000
		End If
	End If

	If (ArkHitsRemain(CP) = 3) Then
		' scene 4 3rd to last hit...
		If (LightRaidS4.State = BulbBlink) Then
			If (QuoteBusy = FALSE) Then
				QuoteBusy = TRUE
				PlaySound "fx_Hum"
				BulbMagnet.State = BulbOn
				ArkMagnet.MaxForce = 10
				ArkMagnet.Strength = 80
				Magnet.Collidable = TRUE
				CoolDownTimer.Set TRUE, 3400
				PlayMusic 2, "vo_InsideArk", FALSE, 1, 800: MusicFade(3800)
			End If
		End If
	Exit Sub
	End If

	If (ArkHitsRemain(CP) = 2) Then
		' scene 4 3rd to last hit...
		If (LightRaidS4.State = BulbBlink) Then
			If (QuoteBusy = FALSE) Then
				QuoteBusy = TRUE
				PlaySound "fx_Hum"
				BulbMagnet.State = BulbOn
				ArkMagnet.MaxForce = 10
				ArkMagnet.Strength = 80
				Magnet.Collidable = TRUE
				CoolDownTimer.Set TRUE, 2000
				PlayMusic 2, "vo_SeeItOpen", FALSE, 1, 800: MusicFade(2400)
			End If
		End If
	Exit Sub
	End If

	If (ArkHitsRemain(CP) = 1) Then

		LightRaidersArk.State = BulbBlink

		' scene 1 is now ready to start...
		If (LightRaidS1.State = BulbBlink) Then
			If (QuoteBusy = FALSE) Then
				QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2500
				EffectMusic 1, SetVolume, 0, 0: ResumeVol.Set TRUE, 1000
				PlayMusic 2, "vo_NothingToFear", FALSE, 1, 1000
			End If
		Exit Sub
		End If

		' scene 2 is now ready to start...
		If (LightRaidS2.State = BulbBlink) Then
			If (QuoteBusy = FALSE) Then
				QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3000
				EffectMusic 1, SetVolume, 0, 0: ResumeVol.Set TRUE, 2000
				Select Case RandomNumber(3)
					Case 1: PlayMusic 2, "vo_NotThirsty2", FALSE, 1, 800
					Case 2: PlayMusic 2, "vo_Pieces3", FALSE, 0.8, 800
					Case 3: PlayMusic 2, "vo_TalkAbout2", FALSE, 0.8, 800
				End Select
			End If
		Exit Sub
		End If

		' scene 3 is now ready to start...
		If (LightRaidS3.State = BulbBlink) Then
			If (QuoteBusy = FALSE) Then
				QuoteBusy = TRUE: QuoteTimer.Set TRUE, 5200
				EffectMusic 1, SetVolume, 0, 0: ResumeVol.Set TRUE, 4200
				PlayMusic 2, "vo_WhatTruck", FALSE, 1, 800
			End If
			'DartTimer.Set TRUE, 1500
			'Magnet.Collidable = TRUE
			'PlaySound "fx_Dart"
		Exit Sub
		End If

		' scene 4 is now ready to start...
		If (LightRaidS4.State = BulbBlink) Then
			If (QuoteBusy = FALSE) Then
				QuoteBusy = TRUE
				PlaySound "fx_Hum"
				BulbMagnet.State = BulbOn
				ArkMagnet.MaxForce = 10
				ArkMagnet.Strength = 80
				Magnet.Collidable = TRUE
				CoolDownTimer.Set TRUE, 5400
				PlayMusic 2, "vo_History", FALSE, 1, 800: MusicFade(5800)
			End If
		End If
	Exit Sub
	End If

	' start the next RAIDERS scene...

	If (ArkHitsRemain(CP) =< 0) Then
		ArkHitsRemain(CP) = 8
		StopMusic 4
		SlingStop = TRUE
		StopHurryUps(): StopFastScoring()
		If (CairoSwordsman = TRUE) Then StopSwordsman()
		LightRaidersArk.State = BulbOff
		LightLastCrusade.State = BulbOff
		LightTempleOfDoom.State = BulbOff
		LightCrystalSkull.State = BulbOff
		LightCrusade.State = BulbOff
		'BulbMystery.State = BulbOff
		RestartMusic.Enabled = FALSE
		RampSkullOff()
		CoolDownTimer.Enabled = FALSE
		MagnetTimer.Enabled = FALSE
		MagnetActive = FALSE
		ArkFlashTimer.Enabled = FALSE

		SceneTotal = 200000: SceneVal = 210000 ' start value for the first shot...
		AddScore(200000)

		ScoreUpdate = TRUE: FlushDMDTimer.Enabled = FALSE

		If (FreeShot(CP) =>1) Then BulbFS.State = BulbBlink: LightFS.State = BulbBlink

		If (LightRaidS1.State = BulbBlink) Then StartROTLA1(): Exit Sub
		If (LightRaidS2.State = BulbBlink) Then StartROTLA2(): Exit Sub
		If (LightRaidS3.State = BulbBlink) Then StartROTLA3(): Exit Sub
		If (LightRaidS4.State = BulbBlink) Then StartROTLA4(): Exit Sub
	End If
	set LastSwitchHit = TriggerArk
End Sub



Sub ArkHitFlash()
	ClearSeq()
	LightSeqPF.Play SeqAllOff
	SpotBulbLS.FlashForMs 600, 75, BulbOff
	FlasherAmb1.FlashForMs 600, 75, BulbOff
	SpotBulbRS.FlashForMs 600, 75, BulbOff
	FlasherAmb2.FlashForMs 600, 75, BulbOff
	PlasDarkOn(): ArkFlashTimer.Set TRUE, 600 ' turn all the lights back on after the effect...
End Sub


Sub ArkWall_Hit()
	PlaySound "HitWallPlastic"
End Sub


Sub ArkFlashTimer_Expired()
	ArkFlashTimer.Enabled = FALSE
	LightSeqPF.StopPlay
	PlasDarkOff()
End Sub


Sub ClearSeq()
	LightSeqPF.StopPlay
	LightSeqGI.StopPlay
	LightSeqJP.StopPlay
End Sub





' ****************************************************
' **                                                **
' **                 THE ARK TARGET                 **
' **                                                **
' ****************************************************

' These targets act as a booby trap, activating a powerful magnet in front of the Ark, deflecting a hit.


' left side targets...

Sub TgtArk1_Hit()
	BoobyTrap()
	Bulb35.FlashForMs 200, 50, BulbOn: Bulb54.FlashForMs 200, 50, BulbOn
	Bulb34.FlashForMs 200, 50, BulbOn: Bulb55.FlashForMs 200, 50, BulbOn
End Sub


Sub TgtArk2_Hit()
	BoobyTrap()
	Bulb35.FlashForMs 200, 50, BulbOn: Bulb54.FlashForMs 200, 50, BulbOn
	Bulb34.FlashForMs 200, 50, BulbOn: Bulb55.FlashForMs 200, 50, BulbOn
End Sub


Sub TgtArk3_Hit()
	BoobyTrap()
	Bulb35.FlashForMs 200, 50, BulbOn: Bulb54.FlashForMs 200, 50, BulbOn
	Bulb34.FlashForMs 200, 50, BulbOn: Bulb55.FlashForMs 200, 50, BulbOn
End Sub


' right side targets...

Sub TgtArk4_Hit()
	BoobyTrap()
	Bulb36.FlashForMs 200, 50, BulbOn: Bulb57.FlashForMs 200, 50, BulbOn
	Bulb37.FlashForMs 200, 50, BulbOn: Bulb56.FlashForMs 200, 50, BulbOn
End Sub


Sub TgtArk5_Hit()
	BoobyTrap()
	Bulb36.FlashForMs 200, 50, BulbOn: Bulb57.FlashForMs 200, 50, BulbOn
	Bulb37.FlashForMs 200, 50, BulbOn: Bulb56.FlashForMs 200, 50, BulbOn
End Sub


Sub TgtArk6_Hit()
	BoobyTrap()
	Bulb36.FlashForMs 200, 50, BulbOn: Bulb57.FlashForMs 200, 50, BulbOn
	Bulb37.FlashForMs 200, 50, BulbOn: Bulb56.FlashForMs 200, 50, BulbOn
End Sub


Sub TgtArk7_Hit()
	BoobyTrap()
	Bulb36.FlashForMs 200, 50, BulbOn: Bulb57.FlashForMs 200, 50, BulbOn
	Bulb37.FlashForMs 200, 50, BulbOn: Bulb56.FlashForMs 200, 50, BulbOn
End Sub



Sub BoobyTrap()
	If (fpTilted = TRUE) Then Exit Sub
	If (ModeName = "RScene4") Then RaidersHit():	Exit Sub
	If (ModeName = "TScene1") and (FlashPFTimer.Enabled = FALSE) Then PlaySound "fx_MachineGun2": ArkFlash(1000): Exit Sub

	NoHit(CP) = FALSE

	' if the magnet is not already active, turn it on...
	If (MagnetTimer.Enabled = FALSE) and (ModeName = "") and (CoolDownTimer.Enabled = FALSE) Then
		ArkMagnet.MaxForce = 20
		ArkMagnet.Strength = 100
		MagnetActive = TRUE
		CoolDownTimer.Set TRUE, 2000
	End If
	'Select Case RandomNumber(7)
	'	Case 1: PlaySound "fx_Ricochet2" 
	'	Case 2: PlaySound "fx_Ricochet3"
	'	Case 3: PlaySound "fx_Ricochet4"
	'	Case 4: PlaySound "fx_Ricochet5"
	'	Case 5: PlaySound "fx_Ricochet6"
	'	Case 6: PlaySound "fx_Ricochet7"
	'	Case 7: PlaySound "fx_Ricochet10"
	'End Select

Select Case RandomNumber(7)
		Case 1: FF_Sound DV_BC,-1,"fx_Ricochet2"
		Case 2: FF_Sound DV_BC,-1,"fx_Ricochet3"
		Case 3: FF_Sound DV_BC,-1,"fx_Ricochet4"
		Case 4: FF_Sound DV_BC,-1,"fx_Ricochet5"
		Case 5: FF_Sound DV_BC,-1,"fx_Ricochet6"
		Case 6: FF_Sound DV_BC,-1,"fx_Ricochet7"
		Case 7: FF_Sound DV_BC,-1,"fx_Ricochet10"
	End Select

	AddScore(1000)
	set LastSwitchHit = TgtArk7
End Sub


Dim Wng
TrigHit = 0


MagnetActive = FALSE

Set ArkMagnet = xBAM.CreateMagneticField(ArkMagnetTrig.X, ArkMagnetTrig.Y,   -20,   60,       0)

' the ball will be effected by the magnet for only a very short pulse (600ms)


Sub ArkMagnetTrig_Hit()
	If (LastSwitchHit.Name = "ArkMagnetTrig") Then Exit Sub
	TrigHit = TrigHit + 1
	' only when the Ark Targets are hit will the magnet activate...
	If (MagnetActive = TRUE) Then
		MagnetActive = FALSE
		Select Case TrigHit
			Case 1: ' PlaySound "fx_ArkHit"
			Case 2: ' PlaySound "fx_ArkHit2"
			Case 3: ' PlaySound "fx_ArkHit3": TrigHit = 0
		End Select
		
		' PlaySound "fx_Electric", 0.3
		FF_Sound DV_SH,200,"fx_Electric"

		BulbMagnet.State = BulbOn
		PlaySound "fx_Hum", 0.7
		ArkMagnet.MaxForce = 10
		ArkMagnet.Strength = 90
		Pulse = 1
		If (QuoteBusy = FALSE) and (Wng = FALSE) and (CairoSwordsman = FALSE) Then
			Wng = TRUE
			Select Case RandomNumber(5)
				Case 1:
					Magnet.Collidable = TRUE
					MagnetTimer.Set TRUE, 2500: CoolDownTimer.Set TRUE, 4500
					QuoteBusy = TRUE: MusicFade(3400): PlayMusic 2, "vo_Medling", FALSE, 1, 500
				Case 2:
					Magnet.Collidable = TRUE
					MagnetTimer.Set TRUE, 3000: CoolDownTimer.Set TRUE, 5000
					QuoteBusy = TRUE: MusicFade(3200): PlayMusic 2, "vo_Warning", FALSE, 1, 500
				Case 3:
					Magnet.Collidable = TRUE
					MagnetTimer.Set TRUE, 4500: CoolDownTimer.Set TRUE, 6000
					QuoteBusy = TRUE: QuoteTimer.Set TRUE, 4500: PlayMusic 4, "vo_TheArk", FALSE, 1, 500
					EffectMusic 1, SetVolume, 0, 0: ResumeVol.Set TRUE, 4500
					OpenArk(): ArkOpen = TRUE
				Case 4:
					Magnet.Collidable = TRUE
					MagnetTimer.Set TRUE, 3000: CoolDownTimer.Set TRUE, 5000
					QuoteBusy = TRUE: MusicFade(3200): PlayMusic 2, "vo_Invincible", FALSE, 1, 500
				Case 5:
					Magnet.Collidable = TRUE
					MagnetTimer.Set TRUE, 3000: CoolDownTimer.Set TRUE, 4500
					QuoteBusy = TRUE: MusicFade(4500): PlayMusic 2, "vo_LevelMountains", FALSE, 1, 500
			End Select
			PlasDarkOn()
		Else
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 500
			MagnetTimer.Set TRUE, 500: CoolDownTimer.Set TRUE, 3000
		End If
	End If
	set LastSwitchHit = ArkMagnetTrig
End Sub


Sub MagnetTimer_Expired()
	Pulse = Pulse - 1
	Select Case Pulse
		Case 1:
			ArkMagnet.Strength = 45
		Case 0:
			If (ArkOpen = TRUE) Then ArkOpen = FALSE: OpenArk() ' closes Ark after Shoot Again...
			PlasDarkOff()
			TrigHit = 0
			MagnetTimer.Enabled = FALSE
			MagnetActive = FALSE
			ArkMagnet.Strength = 0
			Magnet.Collidable = FALSE
			BulbMagnet.State = BulbOff
	End Select
End Sub


Sub CoolDownTimer_Expired()
	CoolDownTimer.Enabled = FALSE
	MagnetTimer.Enabled = FALSE
	MagnetActive = FALSE
	ArkMagnet.MaxForce = 0
	ArkMagnet.Strength = 0
	Magnet.Collidable = FALSE
	BulbMagnet.State = BulbOff
	' you set off the trap, bonus lost....
	If (IdolBonus = TRUE) Then
		IdolBonus = FALSE
		ResumeTimers.Set TRUE, 1500
		If (Trap = TRUE) Then
			Trap = FALSE
			Clip = 9: PlayClip()
			ResumeVol.Set TRUE, 1800
			PlayMusic 3, "Music_IdolCue", FALSE, 0.8
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1000
			BulbArkL.FlashForMs 1000, 75, BulbOff
			BulbArkR.FlashForMs 1000, 75, BulbOff
			FlasherRed.FlashForMs 1000, 75, BulbOff
			FlushDMDTimer.Set TRUE, 1500
			DispDMD1.Text = "[edge3][f6][yc][xc][bf]BONUS LOST"
			DispDMD2.Text = "[edge3][f6][yc][xc][bf]BONUS LOST"
			nvScore(CP) = nvScore(CP) - 1000000 ' tough titty, you lost the OSOT bonus...
		Else
			FlushDMDTimer.Set TRUE, 2200
			DispDMD1.QueueText "[edge3][f6][yc][xc][bf]BONUS KEPT", deNone, 1000, FALSE
			DispDMD2.QueueText "[edge3][f6][yc][xc][bf]BONUS KEPT", deNone, 1000, FALSE
			DispDMD1.QueueText "[edge3][f6][yc][xc][bf]1 MILLION", deFlip, 1200, TRUE
			DispDMD2.QueueText "[edge3][f6][yc][xc][bf]1 MILLION", deFlip, 1200, TRUE
			NoS(): OverlayLCD.Frame 549,550,549: LCD.Frame 549,550,549: MovieTimer.Set TRUE, 1200
			PlayMusic 2, "vo_IndyLaugh"
			PlayMusic 3, "Music_Cue17"
			ResumeVol.Set TRUE, 1000
		End If
	End If
End Sub




' any scene hit scores the same increasing value just to keep it simple...

Sub SceneHit()
	SceneTotal = SceneTotal + (SceneVal*xMarks)
	AddScore(SceneVal)
	SceneVal = SceneVal + 125000 ' after each hit, increase the value by 125k for every scene...
	' only extended the timer during certain scenes, other's are timed exactly to match the music (for increased drama)...
	If (ModeName="RScene3") or (ModeName="CScene1") or (ModeName="CScene2") or (ModeName="CScene3") or (ModeName="TScene1") or (ModeName="TScene2") or (ModeName="SScene3") Then HurryTime = HurryTime + 5
End Sub


' at the end of each movie scene, check the state of the other scenes.
' the next hit to any flashing scene shot will start it...

Sub SceneCheck()
	If (ArkHitsRemain(CP) =< 1) Then LightRaidersArk.State = BulbBlink
	If (StoneHitsRemain(CP) =< 1) Then LightTempleOfDoom.State = BulbBlink: OpenChamber()
	If (GrailHitsRemain(CP) =< 1) Then LightLastCrusade.State = BulbBlink
	If (LROn(CP) = TRUE) Then TorchFlameL2.Frame 1, 40, 1: TorchFlameL2.FadeIn: BulbFlameL2.State = BulbBlink: PlaySound "fx_FlameOnR", 0.4
	If (RROn(CP) = TRUE) Then TorchFlameR2.Frame 1, 40, 1: TorchFlameR2.FadeIn: BulbFlameR2.State = BulbBlink: PlaySound "fx_FlameOnR", 0.4
	If (RROn(CP) = TRUE) and (LROn(CP) = TRUE) Then
		SkullBulb.FlashForMs 600, 150, BulbOn: PlaySound "fx_Skull2", 0.7
		If (SkullHitsRemain(CP) =<1) Then LightCrystalSkull.State = BulbBlink		
	End If
End Sub


' used only to delay the playing of a movie clip during certain scenes, and shoot again...

Sub PlayMovie_Expired()
	PlayMovie.Enabled = FALSE
	If (ModeName = "RScene2") Then Clip = 13: PlayClip(): Exit Sub
	If (ModeName = "RScene3") Then Clip = 14: PlayClip(): Exit Sub
	If (ModeName = "TScene1") Then Clip = 15: PlayClip(): Exit Sub
	If (ModeName = "TScene2") Then Clip = 24: PlayClip(): Exit Sub
	Clip = 39: PlayClip()
End Sub



' ************************************************
' **                                            **
' **              RAIDERS SCENES                **
' **                                            **
' ************************************************


Sub StartRaiderScene_Expired()
	StartRaiderScene.Enabled = FALSE
	If (LightRaidS1.State = BulbBlink) Then StartBOULDER(): Exit Sub
	If (LightRaidS2.State = BulbBlink) Then StartBAR(): Exit Sub
	If (LightRaidS3.State = BulbBlink) Then StartTRUCK(): Exit Sub
	If (LightRaidS4.State = BulbBlink) Then StartARK(): Exit Sub
End Sub


Sub SemiLitPFArk()
	' turn on the semi-lit playfield....Ark torches only...
	TorchFlameL.Frame 1, 40, 1: TorchFlameL.FadeIn
	TorchFlameR.Frame 1, 40, 1: TorchFlameR.FadeIn
	BulbFlameL.State = BulbBlink
	BulbFlameR.State = BulbBlink
	xBAM.SetPlayfieldTexture "APFDArk"
	GIFlash1.State = BulbOff
	GIFlash2.State = BulbOff
End Sub


Sub SemiLitOff()
	TorchesOff()
	xBAM.SetPlayfieldTexture "PFMain"
	GIFlash1.State = BulbOn
	GIFlash2.State = BulbOn
End Sub



' ************************************************
' **                                            **
' **             RAIDERS - SCENE 1              **
' **                                            **
' ************************************************

' Run from the giant boulder and then escape to the plane.

' - shoot any LOOP to run from the boulder
' - shoot the ARK to break through the wall and escape (magnet holds ball)
' - shoot the SPINNERS to run away from the tribe
' - shoot the RAMP to get to the plane and finish the mode

' Shot values for each scene will be the same and progressive, starting at 255k, increasing by 155k.
' Shooting the INDY JONES targets will increase the progressive SCENE VAL by 2500 each time.


Sub StartROTLA1()
	MovieTimer.Enabled = FALSE
	StopMusic 2
	LightArk.State = BulbOff

	' turn on the magnet and hold the ball...
	BulbMagnet.State = BulbOn
	PlaySound "fx_Hum", 0.7
	ArkMagnet.MaxForce = 10
	ArkMagnet.Strength = 90
	Pulse = 1: MagnetTimer.Set TRUE, 2200
	Magnet.Collidable = TRUE

	If (TempleOpen = TRUE) Then CloseChamber(): StoneHitsRemain(CP) = 1 ' it was open so next hit will open it again...

	FlushDMDTimer.Enabled = FALSE
	DispDMD1.QueueText "[edge3][xc][yc][f6]BOULDER RUN", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]BOULDER RUN", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f2][xc][y4]RUN FROM THE[y13]BOULDER AND AVOID[y22]ALL TARGET TRAPS", deFlip, 2000, TRUE
	DispDMD2.QueueText "[edge3][f2][xc][y4]RUN FROM THE[y13]BOULDER AND AVOID[y22]ALL TARGET TRAPS", deFlip, 2000, TRUE

	Clip = 18: PlayClip()
	PlayMusic 1, "Music_BoulderRun", TRUE, 0.8, 2200

	SemiLitPFArk()

	StartRaiderScene.Set TRUE, 2200 ' show the intro clip, then release the ball...
End Sub



Sub StartBOULDER()

	PlayMusic 2, "vo_GoGo"
	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 800

	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 2500
	DispDMD1.Text = "[edge3][f4][y3][b]SHOOT SPINNERS[y17]TO RUN FASTER"
	DispDMD2.Text = "[edge3][f4][y3][b]SHOOT SPINNERS[y17]TO RUN FASTER"

	Run = 5
	SlingStop = FALSE
	ModeHit = 0
	HurryTime = 19: ModeTimer.Set TRUE, 1000

	LightCrusade.State = BulbOff
	SkullBulb.State = BulbOff

	ModeName = "RScene1"
	Magnet.Collidable = FALSE
	LightSeqPF.StopPlay
	PlasDarkOff()

	SemiLitOff()
	
	BulbArkL.FlashForMs 1000, 75, BulbOff
	BulbArkR.FlashForMs 1000, 75, BulbOff
	FlasherRed.FlashForMs 1000, 75, BulbOff
	
	LightSeqPF.Play SeqBlinking, , 11, 75

	' save the state of the INDY JONES lights, we're going to use them for this mode...
	TempL1 = LightINDY1.State
	TempL2 = LightINDY2.State
	TempL3 = LightINDY3.State
	TempL4 = LightINDY4.State
	TempL5 = LightJONES1.State
	TempL6 = LightJONES2.State
	TempL7 = LightJONES3.State
	TempL8 = LightJONES4.State
	TempL9 = LightJONES5.State

	' and now blink them all...these are poison dart traps, avoid them...
	LightINDY1.Set BulbBlink, "10", 100
	LightINDY2.Set BulbBlink, "10", 100
	LightINDY3.Set BulbBlink, "10", 100
	LightINDY4.Set BulbBlink, "10", 100
	LightJONES1.Set BulbBlink, "10", 100
	LightJONES2.Set BulbBlink, "10", 100
	LightJONES3.Set BulbBlink, "10", 100
	LightJONES4.Set BulbBlink, "10", 100
	LightJONES5.Set BulbBlink, "10", 100

	' these are you target shots, shoot the SPINNERS...
	LightOrbitL.State = BulbBlink
	LightOrbitR.STate = BulbBlink

	bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, BSTime(CP): ShootAgainLight.State = BulbBlink
End Sub


' Indy escapes now start chase to plane.

Sub BoulderEscape()
	LightArk.State = BulbOff
	LastShot = FALSE: LightSkull.Set BulbBlink, "10", 100

	StopMusic 8

	BulbMagnet.State = BulbOn
	PlaySound "fx_Hum", 0.7
	ArkMagnet.MaxForce = 10
	ArkMagnet.Strength = 90
	Magnet.Collidable = TRUE
	
	PlayMusic 3, "Music_Cue5"
	SlingStop = TRUE
	HurryTime = 30
	ScoreUpdate = FALSE

	SceneHit()
	Escape = 0

	If (FreeShot(CP) =>1) Then BulbFS.State = BulbBlink: LightFS.State = BulbBlink

	Select Case RandomNumber(2)
		Case 1: PlayMusic 2, "vo_DontKnowYou2": DartTimer.Set TRUE, 6000: PlayMusic 1, "Music_IndyChase", TRUE, 0.8, 5400: ModeTimer.Set TRUE, 6000
			FlushDMDTimer.Set TRUE, 7400
			DispDMD1.QueueText "[edge3][f4][y3]YOU SURVIVED![bf][y17]" & FormatScore(SceneVal*xMarks), deNone, 2000, FALSE
			DispDMD2.QueueText "[edge3][f4][y3]YOU SURVIVED![bf][y17]" & FormatScore(SceneVal*xMarks), deNone, 2000, FALSE
			DispDMD1.QueueText "[edge3][f4][y3]YOU SURVIVED![y17]" & FormatScore(SceneVal*xMarks), deNone, 3000, FALSE
			DispDMD2.QueueText "[edge3][f4][y3]YOU SURVIVED![y17]" & FormatScore(SceneVal*xMarks), deNone, 3000, FALSE
			DispDMD1.QueueText "[edge3][f4][y3][bf]GET TO THE[y17]PLANE", deFlip, 1000, TRUE
			DispDMD2.QueueText "[edge3][f4][y3][bf]GET TO THE[y17]PLANE", deFlip, 1000, TRUE
			FlashPFTimer.Set TRUE, 6200
			StartPlane.Set TRUE, 5200
		Case 2: PlayMusic 2, "vo_DontKnowYou3": DartTimer.Set TRUE, 8600: PlayMusic 1, "Music_IndyChase", TRUE, 0.8, 8600: ModeTimer.Set TRUE, 8600
			FlushDMDTimer.Set TRUE, 10000
			DispDMD1.QueueText "[edge3][f4][y3]YOU SURVIVED![bf][y17]" & FormatScore(SceneVal*xMarks), deNone, 2000, FALSE
			DispDMD2.QueueText "[edge3][f4][y3]YOU SURVIVED![bf][y17]" & FormatScore(SceneVal*xMarks), deNone, 2000, FALSE
			DispDMD1.QueueText "[edge3][f4][y3]YOU SURVIVED![y17]" & FormatScore(SceneVal*xMarks), deNone, 6000, FALSE
			DispDMD2.QueueText "[edge3][f4][y3]YOU SURVIVED![y17]" & FormatScore(SceneVal*xMarks), deNone, 6000, FALSE
			DispDMD1.QueueText "[edge3][f4][y3][bf]GET TO THE[y17]PLANE", deFlip, 1000, TRUE
			DispDMD2.QueueText "[edge3][f4][y3][bf]GET TO THE[y17]PLANE", deFlip, 1000, TRUE
			FlashPFTimer.Set TRUE, 8600
			StartPlane.Set TRUE, 8600
	End Select
	Clip = 5: PlayClip()
	LightSeqPF.Play SeqBlinking, , 5, 75
	PlasDarkOn(): Flash = 5
End Sub


' release any held ball at the Ark magnet...

Sub DartTimer_Expired()
	DartTimer.Enabled = FALSE
	Magnet.Collidable = FALSE
	Pulse = 1: MagnetTimer_Expired()
	SlingStop = FALSE
	If (ModeName = "TScene4") Then
		PlasDarkOff()
		LightSeqPF.Play SeqBlinking, , 3, 100
		QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1500: PlayMusic 2, "vo_StonesMine"
		OpenChamber()
		LightDoom.State = BulbBlink
	End If
End Sub




' ************************************************
' **                                            **
' **             RAIDERS - SCENE 2              **
' **                                            **
' ************************************************

' Marion is interrogated by the creepy Nazi officer.

' The ball (Marion) is held by the Nazis and a score value is assigned to it.  A new ball (Indy) is launched into play and a score countdown timer starts.  

' - shoot the held ball to release it and set the value for each Nazi kill
' - shoot the INDY and JONES targets to eliminate each Nazi and increase the value
' - complete INDY and JONES to score a JACKPOT bonus and reset the targets


Sub StartROTLA2()
	StopMusic 1
	ModeName = "RScene2"

	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 4000 

	Select Case RandomNumber(3)
		Case 1: PlayMusic 2, "vo_UsedTo", FALSE, 1, 1000: StartRaiderScene.Set TRUE, 4400
		Case 2: PlayMusic 2, "vo_Reasonable", FALSE, 1, 800: StartRaiderScene.Set TRUE, 4000
		Case 3: PlayMusic 2, "vo_MeetAgain", FALSE, 1, 800: StartRaiderScene.Set TRUE, 4000
	End Select

	If (TempleOpen = TRUE) Then CloseChamber(): StoneHitsRemain(CP) = 1

	ScoreUpdate = FALSE: FlushDMDTimer.Enabled = FALSE
	DispDMD1.QueueText "[edge3][xc][yc][f6]BAR SHOOTOUT", deNone, 2000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]BAR SHOOTOUT", deNone, 2000, FALSE
	DispDMD1.QueueText "[edge3][f2][xc][y4]SHOOT HELD BALL[y13]TO RESCUE MARION[y22]THEN SHOOT TARGETS", deFlip, 2500, TRUE
	DispDMD2.QueueText "[edge3][f2][xc][y4]SHOOT HELD BALL[y13]TO RESCUE MARION[y22]THEN SHOOT TARGETS", deFlip, 2500, TRUE

	NoS(): OverlayLCD.Frame 184: LCD.Frame 184: MovieTimer.Enabled = FALSE

	LightArk.Set BulbBlink, "10", 100

	PlayMovie.Set TRUE, 1000

	Select Case RandomNumber(2)
		Case 1: PlayMusic 3, "vo_LetHerGo2", FALSE, 1, 4800
		Case 2: PlayMusic 3, "vo_ShootThemBoth", FALSE, 0.8, 4800
	End Select

	' activate the magnet...

	SpotArk.FlashForMs 750, 75, BulbOff
	FlasherArkSpot.FlashForMs 750, 75, BulbOff

	' turn on the magnet to hold the ball....
	BulbMagnet.State = BulbOn
	PlaySound "fx_Hum", 0.7
	ArkMagnet.MaxForce = 10
	ArkMagnet.Strength = 90
	Magnet.Collidable = TRUE
	MagnetRelease.Collidable = TRUE

	' save the state of the INDY JONES lights, these will be shots to the bad guys...
	TempL1 = LightINDY1.State
	TempL2 = LightINDY2.State
	TempL3 = LightINDY3.State
	TempL4 = LightINDY4.State
	TempL5 = LightJONES1.State
	TempL6 = LightJONES2.State
	TempL7 = LightJONES3.State
	TempL8 = LightJONES4.State
	TempL9 = LightJONES5.State

	' and now turn them all off for the first part...
	LightINDY1.State = BulbOff
	LightINDY2.State = BulbOff
	LightINDY3.State = BulbOff
	LightINDY4.State = BulbOff
	LightJONES1.State = BulbOff
	LightJONES2.State = BulbOff
	LightJONES3.State = BulbOff
	LightJONES4.State = BulbOff
	LightJONES5.State = BulbOff

	SemiLitPFArk()

	BallCreateTimer.Set TRUE, 4500
	OneBallTimer.Set TRUE, 6500
End Sub


Sub StartBAR()
	PlayMusic 1, "Music_Bar", TRUE, 0.8
	
	SlingStop = FALSE

	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 3000
	DispDMD1.QueueText "[edge3][f4][y3][b]RESCUE MARION[y17]SHOOT HELD BALL", deNone, 3000, FALSE
	DispDMD2.QueueText "[edge3][f4][y3][b]RESCUE MARION[y17]SHOOT HELD BALL", deNone, 3000, FALSE

	QPlay = FALSE

	Nazi = 0 ' number of kills...
	NaziVal = 750000: NaziTimer.Set TRUE, 3000 ' hurry up value countdown...
	NaziTotal = 0 ' total number of kills...

	LightCrusade.State = BulbOff
	SkullBulb.State = BulbOff

	FlushDMDTimer.Set FALSE: ScoreUpdate = FALSE

	bMultiBallMode = TRUE

	' change the camera angle...
	xBAM.Camera.DesktopSet          261.2,  1266.6,   922.5,   260.9,     623,       0,      50,    500
	xBAM.Camera.DesktopSetLookAt    261.2,  1266.6,   922.5,   260.9,     623,       0,      50,    500

	LightSeqPF.StopPlay
	PlasDarkOff()
	SemiLitOff()

	MovieTimer_Expired()

	bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, BSTime(CP): ShootAgainLight.State = BulbBlink
End Sub






Sub NaziTimer_Expired()
	NaziTimer.Set TRUE, 50
	NaziVal = NaziVal - 2210
	If (NaziVal < 600000) and (QPlay = FALSE) Then
		If (QuoteBusy = FALSE) Then
			QPlay = TRUE
			QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1500
			PlayMusic 2, "vo_HandsOff": BulbMagnet.FlashForMs 1000, 200, BulbOn
		End If
	End If
	If (NaziVal < 30000) Then
		NaziVal = 30000
		NaziTimer.Enabled = FALSE
		ScoreUpdate = TRUE
		DispDMD1.Text = "[edge3][f2][y6]KILL VALUE[f4][y15][bf]" & FormatScore(NaziVal)
		DispDMD2.Text = "[edge3][f2][y6]KILL VALUE[f4][y15][bf]" & FormatScore(NaziVal)
		If (QuoteBusy= FALSE) Then PlayMusic 2, "vo_DoItFaster2": QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1500
	Exit Sub
	End If
	ScoreUpdate = FALSE
	DispDMD1.Text = "[edge3][f2][y6]KILL VALUE[f4][y15]" & FormatScore(NaziVal)
	DispDMD2.Text = "[edge3][f2][y6]KILL VALUE[f4][y15]" & FormatScore(NaziVal)
End Sub


Sub MagnetRelease_Hit()

	If (PlayMovie.Enabled = TRUE) Then Exit Sub ' Failsafe: stop a double hit when TScene2 starts...
	LightArk.State = BulbOff
	MovieTimer_Expired()
	PlaySound "BBHit"
	NaziTimer.Enabled = FALSE
	If (QuoteBusy = FALSE) Then
		QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1800
		PlayMusic 2, "vo_Partner", FALSE, 1, 500
	End If
	PlaySound "fx_Whip2"
	NaziTgt = TRUE
	DispDMD1.QueueText "[edge3][f2][xc][y6]SHOOT TARGETS TO[f4][y15][bf]KILL THE NAZIS", deNone, 2000, TRUE
	DispDMD2.QueueText "[edge3][f2][xc][y6]SHOOT TARGETS TO[f4][y15][bf]KILL THE NAZIS", deNone, 2000, TRUE
	FlushDMDTimer.Set TRUE, 2000

	MagnetRelease.Collidable = FALSE
	Magnet.Collidable = FALSE
	BulbMagnet.State = BulbOff
	CoolDownTimer_Expired()
	
	BulbFS.State = BulbOff: LightFS.State = BulbOff
	
	' when the ball is hit to release it, award double whatever the current Nazi Value is...
	AddScore(NaziVal*2):	NaziTotal = NaziTotal + (NaziVal*2)

	SpotArk.FlashForMs 500, 100, BulbOff
	FlasherArkSpot.FlashForMs 500, 100, BulbOff

	LightSeqPF.Play SeqBlinking, , 1, 100

	LightArk.State = BulbOff

	' now blink all the INDY JONES targets, these are the bad guys...
	LightINDY1.Set BulbBlink, "10", 100
	LightINDY2.Set BulbBlink, "10", 100
	LightINDY3.Set BulbBlink, "10", 100
	LightINDY4.Set BulbBlink, "10", 100
	LightJONES1.Set BulbBlink, "10", 100
	LightJONES2.Set BulbBlink, "10", 100
	LightJONES3.Set BulbBlink, "10", 100
	LightJONES4.Set BulbBlink, "10", 100
	LightJONES5.Set BulbBlink, "10", 100

	bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, BSTime(CP): ShootAgainLight.State = BulbBlink
End Sub


' each letter will go out indicating a Nazi kill. When all letters go out a JACKPOT bonus is awarded and the targets reset.

Sub NaziKill()
	Nazi = Nazi + 1
	ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1200
	AddScore(NaziVal)
	If (ScoreUpdate = FALSE) Then
		DispDMD1.Text = "[edge3][f2][xc][y5]NAZI KILL[f4][y15][bf]" & FormatScore(NaziVal*xMarks)
		DispDMD2.Text = "[edge3][f2][xc][y5]NAZI KILL[f4][y15][bf]" & FormatScore(NaziVal*xMarks)
	End If
	NaziTotal = NaziTotal + (NaziVal*xMarks)
	Select Case RandomNumber(3)
		Case 1: PlaySound "fx_MachineGun1": Clip = 26: PlayClip()
		Case 2: PlaySound "fx_MachineGun2"
		Case 3: PlaySound "fx_Ricochet"
	End Select
	' turns off plas and GI for duration of flash...
	LightSeqPF.Play SeqBlinking, , 2, 150
	PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 300
	CheckINDYJONES()
End Sub



' Used during the bar shootout and mine cart scenes, checks enemies eliminated...

Sub CheckINDYJONES()

	' INDY is complete...
	If (LightINDY1.State=BulbOff)and(LightINDY2.State=BulbOff)and(LightINDY3.State=BulbOff)and(LightINDY4.State=BulbOff) Then
		
		' bar shootout...get the RAIDERS JACKPOT...
		If (ModeName = "RScene2") Then
			AddScore(RaidersJP(CP))
			ScoreUpdate = TRUE: FlushDMDTimer.Set TRUE, 1500
			DispDMD1.Text = "[edge3][f2][y4]NAZI JACKPOT[f6][xc][y13][bf]" & FormatScore(RaidersJP(CP)*xMarks)
			DispDMD2.Text = "[edge3][f2][y4]NAZI JACKPOT[f6][xc][y13][bf]" & FormatScore(RaidersJP(CP)*xMarks)
			NaziTotal = NaziTotal + (RaidersJP(CP)*xMarks)
			MusicFade(1000): PlayMusic 3, "Music_Cue14"
			BulbArkL.FlashForMs 1000, 1000, BulbOff
			BulbArkR.FlashForMs 1000, 1000, BulbOff
			FlasherRed.FlashForMs 1000, 1000, BulbOff
			LightINDY1.State = BulbBlink
			LightINDY2.State = BulbBlink
			LightINDY3.State = BulbBlink
			LightINDY4.State = BulbBlink
		End If

		If (ModeName = "TScene3") Then ' mine cart chase...
			NaziTotal = NaziTotal + (TempleJP(CP)*xMarks)
			AddScore(TempleJP(CP))
			ScoreUpdate = TRUE: FlushDMDTimer.Set TRUE, 1500
			DispDMD1.Text = "[edge3][f2][y4]MINE JACKPOT[f6][xc][y13][bf]" & FormatScore(TempleJP(CP)*xMarks)
			DispDMD2.Text = "[edge3][f2][y4]MINE JACKPOT[f6][xc][y13][bf]" & FormatScore(TempleJP(CP)*xMarks)
			' show clip of enemy cart derail...
			If (MovieTimer.Enabled = FALSE) Then
				Clip = 29: PlayClip()
			End If
			LightSkull.State = BulbBlink ' reset the targets...
		End If
		' reset the targets for another go...
		If (ModeName = "") Then IndyComplete = TRUE: Exit Sub
	End If

	' JONES is complete...
	If (LightJONES1.State=BulbOff)and(LightJONES2.State=BulbOff)and(LightJONES3.State=BulbOff)and(LightJONES4.State=BulbOff)and(LightJONES5.State=BulbOff) Then
		
		' bar shootout...get the RAIDERS JACKPOT...
		If (ModeName = "RScene2") Then
			AddScore(RaidersJP(CP))
			ScoreUpdate = TRUE: FlushDMDTimer.Set TRUE, 1500
			DispDMD1.Text = "[edge3][f2][y4]NAZI JACKPOT[f6][xc][y13][bf]" & FormatScore(RaidersJP(CP)*xMarks)
			DispDMD2.Text = "[edge3][f2][y4]NAZI JACKPOT[f6][xc][y13][bf]" & FormatScore(RaidersJP(CP)*xMarks)
			NaziTotal = NaziTotal + (RaidersJP(CP)*xMarks)
			MusicFade(1000): PlayMusic 3, "Music_Cue14"
			BulbArkL.FlashForMs 1000, 1000, BulbOff
			BulbArkR.FlashForMs 1000, 1000, BulbOff
			FlasherRed.FlashForMs 1000, 1000, BulbOff
			LightJONES1.State = BulbBlink
			LightJONES2.State = BulbBlink
			LightJONES3.State = BulbBlink
			LightJONES4.State = BulbBlink
			LightJONES5.State = BulbBlink
		End If

		If (ModeName = "TScene3") Then ' mine cart chase...
			NaziTotal = NaziTotal + (TempleJP(CP)*xMarks)
			AddScore(TempleJP(CP))
			ScoreUpdate = TRUE: FlushDMDTimer.Set TRUE, 1500
			DispDMD1.Text = "[edge3][f2][y4]MINE JACKPOT[f6][xc][y13][bf]" & FormatScore(TempleJP(CP)*xMarks)
			DispDMD2.Text = "[edge3][f2][y4]MINE JACKPOT[f6][xc][y13][bf]" & FormatScore(TempleJP(CP)*xMarks)
			' show clip of enemy cart derail...
			If (MovieTimer.Enabled = FALSE) Then
				Clip = 29: PlayClip()
			End If
			LightSkull.State = BulbBlink ' reset the targets...
		End If
		' now reset them and do it again...
		If (ModeName = "") Then JonesComplete = TRUE: Exit Sub
	End If
End Sub




' ************************************************
' **                                            **
' **             RAIDERS - SCENE 3              **
' **                                            **
' ************************************************

' Indy chases the truck transporting the Ark. He's just making it up as he goes along.

' - Shoot either loop to get on the truck.
' - Shoot any INDY and any JONES target to fight and elimate each guard.
' - Shoot the Ark to kill the last guard and finish the mode.


Sub StartROTLA3()
	LightArk.State = BulbOff

	ModeName = "RScene3"
	If (TempleOpen = TRUE) Then CloseChamber(): StoneHitsRemain(CP) = 1

	FlushDMDTimer.Enabled = FALSE
	DispDMD1.QueueText "[edge3][xc][yc][f6]TRUCK HIJACK", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]TRUCK HIJACK", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f2][xc][y4]HIJACK THE TRUCK[y13]AND TAKE BACK[y22]THE ARK", deFlip, 2000, TRUE
	DispDMD2.QueueText "[edge3][f2][xc][y4]HIJACK THE TRUCK[y13]AND TAKE BACK[y22]THE ARK", deFlip, 2000, TRUE

	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 4000 
	PlayMovie.Set TRUE, 800

	If (FreeShot(CP) =>1) Then BulbFS.State = BulbBlink: LightFS.State = BulbBlink

	StopMusic 1
	PlayMusic 2, "vo_MakingItUp2", FALSE, 1, 800
	PlayMusic 4, "fx_TruckLong", TRUE, 0.6, 3500

	' activate the magnet...
	PlaySound "fx_Hum", 0.7
	ArkMagnet.MaxForce = 10
	ArkMagnet.Strength = 90
	Pulse = 1: MagnetTimer.Set TRUE, 4000
	Magnet.Collidable = TRUE

	SemiLitPFArk()

	StartRaiderScene.Set TRUE, 4000
End Sub


Sub StartTRUCK()
	PlayMusic 1, "Music_TruckLong", TRUE, 0.8
	SlingStop = FALSE

	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 2000
	DispDMD1.QueueText "[edge3][f4][y3][b]HIJACK THE TRUCK[y17]SHOOT ANY ORBIT", deNone, 2000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3][b]HIJACK THE TRUCK[y17]SHOOT ANY ORBIT", deNone, 2000, TRUE

	ModeHit = 0
	HurryTime = 40: ModeTimer.Set TRUE, 1000

	FlushDMDTimer.Set FALSE: ScoreUpdate = FALSE
	Magnet.Collidable = FALSE

	LightSeqPF.StopPlay
	PlasDarkOff()

	SemiLitOff()

	INDYThrow = FALSE: JONESThrow = FALSE: Guard = 0

	' these are target shots - either orbit to jump onto the truck...
	LightOrbitL.State = BulbBlink
	LightOrbitR.State = BulbBlink

	bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, BSTime(CP): ShootAgainLight.State = BulbBlink
End Sub


' To throw a guard, hit any INDY and any JONES target (in any order).
' 2 guards need to be thrown to take the truck.

Sub GuardThrow()
	If (INDYThrow = TRUE) and (JONESThrow = TRUE) Then
		ScoreUpdate = FALSE
		Guard = Guard + 1
		LightSeqPF.Play SeqBlinking, , 4, 100
		EffectMusic 1, SetVolume, 0, 0: ResumeVol.Set TRUE, 2000
		PlayMusic 3, "Music_Cue6"
		If (Guard = 2) Then
			FlushDMDTimer.Set TRUE, 2500
			DispDMD1.QueueText "[edge3][f2][xc][y5]GUARD THROWN[f4][y15][bf]" & FormatScore(SceneVal*xMarks), deNone, 1000, FALSE
			DispDMD2.QueueText "[edge3][f2][xc][y5]GUARD THROWN[f4][y15][bf]" & FormatScore(SceneVal*xMarks), deNone, 1000, FALSE
			DispDMD1.QueueText "[edge3][f4][y3][b]KILL LAST GUARD[y17]SHOOT THE ARK", deFlip, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][y3][b]KILL LAST GUARD[y17]SHOOT THE ARK", deFlip, 1500, TRUE
			SceneHit()
			LightArk.State = BulbBlink ' light the winning shot at the ark...
			' turn off INDY JONES, no longer needed...
			LightINDY1.State = BulbOff
			LightINDY2.State = BulbOff
			LightINDY3.State = BulbOff
			LightINDY4.State = BulbOff
			LightJONES1.State = BulbOff
			LightJONES2.State = BulbOff
			LightJONES3.State = BulbOff
			LightJONES4.State = BulbOff
			LightJONES5.State = BulbOff
			BulbFS.State = BulbOff: LightFS.State = BulbOff
		Else
			FlushDMDTimer.Set TRUE, 1200
			DispDMD1.Text = "[edge3][f2][xc][y5]GUARD THROWN[f4][y15][bf]" & FormatScore(SceneVal*xMarks)
			DispDMD2.Text = "[edge3][f2][xc][y5]GUARD THROWN[f4][y15][bf]" & FormatScore(SceneVal*xMarks)
			SceneHit()
			INDYThrow = FALSE: JONESThrow = FALSE ' reset and do it again...
			LightINDY1.Set BulbBlink, "10", 125
			LightINDY2.Set BulbBlink, "10", 125
			LightINDY3.Set BulbBlink, "10", 125
			LightINDY4.Set BulbBlink, "10", 125
			LightJONES1.Set BulbBlink, "10", 125
			LightJONES2.Set BulbBlink, "10", 125
			LightJONES3.Set BulbBlink, "10", 125
			LightJONES4.Set BulbBlink, "10", 125
			LightJONES5.Set BulbBlink, "10", 125
		End If
		If (MovieTimer.Enabled = FALSE) Then Clip = 19: PlayClip() ' throw that Nazi scum...
	Else
		Flash = 2: FlashPFTimer.Set TRUE, 100
		If (INDYThrow = TRUE) Then
			LightINDY1.State = BulbOff
			LightINDY2.State = BulbOff
			LightINDY3.State = BulbOff
			LightINDY4.State = BulbOff
			PlaySound "fx_Punch4"
		End If
		If (JONESThrow = TRUE) Then
			LightJONES1.State = BulbOff
			LightJONES2.State = BulbOff
			LightJONES3.State = BulbOff
			LightJONES4.State = BulbOff
			LightJONES5.State = BulbOff
			PlaySound "fx_Punch3"
		End If
	End If
End Sub




' ************************************************
' **                                            **
' **             RAIDERS - SCENE 4              **
' **                                            **
' ************************************************

' 6 balls (not 8 - stupid) are released into play, make 100 switches to light the first JACKPOT at the ark.

' After the first JACKPOT is collected, the required switches to light the next JACKPOT reduces to 50.

' Get 1 JACKPOT to light the SUPER JACKPOT, 2 JACKPOTS to light the Double JACKPOT and 3 JACKPOTS to light the Triple JACKPOT.

' Collect the SUPER JACKPOT to win a Player Perk.

' INDY JONES targets and Bumpers increase JACKPOT value by a small amount.


Sub StartROTLA4()

	LightArk.State = BulbOff
	BallStopper.Collidable = FALSE
	StopMusic 1: StopMusic 2

	If (TempleOpen = TRUE) Then CloseChamber(): StoneHitsRemain(CP) = 1

	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 12500
	DispDMD1.QueueText "[edge3][xc][yc][f6]ARK CEREMONY", deNone, 2000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]ARK CEREMONY", deNone, 2000, FALSE
	DispDMD1.QueueText "[edge3][f2][xc][y4]GET 100 SWITCHES[y13]TO LIGHT ARK[y22]FOR JACKPOTS", deFlip, 5000, FALSE
	DispDMD2.QueueText "[edge3][f2][xc][y4]GET 100 SWITCHES[y13]TO LIGHT ARK[y22]FOR JACKPOTS", deFlip, 5000, FALSE
	DispDMD1.QueueText "[edge3][f4][y3]HIT 100 SWITCHES[y17]TO LIGHT JACKPOT", deNone, 2000, FALSE
	DispDMD2.QueueText "[edge3][f4][y3]HIT 100 SWITCHES[y17]TO LIGHT JACKPOT", deNone, 2000, FALSE
	DispDMD1.QueueText "[edge3][f4][y3][bf]HIT 100 SWITCHES[y17]TO LIGHT JACKPOT", deNone, 1000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3][bf]HIT 100 SWITCHES[y17]TO LIGHT JACKPOT", deNone, 1000, TRUE

	FlashPFTimer.Enabled = FALSE

	' activate the magnet...
	BulbMagnet.State = BulbOn
	PlaySound "fx_Hum", 0.7
	ArkMagnet.MaxForce = 10
	ArkMagnet.Strength = 90
	Magnet.Collidable = TRUE

	StartRaiderScene.Set TRUE, 500
End Sub


Dim ArkTotal,SuperJPVal


Sub StartARK()

	' first, turn off all the lights...
	ClearSeq()
	PlasDarkOn()
	LightSeqPF.Play SeqAllOff

	SemiLitPFArk()

	' and play the movie clip...
	Clip = 4: PlayClip()

	' then open the Ark and show the lights inside it...
	OpenArk2()

	SlingStop = FALSE
	Demon = 0
	Jackpotanim = FALSE

	FlushDMDTimer.set FALSE
	rJackpotHitsLeft = 100

	ArkTotal = 0
	JPHit = 0: SuperJPVal = 0

	PlayMusic 1, "Music_Ark", TRUE, 0.8, 14000

	ArkHitsRemain(CP) = 8

	' hitting the INDY JONES targets will increase the Raiders JP value by a small amount....
	LightINDY1.Set BulbBlink, "10", 100
	LightINDY2.Set BulbBlink, "10", 100
	LightINDY3.Set BulbBlink, "10", 100
	LightINDY4.Set BulbBlink, "10", 100
	LightJONES1.Set BulbBlink, "10", 100
	LightJONES2.Set BulbBlink, "10", 100
	LightJONES3.Set BulbBlink, "10", 100
	LightJONES4.Set BulbBlink, "10", 100
	LightJONES5.Set BulbBlink, "10", 100

	LightCrusade.State = BulbOff
	LightDoom.State = BulbOff
	LightArk.State = BulbOff
	LightSkull.State = BulbOff
	LightOrbitR.State = BulbOff
	LightOrbitL.State = BulbOff

	' the red ark flashes will pulsate...
	bulb4.State = BulbBlink
	bulb5.State = BulbBlink
	bulb6.State = BulbBlink
	bulb7.State = BulbBlink
	bulb8.State = BulbBlink
	bulb9.State = BulbBlink
	bulb10.State = BulbBlink
	bulb12.State = BulbBlink
	bulb13.State = BulbBlink
	bulb14.State = BulbBlink
	bulb15.State = BulbBlink
	bulb16.State = BulbBlink
	bulb17.State = BulbBlink
	bulb18.State = BulbBlink
	FlasherRed.State = BulbOn

	' turn off the red flashing lights after 8 secs...
	FlasherOff.Set TRUE, 8000

	' start the light show...
	FlashLight = 0
	MBTimer1.Set TRUE, 8500

	' finally, release the balls...
	DelayArk.Set TRUE, 13000
	ModeName = "RScene4"
	bMultiBallMode = TRUE

	' change the camera angle...
	xBAM.Camera.DesktopSet          261.2,  1266.6,   922.5,   260.9,     623,       0,      50,    500
	xBAM.Camera.DesktopSetLookAt    261.2,  1266.6,   922.5,   260.9,     623,       0,      50,    500
End Sub


' the ark opening light show...

Sub MBTimer1_Expired()
	MBTimer1.Set TRUE, 200
	ClearSeq()
	FlashLight = FlashLight + 1
	Select Case FlashLight
		Case 1,7,13: 
			SemiLitOff()
			LightSeqPF.Play SeqAllOn
			SpotArk.State = BulbOn: FlasherArkSpot.State = BulbOn
			PlasDarkOn()
			LightBumpFlash.State = BulbOff: LightBumpFlash2.State = BulbOff
			MBTimer1.Set TRUE, 200
		Case 2,8,14: 
			LightSeqPF.Play SeqAllOff
			SpotArk.State = BulbOff: FlasherArkSpot.State = BulbOff
			PlasDarkOff()
			MBTimer1.Set TRUE, 300
		Case 3,9: 
			SpotBulbLS.State = BulbOn: FlasherAmb1.State = BulbOn
			SpotBulbRS.State = BulbOn: FlasherAmb2.State = BulbOn
			PlasDarkOn()
			MBTimer1.Set TRUE, 500
		Case 4,10: 
			SpotBulbLS.State = BulbOff: FlasherAmb1.State = BulbOff
			SpotBulbRS.State = BulbOff: FlasherAmb2.State = BulbOff
			PlasDarkOff()
			MBTimer1.Set TRUE, 350
		Case 5,11:
			SpotBulbLS.State = BulbOn: FlasherAmb1.State = BulbOn
			SpotBulbRS.State = BulbOn: FlasherAmb2.State = BulbOn
			PlasDarkOn()
			MBTimer1.Set TRUE, 250
		Case 6,12: 
			LightSeqPF.Play SeqAllOff
			SpotBulbLS.State = BulbOff: FlasherAmb1.State = BulbOff
			SpotBulbRS.State = BulbOff: FlasherAmb2.State = BulbOff
			PlasDarkOff()
			LightBumpFlash.State = BulbOn: LightBumpFlash2.State = BulbOn
			MBTimer1.Set TRUE, 150
		Case 15:
			ClearSeq()
			SpotBulbLS.State = BulbOff: FlasherAmb1.State = BulbOff
			SpotBulbRS.State = BulbOff: FlasherAmb2.State = BulbOff
			PlasDarkOff()
			MBTimer1.Enabled = FALSE
	End Select
End Sub


' release the balls...open the Ark lid first....

Sub DelayArk_Expired()
	delayark.set FALSE
	OpenArk2()
	FourBallTimer.Set TRUE, 500
	DelayArk2.Set TRUE, 2500
End Sub


' eject all the balls (8 or 4, whatever)...

Sub FourballTimer_Expired()
	FourBallTimer.Set FALSE
	Kicker7.createBall
	Kicker8.createBall
	Kicker9.createBall
	Kicker10.CreateBall
	balldropsound.set TRUE, 400

	' turn off magnet
	Magnet.Collidable = FALSE
	MagnetActive = FALSE
	ArkMagnet.MaxForce = 0
	ArkMagnet.Strength = 0
	BulbMagnet.State = BulbOff

	BallsOnPlayfield = BallsOnPlayfield + 4
	ClearSeq()
	LightSeqPF.Play SeqBlinking, , 3, 100
	CreateNewBall()
	ThreeBallTimer.set TRUE, 1500
End Sub


' launch the ball in the plunger lane, add another one...

Sub ThreeBallTimer_Expired()
	ThreeBallTimer.Set FALSE
	Plunger.SolenoidPulse
	' PlaySound "fx_BallLaunch"
	FF_Sound DV_RS,-1, "fx_BallLaunch"
	BallCreateTimer.Set TRUE, 500
	TwoBallTimer.Set TRUE, 1500
End Sub


' launch the ball in the plunger lane, add another one...

Sub TwoBallTimer_Expired()
	TwoBallTimer.Set FALSE
	Plunger.SolenoidPulse
	' PlaySound "fx_BallLaunch"
	FF_Sound DV_RS,-1, "fx_BallLaunch"
	BallCreateTimer.Set TRUE, 500
	OneBallTimer.Set TRUE, 1500
	If (MovieTimer.Enabled = FALSE) and (ModeName = "TScene3") Then
		Clip = 34: PlayClip() ' mine cart clip of bad guys chasing...
	End If
End Sub



Sub OneBallTimer_Expired()
	OneBallTimer.Set FALSE
	Plunger.SolenoidPulse
	' PlaySound "fx_BallLaunch"
	FF_Sound DV_RS,-1, "fx_BallLaunch"
	PlaySound "fx_GunShot6"
End Sub



Sub BallCreateTimer_Expired()
	BallCreateTimer.Set FALSE
	PlungerKicker.CreateBall: AddTrackedBall(PlungerKicker)
	BallLaunched = FALSE
	BallsOnPlayfield = BallsOnPlayfield + 1
	PlungerKicker.SolenoidPulse
	FF_Sound DV_RF,-1, "fx_BallLaunch"

End Sub



Sub DelayArk2_Expired()
	DelayArk2.Set FALSE
	' now close the ark...
	OpenArk2()
End Sub



Sub RaidersHit()
	If (LightArk.State = BulbBlink) Then Exit Sub
	rJackpotHitsLeft = rJackpotHitsLeft - 1
	AddScore(5000)
	ArkTotal = ArkTotal + (5000*xMarks)
	If (rJackpotHitsLeft = 0) Then
		PlaySound "fx_Lightning2"
		LightArk.State = BulbBlink
		FlushDMDTimer.Set TRUE, 1800
		DispDMD1.QueueText "[edge3][box3,1,1,126,30][f4][y3][bf]JACKPOT[y17]IS LIT", deNone, 75, FALSE
		DispDMD2.QueueText "[edge3][box3,1,1,126,30][f4][y3][bf]JACKPOT[y17]IS LIT", deNone, 75, FALSE
		DispDMD1.QueueText "[edge3][f4][y3][bf]JACKPOT[y17]IS LIT", deNone, 75, FALSE
		DispDMD2.QueueText "[edge3][f4][y3][bf]JACKPOT[y17]IS LIT", deNone, 75, FALSE
	Else
		If (NoPlay = FALSE) Then
			Select Case JPHit
				Case 0:
					DispDMD1.Text = "[edge3][f2][xc][y4]" & rJackpotHitsLeft & " MORE SWITCHES" & "[y13]" & FormatScore(nvscore(CP)) & "[y22]FOR JACKPOT"
					DispDMD2.Text = "[edge3][f2][xc][y4]" & rJackpotHitsLeft & " MORE SWITCHES" & "[y13]" & FormatScore(nvscore(CP)) & "[y22]FOR JACKPOT"
				Case 1: 
					DispDMD1.Text = "[edge3][f2][xc][y4]" & rJackpotHitsLeft & " MORE SWITCHES" & "[y13]" & FormatScore(nvscore(CP)) & "[y22]FOR SUPER JP"
					DispDMD2.Text = "[edge3][f2][xc][y4]" & rJackpotHitsLeft & " MORE SWITCHES" & "[y13]" & FormatScore(nvscore(CP)) & "[y22]FOR SUPER JP"
				Case 2:
					DispDMD1.Text = "[edge3][f2][xc][y4]" & rJackpotHitsLeft & " MORE SWITCHES" & "[y13]" & FormatScore(nvscore(CP)) & "[y22]FOR 2 X SUPER JP"
					DispDMD2.Text = "[edge3][f2][xc][y4]" & rJackpotHitsLeft & " MORE SWITCHES" & "[y13]" & FormatScore(nvscore(CP)) & "[y22]FOR 2 X SUPER JP"
				Case 3:
					DispDMD1.Text = "[edge3][f2][xc][y4]" & rJackpotHitsLeft & " MORE SWITCHES" & "[y13]" & FormatScore(nvscore(CP)) & "[y22]FOR 3 X SUPER JP"
					DispDMD2.Text = "[edge3][f2][xc][y4]" & rJackpotHitsLeft & " MORE SWITCHES" & "[y13]" & FormatScore(nvscore(CP)) & "[y22]FOR 3 X SUPER JP"
			End Select
		End If
	End If
End Sub




' Generic mode timer for all timed modes.
' To create a sense of panic in the player, I add a ticking clock sound fx when the timer reaches 5 seconds.
' I also add specific quotes at certain times to alert the player that time is running out.

' ** MEDIA NEEDED **

' short movie clips showing outcome of each scene in a failed situation if possible. Plane crash for example.


Sub ModeTimer_Expired()
	ModeTimer.Set TRUE, 1000
	HurryTime = HurryTime - 1
	LastShot = FALSE

	If (HurryTime > 5) Then StopMusic 8

	Select Case HurryTime
		Case 15: 
			If (QuoteBusy = FALSE) and (ModeName = "TScene1") and (QPlay = FALSE) Then
				EffectMusic 1, SetVolume, 0, 0: ResumeVol.Set TRUE, 2000
				PlayMusic 2, "vo_Poison": QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3000: QPlay = TRUE
			End If
		Case 5:
			PlayMusic 8, "fx_ClockTicking"
			If (QuoteBusy = FALSE) Then 
				If (ModeName = "RScene3") Then PlayMusic 2, "vo_Faster"
				If (ModeName = "TScene1") or (ModeName = "TScene2") Then PlayMusic 2, "vo_HurryUp"
				If (ModeName = "TScene2") Then MusicFade(1400): Clip = 17: PlayClip() ' got a big problem...
				If (ModeName = "CScene2") Then MusicFade(700): PlayMusic 2, "vo_ComeOn"
				If (ModeName = "RScene1") and (LightSkull.State = BulbBlink) Then MusicFade(800): PlayMusic 2, "vo_MustHurry"
			End If
	End Select

	If (HurryTime =<0) Then
		ModeTimer.Enabled = FALSE
		StopMusic 8

		' the nuke goes off...
		If (ModeName = "SScene2") Then
			SceneSKULLComplete()
			ShowStatusTimer.Enabled = FALSE
			LightDoom.State = BulbOff
			ModeName = ""
			StopMusic 1: StopMusic 2: StopMusic 3: StopMusic 4
			Clip = 44: PlayClip()
			PlasDarkOn()
			LightSeqPF.Play SeqRandom, 30, 1: SpotOn(7)
			fpTilted = TRUE: Nuke = TRUE
			LeftFlipper.SolenoidOff
			RightFlipper.SolenoidOff
			
			FF_Dev DV_LF,0    ' Turn the flipper solenoids off
			FF_Dev DV_RF,0    ' Turn the flipper solenoids off
			
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 5000
			DispDMD1.QueueText "[edge3][f6][xc][yc][b]OUT OF TIME", deNone, 2500, FALSE
			DispDMD2.QueueText "[edge3][f6][xc][yc][b]OUT OF TIME", deNone, 2500, FALSE
			DispDMD1.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6]"&FormatScore(SceneTotal), deFlip, 1000, TRUE
			DispDMD2.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6]"&FormatScore(SceneTotal), deFlip, 1000, TRUE
			If (TempleOpen = TRUE) Then
				TempleOpen = FALSE
				StoneLightsOff()
				BulbDoom.State = BulbOff
				StoneTarget.Collidable = TRUE
				TempleOpen = FALSE: Captive.Rotateyz -25,0
			End If
		Exit Sub
		End If

		PlayMusic 1, "Music_Fail"
		ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2700
		DispDMD1.QueueText "[edge3][f6][xc][yc][b]OUT OF TIME", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][xc][yc][b]OUT OF TIME", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6][b]"&FormatScore(SceneTotal), deScrollIn, 1000, TRUE
		DispDMD2.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[y14][f6][b]"&FormatScore(SceneTotal), deScrollIn, 1000, TRUE

		If (ModeName = "RScene1") Then
			If (QuoteBusy = FALSE) Then
				QuoteTimer.Set TRUE, 3600
				Select Case RandomNumber(4)
					Case 1: PlayMusic 2, "vo_TakeAway"
					Case 2: PlayMusic 2, "vo_EndThisWay"
					Case 3: PlayMusic 2, "vo_TakeAway2"
					Case 4: PlayMusic 2, "vo_TakeAway3": QuoteTimer.Set TRUE, 4600
				End Select
				QuoteBusy = TRUE
				EffectMusic 5, FadeOutAndStop, 0, 200
			End If
			NoS(): OverlayLCD.Frame 97: LCD.Frame 97: MovieTimer.Set TRUE, 2000
			SceneRAIDERSComplete()
			LightINDY1.Set BulbBlink, "10", 150
			LightINDY2.Set BulbBlink, "10", 150
			LightINDY3.Set BulbBlink, "10", 150
			LightINDY4.Set BulbBlink, "10", 150
			LightJONES1.Set BulbBlink, "10", 150
			LightJONES2.Set BulbBlink, "10", 150
			LightJONES3.Set BulbBlink, "10", 150
			LightJONES4.Set BulbBlink, "10", 150
			LightJONES5.Set BulbBlink, "10", 150
			LightINDY1.State = TempL1 
			LightINDY2.State = TempL2 
			LightINDY3.State = TempL3 
			LightINDY4.State = TempL4 
			LightJONES1.State = TempL5
			LightJONES2.State = TempL6 
			LightJONES3.State = TempL7
			LightJONES4.State = TempL8
			LightJONES5.State = TempL9
		End If

		If (ModeName = "RScene3") Then
			SceneRAIDERSComplete()
			If (LightOrbitL.State = BulbOff) Then ' make sure time ran out during phase 2 of the mode...
				LightINDY1.Set BulbBlink, "10", 150
				LightINDY2.Set BulbBlink, "10", 150
				LightINDY3.Set BulbBlink, "10", 150
				LightINDY4.Set BulbBlink, "10", 150
				LightJONES1.Set BulbBlink, "10", 150
				LightJONES2.Set BulbBlink, "10", 150
				LightJONES3.Set BulbBlink, "10", 150
				LightJONES4.Set BulbBlink, "10", 150
				LightJONES5.Set BulbBlink, "10", 150
				LightINDY1.State = TempL1 
				LightINDY2.State = TempL2 
				LightINDY3.State = TempL3 
				LightINDY4.State = TempL4 
				LightJONES1.State = TempL5
				LightJONES2.State = TempL6 
				LightJONES3.State = TempL7
				LightJONES4.State = TempL8
				LightJONES5.State = TempL9
			End If
		End If

		If (ModeName = "TScene1") Then
			SceneTEMPLEComplete()
			If (QuoteBusy = FALSE) Then 
				QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1800: PlayMusic 2, "vo_BeSad"
				If (MovieTimer.Enabled = FALSE) Then NoS(): OverlayLCD.Frame 268: LCD.Frame 268:MovieTimer.Set TRUE, 2000
			End If
			LightINDY1.Set BulbBlink, "10", 150
			LightINDY2.Set BulbBlink, "10", 150
			LightINDY3.Set BulbBlink, "10", 150
			LightINDY4.Set BulbBlink, "10", 150
			LightJONES1.Set BulbBlink, "10", 150
			LightJONES2.Set BulbBlink, "10", 150
			LightJONES3.Set BulbBlink, "10", 150
			LightJONES4.Set BulbBlink, "10", 150
			LightJONES5.Set BulbBlink, "10", 150
			LightINDY1.State = TempL1 
			LightINDY2.State = TempL2 
			LightINDY3.State = TempL3 
			LightINDY4.State = TempL4 
			LightJONES1.State = TempL5
			LightJONES2.State = TempL6 
			LightJONES3.State = TempL7
			LightJONES4.State = TempL8
			LightJONES5.State = TempL9
		End If

		If (ModeName = "TScene2") Then
			SceneTEMPLEComplete()
			MovieTimer_Expired()
			StopMusic 2: QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1000
			PlaySound "fx_PlaneCrash"
			StopMusic 5
			PlasDarkOn()
			LightSeqPF.Play SeqDoNothing, , ,1100
			LightSeqPF.Play SeqBlinking, , 4, 100
			Flash = 5: FlashPFTimer.Set TRUE, 1100
		End If

		If (ModeName = "TScene3") Then
			SceneTEMPLEComplete()
		End If

		If (ModeName = "TScene4") Then
			SceneTEMPLEComplete()
			' temple was open for final part, close it...
			If (TempleOpen = TRUE) Then CloseChamber()
		End If
		
		If (ModeName = "CScene1") Then
			SceneCRUSADEComplete()
			MovieTimer_Expired()
		End If
		
		If (ModeName = "CScene2") Then
			SceneCRUSADEComplete()
			QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3700
			PlayMusic 2, "vo_Trust", FALSE, 1, 500
			If (MovieTimer.Enabled = FALSE) Then NoS(): OverlayLCD.Frame 267: LCD.Frame 267:MovieTimer.Set TRUE, 2000
		End If

		If (ModeName = "CScene3") Then
			SceneCRUSADEComplete()
			TankFire.Enabled = FALSE
			QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3500
			PlayMusic 2, "vo_GoodbyeGermany", FALSE, 1, 500
			If (MovieTimer.Enabled = FALSE) Then NoS(): OverlayLCD.Frame 267: LCD.Frame 267:MovieTimer.Set TRUE, 2000
		End If

		If (ModeName = "CScene4") Then
			SceneCRUSADEComplete()
			LightCrusadeExt.SetLitColor 94, 203, 255
			LightDoomExt.SetLitColor 255, 164, 72
			LightArkExt.SetLitColor 219, 192, 241
			LightSkullExt.SetLitColor 156, 233, 131
			LightOrbitRExt.SetLitColor 243, 117, 63
			If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3500: PlayMusic 2, "vo_ChosenPoorly", FALSE, 1, 500
		End If

		If (ModeName = "SScene1") Then
			SceneSKULLComplete()
			LightSkull.State = BulbOff
			LightOrbitR.State = BulbOff
			Bumper1.State = BulbOff
			Bumper2.State = BulbOff
			Bumper3.State = BulbOff
			Bumper4.State = BulbOff
			RampDiverter.SolenoidOff
			QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2100
			PlayMusic 2, "vo_DontToy"
			If (MovieTimer.Enabled = FALSE) Then NoS(): OverlayLCD.Frame 642: LCD.Frame 642: MovieTimer.Set TRUE, 2000
		End If

		If (ModeName = "SScene3")Then
			SceneSKULLComplete()
			If (Flipped = TRUE) Then
				Flipped = FALSE
				BallSaverTimer.Set TRUE, BSTime(CP)
			End If
			SkullBulb.Set BulbOff, "10", 150
			QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3000
			PlayMusic 2, "vo_SkullSpeak", FALSE, 1, 500
			If (MovieTimer.Enabled = FALSE) Then NoS(): OverlayLCD.Frame 642: LCD.Frame 642: MovieTimer.Set TRUE, 2000
		End If

		If (ModeName = "SScene4") Then
			SceneSKULLComplete()
			QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2100
			PlayMusic 2, "vo_DontToy"
			If (MovieTimer.Enabled = FALSE) Then NoS(): OverlayLCD.Frame 642: LCD.Frame 642: MovieTimer.Set TRUE, 2000
		End If

		' turn off the plane toy rotor if spinning...
		If (PlaneOn = TRUE) Then 
			PlaneOn = FALSE
			PropStop.Set TRUE, 500
		End If

		If (QuoteBusy = FALSE) Then 
			QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3000
			Select Case RandomNumber(5)
				Case 1: PlayMusic 2, "vo_Bastards": NoS(): OverlayLCD.Frame 150: LCD.Frame 150: MovieTimer.Set TRUE, 2000
				Case 2: PlayMusic 2, "vo_TooBad": NoS(): OverlayLCD.Frame 97: LCD.Frame 97: MovieTimer.Set TRUE, 2000
				Case 3: PlayMusic 2, "vo_WrongFriends": NoS(): OverlayLCD.Frame 97: LCD.Frame 97:MovieTimer.Set TRUE, 2000
				Case 4: PlayMusic 2, "vo_BeloqLaugh": NoS(): OverlayLCD.Frame 97: LCD.Frame 97:MovieTimer.Set TRUE, 2000
				Case 5: PlayMusic 2, "vo_NotHard": NoS(): OverlayLCD.Frame 150: LCD.Frame 150:MovieTimer.Set TRUE, 2000
			End Select
		End If

		StopMusic 4
		BulbFS.State = BulbOff: LightFS.State = BulbOff
		StartRovingLights.Enabled = FALSE
		StartRovingINDYJONES.Enabled = FALSE
		ModeName = ""
		LightXMarks.State = BulbOff
		LightCrusade.State = BulbOff
		LightDoom.State = BulbOff
		LightArk.State = BulbOff
		LightSkull.Set BulbOff, "10", 125
		LightOrbitR.State = BulbOff
		LightOrbitL.State = BulbOff
		SceneCheck() ' relight any previous scenes which are ready to start...
		RestartMusic.Set TRUE, 1500
	Exit Sub
	End If
End Sub



' a mode ends successully so award the player with the movie JACKPOT and a random bonus rewards (movie item)...

Sub EndMode()
	ModeTimer.Enabled = FALSE
	ModeHit = 0
	dim st
	StopMusic 8
	LastShot = FALSE 
	DispDMD1.FlushQueue: DispDMD2.FlushQueue
	FlushDMDTimer.Enabled = FALSE

	' SKULL SCENE 2...nuke town
	If (ModeName = "SScene2") Then
		SceneSkullComplete()
		WinVal = SkullJP(CP) + SceneTotal
		AddScore(SkullJP(CP))
		DispDMD1.QueueText "[edge3][f6][yc][bf]YOU MADE IT", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][yc][bf]YOU MADE IT", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f6][yc]YOU MADE IT", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][yc]YOU MADE IT", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL", deFlip, 1000, FALSE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL", deFlip, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deNone, 2000, FALSE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deNone, 2000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 1000, TRUE
		StopMusic 1
		Clip = 43: PlayClip() ' allow the clip to play, then present the award after Indy comes out of the fridge...
		LightDoom.State = BulbOff
		PlasDarkOn()
		LightSeqPF.Play SeqDoNothing, , , 3100
		LightSeqJP.Play SeqDoNothing, , , 3100
		LightSeqPF.Play SeqRandom, 30, 1: FlasherOff.Set TRUE, 7000
		LightSeqJP.Play SeqRandom, 13, 1
		BallFromStone = TRUE
		StoneKicker.Destroyball: DeleteTrackedBall(StoneKicker)
		GrailKicker.CreateBall: AddTrackedBall(GrailKicker)
		TempleOpen = FALSE
		BulbDoom.State = BulbOff
		StoneTarget.Collidable = TRUE
		Captive.Rotateyz -25,0
		ModeName = ""
		GrailKickerTimer.Set TRUE, 14000
		RestartMusic.Set TRUE, 12300
		PlayMusic 3, "vo_SafeThanSorry", FALSE, 1, 9400
		PlayMusic 4, "Music_Cue12", FALSE, 1, 10500
		RS = 12100: SpinMe_Expired()
	Exit Sub
	End If

	PlayMusic 1, "Music_HurryUpAward", FALSE, 0.6 ' 4000 ms...
	ScoreUpdate = FALSE
	DispDMD1.QueueText "[edge3][f6][xc][yc][bf]YOU DID IT", deNone, 800, FALSE
	DispDMD2.QueueText "[edge3][f6][xc][yc][bf]YOU DID IT", deNone, 800, FALSE

	' RAIDERS SCENE 1...bolder run
	If (ModeName = "RScene1") Then
		SceneRAIDERSComplete()
		Clip = 10: PlayClip()
		EffectMusic 5, FadeOutAndStop, 0, 200
		StopMusic 1
		QuoteBusy = TRUE: QuoteTimer.Set TRUE, 12000: PlayMusic 3, "vo_SnakeInPlane2", FALSE, 1, 1000
		WinVal = RaidersJP(CP) + SceneTotal
		AddScore(RaidersJP(CP))
		DispDMD1.QueueText "[edge3][f6][xc][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][xc][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL", deFlip, 1000, FALSE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL", deFlip, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deNone, 2000, FALSE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deNone, 2000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 1000, TRUE
		SpotSword.FlashForMs 1000, 100, BulbOff
		FlasherSword.FlashForMs 1000, 100, BulbOff
		LightSeqPF.Play SeqBlinking, , 4, 75
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 7500
		RS = 7500: SpinMe_Expired()
		st = 10500
	End If


	' RAIDERS SCENE 2 (bar shootout) is a multiball so it ends when only 1 balls remains...


	' RAIDERS SCENE 3...truck hijack
	If (ModeName = "RScene3") Then
		Clip = 68: PlayClip()
		' hold the ball for a sec...
		PlaySound "fx_Hum"
		BulbMagnet.State = BulbOn
		ArkMagnet.MaxForce = 10
		ArkMagnet.Strength = 80
		Magnet.Collidable = TRUE
		CoolDownTimer.Set TRUE, 8000
		SceneRAIDERSComplete()
		StopMusic 1
		PlayMusic 4, "Music_Cue10", FALSE, 0.8, 6000
		WinVal = RaidersJP(CP) + SceneTotal
		AddScore(RaidersJP(CP))
		DispDMD1.QueueText "[edge3][f6][xc][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][xc][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL", deFlip, 1000, FALSE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL", deFlip, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deNone, 2000, FALSE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deNone, 2000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 1000, TRUE

		SpotBulbLS.FlashForMs 1000, 100, BulbOff
		FlasherAmb1.FlashForMs 1000, 100, BulbOff
		SpotBulbRS.FlashForMs 1000, 100, BulbOff
		FlasherAmb2.FlashForMs 1000, 100, BulbOff
		LightSeqPF.Play SeqBlinking, , 4, 75
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 6000

		LightINDY1.Set BulbBlink, "10", 150
		LightINDY2.Set BulbBlink, "10", 150
		LightINDY3.Set BulbBlink, "10", 150
		LightINDY4.Set BulbBlink, "10", 150
		LightJONES1.Set BulbBlink, "10", 150
		LightJONES2.Set BulbBlink, "10", 150
		LightJONES3.Set BulbBlink, "10", 150
		LightJONES4.Set BulbBlink, "10", 150
		LightJONES5.Set BulbBlink, "10", 150
		LightINDY1.State = TempL1 
		LightINDY2.State = TempL2 
		LightINDY3.State = TempL3 
		LightINDY4.State = TempL4 
		LightJONES1.State = TempL5
		LightJONES2.State = TempL6 
		LightJONES3.State = TempL7
		LightJONES4.State = TempL8
		LightJONES5.State = TempL9
		RS = 6600: SpinMe_Expired()
		st = 9500
	End If


	' RAIDERS SCENE 4 (ark ceremony) is a multiball so it ends when only 1 balls remains...


	' TEMPLE SCENE 1...antidote
	If (ModeName = "TScene1") Then
		SceneTEMPLEComplete()
		MovieTimer.Set TRUE, 10
		If (QuoteBusy = FALSE) Then
			PlayMusic 2, "vo_NiceTry"
		Else
			PlaySound "fx_Plane"
		End If
		WinVal = TempleJP(CP) + SceneTotal
		AddScore(TempleJP(CP))
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deFlip, 1000, FALSE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deFlip, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 1000, TRUE
		LightINDY1.Set BulbBlink, "10", 150
		LightINDY2.Set BulbBlink, "10", 150
		LightINDY3.Set BulbBlink, "10", 150
		LightINDY4.Set BulbBlink, "10", 150
		LightJONES1.Set BulbBlink, "10", 150
		LightJONES2.Set BulbBlink, "10", 150
		LightJONES3.Set BulbBlink, "10", 150
		LightJONES4.Set BulbBlink, "10", 150
		LightJONES5.Set BulbBlink, "10", 150
		LightINDY1.State = TempL1 
		LightINDY2.State = TempL2 
		LightINDY3.State = TempL3 
		LightINDY4.State = TempL4 
		LightJONES1.State = TempL5
		LightJONES2.State = TempL6 
		LightJONES3.State = TempL7
		LightJONES4.State = TempL8
		LightJONES5.State = TempL9

		SpotSword.FlashForMs 1000, 100, BulbOff
		FlasherSword.FlashForMs 1000, 100, BulbOff
		LightSeqPF.Play SeqBlinking, , 4, 75
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 3800

		RS = 3800: SpinMe_Expired()
		st = 3800
	End If

	' TEMPLE SCENE 2...plane jump
	If (ModeName = "TScene2") Then
		SceneTEMPLEComplete()
		Clip = 25: PlayClip()
		'If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_WasntBad"
		WinVal = TempleJP(CP) + SceneTotal
		AddScore(TempleJP(CP))
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deFlip, 1000, FALSE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deFlip, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 1000, TRUE
		
		SpotSword.FlashForMs 1000, 100, BulbOff
		FlasherSword.FlashForMs 1000, 100, BulbOff
		LightSeqPF.Play SeqBlinking, , 4, 75
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 4200

		RS = 4200: SpinMe_Expired()
		st = 4000
	End If


	' TEMPLE SCENE 3 (mincart chase) is a multiball so ends when only 1 ball remains....


	' TEMPLE SCENE 4...rope bridge
	If (ModeName = "TScene4") Then
		SceneTEMPLEComplete()
		If (QuoteBusy = FALSE) Then StopMusic 1: PlayMusic 2, "vo_FortuneAndGlory1"
		Clip = 48: PlayClip()
		WinVal = TempleJP(CP) + SceneTotal
		AddScore(TempleJP(CP))
		DispDMD1.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][b]" & FormatScore(WinVal*xMarks), deFlip, 1000, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][b]" & FormatScore(WinVal*xMarks), deFlip, 1000, TRUE

		LightSeqPF.Play SeqBlinking, , 4, 75
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 3500

		RS = 3500: SpinMe_Expired()
		GrailKickerTimer.Set TRUE, 5300: st = 3500
	End If

	' CRUSADE SCENE 1...young indy
	If (ModeName = "CScene1") Then
		PlaySound "fx_Mystery"
		LightCrusade.State = BulbOff
		SceneCRUSADEComplete()
		Clip = 40: PlayClip()
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_YouDidIt"
		WinVal = CrusadeJP(CP) + SceneTotal
		AddScore(CrusadeJP(CP))
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deFlip, 1000, FALSE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deFlip, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 2000, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 2000, TRUE
		
		LightSeqPF.Play SeqBlinking, , 4, 75
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 4200

		RS = 4200: SpinMe_Expired()
		st = 4200
	End If

	' CRUSADE SCENE 2...dogfight

	' ** MEDIA NEEDED **
	' - plane moving along side Indy through tunnel, then exploding

	If (ModeName = "CScene2") Then
		MovieTimer.Set TRUE, 10
		SceneCRUSADEComplete()
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_YouDidIt"
		WinVal = CrusadeJP(CP) + SceneTotal
		AddScore(CrusadeJP(CP))
		DispDMD1.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][b]" & FormatScore(WinVal*xMarks), deFlip, 2000, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][b]" & FormatScore(WinVal*xMarks), deFlip, 2000, TRUE
		
		SpotBulbLS.FlashForMs 1000, 100, BulbOff
		FlasherAmb1.FlashForMs 1000, 100, BulbOff
		SpotBulbRS.FlashForMs 1000, 100, BulbOff
		FlasherAmb2.FlashForMs 1000, 100, BulbOff
		LightSeqPF.Play SeqBlinking, , 4, 75
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 3300

		RS = 3300: SpinMe_Expired()
		st = 2500
	End If

	' CRUSADE SCENE 3...tank attack

	' ** MEDIA NEEDED **
	' - Indy pulling out his dad from the tank

	If (ModeName = "CScene3") Then
		TankFire.Enabled = FALSE
		StopMusic 4
		MovieTimer.Set TRUE, 10
		SceneCRUSADEComplete()
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_YouDidIt"
		WinVal = CrusadeJP(CP) + SceneTotal
		AddScore(CrusadeJP(CP))
		DispDMD1.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][b]" & FormatScore(WinVal*xMarks), deFlip, 2000, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][b]" & FormatScore(WinVal*xMarks), deFlip, 2000, TRUE
		
		LightSeqPF.Play SeqBlinking, , 4, 75
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 2000
		
		RS = 3300: SpinMe_Expired()
		st = 2000
	End If

	' CRUSADE SCENE 4...choose wisely
	If (ModeName = "CScene4") Then
		MovieTimer.Set TRUE, 10
		SceneCRUSADEComplete()
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_YouDidIt"
		WinVal = CrusadeJP(CP) + SceneTotal
		AddScore(CrusadeJP(CP))
		DispDMD1.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][b]" & FormatScore(WinVal*xMarks), deFlip, 2000, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][b]" & FormatScore(WinVal*xMarks), deFlip, 2000, TRUE
		RS = 3100: SpinMe_Expired()
		st = 2000
	End If

	' SKULL SCENE 1...rocket sled
	If (ModeName = "SScene1") Then
		SceneSkullComplete()
		PlasDarkOn()
		LightSeqPF.Play SeqRandom, 30, 1, 4000
		Clip = 62: PlayClip()
		WinVal = CrusadeJP(CP) + SceneTotal
		AddScore(CrusadeJP(CP))
		DispDMD1.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][b]" & FormatScore(WinVal*xMarks), deFlip, 1500, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][b]" & FormatScore(WinVal*xMarks), deFlip, 1500, TRUE
		RS = 5600: SpinMe_Expired()
		st = 5600
	End If


	' SKULL SCENE 2 (nuke town) ends with a nuke explosion in all circumstances - drain, time out, win...


	' SKULL SCENE 3...mind control
	If (ModeName = "SScene3") Then
		SceneSkullComplete()
		Clip = 69: PlayClip()
		Flipped = FALSE
		SkullBulb.Set BulbOff, "10", 150
		PlayMusic 2, "vo_HighestMarks", FALSE, 1, 4300: QuoteBusy = TRUE: QuoteTimer.Set TRUE, 6300
		PlayMusic 3, "Music_Cue17", FALSE, 1, 3800
		PlayMusic 1, "vo_CoverIt"
		WinVal = CrusadeJP(CP) + SceneTotal
		AddScore(CrusadeJP(CP))
		DispDMD1.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deFlip, 2000, FALSE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][bf]" & FormatScore(WinVal*xMarks), deFlip, 2000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 1500, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13]" & FormatScore(WinVal*xMarks), deNone, 1500, TRUE
		
		LightSeqPF.Play SeqBlinking, , 4, 75
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 5000

		RS = 5000: SpinMe_Expired()
		st = 6300
	End If

	' SKULL SCENE 4...skull return
	If (ModeName = "SScene4") Then
		MovieTimer.Set TRUE, 10
		SceneSkullComplete()
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_HighestMarks", FALSE, 1, 900: QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3000
		PlayMusic 1, "Music_Cue12" ' 17-- ms
		WinVal = CrusadeJP(CP) + SceneTotal
		AddScore(CrusadeJP(CP))
		DispDMD1.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][yc]SCENE COMPLETE", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][b]" & FormatScore(WinVal*xMarks), deFlip, 1500, TRUE
		DispDMD2.QueueText "[edge3][f2][y4]SCENE TOTAL[f6][xc][y13][b]" & FormatScore(WinVal*xMarks), deFlip, 1500, TRUE
		
		LightSeqPF.Play SeqBlinking, , 4, 75
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 2000
		
		RS = 3100: SpinMe_Expired()
		st = 3000
	End If

	If (PlaneOn = TRUE) Then PlaneOn = FALSE:	PropStop.Set TRUE, 500 ' stop the plane toy propellor, it might actually fly off the playfield...

	SceneCheck()
	BulbFS.State = BulbOff: LightFS.State = BulbOff
	LightCrusade.State = BulbOff
	LightDoom.State = BulbOff
	LightArk.State = BulbOff
	LightSkull.Set BulbOff, "10", 125
	LightOrbitR.State = BulbOff
	LightOrbitL.State = BulbOff
	NaziTgt = FALSE
	StartRovingLights.Enabled = FALSE
	StartRovingINDYJONES.Enabled = FALSE
	ModeName = ""
	'LightSeqPF.Play SeqBlinking, , 4, 100
	'PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1000
	'BulbArkL.FlashForMs 1000, 75, BulbOff
	'BulbArkR.FlashForMs 1000, 75, BulbOff
	'FlasherRed.FlashForMs 1000, 75, BulbOff
	RestartMusic.Set TRUE, ST
	FlushDMDTimer.Set TRUE, RS
End Sub





' NOT USED...YET...

Sub StartRaidersFinal()
	jackpotanim = FALSE
	LightSeqPF.play seqalloff
	FlushDMDTimer.set FALSE
	rjackpothits = 7
	rJackpotHitsLeft = 100
	Magnet.Collidable = TRUE
	ScoreUpdate = FALSE
	stopmusic 1
	LightCrusade.State = BulbOff
	LightDoom.State = BulbOff
	LightArk.State = BulbOff
	LightSkull.State = BulbOff
	LightOrbitR.State = BulbOff
	LightOrbitL.State = BulbOff
	LightRaidersMain.State = BulbOn
	ArkHitsRemain(CP) = 8
	bulb5.State = BulbBlink
	bulb6.State = BulbBlink
	bulb7.State = BulbBlink
	bulb8.State = BulbBlink
	bulb9.State = BulbBlink
	bulb10.State = BulbBlink
	BulbArkL.State = BulbBlink
	bulb12.State = BulbBlink
	bulb13.State = BulbBlink
	bulb14.State = BulbBlink
	bulb15.State = BulbBlink
	bulb16.State = BulbBlink
	bulb17.State = BulbBlink
	bulb18.State = BulbBlink
	BulbArkR.State = BulbBlink
	bulb4.State = BulbBlink
	flasheroff.set TRUE, 13000
	delayark.set TRUE,16000
	ModeName = "rfinal"
	bMultiBallMode = TRUE
End Sub


' NOT USED

Sub RFinalJackpot()

	JPScore = RaidersJP(CP)
	rJackpotHitsLeft = rJackpotHitsLeft - 1
	If (rJackpotHitsLeft = 0) Then
		jackpotanim = TRUE
		jpscore = RaidersJP(CP)*5
		DispDMD1.FlushQueue: DispDMD2.FlushQueue
		DispDMD1.QueueText "[edge3][f4][xc][yc]" & formatscore(jpscore*xmarks), deNone, 2000, TRUE
		DispDMD2.QueueText "[edge3][f4][xc][yc]" & formatscore(jpscore*xmarks), deNone, 2000, TRUE
		AddScore(jpscore)
		SpotBulbLS.FlashForMs 600, 75, BulbOff
		FlasherAmb1.FlashForMs 600, 75, BulbOff
		SpotBulbRS.FlashForMs 600, 75, BulbOff
		FlasherAmb2.FlashForMs 600, 75, BulbOff
		PlaySound "fx_Lightning"
		ClearSeq()
		LightSeqPF.Play SeqAllOff
		PlasDarkOn(): ArkFlashTimer.Set TRUE, 800
		ModeName = "rfinal"
		rjackpothits = rjackpothits + 1
		LightArk.State = BulbOff
		rJackpotHitsLeft = rjackpothits
	Exit Sub
	End If
	If jackpotanim = FALSE then
		jackpotanim = TRUE
	End If
	DispDMD1.FlushQueue: DispDMD2.FlushQueue
	DispDMD1.QueueText "[edge3][f4][xc][yc]" & formatscore(jpscore*xmarks), deNone, 2000, TRUE
	DispDMD2.QueueText "[edge3][f4][xc][yc]" & formatscore(jpscore*xmarks), deNone, 2000, TRUE
	AddScore(jpscore)
	SpotBulbLS.FlashForMs 600, 75, BulbOff
	FlasherAmb1.FlashForMs 600, 75, BulbOff
	SpotBulbRS.FlashForMs 600, 75, BulbOff
	FlasherAmb2.FlashForMs 600, 75, BulbOff
	PlaySound "fx_Lightning"
	ClearSeq()
	LightSeqPF.Play SeqAllOff
	PlasDarkOn(): ArkFlashTimer.Set TRUE, 800
	ModeName = "rfinal"
	LightArk.State = BulbBlink
End Sub


' NOT USED

Sub RaidersBonus()
	ArkHitsRemain(CP) = 8
	JPScore = RaidersJP(CP)*5
	If (ScoreUpdate = TRUE) Then
		DispDMD1.Text = "[edge3][f4][xc][yc]" & formatscore(jpscore*xmarks)
		DispDMD2.Text = "[edge3][f4][xc][yc]" & formatscore(jpscore*xmarks)
		FlushDMDTimer.set TRUE ,1500
	End If
	AddScore(jpscore)
End Sub




' *********************************************
' **                                         **
' **             THE SANKARA STONE           **
' **                                         **
' *********************************************

' Hitting the captive ball beneath the Sankara Stone toy, will eventually reveal a hidden hole.
' For Scenes 1,2 and 3, when the hole is revealed, shooting it will start the next scene.
' For Scene 4, 3 shots to the hole are needed to start the final scene.

' Collect the 3 Sankara Stones to ready the next Temple of Doom Scenes (Scene 4 only).

' Scene 1: Shaghai - grab the antidote...and the diamond, then escape.
' Scene 2: Plane Crash - grab the raft and jump from the plane.
' Scene 3: Mine Cart - make the leaps and turns while shooting the bad guys. 
' Scene 4: Rope Bridge - hack the bridge then grab the last remaining stone.

' Epilogue: Return the stone to the villiage and kiss the girl.


Sub StoneTarget_Hit()
	PlaySound "BBHit"

	If (fpTilted = TRUE) Then Exit Sub

	PlaySound "fx_4"
	StoneBulb8.FlashForMs 200, 200, BulbOff
	LightSeqPF.Play SeqBlinking, , 1, 100

	If (BonusBall = TRUE) Then
		If (LightDoom.State = BulbOff) Then Exit Sub
		BBTotal(CP) = BBTotal(CP) + BBVal(CP)
		ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1000
		DispDMD1.Text = "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(BBVal(CP))
		DispDMD2.Text = "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(BBVal(CP))
		TempleHit = TempleHit + 1
		Select Case TempleHit
			Case 1: LightDoomS1.State = BulbOn
			Case 2: LightDoomS2.State = BulbOn
			Case 3: LightDoomS3.State = BulbOn
			Case 4: LightDoomS4.State = BulbOn
			Case 5: LightDoomMain.State = BulbOn: BBTotal(CP) = BBTotal(CP) + 350000: LightDoom.State = BulbOff
				MusicFade(1000): PlayMusic 3, "Music_Cue14"
				Flash = 0: FlashPFTimer.Set TRUE, 75
				DispDMD1.Text = "[edge3][f4][y3][bf]MOVIE COMPLETE[y17]COMPLETE"
				DispDMD2.Text = "[edge3][f4][y3][bf]MOVIE COMPLETE[y17]COMPLETE"
		End Select
	Exit Sub
	End If

	TempleHit = TempleHit + 1 ' for the end of ball bonus...

	If (ModeName = "RScene4") Then RaidersHit():	Exit Sub

	If (LightDoom.State = BulbBlink) Then

		If (ModeName = "TScene1") Then
			GetAntidote()
		Exit Sub
		End If

		If (ModeName = "TScene2") Then
			PlaySound "fx_4"
		Exit Sub
		End If

		' get in the fridge...
		If (ModeName = "SScene2") Then
			PlaySound "fx_IdolMove"
			TempleOpen = TRUE: Captive.Rotateyz 30,20
			DropTimer.Set TRUE, 800 ' block the chamber as it opens...
			ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
			DispDMD1.QueueText "[edge3][f4][y3]GET INSIDE[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][y3]GET INSIDE[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			SceneHit()
			Clip = 42: PlayClip()
			BulbFS.State = BulbOff: LightFS.State = BulbOff ' next hit will complete the scene, so no more FREE SHOTS...
		Exit Sub
		End If

		' chosen wisely...
		If (ModeName = "CScene4") Then
			LightDoomExt.SetLitColor 255, 0, 0
			LightDoom.State = BulbOn
			CheckChooseLights()
		Exit Sub
		End If

		' dogfight CRUSADE SCENE 2...
		If (ModeName = "CScene2") Then
			'LightDoom.State = BulbOff
			If (MovieTimer.Enabled = FALSE) Then
				NoS()
				OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100
				LCD.Frame 591,592,591: OverlayLCD.Frame 591,592,591: MovieTimer.Set TRUE, 1000
			End If
			DogFightHit()
			PlaySound "fx_PlaneShoot4"
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1000
			BulbArkL.FlashForMs 1000, 75, BulbOff
			BulbArkR.FlashForMs 1000, 75, BulbOff
			FlasherRed.FlashForMs 1000, 75, BulbOff
			LightSeqPF.Play SeqBlinking, , 7, 75
		Exit Sub
		End If

		' tank CRUSADE shot...
		If (ModeName = "CScene3") Then
			TankHit()
		Exit Sub
		End If

		' mind control SKULL SCENE 3...
		If (ModeName = "SScene3") Then
			LightDoom.State = BulbOff
			SkullPowerHit()
		Exit Sub
		End If

		If (ModeName = "SScene4") Then
			LightDoom.State = BulbOff
			ModeHit = ModeHit + 1
			If (ModeHit = 4) Then EndMode(): Exit Sub
			ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
			DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			SceneHit()
			MusicFade(1000): PlayMusic 3, "Music_Cue3"
			LightSeqPF.Play SeqBlinking, , 3, 75
			Flash = 0: FlashPFTimer.Set TRUE, 75
		Exit Sub
		End If

	Else

		If (ModeName = "TScene1") and (Antidote = FALSE) Then
			If (MovieTimer.Enabled = FALSE) Then
				Clip = 37: PlayClip() ' Indy goes for Anitode, knocks it off table...
			End If
		Exit Sub
		End If

		' choose poorly...
		If (ModeName = "CScene4") Then
			ChooseEnd()
		Exit Sub
		End If
	End If

	If (ModeName = "") Then ' no mode is running...
		AddScore(5000)
		StoneHitsRemain(CP) = StoneHitsRemain(CP) - 1 ' number of hits remaining to open the chamber...

		If (StoneHitsRemain(CP) =< 0) Then ' the chamber will now open...

			OpenChamber(): LightTempleOfDoom.State = BulbBlink

			NoS(): OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100: OverlayLCD.Frame 201,205,201: LCD.Frame 201,205,201: MovieTimer.Set TRUE, 2000

			RestartMusic.Enabled = FALSE
			If (ScoreUpdate = TRUE) Then
				ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1200
				DispDMD1.QueueText "[edge3][f4][xc][y4][bf]TEMPLE OF DOOM[f5][xc][y18]SCENE READY", deNone, 1200, FALSE
				DispDMD2.QueueText "[edge3][f4][xc][y4][bf]TEMPLE OF DOOM[f5][xc][y18]SCENE READY", deNone, 1200, FALSE
			End If
			' scene 1 is ready...
			If (LightDoomS1.State = BulbBlink) Then
				If (QuoteBusy = FALSE) Then
					QuoteBusy = TRUE
					Select Case RandomNumber(3)
						Case 1: MusicFade(2600): PlayMusic 2, "vo_Famous"
						Case 2: MusicFade(4000): PlayMusic 2, "vo_EyesOffMe2", FALSE, 0.7
						Case 3: MusicFade(4000): PlayMusic 2, "vo_FunnyMen"
					End Select
				End If
			End If
			' scene 2 is ready...
			If (LightDoomS2.State = BulbBlink) Then
				If (QuoteBusy = FALSE) Then
					QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1500
					MusicFade(2000)
					Select Case RandomNumber(2)
						Case 1: PlayMusic 2, "vo_TagAlong"
						Case 2: PlayMusic 2, "vo_LionTamer"
					End Select
				End If
			End If
			' scene 3 is ready...
			If (LightDoomS3.State = BulbBlink) Then
				If (QuoteBusy = FALSE) Then
					QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1500
					MusicFade(1500)
					PlayMusic 2, "vo_HangOnRide" 
				End If
			End If
			' scene 4 is ready...
			If (LightDoomS4.State = BulbBlink) Then
				If (QuoteBusy = FALSE) Then
					QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2000
					Select Case RandomNumber(5)
						Case 1: PlayMusic 2, "vo_RightHere": MusicFade(2000)
						Case 2: PlayMusic 2, "vo_Molarram": MusicFade(600): Clip = 59: PlayClip()
						Case 3: PlayMusic 2, "vo_Molarram2": MusicFade(600): Clip = 59: PlayClip()
						Case 4: PlayMusic 2, "vo_ShankaraStone":MusicFade(3000)
						Case 5: PlayMusic 2, "vo_SacredStone": MusicFade(3000)
					End Select
				End If
			End If
		Else
			
			If (ScoreUpdate = TRUE) Then
				ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1000
				DispDMD1.Text = "[edge3][f2][xc][y4]TEMPLE OPEN IN[y14][f6]" & StoneHitsRemain(CP) & " HITS"
				DispDMD2.Text = "[edge3][f2][xc][y4]TEMPLE OPEN IN[y14][f6]" & StoneHitsRemain(CP) & " HITS"
			End If
			
			If (MovieTimer.Enabled = FALSE) Then
				Select Case StoneHitsRemain(CP)
					Case 1: NoS(): OverlayLCD.Frame 7: LCD.Frame 7: MovieTimer.Set TRUE, 1200 ' 1 hit left..
					Case 2: Nos(): OverlayLCD.Frame 8: LCD.Frame 8: MovieTimer.Set TRUE, 1200 ' 2 hits left..
					Case 3: Nos(): OverlayLCD.Frame 9: LCD.Frame 9: MovieTimer.Set TRUE, 1200 ' 3 hits left..
					Case 4: NoS(): OverlayLCD.Frame 10: LCD.Frame 10: MovieTimer.Set TRUE, 1200 ' 4 hits left..
					Case 5: NoS(): OverlayLCD.Frame 199: LCD.Frame 199: MovieTimer.Set TRUE, 1200 ' 5 hits left..
					Case 6: NoS(): OverlayLCD.Frame 200: LCD.Frame 200: MovieTimer.Set TRUE, 1200 ' 6 hits left..
				End Select
			End If

			If (LightDoomS4.State = BulbBlink) Then
				If (QuoteBusy = FALSE) Then
					QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3000
					Select Case StoneHitsRemain(CP)
						Case 1: PlayMusic 2, "vo_NotLeaving": MusicFade(3000)
						Case 2: 
					End Select
				End If
			End If
		End If
	Else
		' when a movie mode is running, the stone is temporarily deactivated for Temple of Doom progress, so just
		' increase the movie jackpots with each hit...
		AdvMovieJP()
	End If
	set LastSwitchHit = StoneTarget
End Sub



Sub AdvMovieJP()
	' any RAIDRS scene...
	If (ModeName="RScene1")or(ModeName="RScene2")or(ModeName="RScene3")or(ModeName="RScene4")Then
		RaidersJP(CP) = RaidersJP(CP) + 5000
		If (ScoreUpdate = TRUE) Then
			FlushDMDTimer.Set TRUE, 800
			DispDMD1.Text = "[edge3][f2][xc][y4]RAIDERS JP GROWS[y14][f6]" & FormatScore(RaidersJP(CP))
			DispDMD2.Text = "[edge3][f2][xc][y4]RAIDERS JP GROWS[y14][f6]" & FormatScore(RaidersJP(CP))
		End If
	End If
	' any TEMPLE scene...
	If (ModeName="TScene1")or(ModeName="TScene2")or(ModeName="TScene3")or(ModeName="TScene4")Then
		TempleJP(CP) = TempleJP(CP) + 5000
		If (ScoreUpdate = TRUE) Then
			FlushDMDTimer.Set TRUE, 800
			DispDMD1.Text = "[edge3][f2][xc][y4]TEMPLE JP GROWS[y14][f6]" & FormatScore(TempleJP(CP))
			DispDMD2.Text = "[edge3][f2][xc][y4]TEMPLE JP GROWS[y14][f6]" & FormatScore(TempleJP(CP))
		End If
	End If
	' any CRUSADE scene...
	If (ModeName="CScene1")or(ModeName="CScene2")or(ModeName="CScene3")or(ModeName="CScene4")Then
		CrusadeJP(CP) = CrusadeJP(CP) + 5000
		If (ScoreUpdate = TRUE) Then
			FlushDMDTimer.Set TRUE, 800
			DispDMD1.Text = "[edge3][f2][xc][y4]CRUSADE JP GROWS[y14][f6]" & FormatScore(CrusadeJP(CP))
			DispDMD2.Text = "[edge3][f2][xc][y4]CRUSADE JP GROWS[y14][f6]" & FormatScore(CrusadeJP(CP))
		End If
	End If
	' any SKULL scene...
	If (ModeName="SScene1")or(ModeName="SScene2")or(ModeName="SScene3")or(ModeName="SScene4")Then
		SkullJP(CP) = SkullJP(CP) + 5000
		If (ScoreUpdate = TRUE) Then
			FlushDMDTimer.Set TRUE, 800
			DispDMD1.Text = "[edge3][f2][xc][y4]SKULL JP GROWS[y14][f6]" & FormatScore(SkullJP(CP))
			DispDMD2.Text = "[edge3][f2][xc][y4]SKULL JP GROWS[y14][f6]" & FormatScore(SkullJP(CP))
		End If
	End If
End Sub



Sub ReturnToStone_Expired()
	ReturnToStone.Enabled = FALSE
	IgnoreMe = TRUE
	StoneKicker_Hit()
End Sub



Sub StoneKicker_Hit()

	If (IgnoreMe = FALSE) Then PlaySound "fx_ScoopHit"

	IgnoreMe = FALSE

	If (LightDoom.State = BulbBlink) Then
		If (ModeName = "TScene1") Then
			GetAntidote()
		Exit Sub
		End If

		' ** NOT USED **
		If (ModeName = "TScene2") Then
			BallFromStone = TRUE
			StoneKicker.Destroyball: DeleteTrackedBall(StoneKicker)
			GrailKicker.CreateBall: AddTrackedBall(GrailKicker)
			CloseChamber()
			GrailKickerTimer.Set TRUE, 2000
			EndMode()
		Exit Sub
		End If

		' grabbed the Sankara Stone to finish the scene...
		If (ModeName = "TScene4") Then
			BallFromStone = TRUE
			StoneKicker.Destroyball: DeleteTrackedBall(StoneKicker)
			GrailKicker.CreateBall: AddTrackedBall(GrailKicker)
			CloseChamber()
			EndMode()
		Exit Sub
		End If

		' got in the fridge and survived the nuke...
		If (ModeName = "SScene2") Then
			EndMode()
		Exit Sub
		End If
	End If

	If (ModeName = "TScene1") and (Antidote = FALSE) Then
		If (MovieTimer.Enabled = FALSE) Then
			Clip = 37: PlayClip() ' Indy goes for Anitode, knocks it off table...
		End If
	Exit Sub
	End If

	If (ModeName = "CScene4") Then
		If (LightDoom.State = BulbBlink) Then
			LightDoomExt.SetLitColor 255, 0, 0
			LightDoom.State = BulbOn
			CheckChooseLights()
			BallFromStone = TRUE
			StoneKicker.Destroyball: DeleteTrackedBall(StoneKicker)
			GrailKicker.CreateBall: AddTrackedBall(GrailKicker)
			CloseChamber()
			GrailKickerTimer.Set TRUE, 2500
		Exit Sub
		Else
			ChooseEnd()
			BallFromStone = TRUE
			StoneKicker.Destroyball: DeleteTrackedBall(StoneKicker)
			GrailKicker.CreateBall: AddTrackedBall(GrailKicker)
			CloseChamber()
			GrailKickerTimer.Set TRUE, 2000
		End If
	Exit Sub
	End If

	If (HurryUpMode = TRUE) Then
		PlayMusic 1, "Music_Cue2"
		PlaySound "fx_Snake", 0.8
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_Indy4"
		HurryUpMode = FALSE
		RatsTimer1.Enabled = FALSE
		RatsTimer2.Enabled = FALSE
		RatsEndTimer.Enabled = FALSE
		AntsTimer1.Enabled = FALSE
		AntsTimer2.Enabled = FALSE
		AntsEndTimer.Enabled = FALSE
		SnakesTimer1.Enabled = FALSE
		SnakesTimer2.Enabled = FALSE
		SnakesEndTimer.Enabled = FALSE
		LightOrbitL.State = BulbOff
		LightOrbitR.State = BulbOff
		ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		DispDMD1.QueueText "[edge3][f6][xc][yc]YOU HAVE FAILED", deNone, 1500, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][yc]YOU HAVE FAILED", deNone, 1500, TRUE
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1200
		ReturnToStone.Set TRUE, 1500
		Snakes = FALSE
		Ants = FALSE
		Rats = FALSE
	Exit Sub
	End If

	' Temple SCENE 4 collects a Sankara Stone...
	If (LightDoomS4.State = BulbBlink) Then
		CollectStone()
	End If

	LightDoom.State = BulbOff ' arrow...
	DoomTimer.Enabled = FALSE
	
	If (BallFromStone = FALSE) Then
		BallFromStone = TRUE
		StoneKicker.DestroyBall: DeleteTrackedBall(StoneKicker)
		GrailKicker.CreateBall: AddTrackedBall(GrailKicker)
		CloseChamber()
		If (ModeName = "") Then
			StopMusic 1
			If (LightDoomS1.State = BulbBlink) Then StartTempleScene(): Exit Sub
			If (LightDoomS2.State = BulbBlink) Then StartTempleScene(): Exit Sub
			If (LightDoomS3.State = BulbBlink) Then StartTempleScene(): Exit Sub
			'If (LightDoomS4.State = BulbBlink) Then StartTempleScene(): Exit Sub
		Else
			If (StartTempleSceneDelay.Enabled = FALSE) Then GrailKickerTimer.Set TRUE, 500
		End If
	End If
End Sub



' only collect the stones if scene 4 is blinking...

Sub CollectStone()
	StonesCollected(CP) = StonesCollected(CP) + 1
	If (StonesCollected(CP) = 4) Then
		StartTempleScene()
	Else
		LightSeqPF.Play SeqBlinking, , 5, 50
		PlasDarkOn(): Flash = 0: FlashPFTimer.Set TRUE, 100
		PlaySound "fx_StoneCollect", 0.8
		Select Case StonesCollected(CP)
			Case 1:
				Select Case RandomNumber(2)
					Case 1: PlayMusic 2, "vo_MissingTwo", FALSE, 0.8, 800: RestartMusic.Set TRUE, 2300: GrailKickerTimer.Set TRUE, 2000
					Case 2: PlayMusic 2, "vo_OneStones", FALSE, 1, 1000: RestartMusic.Set TRUE, 2300: GrailKickerTimer.Set TRUE, 2300
				End Select
				NoS(): OverlayLCD.Frame 3,4,3: LCD.Frame 3,4,3: MovieTimer.Set TRUE, 2000
				DispDMD1.QueueText "[edge3][f3][xc][y4]STONE[f6][xc][y14]COLLECTED", deNone, 1200, FALSE
				DispDMD2.QueueText "[edge3][f3][xc][y4]STONE[f6][xc][y14]COLLECTED", deNone, 1200, FALSE
				DispDMD1.QueueText "[edge3][f3][xc][y4][b]2 STILL[f6][xc][y14]MISSING", deNone, 1500, TRUE
				DispDMD2.QueueText "[edge3][f3][xc][y4][b]2 STILL[f6][xc][y14]MISSING", deNone, 1500, TRUE
				ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2700
			Case 2:
				NoS(): OverlayLCD.Frame 4,5,4: LCD.Frame 4,5,4: MovieTimer.Set TRUE, 2000
				StoneDisplayTimer.Set TRUE, 400
				DispDMD1.QueueText "[edge3][f3][xc][y4]2 STONES[f6][xc][y14]COLLECTED", deNone, 1200, FALSE
				DispDMD2.QueueText "[edge3][f3][xc][y4]2 STONES[f6][xc][y14]COLLECTED", deNone, 1200, FALSE
				DispDMD1.QueueText "[edge3][f3][xc][y4][b]1 STILL[f6][xc][y14]MISSING", deNone, 1500, TRUE
				DispDMD2.QueueText "[edge3][f3][xc][y4][b]1 STILL[f6][xc][y14]MISSING", deNone, 1500, TRUE
				ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2700
			Case 3:
			
				' ** ADD CLIP OF INDY BRINGING STONES TOGETHER SHOWING THEM GLOW **

				FlushDMDTimer.Enabled = FALSE
				NoS(): OverlayLCD.Frame 5,6,5: LCD.Frame 5,6,5
				PlayMusic 3, "vo_Glow", FALSE, 1, 1000 ' there may be a quote playing so use a different channel for this quote...
				ReturnToStone.Set TRUE, 4300
				DispDMD1.Text = "[edge3][f3][xc][y4]ALL STONES[f6][xc][y14]COLLECTED"
				DispDMD2.Text = "[edge3][f3][xc][y4]ALL STONES[f6][xc][y14]COLLECTED"
		End Select
	End If
End Sub



Sub StoneDisplayTimer_Expired()
	dim tt
	StoneDisplayTimer.Enabled = FALSE
	If (QuoteBusy = FALSE) Then
		StoneQ = StoneQ + 1
		Select Case StoneQ
			Case 1: PlayMusic 2, "vo_FindStone": tt = 3300
			Case 2: PlayMusic 2, "vo_NotToday": tt = 4000
			Case 3: PlayMusic 2, "vo_BroughtYouHere": tt = 2500
			Case 4: PlayMusic 2, "vo_AllPowerful": tt = 4300
			Case 5: PlayMusic 2, "vo_DeadPeople": tt = 3000: StoneQ = 0
		End Select
		RestartMusic.Set TRUE, tt: GrailKickerTimer.Set TRUE, tt
	Else
		RestartMusic.Set TRUE, 1000: GrailKickerTimer.Set TRUE, 1000
	End If
	AddScore(125000)
End Sub



Sub StartTempleScene()
	'BulbMystery.State = BulbOff
	LightLastCrusade.State = BulbOff
	LightRaidersArk.State = BulbOff
	LightCrystalSkull.State = BulbOff
	SceneTotal = 200000: SceneVal = 210000 ' start value for the first shot...
	AddScore(200000)
	RampSkullOff()
	FlashPFTimer.Enabled = FALSE
	PlasDarkOn()
	ScoreUpdate = TRUE: FlushDMDTimer.Enabled = FALSE
	If (FreeShot(CP) =>1) Then BulbFS.State = BulbBlink: LightFS.State = BulbBlink
	If (LightDoomS4.State = BulbBlink) Then StartTOD4()
	If (LightDoomS3.State = BulbBlink) Then StartTOD3()
	If (LightDoomS2.State = BulbBlink) Then StartTOD2()
	If (LightDoomS1.State = BulbBlink) Then StartTOD1()
End Sub



' *************************************************
' **                                             **
' **          TEMPLE OF DOOM - SCENE 1           **
' **                                             **
' *************************************************

' In Club Obi Wan, Indy gets into a bit of trouble with local Chinese businessman Lau Che.

' This scene has 3 parts:

' - get the ANTIDOTE by shooting the roving ARROW shot
' - get the DIAMOND by shooting the roving INDY JONES shot
' - shoot the ramp to escape the club and again to take off in the plane

' ** MEDIA NEEDED **

' - clips of club henchmen firing machine guns at indy for any missed shot
' - clip of Indy falling from club into Short Round's taxi (first ramp hit)
' - clip of chase in car (second ramp hit)
' - clip of 'Nice try Lau Che' (END)


Sub StartTOD1()
	ModeName = "TScene1"
	TempleNeeded(CP) = TempleNeeded(CP) + 1: StoneHitsRemain(CP) = TempleNeeded(CP)

	StopHurryUps(): StopFastScoring()

	SlingStop = TRUE

	If (CairoSwordsman = TRUE) Then StopSwordsman()

	StopMusic 1

	Antidote = FALSE
	Diamond = FALSE
	ModeHit = 0

	If (FreeShot(CP) =>1) Then BulbFS.State = BulbBlink: LightFS.State = BulbBlink

	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 4000
	Clip = 20: PlayClip()
	
	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 4500
	DispDMD1.QueueText "[edge6][xc][yc][f6]THE ANTIDOTE", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge6][xc][yc][f6]THE ANTIDOTE", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f4][y3]SHOOT LIT ARROW[y17][bf]GRAB THE ANTIDOTE", deFlip, 1500, FALSE
	DispDMD2.QueueText "[edge3][f4][y3]SHOOT LIT ARROW[y17][bf]GRAB THE ANTIDOTE", deFlip, 1500, FALSE
	DispDMD1.QueueText "[edge3][f4][y3]SHOOT LIT TARGET[y17][bf]GRAB THE DIAMOND", deFlip, 2000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3]SHOOT LIT TARGET[y17][bf]GRAB THE DIAMOND", deFlip, 2000, TRUE

	LightCrusade.State = BulbOff
	LightDoom.State = BulbOff
	LightArk.State = BulbOff
	LightSkull.State = BulbOff
	LightOrbitR.State = BulbOff
	LightOrbitL.State = BulbOff

	' save the state of the INDY JONES lights, we're going to use them for the diamond...
	TempL1 = LightINDY1.State
	TempL2 = LightINDY2.State
	TempL3 = LightINDY3.State
	TempL4 = LightINDY4.State
	TempL5 = LightJONES1.State
	TempL6 = LightJONES2.State
	TempL7 = LightJONES3.State
	TempL8 = LightJONES4.State
	TempL9 = LightJONES5.State

	' and now turn them all off...and start the roving shot...
	LightINDY1.State = BulbOff
	LightINDY2.State = BulbOff
	LightINDY3.State = BulbOff
	LightINDY4.State = BulbOff
	LightJONES1.State = BulbOff
	LightJONES2.State = BulbOff
	LightJONES3.State = BulbOff
	LightJONES4.State = BulbOff
	LightJONES5.State = BulbOff

	RotateL2 = 0

	' start on a random light...
	Select Case RandomNumber(5)
		Case 1: RotateL = 0
		Case 2: RotateL = 1
		Case 3: RotateL = 2
		Case 4: RotateL = 3
		Case 5: RotateL = 4
	End Select

	StartRovingINDYJONES.Set TRUE, 5000 ' rotate the INDY JONES inserts...
	StartRovingLights.Set TRUE, 5000 ' rotate the main shot arrows....

	HurryTime = 35: ModeTimer.Set TRUE, 4700

	' allow the intro to play first to set the scene, then eject the ball into play...
	StartTempleSceneDelay.Set TRUE, 4700
End Sub



Sub StartTempleSceneDelay_Expired()
	StartTempleSceneDelay.Set FALSE
	BallFromStone = FALSE
	GrailKickerTimer_Expired()
	SlingStop = FALSE
	RestartMusic.Set TRUE, 100
	LightSeqPF.StopPlay
	SpotOn(0)
	bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, BSTime(CP): ShootAgainLight.State = BulbBlink
End Sub



Sub StartRovingLights_Expired()
	RotateL = RotateL + 1
	Select Case RotateL
		Case 1:
			LightOrbitR.State = BulbOff
			LightCrusade.State = BulbBlink
		Case 2:
			LightCrusade.State = BulbOff
			LightOrbitL.State = BulbBlink
		Case 3:
			LightOrbitL.State = BulbOff
			LightDoom.State = BulbBlink
		Case 4:
			LightDoom.State = BulbOff
			LightArk.State = BulbBlink
		Case 5:
			LightArk.State = BulbOff
			LightSkull.State = BulbBlink
		Case 6:
			LightSkull.State = BulbOff
			LightOrbitR.State = BulbBlink
		Case 7:
			LightOrbitR.State = BulbOff
			LightSkull.State = BulbBlink
		Case 8:
			LightSkull.State = BulbOff
			LightArk.State = BulbBlink
		Case 9:
			LightArk.State = BulbOff
			LightDoom.State = BulbBlink
		Case 10:
			LightDoom.State = BulbOff
			LightOrbitL.State = BulbBlink
		Case 11:
			LightOrbitL.State = BulbOff
			LightCrusade.State = BulbBlink
			RotateL = 1
	End Select
End Sub



Sub StartRovingINDYJONES_Expired()
	RotateL2 = RotateL2 + 1
	Select Case RotateL2
		Case 1:
			LightJONES5.State = BulbOff
			LightINDY1.State = BulbBlink
		Case 2:
			LightINDY1.State = BulbOff
			LightINDY2.State = BulbBlink
		Case 3:
			LightINDY2.State = BulbOff
			LightINDY3.State = BulbBlink
		Case 4:
			LightINDY3.State = BulbOff
			LightINDY4.State = BulbBlink
		Case 5:
			LightINDY4.State = BulbOff
			LightJONES1.State = BulbBlink
		Case 6:
			LightJONES1.State = BulbOff
			LightJONES2.State = BulbBlink
		Case 7:
			LightJONES2.State = BulbOff
			LightJONES3.State = BulbBlink
		Case 8:
			LightJONES3.State = BulbOff
			LightJONES4.State = BulbBlink
		Case 9:
			LightJONES4.State = BulbOff
			LightJONES5.State = BulbBlink
			RotateL2 = 0
	End Select
End Sub


Sub GetDiamond()
	StartRovingINDYJONES.Enabled = FALSE
	' revert the INDY JONES targets to their previous state....Fast Scoring can now continue....
	LightINDY1.State = TempL1 
	LightINDY2.State = TempL2 
	LightINDY3.State = TempL3 
	LightINDY4.State = TempL4 
	LightJONES1.State = TempL5
	LightJONES2.State = TempL6 
	LightJONES3.State = TempL7 
	LightJONES4.State = TempL8
	LightJONES5.State = TempL9
	Diamond = TRUE
	HurryTime = HurryTime + 8
	MusicFade(1600)
	PlaySound "fx_GetItem"
	PlayMusic 2, "vo_TheDiamond", FALSE, 1, 600
	NoS(): OverlayLCD.UpdateInterval = 150: LCD.UpdateInterval = 150
	OverlayLCD.Frame 93,94,93: LCD.Frame 93,94,93: MovieTimer.Set TRUE, 2000
	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1200
	DispDMD1.QueueText "[edge3][f4][y3]GOT THE DIAMOND[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
	DispDMD2.QueueText "[edge3][f4][y3]GOT THE DIAMOND[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
	SceneHit()
	LightSeqPF.Play SeqBlinking, , 1, 500
	Flash = 0: FlashPFTimer.Set TRUE, 75
	If (Antidote = TRUE) Then 
		StartPlane.Set TRUE, 500
		LightSkull.State = BulbBlink
		BulbFS.State = BulbOff: LightFS.State = BulbOff ' turn off Free Shot, can't be used for last shot to win mode...
		FlushDMDTimer.Set TRUE, 3200
		DispDMD1.QueueText "[edge3][f3][xc][y3]SHOOT RAMP TO[f6][y13][bf]ESCAPE IN PLANE", deFlip, 2000, TRUE
		DispDMD2.QueueText "[edge3][f3][xc][y3]SHOOT RAMP TO[f6][y13][bf]ESCAPE IN PLANE", deFlip, 2000, TRUE
	End If
End Sub


Sub GetAntidote()
	LightSeqPF.Play SeqBlinking, , 3, 75
	Flash = 0: FlashPFTimer.Set TRUE, 75
	StartRovingLights.Enabled = FALSE
	LightCrusade.State = BulbOff
	LightDoom.State = BulbOff
	LightArk.State = BulbOff
	LightSkull.State = BulbOff
	LightOrbitR.State = BulbOff
	LightOrbitL.State = BulbOff
	OverlayLCD.UpdateInterval = 150
	NoS(): OverlayLCD.Frame 91,92,91: LCD.Frame 91,92,91: MovieTimer.Set TRUE, 2000
	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1200
	DispDMD1.QueueText "[edge3][f4][y3]GOT THE ANTIDOTE[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
	DispDMD2.QueueText "[edge3][f4][y3]GOT THE ANTIDOTE[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
	SceneHit()
	MusicFade(1600)
	PlayMusic 2, "vo_Antidote3", FALSE, 1, 600
	PlayMusic 3, "Music_Cue3"
	Antidote = TRUE:
	HurryTime = HurryTime + 8
	If (Diamond = TRUE) Then
		StartPlane.Set TRUE, 500
		LightSkull.State = BulbBlink
		BulbFS.State = BulbOff: LightFS.State = BulbOff ' turn off Free Shot, can't be used for last shot to win mode...
		FlushDMDTimer.Set TRUE, 3200
		DispDMD1.QueueText "[edge3][f3][xc][y3]SHOOT RAMP TO[f6][y13][bf]ESCAPE IN PLANE", deFlip, 2000, TRUE
		DispDMD2.QueueText "[edge3][f3][xc][y3]SHOOT RAMP TO[f6][y13][bf]ESCAPE IN PLANE", deFlip, 2000, TRUE
	End If
End Sub



' *************************************************
' **                                             **
' **          TEMPLE OF DOOM - SCENE 2           **
' **                                             **
' *************************************************

' after escaping the Obi Wan club in the plane, the pilots jump out leaving the plane to crash.

' - shoot the Ark to grab the raft.
' - shoot the ramp to jump out of the plane on the raft.

' ** FUTURE UPDATE **

' - shoot the bumpers to navigate through the rapids.

' ** MEDIA NEEDED **

' - clip of raft sliding down mountain then into river
' - clip inside raft, Indy reactions  
' - clip of arrival at Indian villiage and close up of creepy Indian guy (END)


Sub StartTOD2()
	ModeName = "TScene2"
	TempleNeeded(CP) = TempleNeeded(CP) + 1: StoneHitsRemain(CP) = TempleNeeded(CP)

	StopHurryUps(): StopFastScoring()

	SlingStop = TRUE
	QPlay = FALSE

	If (CairoSwordsman = TRUE) Then StopSwordsman()

	If (FreeShot(CP) =>1) Then BulbFS.State = BulbBlink: LightFS.State = BulbBlink

	ScoreUpdate = FALSE
	StopMusic 1

	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2800 
	Clip = 12: PlayClip()

	ModeHit = 0

	StartPlane.Set TRUE, 2500

	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 3000
	DispDMD1.QueueText "[edge3][xc][yc][f6]PLANE JUMP", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]PLANE JUMP", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f4][y3][b]SHOOT ARK TO[y17]GRAB THE RAFT", deFlip, 2000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3][b]SHOOT ARK TO[y17]GRAB THE RAFT", deFlip, 2000, TRUE

	LightCrusade.State = BulbOff
	LightDoom.State = BulbOff
	LightArk.State = BulbOff
	LightSkull.State = BulbOff
	LightOrbitR.State = BulbOff
	LightOrbitL.State = BulbOff

	' for now, just keep it simple, shoot the Ark to grab the raft...
	LightArk.State = BulbBlink

	HurryTime = 30: ModeTimer.Set TRUE, 2800
	StartTempleSceneDelay.Set TRUE, 2800
End Sub



Sub TempleSceneHit()
	If (ModeName = "TScene2") Then
		Select Case ModeHit
			Case 1:
				PlayMusic 3, "Music_Cue3"
				'LightSeqPF.Play SeqBlinking, , 3, 50
				'PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 250
				LightArk.State = BulbOff
				LightSkull.State = BulbBlink			
				ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 3000
				DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1000, FALSE
				DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1000, FALSE
				DispDMD1.QueueText "[edge3][f3][xc][y3]SHOOT RAMP TO[f6][y13]JUMP FROM PLANE", deFlip, 2000, TRUE
				DispDMD2.QueueText "[edge3][f3][xc][y3]SHOOT RAMP TO[f6][y13]JUMP FROM PLANE", deFlip, 2000, TRUE
				SceneHit(): HurryTime = HurryTime + 10
				BulbFS.State = BulbOff: LightFS.State = BulbOff ' turn off Free Shot, can't be used for last shot to win mode...
				NoS(): OverlayLCD.Frame 174,175,174: LCD.Frame 174,175,174: PlayMovie.Set TRUE, 2000
				MusicFade(3400): PlayMusic 2, "vo_WereCrashing2", FALSE, 1, 1000
				QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3400
			Case 2:
				BallHeld = TRUE
				StopIt = TRUE: PopUpLane.SolenoidPulse(5500) ' hold ball on the ramp for a few secs...
				EndMode()
			Case 3:
				' ** NOT USED - LATER UPDATE **
				' now shoot the bumpers to stay on the raft through the rapids...
				LightSkull.State = BulbOff
				ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 3000
				DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1000, FALSE
				DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1000, FALSE
				DispDMD1.QueueText "[edge3][f3][xc][y3]SHOOT BUMPERS TO[f6][y13]NAVIGATE RAPIDS", deFlip, 2000, TRUE
				DispDMD2.QueueText "[edge3][f3][xc][y3]SHOOT BUMPERS TO[f6][y13]NAVIGATE RAPIDS", deFlip, 2000, TRUE
		End Select
	End If
End Sub



' *************************************************
' **                                             **
' **          TEMPLE OF DOOM - SCENE 3           **
' **                                             **
' *************************************************

' Indy, Willie and Shortround are chased in a mine cart.

' The scene has 2 parts:

' - Make the RIGHT ORBIT shot to start multiball (single ball play)
' - Shoot the INDY JONES targets to attack the bad guys
' - Complete INDY or JONES to take out an enemy mine cart and score the JACKPOT
' - Shooting the ramp resets the INDY JONES targets

' Shooting the ramp or orbits will increase the JACKPOT value


' ** MEDIA NEEDED **

' - more general clips of the chase
' - Indy slowing the cart down with his foot (END)


Sub StartTOD3()
	ModeName = "TScene3"
	TempleNeeded(CP) = TempleNeeded(CP) + 1: StoneHitsRemain(CP) = TempleNeeded(CP)

	StopMusic 1

	StopHurryUps(): StopFastScoring()

	SlingStop = TRUE

	If (CairoSwordsman = TRUE) Then StopSwordsman()

	If (FreeShot(CP) =>1) Then BulbFS.State = BulbBlink: LightFS.State = BulbBlink

	NoS(): OverlayLCD.Frame 184: LCD.Frame 184 

	Nazi = 0: NaziVal = 0: NaziTotal = 0
	ModeHit = 0

	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 7500
	DispDMD1.QueueText "[edge3][xc][yc][f6]MINECART CHASE", deNone, 2500, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]MINECART CHASE", deNone, 2500, FALSE
	DispDMD1.QueueText "[edge3][f4][y3][bf]SHOOT RIGHT ORBIT[y17]TO START CHASE", deFlip, 2500, FALSE
	DispDMD2.QueueText "[edge3][f4][y3][bf]SHOOT RIGHT ORBIT[y17]TO START CHASE", deFlip, 2500, FALSE
	DispDMD1.QueueText "[edge3][f4][y3][bf]LEFT ORBIT[y17]TO EXIT", deFlip, 1000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3][bf]LEFT ORBIT[y17]TO EXIT", deFlip, 1000, TRUE

	' save the state of the INDY JONES lights, these will be shots to the bad guys...
	TempL1 = LightINDY1.State
	TempL2 = LightINDY2.State
	TempL3 = LightINDY3.State
	TempL4 = LightINDY4.State
	TempL5 = LightJONES1.State
	TempL6 = LightJONES2.State
	TempL7 = LightJONES3.State
	TempL8 = LightJONES4.State
	TempL9 = LightJONES5.State

	' and now turn them all off for the first part...
	LightINDY1.State = BulbOff
	LightINDY2.State = BulbOff
	LightINDY3.State = BulbOff
	LightINDY4.State = BulbOff
	LightJONES1.State = BulbOff
	LightJONES2.State = BulbOff
	LightJONES3.State = BulbOff
	LightJONES4.State = BulbOff
	LightJONES5.State = BulbOff

	' CORDINATE GUN SHOTS WITH SPOT LIGHT FLASHES...

	Clip = 38: PlayClip()
	GF = 0: GunFire.Set TRUE, 2100
	LightSeqPF.Play SeqAllOff
	PlasDarkOn()
	GetOutTimer.Set TRUE, 6200
End Sub


' coordinate the lights with the audio...
Sub GunFire_Expired()
	GF = GF + 1
	Select Case GF
		Case 1: 
				GunFire.Set TRUE, 500
				FlasherSword.FlashForMs 200, 100, BulbOff
				SpotSword.FlashForMs 200, 100, BulbOff
		Case 2: 
				GunFire.Set TRUE, 500
				FlasherArkSpot.FlashForMs 200, 100, BulbOff
				SpotArk.FlashForMs 200, 100, BulbOff
		Case 3:
				GunFire.Set TRUE, 1900
				FlasherRed.FlashForMs 200, 100, BulbOff
				BulbArkL.FlashForMs 200, 100, BulbOff
				BulbArkR.FlashForMs 200, 100, BulbOff
		Case 4:
				GunFire.Enabled = FALSE
				FlasherArkSpot.FlashForMs 200, 100, BulbOff
				SpotArk.FlashForMs 200, 100, BulbOff
				FlasherSword.FlashForMs 200, 100, BulbOff
				SpotSword.FlashForMs 200, 100, BulbOff
				FlasherRed.FlashForMs 200, 100, BulbOff
				BulbArkL.FlashForMs 200, 100, BulbOff
				BulbArkR.FlashForMs 200, 100, BulbOff
	End Select
End Sub



Sub GetOutTimer_Expired()
	GetOutTimer.Enabled = FALSE
	PlayMusic 2, "vo_TakeLeftTunnel"
	LightSeqPF.StopPlay
	LightOrbitR.State = BulbBlink
	Flash = 5: FlashPFTimer.Set TRUE, 2000
	SpotOn(4)
	StartTempleSceneDelay.Set TRUE, 2000 ' release the ball, start the ball saver...
End Sub


Sub StartChaseMB()
	LightOrbitR.State = BulbOff
	PlayMusic 2, "vo_LeftTunnel2"

	SpotSword.FlashForMs 2000, 100, BulbOff
	FlasherSword.FlashForMs 2000, 100, BulbOff

	Select Case RandomNumber(3)
		Case 1,2: PlayMusic 4, "vo_GotCompany2", FALSE, 1, 3500
		Case 3: PlayMusic 4, "vo_GotCompany3", FALSE, 1, 3500
	End Select
	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 4600

	BulbArkL.FlashForMs 2000, 2000, BulbOff
	BulbArkR.FlashForMs 2000, 2000, BulbOff
	FlasherRed.FlashForMs 2000, 2000, BulbOff
	PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 4000
	bMultiballMode = TRUE
	MovieTimer.Set TRUE, 100

	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
	DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
	DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
	SceneHit()

	' now blink all the INDY JONES targets, these are the bad guys...
	LightINDY1.Set BulbBlink, "10", 100
	LightINDY2.Set BulbBlink, "10", 100
	LightINDY3.Set BulbBlink, "10", 100
	LightINDY4.Set BulbBlink, "10", 100
	LightJONES1.Set BulbBlink, "10", 100
	LightJONES2.Set BulbBlink, "10", 100
	LightJONES3.Set BulbBlink, "10", 100
	LightJONES4.Set BulbBlink, "10", 100
	LightJONES5.Set BulbBlink, "10", 100

	' change the camera angle...
	xBAM.Camera.DesktopSet          261.2,  1266.6,   922.5,   260.9,     623,       0,      50,    500
	xBAM.Camera.DesktopSetLookAt    261.2,  1266.6,   922.5,   260.9,     623,       0,      50,    500

	BallCreateTimer.Set TRUE, 1500
	TwoBallTimer.Set TRUE, 2500 ' auto launch ball in the plunger lane, add another one...

	BulbFS.State = BulbOff: LightFS.State = BulbOff ' can no longer use Free Shot...

	' restart the Ball Saver...
	bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, BSTime(CP): ShootAgainLight.State = BulbBlink
End Sub



' Clear all the INDY or JONES targets to illininate each minecart full of bad guys following you.
' Each target bank cleared will reset with increased value.

Sub MineKill()
	Nazi = Nazi + 1
	NaziVal = NaziVal + 15500
	ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1000
	AddScore(NaziVal)
	DispDMD1.Text = "[edge3][f2][xc][y5]ENEMY KILLED[f4][y15][bf]" & FormatScore(NaziVal*xMarks)
	DispDMD2.Text = "[edge3][f2][xc][y5]ENEMY KILLED[f4][y15][bf]" & FormatScore(NaziVal*xMarks)
	SceneTotal = SceneTotal + NaziVal
	Select Case RandomNumber(7)
		Case 1: PlaySound "fx_GunShot4"
		Case 2: PlaySound "fx_GunShot7"
		Case 3: PlaySound "fx_Ricochet"
		Case 4: PlaySound "fx_Ricochet8"
		Case 5: PlaySound "fx_GunShot5"
		Case 6: PlaySound "fx_Ricochet9"
		Case 7: PlaySound "fx_Ricochet10"
	End Select
	' turns off plas and GI for duration of flash...
	LightSeqPF.Play SeqBlinking, , 2, 150
	PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 300
	CheckINDYJONES()
End Sub




' *************************************************
' **                                             **
' **          TEMPLE OF DOOM - SCENE 4           **
' **                                             **
' *************************************************

' Indy is surrounded on the rope bridge.

' - Make a Combo to the ramp or right loop to starting cutting the rope.
' - Shoot the Ark to cut the rope and bring down the bridge.


' ** FUTURE UPDATE **

' - shoot the bumpers to fight Mola Ram on the bridge


' ** MEDIA NEEDED **

' - clips of Indy and Mola Ram fighting on bridge to claim the stone
' - clip of Mola Ram falling to death and being eaten by crocs


Sub StartTOD4()
	GrailKickerTimer.Enabled = FALSE
	ModeName = "TScene4"
	TempleNeeded(CP) = TempleNeeded(CP) + 1: StoneHitsRemain(CP) = TempleNeeded(CP)

	'If (StonesCollected =<2) Then
	'	GrailKickerTimer.Set TRUE, 2500
	'Exit Sub
	'End If

	StopHurryUps(): StopFastScoring()

	SlingStop = TRUE

	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 4000
	DispDMD1.QueueText "[edge3][xc][yc][f6]ROPE BRIDGE", deNone, 1200, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]ROPE BRIDGE", deNone, 1200, FALSE
	DispDMD1.QueueText "[edge3][f4][y3][b]MAKE A COMBO TO[y17]CUT THE BRIDGE", deFlip, 1000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3][b]MAKE A COMBO TO[y17]CUT THE BRIDGE", deFlip, 1000, TRUE

	If (CairoSwordsman = TRUE) Then StopSwordsman()

	Clip = 45: PlayClip()

	ModeHit = 0

	StonesCollected(CP) = 0
	ScoreUpdate = FALSE
	StopMusic 1

	' save the state of the INDY JONES lights, these will be shots to the bad guys...
	TempL1 = LightINDY1.State
	TempL2 = LightINDY2.State
	TempL3 = LightINDY3.State
	TempL4 = LightINDY4.State
	TempL5 = LightJONES1.State
	TempL6 = LightJONES2.State
	TempL7 = LightJONES3.State
	TempL8 = LightJONES4.State
	TempL9 = LightJONES5.State

	' reset the lights...
	LightINDY1.Set BulbBlink, "10", 100
	LightINDY2.Set BulbBlink, "10", 100
	LightINDY3.Set BulbBlink, "10", 100
	LightINDY4.Set BulbBlink, "10", 100
	LightJONES1.Set BulbBlink, "10", 100
	LightJONES2.Set BulbBlink, "10", 100
	LightJONES3.Set BulbBlink, "10", 100
	LightJONES4.Set BulbBlink, "10", 100
	LightJONES5.Set BulbBlink, "10", 100

	' make a combo to any of these 2 shots to start cutting the rope...
	LightSkull.State = BulbBlink
	LightOrbitR.State = BulbBlink

	HurryTime = 40: ModeTimer.Set TRUE, 3800
	StartTempleSceneDelay.Set TRUE, 3800
End Sub



Sub CutRope()
	ModeHit = ModeHit + 1
	If (ResumeVol.Enabled = FALSE) Then
		Select Case ModeHit
			Case 1: PlayMusic 2, "vo_Genargh": MusicFade(1000)
			Case 2: PlayMusic 2, "vo_Molarram": MusicFade(2000)
			Case 3: PlayMusic 2, "vo_Molarram2": MusicFade(600)
			Case 4: PlayMusic 2, "vo_Orders": MusicFade(2500)
			Case 5: PlayMusic 2, "vo_InHell": MusicFade(3500): ModeHit = 0
		End Select
	End If
End Sub





' ************************************************
' **                                            **
' **               THE HOLY GRAIL               **
' **                                            **
' ************************************************

' Starts each LAST CRUSADE scene and the MYSTERY feature when lit.

' Scene 1: Young Indy on Train
' Scene 2: Plane Attack
' Scene 3: Tank Chase
' Scene 4: Choose Wisley

' extra scenes (possible future update)

' motorbike chase
' mansion fire escape


Sub ReHitGrail_Expired()
	ReHitGrail.Enabled = FALSE
	IgnoreMe2 = TRUE
	GrailKicker_Hit()
End Sub


Sub GrailKicker_Hit()

	If (fpTilted = TRUE) Then GrailKicker.SolenoidPulse: Exit Sub

	If (BonusBall = TRUE) Then
		If (LightCrusade.State = BulbOff) Then Exit Sub
		PlaySound "fx_ScoopHitL"
		PlaySound "fx_GrailHit"
		BBTotal(CP) = BBTotal(CP) + BBVal(CP)
		ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1000
		DispDMD1.Text = "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(BBVal(CP))
		DispDMD2.Text = "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(BBVal(CP))
		GrailHit = GrailHit + 1
		Select Case GrailHit
			Case 1: LightCrusadeS1.State = BulbOn
			Case 2: LightCrusadeS2.State = BulbOn
			Case 3: LightCrusadeS3.State = BulbOn
			Case 4: LightCrusadeS4.State = BulbOn
			Case 5: LightCrusadeMain.State = BulbOn: BBTotal(CP) = BBTotal(CP) + 350000: LightCrusade.State = BulbOff
				MusicFade(1000): PlayMusic 3, "Music_Cue14"
				Flash = 0: FlashPFTimer.Set TRUE, 75
				DispDMD1.Text = "[edge3][f4][y3][bf]MOVIE COMPLETE[y17]COMPLETE"
				DispDMD2.Text = "[edge3][f4][y3][bf]MOVIE COMPLETE[y17]COMPLETE"
		End Select
		GrailKickerTimer_Expired()
	Exit Sub
	End If

	' ball came from Sankara Stone subway so start Temple scene...

	If (BallFromStone = TRUE) Then BallFromStone = FALSE: Exit Sub

	If (IgnoreMe2 = FALSE) Then PlaySound "fx_ScoopHitL": GrailHit = GrailHit + 1 ' for the end of ball bonus...

	IgnoreMe2 = FALSE

	If (LightCrusade.State = BulbBlink) Then
	
		' get Antidote...
		If (ModeName = "TScene1") Then
			GetAntidote()
			GrailKickerTimer.Set TRUE, 1000
		Exit Sub
		End If

		' cut the rope bridge...
		If (ModeName = "TScene4") Then
			LightCrusade.State = BulbOff
			CutRope()
			GrailKickerTimer.Set TRUE, 1000
		Exit Sub
		End If

		' chosen wisely...
		If (ModeName = "CScene4") Then
			LightCrusadeExt.SetLitColor 255, 0, 0
			LightCrusade.State = BulbOn
			GrailKickerTimer.Set TRUE, 2000
			CheckChooseLights() ' if winning shot, stop timer to exit the ball...
		Exit Sub
		End If

		If (ModeName = "CScene1") Then ' CScene 1 ends here, Indy disappears in the magic trunk...
			EndMode()
			If (BulbMystery.State = BulbOn) Then
				NoRtn = TRUE ' don't count as a hit...
				ReHitGrail.Set TRUE, 6000
			Else
				GrailKickerTimer.Set TRUE, 6000
			End If
		Exit Sub
		End If

		' dogfight CRUSADE SCENE 2...
		If (ModeName = "CScene2") Then
			'LightCrusade.State = BulbOff
			If (MovieTimer.Enabled = FALSE) Then
				NoS()
				OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100
				LCD.Frame 591,592,591: OverlayLCD.Frame 591,592,591: MovieTimer.Set TRUE, 1000
			End If
			DogFightHit()
			PlaySound "fx_PlaneShoot3"
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1000
			BulbArkL.FlashForMs 1000, 75, BulbOff
			BulbArkR.FlashForMs 1000, 75, BulbOff
			FlasherRed.FlashForMs 1000, 75, BulbOff
			LightSeqPF.Play SeqBlinking, , 7, 75
			GrailKickerTimer.Set TRUE, 1000
		Exit Sub
		End If

		' tank CRUSADE shot...
		If (ModeName = "CScene3") Then
			TankHit()
			GrailKickerTimer.Set TRUE, 1000
		Exit Sub
		End If

		If (ModeName = "SScene1") Then
			LightCrusade.State = BulbOff
			EndMode()
			If (BulbMystery.State = BulbOn) Then
				NoRtn = TRUE ' don't count as a hit...
				ReHitGrail.Set TRUE, 7300
			Else
				GrailKickerTimer.Set TRUE, 7300
			End If
		Exit Sub
		End If

		' mind control SKULL SCENE 3...
		If (ModeName = "SScene3") Then
			LightCrusade.State = BulbOff
			SkullPowerHit()
			GrailKickerTimer.Set TRUE, 1000
		Exit Sub
		End If

		If (ModeName = "SScene4") Then
			LightCrusade.State = BulbOff
			ModeHit = ModeHit + 1
			If (ModeHit = 4) Then EndMode(): GrailKickerTimer.Set TRUE, 4000: Exit Sub
			ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
			DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			SceneHit()
			MusicFade(1000): PlayMusic 3, "Music_Cue3"
			LightSeqPF.Play SeqBlinking, , 3, 75
			Flash = 0: FlashPFTimer.Set TRUE, 75
			GrailKickerTimer.Set TRUE, 1000
		Exit Sub
		End If

		' failsafe, something went wrong, kick the ball back out...
		GrailKickerTimer.Set TRUE, 500
	End If

	' Raiders Scene 1...(bad shot)
	If (ModeName = "RScene1") Then
		If (BulbMystery.State = BulbOn) Then
			BulbMystery.State = BulbOff
			PlaySound "fx_15"
			AdvMovieJP()
			GrailKickerTimer.Set TRUE, 1000
		Else

		' ** MEDIA NEEDED **
		' - guy impalled through spikes jumps out at Indy
			GrailKickerTimer.Set TRUE, 500
		End If
	Exit Sub
	End If

	' you chose poorly...
	If (ModeName = "CScene4") Then
		LightCrusade.State = BulbOff
		ChooseEnd()
		If (BulbMystery.State = BulbOn) Then
			NoRtn = TRUE ' don't count as a hit...
			ReHitGrail.Set TRUE, 3000
		Else
			GrailKickerTimer.Set TRUE, 3000
		End If
	Exit Sub
	End If

	If (ModeName = "RScene4") Then
		RaiderShit()
		GrailKickerTimer.Set TRUE, 500
	Exit Sub
	End If

	' Indy returns fire in the bar...
	If (ModeName = "RScene2") Then
		Clip = 39: PlayClip()
		GrailKickerTimer.Set TRUE, 500
		'PlayMusic 5, "vo_Nick"
	Exit Sub
	End If

	' just for fun, add a motorbike fx whenever this is hit during the Skull scenes...
	If (ModeName="SScene1") or (ModeName="SScene2") or (ModeName="SScene3") or (ModeName="SScene4") Then
		PlaySound "fx_MotorBikeKick"
		If (BulbMystery.State = BulbOn) Then
			BulbMystery.State = BulbOff
			HurryTime = HurryTime + 10
			ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 800
			DispDMD1.Text = "[edge3][f6][xc][yc][bf]TIME EXTENDED"
			DispDMD2.Text = "[edge3][f6][xc][yc][bf]TIME EXTENDED"
			GrailKickerTimer.Set TRUE, 800
		Else
			GrailKickerTimer.Set TRUE, 500
		End If
	Exit Sub
	End If

	If (ModeName = "TScene1") Then
		If (BulbMystery.State = BulbOn) Then
			BulbMystery.State = BulbOff
			If (QuoteBusy = FALSE) Then 
				EffectMusic 1, SetVolume, 0, 0: ResumeVol.Set TRUE, 2900: PlayMusic 2, "vo_GiveMe"
				QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3000
			End If
			HurryTime = HurryTime + 10
			ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 1000
			DispDMD1.Text = "[edge3][f6][xc][yc][bf]TIME EXTENDED"
			DispDMD2.Text = "[edge3][f6][xc][yc][bf]TIME EXTENDED"
			GrailKickerTimer.Set TRUE, 1000
		Else
			GrailKickerTimer.Set TRUE, 500
		End If
	Exit Sub
	End If

	If (ModeName = "TScene2") Then
		If (QuoteBusy = FALSE) Then 
			PlayMusic 2, "vo_Parachutes"
			QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2100
		End If
		If (BulbMystery.State = BulbOn) Then
			BulbMystery.State = BulbOff
			HurryTime = HurryTime + 10
			ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 800
			DispDMD1.Text = "[edge3][f6][xc][yc][bf]TIME EXTENDED"
			DispDMD2.Text = "[edge3][f6][xc][yc][bf]TIME EXTENDED"
			GrailKickerTimer.Set TRUE, 800
		Else
			GrailKickerTimer.Set TRUE, 500
		End If
	Exit Sub
	End If

	' Crusade Scene 1, young Indy falls into the snakes...
	If (ModeName = "CScene1") Then
		MusicFade(1200): PlaySound "fx_SnakePit"
		LightSeqPF.Play SeqBlinking, , 4, 75
		ArkFlash(1000)
		If (BulbMystery.State = BulbOn) Then
			BulbMystery.State = BulbOff
			HurryTime = HurryTime + 10
			ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 1000
			DispDMD1.Text = "[edge3][f6][xc][yc][bf]TIME EXTENDED"
			DispDMD2.Text = "[edge3][f6][xc][yc][bf]TIME EXTENDED"
			GrailKickerTimer.Set TRUE, 1000
		Else
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1200
			DispDMD1.QueueText "[edge3][f6][xc][yc][bf]SNAKES", deNone, 1000, TRUE
			DispDMD2.QueueText "[edge3][f6][xc][yc][bf]SNAKES", deNone, 1000, TRUE
			GrailKickerTimer.Set TRUE, 1000
		End If
	Exit Sub
	End If

	' Crusade Scene 2, plane takes a hit (bad shot)...
	If (ModeName = "CScene2") Then
		If (BulbMystery.State = BulbOn) Then
			BulbMystery.State = BulbOff
			HurryTime = HurryTime + 10
			ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 800
			DispDMD1.Text = "[edge3][f6][xc][yc][bf]TIME EXTENDED"
			DispDMD2.Text = "[edge3][f6][xc][yc][bf]TIME EXTENDED"
			GrailKickerTimer.Set TRUE, 800
		Else
			GrailKickerTimer.Set TRUE, 500
		End If
	Exit Sub
	End If

	' Crusade Scene 3, near miss tank shot (bad shot)...
	If (ModeName = "CScene3") Then
		If (BulbMystery.State = BulbOn) Then
			BulbMystery.State = BulbOff
			If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_Schnell"
			HurryTime = HurryTime + 10
			ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 800
			DispDMD1.Text = "[edge3][f6][xc][yc][bf]TIME EXTENDED"
			DispDMD2.Text = "[edge3][f6][xc][yc][bf]TIME EXTENDED"
			GrailKickerTimer.Set TRUE, 800
		Else
			GrailKickerTimer.Set TRUE, 500
		End If
	Exit Sub
	End If

	' a movie scene is running but the grail shot is not part of it, just increase the movie jackpot...
	If not (ModeName = "") Then
		If (BulbMystery.State = BulbOn) Then
			BulbMystery.State = BulbOff
			PlaySound "fx_15"
			AdvMovieJP()
		End If
		GrailKickerTimer_Expired()
	Exit Sub
	End If

	If (HurryUpMode = TRUE) Then
		PlayMusic 1, "Music_Cue1"
		PlaySound "fx_Snake", 0.8
		PlayMusic 2, "vo_NastyPlace2", FALSE, 1, 500
		HurryUpMode = FALSE
		RatsTimer1.Enabled = FALSE
		RatsTimer2.Enabled = FALSE
		RatsEndTimer.Enabled = FALSE
		AntsTimer1.Enabled = FALSE
		AntsTimer2.Enabled = FALSE
		AntsEndTimer.Enabled = FALSE
		SnakesTimer1.Enabled = FALSE
		SnakesTimer2.Enabled = FALSE
		SnakesEndTimer.Enabled = FALSE
		LightOrbitL.State = BulbOff
		LightOrbitR.State = BulbOff
		RestartMusic.Set TRUE, 1500
		ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		DispDMD1.QueueText "[edge3][f6][xc][yc]YOU HAVE FAILED", deNone, 1500, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][yc]YOU HAVE FAILED", deNone, 1500, TRUE
		LightSeqPF.Play SeqBlinking, , 3, 100
		ArkFlash(1000)
		GrailKickerTimer.Set TRUE, 3400
		Snakes = FALSE
		Ants = FALSE
		Rats = FALSE
		MovieTimer.Set TRUE, 100
	Exit Sub
	End If

	If (BOG = TRUE) Then
		BOG = FALSE
		PlayMusic 1, "Music_Cue1"
		ChallengeTimer.Enabled = FALSE
		BreathOfGodTimer.Enabled = FALSE
		LightChallenge.State = BulbOff
		MovieTimer.Set TRUE, 100
		ResetBlade.Set TRUE, 200
		If (ModeName = "") Then
			PlayMusic 1, "Music_Cue1"
			RestartMusic.Set TRUE, 1200
			If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_Challenge", FALSE, 1, 600
		End If
		ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		DispDMD1.QueueText "[edge3][f6][xc][yc]YOU HAVE FAILED", deNone, 1500, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][yc]YOU HAVE FAILED", deNone, 1500, TRUE
		LightSeqPF.Play SeqBlinking, , 3, 100
		ArkFlash(1000)
		GrailKickerTimer.Set TRUE, 1500
	Exit Sub
	End If

	BulbGrail.State = BulbOn: BulbGrail2.State = BulbOn
	FlashPFTimer.Enabled = FALSE
	ClearSeq():	PlasDarkOn()

	If (NoRtn = FALSE) Then 
		GrailHitsRemain(CP) = GrailHitsRemain(CP) - 1
		AddScore(10000)
		CheckCRUSADE()
	Else
		NoRtn = FALSE
	End If

	' only collect the Mystery Award if no other modes are running...
	If (BulbMystery.State = BulbOn) and (ModeName = "") and (NoRtn = FALSE) Then
		StartMystery()
		BulbMystery.State = BulbOff
	End If
End Sub



Sub CheckCRUSADE()
	NoRtn = TRUE
	Dim T
	If (GrailHitsRemain(CP) <= 0) and (ModeName = "") Then ' good to start the next CRUSADE scene...
		GrailKickerTimer.Enabled = FALSE

		StopHurryUps(): StopFastScoring()

		If (TempleOpen = TRUE) Then CloseChamber(): StoneHitsRemain(CP) = 1

		If (CairoSwordsman = TRUE) Then StopSwordsman()

		'BulbMystery.State = BulbOff
		LightTempleOfDoom.State = BulbOff
		LightRaidersArk.State = BulbOff
		LightLastCrusade.State = BulbOff
		LightCrystalSkull.State = BulbOff

		RampSkullOff()
		ScoreUpdate = TRUE: FlushDMDTimer.Enabled = FALSE

		SceneTotal = 200000: SceneVal = 210000 ' start value for the first shot...
		AddScore(200000)

		If (FreeShot(CP) =>1) Then BulbFS.State = BulbBlink: LightFS.State = BulbBlink

		If (LightCrusadeS1.State = BulbBlink) Then StartLC1(): Exit Sub
		If (LightCrusadeS2.State = BulbBlink) Then StartLC2(): Exit Sub
		If (LightCrusadeS3.State = BulbBlink) Then StartLC3(): Exit Sub
		If (LightCrusadeS4.State = BulbBlink) Then StartLC4(): Exit Sub

		If (LightCrusadeMain.State = BulbBlink) Then ' Final
			LightCrusadeMain.State = BulbOn
			GrailKickerTimer.Set TRUE, 500
		Exit Sub
		End If

	Else

		If (GrailHitsRemain(CP) = 1) Then ' 1 more hit needed...
			LightLastCrusade.State = BulbBlink
			If (MovieTimer.Enabled = FALSE) Then NoS(): OverlayLCD.UpdateInterval = 150: LCD.UpdateInterval = 150: OverlayLCD.Frame 178,179,178: LCD.Frame 178,179,178: MovieTimer.Set TRUE, 2000 ' 1 hit left..

			If (LightCrusadeS1.State = BulbBlink) and (QuoteBusy = FALSE) Then
				MusicFade(1700): PlayMusic 2, "vo_TheCross", FALSE, 1, 300: t = 1700
				If (ScoreUpdate = TRUE) Then
					DispDMD1.QueueText "[edge3][f4][xc][y5][b]LAST CRUSADE[f5][xc][y18]SCENE 1 READY", deScrollIn, 1000, TRUE
					DispDMD2.QueueText "[edge3][f4][xc][y5][b]LAST CRUSADE[f5][xc][y18]SCENE 1 READY", deScrollIn, 1000, TRUE
					ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2300
				End If
			End If

			If (LightCrusadeS2.State = BulbBlink) and (QuoteBusy = FALSE) Then
				MusicFade(2000): PlayMusic 2, "vo_GoToBerlin", FALSE, 1, 300: t = 2200
				If (ScoreUpdate = TRUE) Then
					DispDMD1.QueueText "[edge3][f4][xc][y5][b]LAST CRUSADE[f5][xc][y18]SCENE 2 READY", deScrollIn, 1000, TRUE
					DispDMD2.QueueText "[edge3][f4][xc][y5][b]LAST CRUSADE[f5][xc][y18]SCENE 2 READY", deScrollIn, 1000, TRUE
					ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, t
				End If
			End If

			If (LightCrusadeS3.State = BulbBlink) and (QuoteBusy = FALSE) Then
				Select Case RandomNumber(2)
					Case 1: MusicFade(3300): PlayMusic 2, "vo_WarOnJones", FALSE, 1, 300: t = 2100
					Case 2: MusicFade(1300): PlayMusic 2, "vo_AfterDad", FALSE, 1, 300: t = 1600
				End Select
				If (ScoreUpdate = TRUE) Then
					DispDMD1.QueueText "[edge3][f4][xc][y5][b]LAST CRUSADE[f5][xc][y18]SCENE 3 READY", deScrollIn, 1000, TRUE
					DispDMD2.QueueText "[edge3][f4][xc][y5][b]LAST CRUSADE[f5][xc][y18]SCENE 3 READY", deScrollIn, 1000, TRUE
					ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, t
				End If
			End If

			' 2nd to last shot to start SCENE 4...play a special quote...
			If (LightCrusadeS4.State = BulbBlink) Then
				If (QuoteBusy = FALSE) and (ResumeVol.Enabled = FALSE) Then
					Select Case RandomNumber(7)
						Case 1: PlayMusic 2, "vo_Quest2", FALSE, 1, 300: t = 1500
						Case 2: PlayMusic 2, "vo_OneStepAway", FALSE, 1, 300: t = 1500
						Case 3: PlayMusic 2, "vo_FinalChallenge", FALSE, 1, 300: t = 3000
						Case 4: PlayMusic 2, "vo_TheHolyGrail", FALSE, 1, 300: t = 1800
						Case 5: PlayMusic 2, "vo_GrailItself", FALSE, 1, 300: t = 3200
						Case 6: PlayMusic 2, "vo_GrailIsMine", FALSE, 1, 300: t = 2500
						Case 7: PlayMusic 2, "vo_Price", FALSE, 1, 300: t = 6500
					End Select
					MusicFade(t)
				Else
					PlaySound "fx_PageTurn"
				End If
				If (ScoreUpdate = TRUE) Then
					DispDMD1.QueueText "[edge3][f4][xc][y5][b]LAST CRUSADE[f5][xc][y18]SCENE 4 READY", deScrollIn, 1000, TRUE
					DispDMD2.QueueText "[edge3][f4][xc][y5][b]LAST CRUSADE[f5][xc][y18]SCENE 4 READY", deScrollIn, 1000, TRUE
					ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, t
				End If
			End If

			If (BulbMystery.State = BulbOn) Then ' go back and get the mystery...
				ReHitGrail.Set TRUE, t+500
			Else
				GrailKickerTimer.Set TRUE, t
			End If

		Else

			If (GrailHitsRemain(CP) =<0) Then GrailHitsRemain(CP) = 1: GrailKickerTimer_Expired(): Exit Sub

			' all other hits count towards starting the next Crusade scene...
			If (ScoreUpdate = TRUE) Then
				ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1200
				DispDMD1.Text = "[edge3][f2][xc][y4]CRUSADE READY IN[y14][f6]" & GrailHitsRemain(CP) & " HITS"
				DispDMD2.Text = "[edge3][f2][xc][y4]CRUSADE READY IN[y14][f6]" & GrailHitsRemain(CP) & " HITS"
			End If

			' possibility of ball bouncing off INDY targets, which may be playing a clip of Monkey or Marion, so let the clip play out...
			If (MovieTimer.Enabled = FALSE) Then 
				Select Case GrailHitsRemain(CP)
					Case 4: NoS(): OverlayLCD.Frame 34: LCD.Frame 34: MovieTimer.Set TRUE, 1200 ' 4 hits left..
					Case 3: NoS(): OverlayLCD.Frame 33: LCD.Frame 33: MovieTimer.Set TRUE, 1200 ' 3 hits left..
					Case 2: NoS(): OverlayLCD.Frame 32: LCD.Frame 32: MovieTimer.Set TRUE, 1200 ' 2 hits left..
				End Select
			End If

			' special quotes only played when SCENE 4 is next to start...
			If (LightCrusadeS4.State = BulbBlink) Then
				If (QuoteBusy = FALSE) Then
					Select Case GrailHitsRemain(CP)
						Case 5: PlayMusic 2, "vo_EternalLife": MusicFade(3000): T = 2500
						Case 4: PlayMusic 2, "vo_Search": MusicFade(5000): T = 4500
						Case 3: PlayMusic 2, "vo_RestingPlace": MusicFade(3900): T = 3400
						Case 2: PlayMusic 2, "vo_Matters": MusicFade(1800): T = 1400
					End Select
					If (BulbMystery.State = BulbOn) Then
						MovieTimer.Enabled = FALSE
						ReHitGrail.Set TRUE, T+500
					Else
						GrailKickerTimer.Set TRUE, T
					End If
				Else
					' PlaySound "fx_Impact"
					FF_Sound DV_SH,50,"fx_Impact"

					GrailKickerTimer.Set TRUE, 600
				End If
			Else
				PlaySound "fx_Impact"
				FF_Sound DV_SH,100,"fx_Impact"

				If (BulbMystery.State = BulbOn) Then ' start mystery if lit straight after...
					MovieTimer.Enabled = FALSE
					ReHitGrail.Set TRUE, 1000
				Else
					If (QuoteBusy = FALSE) Then
						' any qualifying shot to the grail above 1 remaining is just dealt with quickly...
						PlayMusic 2, "vo_GetOut", FALSE, 1, 500
						GrailKickerTimer.Set TRUE, 600
					Else
						GrailKickerTimer_Expired()
					End If
				End If
			End If
		End If
	End If
End Sub


' ejects the ball from the kicker...

Sub GrailKickerTimer_Expired()
	PreKick = PreKick + 1
	Select Case PreKick
		Case 1:
			PlaySound "fx_PreKick"
			PlasDarkOn()
			BulbGrail.FlashForMs 500, 100, BulbOff
			BulbGrail2.FlashForMs 500, 100, BulbOff
			GrailKickerTimer.Set TRUE, 500
		Case 2:
			PreKick = 0
			GrailKicker.SolenoidPulse
			PlaySound "fx_ScoopExit"
			GrailKickerTimer.set FALSE
			PlasDarkOff()
			LightSeqPF.Play SeqBlinking, , 1, 100
			NoRtn = FALSE
	End Select
End Sub



' ************************************************
' **                                            **
' **           LAST CRUSADE - SCENE 1           **
' **                                            **
' ************************************************

' grab the Cross of Coronado and escape on a train.


Sub StartLC1()
	CrusadeNeeded(CP) = CrusadeNeeded(CP) + 1: GrailHitsRemain(CP) = CrusadeNeeded(CP)

	MagnetActive = FALSE ' disable pulse magnet...

	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3000 
	Clip = 28: PlayClip()

	ModeName = "CScene1"
	PlayMusic 1, "Music_YoungIndy", TRUE, 0.8, 3000
	DispDMD1.QueueText "[edge3][xc][yc][f6]YOUNG INDY", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]YOUNG INDY", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f2][xc][y4]GRAB THE CROSS[y13]GET TO THE[y22]TRAIN AND ESCAPE", deFlip, 2000, FALSE
	DispDMD2.QueueText "[edge3][f2][xc][y4]GRAB THE CROSS[y13]GET TO THE[y22]TRAIN AND ESCAPE", deFlip, 2000, FALSE
	DispDMD1.QueueText "[edge3][f4][y3][bf]SHOOT ARK AND[y17]GRAB THE CROSS", deNone, 1000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3][bf]SHOOT ARK AND[y17]GRAB THE CROSS", deNone, 1000, TRUE
	FlushDMDTimer.Set TRUE, 5000

	If (FreeShot(CP) =>1) Then BulbFS.State = BulbBlink: LightFS.State = BulbBlink

	ModeHit = 0
	HurryTime = 30: ModeTimer.Set TRUE, 5000

	' first hit the ark to grab the cross, then hit the orbits to ride the horse to the train, then hit the ramp to
	' run accross the train and finally hit the grail scoop to 'disappear'.....phew.

	LightArk.State = BulbBlink

	bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, BSTime(CP): ShootAgainLight.State = BulbBlink
	GrailKickerTimer.Set TRUE, 3000
End Sub




' ************************************************
' **                                            **
' **           LAST CRUSADE - SCENE 2           **
' **                                            **
' ************************************************

' Indy and his dad escape the airship in a plane and are attacked by a German plane.....boo hiss...

' - shoot any shot to get Jones Snr on the Machine gun
' - now shoot any 5 of the flashing shots and dad will fire at the plane
' [after 6 successful shots, Jones Snr shoots the tail fin so Indy has to land]

' ** INCOMPLETE - TO FOLLOW **

' - shoot the Ark to land
' - drive the car into the tunnel and watch the German plane follow (end)


' ** MEDIA NEEDED **

' - clip of Indy landing
' - clip of plane crashing through tunnel (end)


Sub StartLC2()
	CrusadeNeeded(CP) = CrusadeNeeded(CP) + 1: GrailHitsRemain(CP) = CrusadeNeeded(CP)
	ModeName = "CScene2"
	PlayMusic 1, "Music_DogFight", TRUE, 0.8, 5300
	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 5300

	Clip = 50: PlayClip()

	DispDMD1.QueueText "[edge3][xc][yc][f6]DOGFIGHT", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]DOGFIGHT", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f2][xc][y4]GET DAD ON THE[y13]MACHINE GUN AND[y22]SHOOT THE PLANE", deFlip, 2200, FALSE
	DispDMD2.QueueText "[edge3][f2][xc][y4]GET DAD ON THE[y13]MACHINE GUN AND[y22]SHOOT THE PLANE", deFlip, 2200, FALSE
	DispDMD1.QueueText "[edge3][f4][y3][bf]SHOOT ANY ARROW[y17]FOR MACHINE GUN", deNone, 1000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3][bf]SHOOT ANY ARROW[y17]FOR MACHINE GUN", deNone, 1000, TRUE
	FlushDMDTimer.Set TRUE, 5200

	If (FreeShot(CP) =>1) Then BulbFS.State = BulbBlink: LightFS.State = BulbBlink

	' the first of any of these shots will get Jones Snr on the Machine Gun
	' subsequent shots will start firing at the German plane...
	LightCrusade.Set BulbBlink, "10", 125
	LightDoom.Set BulbBlink, "10", 125
	LightArk.Set BulbBlink, "10", 125
	LightSkull.Set BulbBlink, "10", 125
	LightOrbitR.Set BulbBlink, "10", 125
	LightOrbitL.Set BulbBlink, "10", 125

	StartPlane.Set TRUE, 5300

	ModeHit = 0
	HurryTime = 30: ModeTimer.Set TRUE, 5300
	bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, BSTime(CP)+5000: ShootAgainLight.State = BulbBlink
	GrailKickerTimer.Set TRUE, 5300
End Sub



Sub DogFightHit()
	ModeHit = ModeHit + 1
	If (ModeHit = 8) Then EndMode(): Exit Sub ' 8th shot hits the ark ftw...
	Select Case ModeHit
		Case 1: If (QuoteBusy = FALSE) Then QuoteBusy = FALSE: MusicFade(2000): PlayMusic 2, "vo_UseMachineGun"
		Case 2: If (QuoteBusy = FALSE) Then MusicFade(1200): PlayMusic 2, "vo_ComeOnMove"
		Case 3: If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: MusicFade(1000): PlayMusic 2, "vo_11OClock"
		Case 4: If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: MusicFade(1400): PlayMusic 2, "vo_WhatHappens11"
		Case 5: Clip = 58: PlayClip(): If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: MusicFade(1200): PlayMusic 2, "vo_11OClockFire"
		Case 6: If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: MusicFade(2500): PlayMusic 2, "vo_KillUs"
		Case 7: If (QuoteBusy = FALSE) Then MusicFade(1200): PlayMusic 2, "vo_GoingIn", FALSE, 0.8
			LightArk.Set BulbBlink, "10", 100
			LightCrusade.Set BulbOff, "10", 125
			LightDoom.Set BulbOff, "10", 125
			LightSkull.Set BulbOff, "10", 125
			LightOrbitR.Set BulbOff, "10", 125
			LightOrbitL.Set BulbOff, "10", 125
	End Select
	HurryTime = HurryTime + 5
	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
	DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
	DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
	SceneHit()
End Sub



' ************************************************
' **                                            **
' **           LAST CRUSADE - SCENE 3           **
' **                                            **
' ************************************************

' ** UNFINISHED **

' Jones Snr is held captive in a tank. The tank will fire on Indy. Block the Tank's gun
' with a stone to stop it firing (and removing lit shots). Then jump on board and save dad.

' Every 5 seconds the tank will fire, eliminating a lit shot and any scoring potential.
' When all lights are out, the mode is over.

' Make any 6 shots to win.


Sub StartLC3()
	CrusadeNeeded(CP) = CrusadeNeeded(CP) + 1: GrailHitsRemain(CP) = CrusadeNeeded(CP)
	ModeName = "CScene3"
	PlayMusic 1, "Music_Tank", TRUE, 0.8
	MusicFade(3500): QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3500
	PlayMusic 4, "fx_Tank", TRUE, 0.6, 1100

	DispDMD1.QueueText "[edge3][xc][yc][f6]TANK RESCUE", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]TANK RESCUE", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f2][xc][y4]RESCUE JONES SNR[y13]FROM THE BELLY[y22]OF THE BEAST", deFlip, 2000, FALSE
	DispDMD2.QueueText "[edge3][f2][xc][y4]RESCUE JONES SNR[y13]FROM THE BELLY[y22]OF THE BEAST", deFlip, 2000, FALSE
	DispDMD1.QueueText "[edge3][f4][y3][bf]QUICKLY SHOOT[y17]LIT ARROWS", deNone, 1000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3][bf]QUICKLY SHOOT[y17]LIT ARROWS", deNone, 1000, TRUE
	FlushDMDTimer.Set TRUE, 4500

	Clip = 51: PlayClip()

	If (FreeShot(CP) =>1) Then BulbFS.State = BulbBlink: LightFS.State = BulbBlink

	LightCrusade.Set BulbBlink, "10", 125
	LightDoom.Set BulbBlink, "10", 125
	LightArk.Set BulbBlink, "10", 125
	LightSkull.Set BulbBlink, "10", 125
	LightOrbitR.Set BulbBlink, "10", 125
	LightOrbitL.Set BulbBlink, "10", 125

	TFire = 0: TankFire.Set TRUE, 10000

	ModeHit = 6
	bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, BSTime(CP)+4000: ShootAgainLight.State = BulbBlink
	GrailKickerTimer.Set TRUE, 3500
End Sub




Sub TankFire_Expired()
	TFire = TFire + 1
	If (TFire =<5) Then
		TankFire.Set TRUE, 6000
		MusicFade(2000)
		Select Case TFire
			Case 1,3,5: Clip = 65: PlayClip()
			Case 2,4: Clip = 66: PlayClip()
		End Select
		LightSeqPF.Play SeqDoNothing, , ,1000
		LightSeqPF.Play SeqBlinking, , 1, 250
		ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2000
		DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD1.QueueText "[edge3][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD2.QueueText "[edge3][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD1.QueueText "[edge3][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD2.QueueText "[edge3][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD1.QueueText "[edge3][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD2.QueueText "[edge3][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD1.QueueText "[edge3][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD2.QueueText "[edge3][f6][yc][bf]TANK FIRING", deNone, 75, FALSE
		DispDMD1.QueueText "[edge3][f4][y3][b]SHOT[y17]ELIMINATED", deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f4][y3][b]SHOT[y17]ELIMINATED", deNone, 1000, TRUE
		Select Case TFire
			Case 1: LightCrusade.State = BulbOff
			Case 2: LightDoom.State = BulbOff
			Case 3: LightArk.State = BulbOff
			Case 4: LightSkull.State = BulbOff
			Case 5: LightOrbitL.State = BulbOff
		End Select
	Else
		LightOrbitR.State = BulbOff
		CheckTank()
	End If
End Sub



Sub TankHit()
	ModeHit = ModeHit - 1
	If (ModeHit = 0) Then EndMode(): Exit Sub
	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
	DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
	DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
	SceneHit()
	MusicFade(1000): PlayMusic 3, "Music_Cue3"
	LightSeqPF.Play SeqBlinking, , 3, 75
	Flash = 0: FlashPFTimer.Set TRUE, 75
End Sub



Sub CheckTank()
	If (LightCrusade.State=BulbOff)and(LightDoom.State=BulbOff)and(LightArk.State=BulbOff)and(LightSkull.State=BulbOff)and(LightOrbitL.State=BulbOff)and(LightOrbitR.State=BulbOff) Then
		TankFire.Enabled = FALSE
		PlaySound "fx_TankFire"
		LightSeqPF.Play SeqBlinking, , 1, 500
		Flash = 5: FlashPFTimer.Set TRUE, 500
		HurryTime = 1: ModeTimer_Expired()
	End If
End Sub




' ************************************************
' **                                            **
' **           LAST CRUSADE - SCENE 4           **
' **                                            **
' ************************************************

' Only shoot the main flashing shots, which then turn red.
' Continue to shoot the flashing shots and avoid the red otherwise you choose poorly.

' Make all the shots to receive "Eternal Life" - an unlimited BallSaver and the Crusade Jackpot.
' All Lights will then re-Light for increased scoring....maybe I'll have the flash red and normal for
' the next round...only shoot when normal, not red.


Sub StartLC4()
	CrusadeNeeded(CP) = CrusadeNeeded(CP) + 1: GrailHitsRemain(CP) = CrusadeNeeded(CP)

	' now we start Choose Wisely
	ModeName = "CScene4"
	PlayMusic 1, "Music_Choose", TRUE, 0.8, 500
	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 6000: PlayMusic 2, "vo_Choose"
	DispDMD1.QueueText "[edge3][xc][yc][f6]CHOOSE WISELY", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]CHOOSE WISELY", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f4][xc][y2]NOW YOU MUST[f6][xc][y15]CHOOSE WISELY", deNone, 2000, FALSE
	DispDMD2.QueueText "[edge3][f4][xc][y2]NOW YOU MUST[f6][xc][y15]CHOOSE WISELY", deNone, 2000, FALSE
	DispDMD1.QueueText "[edge3][f4][xc][y3][b]HIT THE FLASHING[f6][xc][y15]ARROWS ONLY", deNone, 3500, TRUE
	DispDMD2.QueueText "[edge3][f4][xc][y3][b]HIT THE FLASHING[f6][xc][y15]ARROWS ONLY", deNone, 3500, TRUE
	FlushDMDTimer.Set TRUE, 6500

	GrailKickerTimer.Set TRUE, 6000

	Clip = 63: PlayClip()

	ModeHit = 0
	HurryTime = 25: ModeTimer.Set TRUE, 6500

	ChooseTotal = 0: ChooseJP = 0

	' you're aiming for the strobbing Light...
	LightCrusade.State = BulbBlink
	LightDoom.State = BulbBlink
	LightArk.State = BulbBlink
	LightSkull.State = BulbBlink
	LightOrbitR.State = BulbBlink
End Sub


Sub CheckChooseLights()
	If (LightCrusade.State = BulbOn) and (LightDoom.State = BulbOn) and (LightArk.State = BulbOn) and (LightSkull.State = BulbOn) and (LightOrbitR.State = BulbOn) Then
		AddScore(CrusadeJP(CP))
		ChooseTotal = ChooseTotal + (CrusadeJP(CP)*xMarks)
		ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
		DispDMD1.FlushQueue: DispDMD2.FlushQueue
		DispDMD1.QueueText "[edge3][f3][xc][y4]CRUSADE JACKPOT[f6][y14][bf]" & FormatScore(CrusadeJP(CP)*xMarks), deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f3][xc][y4]CRUSADE JACKPOT[f6][y14][bf]" & FormatScore(CrusadeJP(CP)*xMarks), deNone, 1000, TRUE

		QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3000: PlayMusic 2, "vo_StrangeDress"
		LightCrusadeExt.SetLitColor 94, 203, 255
		LightDoomExt.SetLitColor 255, 164, 72
		LightArkExt.SetLitColor 219, 192, 241
		LightSkullExt.SetLitColor 156, 233, 131
		LightOrbitRExt.SetLitColor 243, 117, 63
		' Great, now the Lights are re-lit with increased values...
		LightCrusade.State = BulbBlink
		LightDoom.State = BulbBlink
		LightArk.State = BulbBlink
		LightSkull.State = BulbBlink
		LightOrbitR.State = BulbBlink
		ChooseJP = ChooseJP + 100000 ' increase the hit value by 100k...

		' the Ball Saver (Eternal Life) is now active for the rest of the mode...
		bBallSaverActive = TRUE: ShootAgainLight.State = BulbBlink
		PlayMusic 3, "Music_Cue14"
		StopMusic 1: RestartMusic.Set TRUE, 1000
		LightSeqPF.Play SeqBlinking, , 3, 100
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1000
	Else
		QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2000: PlayMusic 2, "vo_Wisely"
		PlaySound "fx_Whip3", 0.8
		LightSeqPF.Play SeqBlinking, , 2, 50
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 300
		HurryTime = HurryTime + 10
		ChooseJP = ChooseJP + 250000: ChooseTotal = ChooseTotal + (250000*xMarks)
		ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 2000
		DispDMD1.FlushQueue: DispDMD2.FlushQueue
		DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD1.QueueText "[edge3][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD1.QueueText "[edge3][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD1.QueueText "[edge3][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD1.QueueText "[edge3][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][f6][xc][yc]" & FormatScore(ChooseJP*xMarks), deNone, 50, FALSE
		DispDMD1.QueueText "[edge3][f3][xc][y4]YOU HAVE CHOSEN[f6][y14][b]WISELY", deFlip, 1000, TRUE
		DispDMD2.QueueText "[edge3][f3][xc][y4]YOU HAVE CHOSEN[f6][y14][b]WISELY", deFlip, 1000, TRUE
		AddScore(ChooseJP)
	End If
End Sub


Sub ChooseEnd()
	SceneCRUSADEComplete()
	LightCrusadeExt.SetLitColor 94, 203, 255
	LightDoomExt.SetLitColor 255, 164, 72
	LightArkExt.SetLitColor 219, 192, 241
	LightSkullExt.SetLitColor 156, 233, 131
	LightOrbitRExt.SetLitColor 243, 117, 63
	LightCrusade.State = BulbOff
	LightDoom.State = BulbOff
	LightArk.State = BulbOff
	LightSkull.State = BulbOff
	LightOrbitR.State = BulbOff
	LightOrbitL.State = BulbOff
	LightLastCrusade.State = BulbOff
	ModeTimer.Enabled = FALSE
	BallSaverTimer.Set TRUE, 1000
	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 2500
	DispDMD1.QueueText "[edge3][f3][xc][y4]YOU HAVE CHOSEN[f6][y14][bf]POORLY", deNone, 1200, FALSE
	DispDMD2.QueueText "[edge3][f3][xc][y4]YOU HAVE CHOSEN[f6][y14][bf]POORLY", deNone, 1200, FALSE
	DispDMD1.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[f6][y14][bf]" & FormatScore(ChooseTotal), deFlip, 1200, TRUE
	DispDMD2.QueueText "[edge3][f3][xc][y4]SCENE TOTAL[f6][y14][bf]" & FormatScore(ChooseTotal), deFlip, 1200, TRUE
	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 3300: PlayMusic 2, "vo_ChosenPoorly", FALSE, 1, 600
	ModeName = ""
	BulbFS.State = BulbOff: LightFS.State = BulbOff
	ArkFlash(1000)
	Clip = 64: PlayClip()
	PlayMusic 1, "Music_Cue7"
	RestartMusic.Set TRUE, 2600
End Sub




' *************************************************
' **                                             **
' **            THE CRYSTAL SKULL RAMP           **
' **                                             **
' *************************************************

' Starts each CRYSTAL SKULL scene. Both targets at the ramp entrance need to be hit to light the skull.

' ** UNFINISHED **

' Scene 1: Area 51 Warehouse
' Scene 2: Nuke Town
' Scene 3: Jungle Chase
' Scene 4: The Inter-Dimensional Chamber

' extra scene (possible future update)

' Rocket Sledge


Sub RampTrigger_Hit()
	PlaySound "fx_GateHitL"
	If (fpTilted = TRUE) Then Exit Sub

	If (BonusBall = TRUE) Then
		If (LightSkull.State = BulbOff) Then Exit Sub
		PlaySound "fx_Skull2": SkullBulb.FlashForMs 600, 100, BulbOff
		BBTotal(CP) = BBTotal(CP) + BBVal(CP)
		ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1000
		DispDMD1.Text = "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(BBVal(CP))
		DispDMD2.Text = "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(BBVal(CP))
		SkullHit = SkullHit + 1
		Select Case SkullHit
			Case 1: LightSkullS1.State = BulbOn
			Case 2: LightSkullS2.State = BulbOn
			Case 3: LightSkullS3.State = BulbOn
			Case 4: LightSkullS4.State = BulbOn
			Case 5: LightSkullMain.State = BulbOn: BBTotal(CP) = BBTotal(CP) + 350000: LightSkull.State = BulbOff
				MusicFade(1000): PlayMusic 3, "Music_Cue14"
				Flash = 0: FlashPFTimer.Set TRUE, 75
				DispDMD1.Text = "[edge3][f4][y3][bf]MOVIE COMPLETE[y17]COMPLETE"
				DispDMD2.Text = "[edge3][f4][y3][bf]MOVIE COMPLETE[y17]COMPLETE"
		End Select
		FlasherRed.FlashForMs 500, 100, BulbOff
		BulbArkL.FlashForMs 500, 100, BulbOff
		BulbArkR.FlashForMs 500, 100, BulbOff
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 500
	Exit Sub
	End If

	SkullHit = SkullHit + 1 ' for end of ball bonus...

	If (ModeName = "TScene4") Then
		' do nothing...COMBO is used for something else...
	Else
		If (ComboTimer.Enabled = TRUE) Then ' COMBO timer starts when balls hit trigger at end of ramp...
			ComboAward()
		End If
	End If

	' anytime the ramp is hit during Raiders Scene 4 (The Ark), just play a clip of a demon and some screaming....

	If (ModeName = "RScene4") Then
		AddScore(100000)
		Select Case RandomNumber(4)
			Case 1: PlaySound "fx_Demon"
			Case 2: PlaySound "fx_Demon4"
			Case 3: PlaySound "fx_Demon5"
			Case 4: PlaySound "fx_Demon6"
		End Select
		If (MovieTimer.Enabled = FALSE) Then
			NoS(): LCD2.UpdateInterval = 68: OverlayMovie.UpdateInterval = 68
			Demon = Demon + 1
			Select Case Demon
				Case 1: Clip = 52: PlayClip()
				Case 2: Clip = 53: PlayClip()
				Case 3: Clip = 54: PlayClip()
				Case 4: Clip = 55: PlayClip()
				Case 5: Clip = 56: PlayClip()
				Case 6: Clip = 1: PlayClip(): Demon = 0
			End Select
		End If
		Flash = 0: FlashPFTimer.Set TRUE, 150
		If (LightExtraBall.State = BulbOn) Then
			LightExtraBall.State = BulbOff	
			ExtraBallsAwards(CP) = ExtraBallsAwards(CP) + 1
			ShootagainLight.State = BulbOn
		End If
	Exit Sub
	End If

	' the main SHOT ARROW is blinking...

	If (LightSkull.State = BulbBlink) Then

		' 2 shots to the ramp in RAIDERS SCENE 1 will first see Indy running from the tribe and then escaping in the plane...

		If (ModeName = "RScene1") Then
			Escape = Escape + 1
			Select Case Escape
				Case 1: 
					Clip = 6: PlayClip() ' Indy running from the tribe...
					ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 3200
					DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
					DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
					DispDMD1.QueueText "[edge3][f3][xc][y3]SHOOT RAMP TO[f6][y13]GET TO PLANE", deFlip, 2000, TRUE
					DispDMD2.QueueText "[edge3][f3][xc][y3]SHOOT RAMP TO[f6][y13]GET TO PLANE", deFlip, 2000, TRUE
					SceneHit()
					MusicFade(2000): PlayMusic 3, "Music_Cue3"
					LightSeqPF.Play SeqBlinking, , 3, 75
					Flash = 0: FlashPFTimer.Set TRUE, 75
					BulbFS.State = BulbOff: LightFS.State = BulbOff
					LastShot = TRUE ' the next shot will complete the scene...
				Case 2: StopIt = TRUE: PopUpLane.SolenoidPulse(8500): BallHeld = TRUE: EndMode()
			End Select
			If (LightExtraBall.State = BulbOn) Then GetExtra()
		Exit Sub
		End If

		' escape in the plane for TEMPLE SCENE 1...

		If (ModeName = "TScene1") Then
			If (Antidote = TRUE) Then
				BallHeld = TRUE
				StopIt = TRUE: PopUpLane.SolenoidPulse(5000) ' hold ball on the ramp...
				EndMode()
			Else
				GetAntidote()
			End If
			If (LightExtraBall.State = BulbOn) Then GetExtra()
		Exit Sub
		End If

		' jump from the plane in TEMPLE SCENE 2...

		If (ModeName = "TScene2") Then
			ModeHit = ModeHit + 1: TempleSceneHit()
			If (LightExtraBall.State = BulbOn) Then GetExtra()
		Exit Sub
		End If

		' ride in the minecart in TEMPLE SCENE 3...reset INDY JONES targets...

		If (ModeName = "TScene3") Then
			LightSkull.State = BulbOff
			LightSeqPF.Play SeqBlinking, , 4, 100
			BulbArkL.FlashForMs 1500, 1500, BulbOff
			BulbArkR.FlashForMs 1500, 1500, BulbOff
			FlasherRed.FlashForMs 1500, 1500, BulbOff
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1500
			ModeHit = ModeHit + 1
			Select Case ModeHit
				Case 1: PlaySound "fx_MineRamp"
					If (MovieTimer.Enabled = FALSE) Then
						Clip = 30: PlayClip()
					End If
				Case 2: PlaySound "fx_MineCart"
				Case 3: PlaySound "fx_MineCart6"
				Case 4: PlayMusic 2, "vo_LetGoBrake"
				Case 5: PlaySound "fx_MineCart5"
				Case 6: PlayMusic 2, "vo_LetGoBrake2"
				Case 7: PlaySound "fx_MineRamp": ModeHit = 6
					If (MovieTimer.Enabled = FALSE) Then
						Clip = 30: PlayClip()
					End If
			End Select

			' reset the INDY JONES targets, more to hit, more points to score...
			LightINDY1.Set BulbBlink, "10", 125
			LightINDY2.Set BulbBlink, "10", 125
			LightINDY3.Set BulbBlink, "10", 125
			LightINDY4.Set BulbBlink, "10", 125
			LightJONES1.Set BulbBlink, "10", 125
			LightJONES2.Set BulbBlink, "10", 125
			LightJONES3.Set BulbBlink, "10", 125
			LightJONES4.Set BulbBlink, "10", 125
			LightJONES5.Set BulbBlink, "10", 125

			If (LightExtraBall.State = BulbOn) Then GetExtra()
		Exit Sub
		End If

		' cut the rope bridge in TEMPLE SCENE 4, needs to be a COMBO shot to qualify...

		If (ModeName = "TScene4") Then
			If (ComboTimer.Enabled = TRUE) Then
				ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
				DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
				DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
				SceneHit()
				Clip = 46: PlayClip(): MusicFade(2000)
				LightOrbitR.State = BulbOff
				LightSkull.State = BulbOff
				LightArk.State = BulbBlink
				PlayMusic 3, "Music_Cue3"
				Flash = 0: FlashPFTimer.Set TRUE, 100
			Else
				ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1000
				DispDMD1.QueueText "[edge3][f4][y3][b]MAKE COMBO[y17]TO CUT ROPE", deNone, 1000, TRUE
				DispDMD2.QueueText "[edge3][f4][y3][b]MAKE COMBO[y17]TO CUT ROPE", deNone, 1000, TRUE
				CutRope()
			End If
			If (LightExtraBall.State = BulbOn) Then GetExtra()
		Exit Sub
		End If

		' run across train in CRUSADE SCENE 1...

		If (ModeName = "CScene1") Then
			Clip = 23: PlayClip()
			LightSkull.State = BulbOff
			LightCrusade.State = BulbBlink
			ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 3500
			DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, FALSE
			DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, FALSE
			DispDMD1.QueueText "[edge3][f3][xc][y3]ESCAPE IN THE[f6][y13]MAGIC TRUNK", deFlip, 2000, TRUE
			DispDMD2.QueueText "[edge3][f3][xc][y3]ESCAPE IN THE[f6][y13]MAGIC TRUNK", deFlip, 2000, TRUE
			SceneHit()
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 500
			BulbArkL.FlashForMs 500, 100, BulbOff
			BulbArkR.FlashForMs 500, 100, BulbOff
			FlasherRed.FlashForMs 500, 100, BulbOff
			LightSeqPF.Play SeqBlinking, , 5, 100
			BulbFS.State = BulbOff: LightFS.State = BulbOff
			If (LightExtraBall.State = BulbOn) Then GetExtra()
		Exit Sub
		End If

		' dogfight CRUSADE SCENE 2...
		If (ModeName = "CScene2") Then
			'LightSkull.State = BulbOff
			If (MovieTimer.Enabled = FALSE) Then
				NoS()
				OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100
				LCD.Frame 591,592,591: OverlayLCD.Frame 591,592,591: MovieTimer.Set TRUE, 1000
			End If
			DogFightHit()
			PlaySound "fx_PlaneShoot"
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1000
			BulbArkL.FlashForMs 1000, 75, BulbOff
			BulbArkR.FlashForMs 1000, 75, BulbOff
			FlasherRed.FlashForMs 1000, 75, BulbOff
			LightSeqPF.Play SeqBlinking, , 7, 75
			If (LightExtraBall.State = BulbOn) Then GetExtra()
		Exit Sub
		End If

		' tank CRUSADE shot...
		If (ModeName = "CScene3") Then
			TankHit()
			If (LightExtraBall.State = BulbOn) Then GetExtra()
		Exit Sub
		End If

		' Rocket Car, divert the ball into the bumpers...
		If (ModeName = "SScene1") Then
			If (LightSkull.State = BulbBlink) Then RampDiverter.SolenoidPulse(2000)
		Exit Sub
		End If

		' mind control SKULL SCENE 3...
		If (ModeName = "SScene3") Then
			SkullPowerHit()
			If (LightExtraBall.State = BulbOn) Then GetExtra()
		Exit Sub
		End If

		If (ModeName = "SScene4") Then
			LightSkull.State = BulbOff
			ModeHit = ModeHit + 1
			If (ModeHit = 4) Then EndMode(): Exit Sub
			ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
			DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			SceneHit()
			MusicFade(1000): PlayMusic 3, "Music_Cue3"
			LightSeqPF.Play SeqBlinking, , 3, 75
			Flash = 0: FlashPFTimer.Set TRUE, 75
			If (LightExtraBall.State = BulbOn) Then GetExtra()
		Exit Sub
		End If

	End If

	' ramp hit during TEMPLE SCENE 2 when not lit...

	If (ModeName = "TScene2") Then
		If (QuoteBusy = FALSE) Then
			If (QPlay = FALSE) Then
				QPlay = TRUE: MusicFade(1500)
				QuoteBusy = TRUE: PlayMusic 2, "vo_NoOneFlying"
				Clip = 24: PlayClip()
			Else
				PlaySound "fx_Plane1"
			End If
		Exit Sub
		End If
		If (LightExtraBall.State = BulbOn) Then GetExtra()
	Exit Sub
	End If

	If (ModeName = "TScene3") Then
		' player has missed the right orbit and hit the ramp, just remind them to do as they are told...
		If (LightOrbitR.State = BulbBlink) Then
			PlaySound "fx_MineCart4", 0.7
			'PlayMusic 2, "vo_TakeLeftTunnel"
			ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
			DispDMD1.Text = "[edge3][f3][xc][y4]SHOOT THE[f6][y14][bf]RIGHT ORBIT"
			DispDMD2.Text = "[edge3][f3][xc][y4]SHOOT THE[f6][y14][bf]RIGHT ORBIT"
		Else
			Select Case RandomNumber(2)
				Case 1: PlaySound "fx_MineCart"
				Case 2: PlaySound "fx_MineCart6"
			End Select
		End If
	Exit Sub
	End If

	' ramp hit when not lit during CRUSADE SCENE 4, you have chosen poorly...

	If (ModeName = "CScene4") Then
		If (LightSkull.State = BulbBlink) Then
			LightSkullExt.SetLitColor 255, 0, 0
			LightSkull.State = BulbOn
			CheckChooseLights()
		Else
			ChooseEnd()
		End If
		If (LightExtraBall.State = BulbOn) Then GetExtra()
	Exit Sub
	End If

	' a movie mode is running but the ramp shot is not part of it, increase the movie jackpot...
	If (ModeName <>"") Then
		If (ModeName = "RScene1") Then PlaySound "fx_13"
		If (ModeName = "TScene3") Then PlaySound "fx_MineCart5"
		If (ModeName = "TScene4") Then CutRope()
		If (ModeName = "CScene1") Then PlaySound "fx_Train2"
		If (ModeName = "CScene2") Then PlaySound "fx_Plane1"
		If (ModeName = "SScene1") or (ModeName = "SScene3") Then PlaySound "fx_Truck"
		If (ModeName = "TScene1") Then PlaySound "fx_MachineGun2": ArkFlash(1000)
		AdvMovieJP()
		If (LightExtraBall.State = BulbOn) Then GetExtra()
	Exit Sub
	End If

	' ALL OTHER RAMP SHOTS CONTRIBUTE TOWARDS STARTING THE CRYSTAL SKULL SCENES

	' the 2 torches at the ramp entrance have been lit and the Crystal Skull is lit...

	If (RROn(CP) = TRUE) and (LROn(CP) = TRUE) Then

		RROn(CP) = FALSE: LROn(CP) = FALSE
		SkullBulb.FlashForMs 1000, 200, BulbOff
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1500
		TorchFlameL2.Frame 41: TorchFlameL2.FadeOut: BulbFlameL2.State = BulbOff
		TorchFlameR2.Frame 41: TorchFlameR2.FadeOut: BulbFlameR2.State = BulbOff
		SkullHitsRemain(CP) = SkullHitsRemain(CP) - 1

		If (SkullHitsRemain(CP) = 0) Then ' start the next CRYSTAL SKULL scene...
			
			If (LightExtraBall.State = BulbOn) Then
				LightExtraBall.State = BulbOff
				ExtraBallsAwards(CP) = ExtraBallsAwards(CP) + 1
				ShootAgainLight.State = BulbOn
			End If
			
			SceneTotal = 200000: SceneVal = 210000 ' start value for the first shot...
			AddScore(200000)

			If (FreeShot(CP) =>1) Then BulbFS.State = BulbBlink: LightFS.State = BulbBlink

			If (LightSkullS1.State = BulbBlink) Then StartCS1(): Exit Sub
			If (LightSkullS2.State = BulbBlink) Then StartCS2(): Exit Sub
			If (LightSkullS3.State = BulbBlink) Then StartCS3(): Exit Sub
			If (LightSkullS4.State = BulbBlink) Then StartCS4(): Exit Sub
		Exit Sub
		Else

			PlaySound "fx_Skull"

			If (QuoteBusy = FALSE) Then
				QuoteBusy = TRUE
				Select Case RandomNumber(5)
					Case 1: MusicFade(2200): PlayMusic 2, "vo_PureCrystal"
					Case 2: MusicFade(2100): PlayMusic 2, "vo_TheSkull"
					Case 3: MusicFade(3200): PlayMusic 2, "vo_Akator"
					Case 4: MusicFade(3000): PlayMusic 2, "vo_NaturalForce"
					Case 5: MusicFade(1800): PlayMusic 2, "vo_Point"
				End Select
			End If

			If (MovieTimer.Enabled = FALSE) Then
				NoS()
				Select Case SkullHitsRemain(CP)
					Case 1: OverlayLCD.Frame 78: LCD.Frame 78: MovieTimer.Set TRUE, 1500
					Case 2: OverlayLCD.Frame 79: LCD.Frame 79: MovieTimer.Set TRUE, 1500
					Case 3: OverlayLCD.Frame 80: LCD.Frame 80: MovieTimer.Set TRUE, 1500
					Case 4: OverlayLCD.Frame 81: LCD.Frame 81: MovieTimer.Set TRUE, 1500
				End Select
			End If

			If (ScoreUpdate = TRUE) Then
				ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
				DispDMD1.Text = "[edge3][f2][xc][y4]CRYSTAL SKULL IN[y14][f6]" & SkullHitsRemain(CP) & " HITS"
				DispDMD2.Text = "[edge3][f2][xc][y4]CRYSTAL SKULL IN[y14][f6]" & SkullHitsRemain(CP) & " HITS"
			End If
		End If
	Else

		' remind the player to light the 2 torches first before shooting the ramp...

		AddScore(RampVal(CP))

		If (ScoreUpdate = TRUE) Then
			ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
			DispDMD1.QueueText "[edge3][f4][y3][b]SHOOT TORCHES[y17]TO ADV SKULL", deNone, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][y3][b]SHOOT TORCHES[y17]TO ADV SKULL", deNone, 1500, TRUE
		End If

		Select Case RandomNumber(5)
			Case 1:
				If (PlaneOn = FALSE) Then
					PropSpeed = 4000
					PlaneProp1.Rotatexy propspeed
					PropSlow.Set TRUE, 1000
				End If
				PlaySound "fx_Plane1"
				Flash = 0
				FlashPFTimer.Set TRUE, 150
			Case 2: 
				PlaySound "fx_MineRamp"
				Flash = 0
				FlashPFTimer.Set TRUE, 150
			Case 3:
				PlaySound "fx_Truck"
			Case 4:
				PlaySound "fx_Bike"
			Case 5:
				PlaySound "fx_MineCart5"
		End Select
	End If

	If (LightExtraBall.State = BulbOn) Then GetExtra()
End Sub


' on the very rare occasion the ball will get stuck on the ramp, there is an opening above the bumpers
' where the ball can exit...with some gentle persuation...

Sub TrigRampStop_Hit()
	If (SuperPops = TRUE) Then
		PlaySound "fx_MetalHitHardL"
		PlaySound "fx_BallDropL"
	Exit Sub
	End If
	' Rocket Car, divert the ball into the bumpers...
	If (ModeName = "SScene1") Then
		If (LightSkull.State = BulbBlink) Then
			PlaySound "fx_MetalHitHardL"
			PlaySound "fx_BallDropL"
		End If
	Exit Sub
	End If
	RampStopTimer.Set TRUE, 3000
End Sub


Sub TrigRampStop_UnHit()
	RampStopTimer.Enabled = FALSE
End Sub


Sub RampStopTimer_Expired()
	RampStopTimer.Enabled = FALSE
	PlaySound "fx_Punch7"
	RampDiverter.SolenoidPulse(1000)
End Sub


Sub TriggerRampEnd_Hit()
	RampStopTimer.Enabled = FALSE
	If (BallHeld = FALSE) Then
		ComboTimer.Set TRUE, 3000
	Else
		BallHeld = FALSE
	End If
	set LastSwitchHit = TriggerRampEnd
End Sub


' the plane toy rotor animation is handled here...

Sub StartPlane_Expired()
	StartPlane.Enabled = FALSE
	PlaneOn = TRUE
	PropSpeed = 3000
	PlaneProp1.Rotatexy PropSpeed
	If (ModeName = "RScene1") Then Clip = 21: PlayClip() ' only play propeller clip for Raiders 1...
	PlayMusic 5, "fx_PlaneStart", FALSE, 0.5 
	FlasherSword.FlashForMs 1000, 100, BulbOff
	SpotSword.FlashForMs 1000, 100, BulbOff
End Sub


Sub RampGate_Hit()
	PlaySound "fx_GateHitL"
End Sub




' ****************************
' **                        **
' **          COMBO         **
' **                        **
' ****************************

' Making a Combo shot, ramp to ramp or ramp to right loop, feels great doesn't it?  Some nice points
' here too.

' Make a 4-way Combo to light the SPECIAL.

' Possible future update:

' will spell ADVENTURE throughout the game.
' Complete ADVENTURE to activate DOUBLE SCORING for the rest of the ball.


Sub ComboTimer_Expired()
	ComboTimer.Enabled = FALSE
	ComboVal = 0: ComboX = 1
End Sub



Sub ComboAward()
	ComboTotal = ComboTotal + 1
	ComboVal = ComboVal + 50000
	AddScore(ComboVal)
	ComboTimer.Set TRUE, 3000
	' combo is used for something else here...
	If (ModeName = "TScene4") or (ModeName = "SScene3") Then Exit Sub
	ComboX = ComboX + 1
	If (QuoteBusy = FALSE) Then
		QuoteBusy = TRUE
		Select Case ComboX
			Case 2: MusicFade(500): PlayMusic 2, "vo_Wow"
			Case 3: MusicFade(1000): PlayMusic 2, "vo_WowHolySmoke"
			Case 4: MusicFade(1600): PlayMusic 2, "vo_Incredible", FALSE, 1, 750
			Case else: MusicFade(1500): PlayMusic 2, "vo_Unreal", FALSE, 1, 750
		End Select
	End If

	' increase the Ramp Val is Combo Perk active...
	If (PerkCombo(CP) = TRUE) Then
		RampVal(CP) = RampVal(CP) + 5000
	End If

	If (ComboX = 4) Then 
		If (PerkSpecial(CP) = TRUE) Then
			LightSpecialL.State = BulbOn
			LightSpecialR.State = BulbOn
		Else
			LightSpecialL.State = BulbOn
		End If
		BulbArkL.FlashForMs 1000, 75, BulbOff
		BulbArkR.FlashForMs 1000, 75, BulbOff
		FlasherRed.FlashForMs 1000, 75, BulbOff
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1000
		PlaySound "fx_GunQuad"
		ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1000
		DispDMD1.QueueText "[edge3][box3,1,1,126,30][f5][xc][y2]4-WAY COMBO[f6][y14]SPECIAL LIT", deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][box3,1,1,126,30][f5][xc][y2]4-WAY COMBO[f6][y14]SPECIAL LIT", deNone, 50, FALSE
		DispDMD1.QueueText "[edge3][f5][xc][y2]4-WAY COMBO[f6][y14]SPECIAL LIT", deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][f5][xc][y2]4-WAY COMBO[f6][y14]SPECIAL LIT", deNone, 50, FALSE
	Else
		PlaySound "fx_Whip5": WhipFlash()
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1000
		ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1000
		DispDMD1.QueueText "[edge3][box3,1,1,126,30][f5][xc][y2]COMBO X "&ComboX&"[f6][y14]" & FormatScore(ComboVal*xMarks), deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][box3,1,1,126,30][f5][xc][y2]COMBO X "&ComboX&"[f6][y14]" & FormatScore(ComboVal*xMarks), deNone, 50, FALSE
		DispDMD1.QueueText "[edge3][f5][xc][y2]COMBO X "&ComboX&"[f6][y14]" & FormatScore(ComboVal*xMarks), deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][f5][xc][y2]COMBO X "&ComboX&"[f6][y14]" & FormatScore(ComboVal*xMarks), deNone, 50, FALSE
	End If
End Sub




' ************************************************
' **                                            **
' **          CRYSTAL SKULL - SCENE 1           **
' **                                            **
' ************************************************

' Rocket Car scene.

' - Shoot the bumpers to power up the thruster (20 times)
' - Shoot the Grail Scoop to start the rocket

' Ball Saver is active for the duration of the scene (to help get the ball into the bumpers)

' Shot values for each scene will be the same and progressive, starting at 255k, increasing by 155k.


Sub StartCS1()
	LightSkullS1.State = BulbBlink
	LightCrystalSkull.State = BulbOff
	ResetBumpers.Enabled = FALSE
	
	StopHurryUps(): StopFastScoring()

	If (TempleOpen = TRUE) Then CloseChamber(): StoneHitsRemain(CP) = 1
	If (CairoSwordsman = TRUE) Then StopSwordsman()
	TempCrusade(CP) = LightLastCrusade.State:	LightLastCrusade.State = BulbOff
	TempDoom(CP) = LightTempleOfDoom.State: LightTempleOfDoom.State = BulbOff
	TempRaiders(CP) = LightRaidersArk.State: LightRaidersArk.State = BulbOff

	PopUpLane.SolenoidPulse(3000)
	ModeHit = 0: Thrust = 0
	HurryTime = 31: ModeTimer.Set TRUE, 3000 ' 34 seconds...

	' make sure SUPER POPS isn't active, we're taking over the pops...
	SuperPops = FALSE
	ResetBumpers.Enabled = FALSE

	' the bumpers are the targets, flash the shots leading to them...
	LightSkull.Set BulbBlink, "10", 125
	LightOrbitR.Set BulbBlink, "10", 125
	Bumper1.State = BulbBlink
	Bumper2.State = BulbBlink
	Bumper3.State = BulbBlink
	Bumper4.State = BulbBlink

	' set off the Ark lighs to mimic warning hazard lights... 
	PlasDarkOn()
	bulb4.State = BulbBlink
	bulb5.State = BulbBlink
	bulb6.State = BulbBlink
	bulb7.State = BulbBlink
	bulb8.State = BulbBlink
	bulb9.State = BulbBlink
	bulb10.State = BulbBlink
	bulb12.State = BulbBlink
	bulb13.State = BulbBlink
	bulb14.State = BulbBlink
	bulb15.State = BulbBlink
	bulb16.State = BulbBlink
	bulb17.State = BulbBlink
	bulb18.State = BulbBlink
	FlasherRed.State = BulbOn
	FlasherOff.Set TRUE, 3000
	Flash = 5: FlashPFTimer.Set TRUE, 3000

	StopIt = TRUE ' stop the left inlane from activating when ball exits ramp, this one time...

	Clip = 60: PlayClip()
	ModeName = "SScene1"
	PlayMusic 1, "Music_RocketCar", TRUE, 0.8
	
	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 3200
	DispDMD1.QueueText "[edge3][xc][yc][f6]ROCKET SLED", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]ROCKET SLED", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f4][y3][b]SHOOT BUMPERS TO[y17]INITIATE THRUSTER", deFlip, 2000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3][b]SHOOT BUMPERS TO[y17]INITIATE THRUSTER", deFlip, 2000, TRUE
	SkullNeeded(CP) = SkullNeeded(CP) + 1: SkullHitsRemain(CP) = SkullNeeded(CP)

	bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, 34000 ' ball saver is active for the duration of the mode...
	ShootAgainLight.State = BulbBlink
End Sub


' Each time a lit bumper is hit, we go here...20 hits needed (using a FREE SHOT will give you a big boost)

Sub RocketHit()
	Thrust = Thrust + 5
	If (Thrust > 99) Then
		' fire the thrusters...
		LightSkull.State = BulbOff
		LightOrbitR.State = BulbOff
		Bumper1.State = BulbOff
		Bumper2.State = BulbOff
		Bumper3.State = BulbOff
		Bumper4.State = BulbOff
		RampDiverter.SolenoidOff
		BulbFS.State = BulbOff: LightFS.State = BulbOff
		MusicFade(3000): Clip = 61: PlayClip()
		LightSeqJP.Play SeqDoNothing, , , 1000
		LightSeqJP.Play SeqBlinking, , 1, 2000
		LightSeqPF.Play SeqDoNothing, , , 1000
		LightSeqPF.Play SeqRandom, 30, 1, 2000
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 3000
		LightCrusade.State = BulbBlink ' now shoot the Grail and hang on...
		If (ScoreUpdate = TRUE) Then
			NoPlay = TRUE: ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2300
			DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]T H R U S T", deNone, 50, FALSE
			DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]T H R U S T", deNone, 50, FALSE
			DispDMD1.QueueText "[edge3][f6][xc][yc]T H R U S T", deNone, 50, FALSE
			DispDMD2.QueueText "[edge3][f6][xc][yc]T H R U S T", deNone, 50, FALSE
			DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]T H R U S T", deNone, 50, FALSE
			DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]T H R U S T", deNone, 50, FALSE
			DispDMD1.QueueText "[edge3][f6][xc][yc]T H R U S T", deNone, 50, FALSE
			DispDMD2.QueueText "[edge3][f6][xc][yc]T H R U S T", deNone, 50, FALSE
			DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]T H R U S T", deNone, 50, FALSE
			DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]T H R U S T", deNone, 50, FALSE
			DispDMD1.QueueText "[edge3][f6][xc][yc]T H R U S T", deNone, 50, FALSE
			DispDMD2.QueueText "[edge3][f6][xc][yc]T H R U S T", deNone, 50, FALSE
			DispDMD1.QueueText "[edge3][f4][y3][b]SHOOT GRAIL TO[y17]LAUNCH ROCKET", deFlip, 2000, TRUE
			DispDMD2.QueueText "[edge3][f4][y3][b]SHOOT GRAIL TO[y17]LAUNCH ROCKET", deFlip, 2000, TRUE
		End If
		SceneHit()
	Else
		PlaySound "fx_ElectricHit", 0.5
		If (ScoreUpdate = TRUE) Then
			FlushDMDTimer.Set TRUE, 500
			DispDMD1.Text = "[edge3][f2][xc][y4]ROCKET THRUST[y14][f6]LEVEL - "&Thrust&"%"
			DispDMD2.Text = "[edge3][f2][xc][y4]ROCKET THRUST[y14][f6]LEVEL - "&Thrust&"%"
		End If
	End If
End Sub




' ************************************************
' **                                            **
' **          CRYSTAL SKULL - SCENE 2           **
' **                                            **
' ************************************************

' A siren warns of an imminent nuclear test. Indy must find a way to survive it.

' - shoot the Stone CAPTIVE BALL to open the chamber
' - shoot the chamber to climb inside the fridge

' Fail and the table will shut down to allow the ball to drain while the nuke goes off.
' This ball is returned to the player without penalty.


Sub StartCS2()
	LightSkullS2.State = BulbBlink
	LightCrystalSkull.State = BulbOff

	StopHurryUps(): StopFastScoring()

	TempCrusade(CP) = LightLastCrusade.State:	LightLastCrusade.State = BulbOff
	TempDoom(CP) = LightTempleOfDoom.State: LightTempleOfDoom.State = BulbOff
	TempRaiders(CP) = LightRaidersArk.State: LightRaidersArk.State = BulbOff

	ModeHit = 0
	HurryTime = 18: ModeTimer.Set TRUE, 4000

	' need to shoot the captive ball to open the hole then shoot the hole...
	LightDoom.Set BulbBlink, "10", 125

	If (TempleOpen = TRUE) Then CloseChamber(): StoneHitsRemain(CP) = 1

	If (CairoSwordsman = TRUE) Then StopSwordsman()

	ModeName = "SScene2"

	PlayMusic 1, "Music_NukeTown" , TRUE, 0.8, 1000
	PlayMusic 4, "fx_NukeSiren2", FALSE, 1
	PlayMusic 2, "vo_WaitAMin"
	PopUpLane.SolenoidPulse(3500)

	Clip = 41: PlayClip()

	' set off the Ark lighs to mimic warning hazard lights... 
	PlasDarkOn()
	bulb4.State = BulbBlink
	bulb5.State = BulbBlink
	bulb6.State = BulbBlink
	bulb7.State = BulbBlink
	bulb8.State = BulbBlink
	bulb9.State = BulbBlink
	bulb10.State = BulbBlink
	bulb12.State = BulbBlink
	bulb13.State = BulbBlink
	bulb14.State = BulbBlink
	bulb15.State = BulbBlink
	bulb16.State = BulbBlink
	bulb17.State = BulbBlink
	bulb18.State = BulbBlink
	FlasherRed.State = BulbOn
	FlasherOff.Set TRUE, 3500
	Flash = 5: FlashPFTimer.Set TRUE, 3500

	StopIt = TRUE ' stop the left inlane from activating when ball exits ramp, this one time...

	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 4000
	DispDMD1.QueueText "[edge3][xc][yc][f6]NUKE TOWN", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]NUKE TOWN", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f4][y3]NUCLEAR TEST[y17][bf]IMMINENT", deFlip, 1000, FALSE
	DispDMD2.QueueText "[edge3][f4][y3]NUCLEAR TEST[y17][bf]IMMINENT", deFlip, 1000, FALSE
	DispDMD1.QueueText "[edge3][f4][y3]SHOOT STONE TO[y17][bf]GET IN FRIDGE", deFlip, 1000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3]SHOOT STONE TO[y17][bf]GET IN FRIDGE", deFlip, 1000, TRUE
	SkullNeeded(CP) = SkullNeeded(CP) + 1: SkullHitsRemain(CP) = SkullNeeded(CP)
End Sub




' ************************************************
' **                                            **
' **          CRYSTAL SKULL - SCENE 3           **
' **                                            **
' ************************************************

' Mind control.  The skull has power over your mind.

' The flippers are switched, make the shots to break free.


' ** MEDIA NEEDED **

' - Indy faces the skull (start)
' - Indy reacts to skull's power
' - Indy is released from power (end)


Sub StartCS3()
	LightCrystalSkull.State = BulbOff
	LightSkullS3.State = BulbBlink
	StopHurryUps(): StopFastScoring()

	' if any of the other movies were ready to start, save the states...
	TempCrusade(CP) = LightLastCrusade.State:	LightLastCrusade.State = BulbOff
	TempDoom(CP) = LightTempleOfDoom.State: LightTempleOfDoom.State = BulbOff
	TempRaiders(CP) = LightRaidersArk.State: LightRaidersArk.State = BulbOff

	ModeHit = 0: 
	HurryTime = 40: ModeTimer.Set TRUE, 5000

	PopUpLane.SolenoidPulse(5000)

	LightSkull.Set BulbBlink, "10", 125 ' shoot the skull or the 2 stand up targets...

	If (TempleOpen = TRUE) Then CloseChamber(): StoneHitsRemain(CP) = 1

	If (CairoSwordsman = TRUE) Then StopSwordsman()
	
	Flipped = TRUE ' switch the flippers...oh how original...it's only for the first shot...

	ModeName = "SScene3"
	PlayMusic 1, "Music_Skull", TRUE, 0.8, 4500
	PlayMusic 3, "vo_ChangeYou", FALSE, 1
	PlayMusic 2, "vo_Easy", FALSE, 1, 4900

	Clip = 67: PlayClip()

	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 7900

	StopIt = TRUE ' stop the left inlane from activating when ball exits ramp, this one time...

	SkullBulb.State = BulbOn ' turn the skull toy back on...

	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 5000
	DispDMD1.QueueText "[edge3][xc][yc][f6]MIND CONTROL", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]MIND CONTROL", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f2][xc][y4]THE SKULL HAS[y13]POWER OVER YOUR[y22]MIND - BREAK FREE", deFlip, 3000, FALSE
	DispDMD2.QueueText "[edge3][f2][xc][y4]THE SKULL HAS[y13]POWER OVER YOUR[y22]MIND - BREAK FREE", deFlip, 3000, FALSE
	DispDMD1.QueueText "[edge3][f4][y3][bf]FLIPPERS REVERSED[/bf][y17]SHOOT SKULL", deNone, 1000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3][bf]FLIPPERS REVERSED[/bf][y17]SHOOT SKULL", deNone, 1000, TRUE, "fx_DMDPrompt"
	SkullNeeded(CP) = SkullNeeded(CP) + 1: SkullHitsRemain(CP) = SkullNeeded(CP)
	bBallSaverActive = TRUE: ShootAgainLight.State = BulbBlink
End Sub




Sub SkullPowerHit()
	ModeHit = ModeHit + 1
	PlaySound "fx_Skull3"
	If (ModeHit = 6) Then EndMode(): StopIt = TRUE: PopUpLane.SolenoidPulse(6000): Exit Sub
	' the skull toy will blink faster and faster with each hit...(fading would be better)...
	' (add creepy pulse sound fx here, to match the rythum of the skull blinking)

	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
	DispDMD1.Text = "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks)
	DispDMD2.Text = "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks)

	' pause the timer each time and stop the ticking fx...
	If (QuoteBusy = FALSE) Then ModeTimer.Enabled = FALSE: StopMusic 8

	StopIt = TRUE
	Select Case ModeHit
		Case 1: SkullBulb.Set BulbBlink, "10", 250
			If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: MusicFade(3200): PlayMusic 2, "vo_KnowSecrets": PopUpLane.SolenoidPulse(2900): ModeTimer.Set TRUE, 2900
			Flipped = FALSE: BallSaverTimer.Set TRUE, BSTime(CP)
			DispDMD1.Text = "[edge3][f4][y3][bf]FLIPPERS BACK[/bf][y17]"&FormatScore(SceneVal*xMarks)
			DispDMD2.Text = "[edge3][f4][y3][bf]FLIPPERS BACK[/bf][y17]"&FormatScore(SceneVal*xMarks)
		Case 2: SkullBulb.Set BulbBlink, "10", 200
			If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: MusicFade(3000): PlayMusic 2, "vo_OurThoughts": PopUpLane.SolenoidPulse(2400): ModeTimer.Set TRUE, 2400
		Case 3: SkullBulb.Set BulbBlink, "10", 150
			If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: MusicFade(4600): PlayMusic 2, "vo_OurCommand": PopUpLane.SolenoidPulse(4000): ModeTimer.Set TRUE, 4000
		Case 4: SkullBulb.Set BulbBlink, "10", 100
			If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: MusicFade(4500): PlayMusic 2, "vo_EverywhereAtOnce": PopUpLane.SolenoidPulse(3900): ModeTimer.Set TRUE, 3900
		Case 5: SkullBulb.Set BulbBlink, "10", 50
			If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: MusicFade(4400): PlayMusic 2, "vo_BestPart", FALSE, 1, 400: PopUpLane.SolenoidPulse(3900): ModeTimer.Set TRUE, 3900
	End Select
	SceneHit()
	PlayMusic 3, "Music_Cue18"
	LightSeqPF.Play SeqBlinking, , 2, 75
	Flash = 2: FlashPFTimer.Set TRUE, 75
End Sub




' ************************************************
' **                                            **
' **          CRYSTAL SKULL - SCENE 4           **
' **                                            **
' ************************************************

' The chamber, returning the skull.


' ** MEDIA NEEDED **

' - skull attaches back to body, chamber activates (start)
' - portal opens, panic
' - Indy and company go up the water chute to the surface (end)


Sub StartCS4()
	LightCrystalSkull.State = BulbOff
	LightSkullS4.State = BulbBlink
	StopHurryUps(): StopFastScoring()

	' if any of the other movies were ready to start, save the states...
	TempCrusade(CP) = LightLastCrusade.State:	LightLastCrusade.State = BulbOff
	TempDoom(CP) = LightTempleOfDoom.State: LightTempleOfDoom.State = BulbOff
	TempRaiders(CP) = LightRaidersArk.State: LightRaidersArk.State = BulbOff

	ModeHit = 0
	HurryTime = 30: ModeTimer.Set TRUE, 3000

	PopUpLane.SolenoidPulse(2000)

	LightCrusade.Set BulbBlink, "10", 125
	LightDoom.Set BulbBlink, "10", 125
	LightArk.Set BulbBlink, "10", 125
	LightSkull.Set BulbBlink, "10", 125
	LightOrbitR.Set BulbBlink, "10", 125
	LightOrbitL.Set BulbBlink, "10", 125

	If (TempleOpen = TRUE) Then CloseChamber(): StoneHitsRemain(CP) = 1

	If (CairoSwordsman = TRUE) Then StopSwordsman()
	
	ModeName = "SScene4"
	PlayMusic 1, "Music_Mutt", TRUE, 0.8
	PlayMusic 2, "vo_Skull", FALSE, 1

	MovieTimer_Expired()

	StopIt = TRUE ' stop the left inlane from activating when ball exits ramp, this one time...

	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 4000
	DispDMD1.QueueText "[edge3][xc][yc][f6]RETURN", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6]RETURN", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f2][xc][y4]RETURN THE SKULL[y13]TO THE CHAMBER[y22]AND ESCAPE", deFlip, 2000, FALSE
	DispDMD2.QueueText "[edge3][f2][xc][y4]RETURN THE SKULL[y13]TO THE CHAMBER[y22]AND ESCAPE", deFlip, 2000, FALSE
	DispDMD1.QueueText "[edge3][f4][y3][b]SHOOT LIT ARROWS[y17]FOR JACKPOTS", deFlip, 1000, TRUE
	DispDMD2.QueueText "[edge3][f4][y3][b]SHOOT LIT ARROWS[y17]FOR JACKPOTS", deFlip, 1000, TRUE
	SkullNeeded(CP) = SkullNeeded(CP) + 1: SkullHitsRemain(CP) = SkullNeeded(CP)
End Sub



Sub EndMovieScene()
	ModeName = ""
	LightRaidersArk.State = TempRaiders(CP) 
	LightTempleOfDoom.State = TempDoom(CP)
	LightLastCrusade.State = TempCrusade(CP) 
	LightSkull.State = TempSkull(CP)
End Sub





' ************************************************
' **                                            **
' **              I-N-D-Y TARGETS               **
' **                                            **
' ************************************************

' INDY and JONES Fast Scoring are only activated during the Skill Shot.

' A strobing letter now has a start value of 55k. Hit it to collect this value and double it each time.
' Hit the strobing letter 3 times to complete the feature and collect 550k

' These targets are also used in various scenes, so states will be saved if needed

' RScene1 - poison darts (all acts)
' RScene2 - Nazis killed in bar (act 2)
' RScene3 - guards thrown from truck (act 2)
' TScene1 - grab the diamond (act 1)
' TScene3 - minecart kill (act 2)


Sub TgtINDY1_Hit()
	If (fpTilted = TRUE) Then Exit Sub

	If (ModeName = "RScene4") Then RaidersJP(CP) = RaidersJP(CP) + 1000: RndBulletHit(): RaidersHit(): Exit Sub

	If (LightINDY1.State <> BulbOff) Then
		If (INDYScoring = TRUE) Then IndyHit(): Exit Sub
		If (IJScoring = TRUE) Then IndyJonesHit(): Exit Sub
		If (ModeName = "TScene1") and (Diamond = FALSE) Then GetDiamond(): Exit Sub
		If (ModeName = "RScene2") and (NaziTgt = TRUE) Then NaziKill(): LightINDY1.State = BulbOff: Exit Sub
		If (ModeName = "RScene3") and (NaziTgt = TRUE) Then INDYThrow = TRUE: GuardThrow(): Exit Sub
		If (ModeName = "TScene3") Then MineKill(): LightINDY1.State = BulbOff: Exit Sub
	Else
		' missed shot, show Monkey squeel...
		If (INDYScoring = TRUE) and (MovieTimer.Enabled = FALSE) Then Clip = 7: PlayClip(): Exit Sub
	End If

	' missed the diamond shot...
	If (ModeName = "TScene1") and (Diamond = FALSE) Then
		If (MovieTimer.Enabled = FALSE) Then
			Clip = 31: PlayClip()
		End If
	Exit Sub
	End If

	If (ModeName = "RScene1") Then
		PlaySound "fx_Dart2", 0.7
		AddScore(1250)
		SceneVal = SceneVal + 2500
	Exit Sub
	End If

	If (LightINDY1.State = BulbBlink) Then
		LightINDY1.State = BulbOn
		AddScore(5000)
		RndPunch(): RndJungle()
		CheckINDY()
	Else
		RndRicochet()
		AddScore(1000)
	End If
	set LastSwitchHit = TgtIndy1
End Sub


Sub TgtINDY2_hit()
	If (fpTilted = TRUE) Then Exit Sub

	If (ModeName = "RScene4") Then RaidersJP(CP) = RaidersJP(CP) + 1000: RndBulletHit(): RaidersHit(): Exit Sub

	If (LightINDY2.State <> BulbOff) Then
		If (INDYScoring = TRUE) Then IndyHit(): Exit Sub
		If (IJScoring = TRUE) Then IndyJonesHit(): Exit Sub
		If (ModeName = "TScene1") and (Diamond = FALSE) Then GetDiamond(): Exit Sub
		If (ModeName = "RScene2") and (NaziTgt = TRUE) Then NaziKill(): LightINDY2.State = BulbOff: Exit Sub
		If (ModeName = "RScene3") and (NaziTgt = TRUE) Then INDYThrow = TRUE: GuardThrow(): Exit Sub
		If (ModeName = "TScene3") Then MineKill(): LightINDY2.State = BulbOff: Exit Sub
	Else
		If (INDYScoring = TRUE) and (MovieTimer.Enabled = FALSE) Then Clip = 7: PlayClip(): Exit Sub
	End If
	If (ModeName = "RScene1") Then
		PlaySound "fx_Dart2", 0.7
		AddScore(1250)
		SceneVal = SceneVal + 2500
	Exit Sub
	End If
	If (LightINDY2.State = BulbBlink) Then
		LightINDY2.State = BulbOn
		AddScore(5000)
		RndPunch(): RndJungle()
		CheckINDY()
	else
		RndRicochet()
		AddScore(1000)
	End If
	set LastSwitchHit = TgtIndy2
End Sub


Sub TgtINDY3_Hit()
	If (fpTilted = TRUE) Then Exit Sub

	If (ModeName = "RScene4") Then RaidersJP(CP) = RaidersJP(CP) + 1000: RndBulletHit(): RaidersHit(): Exit Sub

	If (LightINDY3.State <> BulbOff) Then
		If (INDYScoring = TRUE) Then IndyHit(): Exit Sub
		If (IJScoring = TRUE) Then IndyJonesHit(): Exit Sub
		If (ModeName = "TScene1") and (Diamond = FALSE) Then GetDiamond(): Exit Sub
		If (ModeName = "RScene2") and (NaziTgt = TRUE) Then NaziKill(): LightINDY3.State = BulbOff: Exit Sub
		If (ModeName = "RScene3") and (NaziTgt = TRUE) Then INDYThrow = TRUE: GuardThrow(): Exit Sub
		If (ModeName = "TScene3") Then MineKill(): LightINDY3.State = BulbOff: Exit Sub
	Else
		If (INDYScoring = TRUE) and (MovieTimer.Enabled = FALSE) Then Clip = 7: PlayClip(): Exit Sub
	End If
	' missed the diamond shot...
	If (ModeName = "TScene1") and (Diamond = FALSE) Then
		If (MovieTimer.Enabled = FALSE) Then
			Clip = 31: PlayClip()
		End If
	Exit Sub
	End If
	If (ModeName = "RScene1") Then
		PlaySound "fx_Dart2", 0.7
		AddScore(1250)
		SceneVal = SceneVal + 2500
	Exit Sub
	End If
	If (LightINDY3.State = BulbBlink) Then
		LightINDY3.State = BulbOn
		AddScore(5000)
		RndPunch()
		CheckINDY()
	else
		RndRicochet()
		AddScore(1000)
	End If
	set LastSwitchHit = TgtIndy3
End Sub


Sub TgtINDY4_Hit()
	If (fpTilted = TRUE) Then Exit Sub

	If (ModeName = "RScene4") Then RaidersJP(CP) = RaidersJP(CP) + 1000: RndBulletHit(): RaidersHit(): Exit Sub

	If (LightINDY4.State <> BulbOff) Then
		If (INDYScoring = TRUE) Then IndyHit(): Exit Sub
		If (IJScoring = TRUE) Then IndyJonesHit(): Exit Sub
		If (ModeName = "TScene1") and (Diamond = FALSE) Then GetDiamond(): Exit Sub
		If (ModeName = "RScene2") and (NaziTgt = TRUE) Then NaziKill(): LightINDY4.State = BulbOff: Exit Sub
		If (ModeName = "RScene3") and (NaziTgt = TRUE) Then INDYThrow = TRUE: GuardThrow(): Exit Sub
		If (ModeName = "TScene3") Then MineKill(): LightINDY4.State = BulbOff: Exit Sub
	Else
		If (INDYScoring = TRUE) and (MovieTimer.Enabled = FALSE) Then Clip = 7: PlayClip(): Exit Sub
	End If

	If (ModeName = "RScene1") Then
		PlaySound "fx_Dart2", 0.7
		AddScore(1250)
		SceneVal = SceneVal + 2500
	Exit Sub
	End If

	If (LightINDY4.State = BulbBlink) Then
		LightINDY4.State = BulbOn
		AddScore(5000)
		RndPunch(): RndJungle()
		CheckINDY()
	Else
		RndRicochet()
		AddScore(1000)
	End If
	set LastSwitchHit = TgtIndy4
End Sub



' hit a letter to add more time and increase the value...

Sub INDYHit()
	INDYTotal = INDYTotal + (55000*xMarks)
	INDY = INDY + 55000 ' increase the value by 55k each time (175k max)
	AddScore(INDY)

	If (INDYHitsLeft = 0) Then EndINDY()

	If (ModeName = "") Then
		LightSeqPF.Play SeqBlinking, , 4,50
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 500
	End If
	ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 1200
	DispDMD1.Text = "[edge3][f4][xc][y3]MARION FOUND[y17][bf]" & FormatScore(INDY*xMarks)
	DispDMD2.Text = "[edge3][f4][xc][y3]MARION FOUND[y17][bf]" & FormatScore(INDY*xMarks)
	'IndyScoringTimer.Set TRUE, 1200
	PlayMusic 3, "Music_Cue11"
	EffectMusic 1, SetVolume, 0, 0: ResumeVol.Set TRUE, 1000
	Clip = 27: PlayClip() ' show Marion in the basket...
End Sub


Sub INDYScoringTimer_Expired()
	IndyScoringTimer.Enabled = FALSE
	INDYHitsLeft = INDYHitsLeft - 1
	If (INDYHitsLeft = 0) Then EndINDY()
End Sub



' successfully hit the strobling letter 3 times to complete this feature and win 550k

Sub EndINDY()
	INDYLightsTimer.Enabled = FALSE
	INDYTotal = INDYTotal + (IndyFSVal(CP)*xMarks)
	AddScore(IndyFSVal(CP))
	IndyFSVal(CP) = IndyFSVal(CP) + 100000 ' increase the value for next time...
	INDYScoring = FALSE
	ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1800
	DispDMD1.Text = "[edge3][f2][xc][y2]INDY SCORING[y10]TOTAL COLLECTED[f4][y19]" & FormatScore(INDYTotal)
	DispDMD2.Text = "[edge3][f2][xc][y2]INDY SCORING[y10]TOTAL COLLECTED[f4][y19]" & FormatScore(INDYTotal)
	LightINDY1.State = TempL1 
	LightINDY2.State = TempL2 
	LightINDY3.State = TempL3 
	LightINDY4.State = TempL4 
	IndyHitsLeft = 3

	If (CairoSwordsman = FALSE) and (HurryUpMode = FALSE) and (ModeName = "") Then
		StopMusic 1
		LightSeqPF.Play Seqblinking, , 4, 100
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1200
		If (QuoteBusy = FALSE) Then
			QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1600
			Select Case RandomNumber(4)
				Case 1: PlayMusic 2, "fx_DrJones"
				Case 2: PlayMusic 2, "fx_DrJones2"
				Case 3: PlayMusic 2, "fx_DrJones3"
				Case 4: PlayMusic 2, "fx_DrJones4"
				Case 5: PlayMusic 2, "fx_DrJones5"
			End Select
		Else
			PlayMusic 3, "Music_Cue9"
		End If
		RestartMusic.Set TRUE, 1400
		If (MovieTimer.Enabled = FALSE) Then MovieTimer_Expired()
	End If
	'If (CairoSwordsman = FALSE) and (HurryUpMode = FALSE) and (ModeName = "") Then
	'	PlayMusic 3, "Music_Cue9":	RestartMusic.Set TRUE, 1600
	'	LightSeqPF.Play Seqblinking, , 4, 100
	'	PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1600
	'End If
	'IHit = 0
End Sub



' in normal play, check if INDY and JONES are now complete for INDY JONES Fast Scoring...

Sub CheckINDY()
	If (LightINDY1.State=BulbOn)and(LightINDY2.State=BulbOn)and(LightINDY3.State=BulbOn)and(LightINDY4.State=BulbOn) Then
		If (ModeName = "") Then
			' if JONES Scoring is running, completing INDY will start INDY JONES scoring...
			If (JONESScoring = TRUE) Then StartINDYJONES(): Exit Sub
			IndyComplete = TRUE
			If (IndyComplete = TRUE) and (JonesComplete = TRUE) Then
				StartINDYJONES()
			Exit Sub
			End If
		Else
			' if a scene is active, add big points and reset the targets...
			AddScore(200000)
			LightINDY1.Set BulbBlink, "10", 125
			LightINDY2.Set BulbBlink, "10", 125
			LightINDY3.Set BulbBlink, "10", 125
			LightINDY4.Set BulbBlink, "10", 125
			PlaySound "fx_Whip3"
			LightSeqPF.Play SeqBlinking, , 2, 50
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 300
			If (ScoreUpdate = TRUE) Then
				ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 1000
				DispDMD1.Text = "[edge3][f4][xc][y3]INDY COMPLETE[y17][bf]" & FormatScore(200000*xMarks)
				DispDMD2.Text = "[edge3][f4][xc][y3]INDY COMPLETE[y17][bf]" & FormatScore(200000*xMarks)
			End If
			IHit = 0
		End If
	Else
		IHit = IHit + 1
		If (MovieTimer.Enabled = FALSE) Then
			NoS(): OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100
			' gfx not matched to the lights yet, a later update...
			Select Case IHit
				Case 1: OverlayLCD.Frame 74: LCD.Frame 74: MovieTimer.Set TRUE, 800 ' show I
				Case 2: OverlayLCD.Frame 74,75,74: LCD.Frame 75,75,74: MovieTimer.Set TRUE, 800 ' show N
				Case 3: OverlayLCD.Frame 75,76,75: LCD.Frame 75,76,75: MovieTimer.Set TRUE, 800 ' show D
				Case else: OverlayLCD.Frame 76,77,76: LCD.Frame 76,77,76: MovieTimer.Set TRUE, 800 ' show Y
			End Select
		End If
		Bulb24.FlashForMs 200, 50, BulbOn
		Bulb23.FlashForMs 200, 50, BulbOn
		Bulb25.FlashForMs 200, 50, BulbOn
		Bulb51.FlashForMs 200, 50, BulbOn
		Bulb52.FlashForMs 200, 50, BulbOn
	End If
End Sub



Sub StartINDY()
	' targets are used for other things during mode, states are saved....
	If (ModeName = "") and (HurryUpMode = FALSE) Then
		ScoreUpdate = FALSE:	FlushDMDTimer.set TRUE, 2800
		DispDMD1.QueueText "[edge3][bf][f6][xc][yc]INDY SCORING", deNone, 800, FALSE
		DispDMD2.QueueText "[edge3][bf][f6][xc][yc]INDY SCORING", deNone, 800, FALSE
		DispDMD1.QueueText "[edge3][b][f3][xc][y4]TARGETS START AT[f6][y14]55K EACH", deFlip, 2000, TRUE
		DispDMD2.QueueText "[edge3][b][f3][xc][y4]TARGETS START AT[f6][y14]55K EACH", deFlip, 2000, TRUE
		PlayMusic 2, "vo_Indy2"
		If (CairoSwordsman = FALSE) Then PlayMusic 1, "Music_Streets", TRUE, 0.8, 1000
		If (MovieTimer.Enabled = FALSE) Then NoS(): OverlayLCD.Frame 148,149,148: LCD.Frame 148,149,148: MovieTimer.Set TRUE, 2000
	End If
	'IndyComplete = FALSE
	INDYTotal = 0
	INDY = 0: IndyHitsLeft = 3
	INDYScoring = TRUE
	' save the state of the INDY lights...need to resume INDY SCORING if necessary...
	TempL1 = LightINDY1.State
	TempL2 = LightINDY2.State
	TempL3 = LightINDY3.State
	TempL4 = LightINDY4.State
	' now set them in sequence for this feature...
	LightINDY1.State = BulbOn
	LightINDY2.State = BulbOff
	LightINDY3.State = BulbOff
	LightINDY4.State = BulbOff
	IndyLightsTimer.Set TRUE, 500
	LightSeqPF.Play SeqBlinking, , 2, 100
End Sub


Sub INDYLightsTimer_Expired()
	If LightINDY4.State = BulbOn then
		LightINDY4.State = BulbOff
		LightINDY1.State = BulbOn
	Exit Sub
	End If
	If LightINDY3.State = BulbOn then
		LightINDY4.State = BulbOn
		LightINDY3.State = BulbOff
	Exit Sub
	End If
	If LightINDY2.State = BulbOn then
		LightINDY3.State = BulbOn
		LightINDY2.State = BulbOff
	Exit Sub
	End If
	If LightINDY1.State = BulbOn then
		LightINDY2.State = BulbOn
		LightINDY1.State = BulbOff
	Exit Sub
	End If
End Sub



'Sub RndPunch()
'	Select Case RandomNumber(5)
'		Case 1: PlaySound "fx_Punch", 0.8
'		Case 2: PlaySound "fx_Punch2", 0.8
'		Case 3: PlaySound "fx_Punch5", 0.8
'		Case 4: PlaySound "fx_Punch6", 0.8
'		Case 5: PlaySound "fx_Punch7", 0.8
'	End Select
'End Sub

Sub RndPunch()
	Select Case RandomNumber(5)
		Case 1: FF_Sound DV_ML,-1,"fx_Punch"
		Case 2: FF_Sound DV_ML,-1,"fx_Punch2"
		Case 3: FF_Sound DV_ML,-1,"fx_Punch5"
		Case 4: FF_Sound DV_ML,-1,"fx_Punch6"
		Case 5: FF_Sound DV_ML,-1,"fx_Punch7"
	End Select
End Sub


'Sub RndRicochet()
'	Select Case RandomNumber(5)
'		Case 1: PlaySound "fx_Ricochet2"
'		Case 2: PlaySound "fx_Ricochet3"
'		Case 3: PlaySound "fx_Ricochet4"
'		Case 4: PlaySound "fx_Ricochet6"
'		Case 5: PlaySound "fx_Ricochet10"
'	End Select
'End Sub

Sub RndRicochet()
	Select Case RandomNumber(5)
		Case 1: FF_Sound DV_ML,-1,"fx_Ricochet2"
		Case 2: FF_Sound DV_ML,-1,"fx_Ricochet3"
		Case 3: FF_Sound DV_ML,-1,"fx_Ricochet4"
		Case 4: FF_Sound DV_ML,-1,"fx_Ricochet6"
		Case 5: FF_Sound DV_ML,-1,"fx_Ricochet10"
	End Select
End Sub


'Sub RndBulletHit()
'	Select Case RandomNumber(6)
'		Case 1: PlaySound "fx_BulletHit", 0.8
'		Case 2: PlaySound "fx_BulletHit2", 0.8
'		Case 3: PlaySound "fx_BulletHit3", 0.8
'		Case 4: PlaySound "fx_BulletHit4", 0.8
'		Case 5: PlaySound "fx_BulletHit5", 0.8
'		Case 6: PlaySound "fx_BulletHit6", 0.8
'	End Select
'End Sub

Sub RndBulletHit()
	Select Case RandomNumber(6)
		Case 1: FF_Sound DV_ML,-1,"fx_BulletHit"
		Case 2: FF_Sound DV_ML,-1,"fx_BulletHit2"
		Case 3: FF_Sound DV_ML,-1,"fx_BulletHit3"
		Case 4: FF_Sound DV_ML,-1,"fx_BulletHit4"
		Case 5: FF_Sound DV_ML,-1,"fx_BulletHit5"
		Case 6: FF_Sound DV_ML,-1,"fx_BulletHit6"
	End Select
End Sub


'Sub RndJungle()
'	Select Case RandomNumber(8)
'		Case 1: PlaySound "fx_Jungle1"
'		Case 2: PlaySound "fx_Jungle2"
'		Case 3: PlaySound "fx_Jungle3"
'		Case 4: PlaySound "fx_Jungle4"
'		Case 5: PlaySound "fx_Jungle5"
'		Case 6: PlaySound "fx_Jungle6"
'		Case 7: PlaySound "fx_Jungle7"
'		Case 8: PlaySound "fx_JungleShort"
'	End Select
'End Sub

Sub RndJungle()
	Select Case RandomNumber(8)
		Case 1: FF_Sound DV_ML,-1,"fx_Jungle1"
		Case 2: FF_Sound DV_ML,-1,"fx_Jungle2"
		Case 3: FF_Sound DV_ML,-1,"fx_Jungle3"
		Case 4: FF_Sound DV_ML,-1,"fx_Jungle4"
		Case 5: FF_Sound DV_ML,-1,"fx_Jungle5"
		Case 6: FF_Sound DV_ML,-1,"fx_Jungle6"
		Case 7: FF_Sound DV_ML,-1,"fx_Jungle7"
		Case 8: FF_Sound DV_ML,-1,"fx_JungleShort"
	End Select
End Sub



' ************************************************
' **                                            **
' **             J-O-N-E-S TARGETS              **
' **                                            **
' ************************************************

' Skill Shot feature only. INDY or JONES Fast Scoring will start randomly.  

' Basically, hit the strobing letter 3 times to complete the feature and win 550k

' JONES are also used during:

' RScene1 - poison darts (all acts)
' RScene2 - Nazis killed in bar (act 2)
' RScene3 - guards thrown from truck (act 2)
' TScene1 - grab the diamond (act 1)
' TScene3 - minecart kill (act 2)


Sub RndGunShot()
	Select Case RandomNumber(8)
		Case 1: PlaySound "fx_GunShot2"
		Case 2: PlaySound "fx_GunShot3"
		Case 3: PlaySound "fx_GunShot4"
		Case 4: PlaySound "fx_GunShot5"
		Case 5: PlaySound "fx_GunShot6"
		Case 6: PlaySound "fx_GunShot7"
		Case 7: PlaySound "fx_GunShot8"
		Case 8: PlaySound "fx_GunShot9"
	End Select
End Sub


Sub Target1_Hit()
	If (fpTilted = TRUE) Then Exit Sub

	Bulb30.FlashForMs 300, 100, BulbOn
	Bulb50.FlashForMs 300, 100, BulbOn

	If (ModeName = "RScene4") Then RaidersJP(CP) = RaidersJP(CP) + 1000: RndBulletHit(): RaidersHit(): Exit Sub

	If (LightJONES1.State <> BulbOff) Then ' it's on or blinking...
		If (JONESScoring = TRUE) Then JONESHit(): Exit Sub
		If (IJScoring = TRUE) Then IndyJonesHit(): Exit Sub
		If (ModeName = "TScene1") and (Diamond = FALSE) Then GetDiamond(): Exit Sub
		If (ModeName = "RScene2") and (NaziTgt = TRUE) Then NaziKill(): LightJONES1.State = BulbOff: Exit Sub
		If (ModeName = "RScene3") and (NaziTgt = TRUE) Then JONESThrow = TRUE: GuardThrow(): Exit Sub
		If (ModeName = "TScene3") Then MineKill(): LightJONES1.State = BulbOff: Exit Sub
	End If

	If (ModeName = "RScene1") Then
		PlaySound "fx_Dart2", 0.7
		AddScore(1250)
		SceneVal = SceneVal + 2500
	Exit Sub
	End If

	If (LightJONES1.State = BulbBlink) Then
		LightJONES1.State = BulbOn
		AddScore(5000)
		RndGunShot(): RndJungle()
		CheckJones()
	Else
		RndRicochet()
		AddScore(1000)
	End If
	set LastSwitchHit = Target1
End Sub



Sub Target2_Hit()
	If (fpTilted = TRUE) Then Exit Sub

	Bulb30.FlashForMs 300, 100, BulbOn
	Bulb50.FlashForMs 300, 100, BulbOn

	If (ModeName = "RScene4") Then RaidersJP(CP) = RaidersJP(CP) + 1000: RndBulletHit(): RaidersHit(): Exit Sub

	If (LightJONES2.State <> BulbOff) Then
		If (JONESScoring = TRUE) Then JONESHit(): Exit Sub
		If (IJScoring = TRUE) Then IndyJonesHit(): Exit Sub
		If (ModeName = "TScene1") and (Diamond = FALSE) Then GetDiamond(): Exit Sub
		If (ModeName = "RScene2") and (NaziTgt = TRUE) Then NaziKill(): LightJONES2.State = BulbOff: Exit Sub
		If (ModeName = "RScene3") and (NaziTgt = TRUE) Then JONESThrow = TRUE: GuardThrow(): Exit Sub
		If (ModeName = "TScene3") Then MineKill(): LightJONES2.State = BulbOff: Exit Sub
	End If

	' missed the diamond shot...
	If (ModeName = "TScene1") and (Diamond = FALSE) Then
		If (MovieTimer.Enabled = FALSE) Then
			Clip = 31: PlayClip()
		End If
	Exit Sub
	End If

	If (ModeName = "RScene1") Then
		PlaySound "fx_Dart2", 0.7
		AddScore(1250)
		SceneVal = SceneVal + 2500
	Exit Sub
	End If

	If (LightJONES2.State = BulbBlink) Then
		LightJONES2.State = BulbOn
		AddScore(5000)
		RndGunShot(): RndJungle()
		checkjones()
	Else
		RndRicochet()
		AddScore(1000)
	End If
	set LastSwitchHit = Target2
End Sub



Sub Target3_Hit()
	If (fpTilted = TRUE) Then Exit Sub

	Bulb30.FlashForMs 300, 100, BulbOn
	Bulb50.FlashForMs 300, 100, BulbOn

	If (ModeName = "RScene4") Then RaidersJP(CP) = RaidersJP(CP) + 1000: RndBulletHit(): RaidersHit(): Exit Sub

	If (LightJONES3.State <> BulbOff) Then
		If (JONESScoring = TRUE) Then JONESHit(): Exit Sub
		If (IJScoring = TRUE) Then IndyJonesHit(): Exit Sub
		If (ModeName = "TScene1") and (Diamond = FALSE) Then GetDiamond(): Exit Sub
		If (ModeName = "RScene2") and (NaziTgt = TRUE) Then NaziKill(): LightJONES3.State = BulbOff: Exit Sub
		If (ModeName = "RScene3") and (NaziTgt = TRUE) Then JONESThrow = TRUE: GuardThrow(): Exit Sub
		If (ModeName = "TScene3") Then MineKill(): LightJONES3.State = BulbOff: Exit Sub
	End If

	If (ModeName = "RScene1") Then
		PlaySound "fx_Dart2", 0.7
		AddScore(1250)
		SceneVal = SceneVal + 2500
	Exit Sub
	End If

	If (LightJONES3.State = BulbBlink) Then
		LightJONES3.State = BulbOn
		AddScore(5000)
		RndGunShot(): RndJungle()
		checkjones()
	else
		RndRicochet()
		AddScore(1000)
	End If
	set LastSwitchHit = Target3
End Sub



Sub Target4_Hit()
	If (fpTilted = TRUE) Then Exit Sub

	Bulb28.FlashForMs 300, 100, BulbOn
	Bulb49.FlashForMs 300, 100, BulbOn

	If (ModeName = "RScene4") Then RaidersJP(CP) = RaidersJP(CP) + 1000: RndBulletHit(): RaidersHit(): Exit Sub

	If (LightJONES4.State <> BulbOff) Then
		If (JONESScoring = TRUE) Then JONESHit(): Exit Sub
		If (IJScoring = TRUE) Then IndyJonesHit(): Exit Sub
		If (ModeName = "TScene1") and (Diamond = FALSE) Then GetDiamond(): Exit Sub
		If (ModeName = "RScene2") and (NaziTgt = TRUE) Then NaziKill(): LightJONES4.State = BulbOff: Exit Sub
		If (ModeName = "RScene3") and (NaziTgt = TRUE) Then JONESThrow = TRUE: GuardThrow(): Exit Sub
		If (ModeName = "TScene3") Then MineKill(): LightJONES4.State = BulbOff: Exit Sub
	End If

	' missed the diamond shot...
	If (ModeName = "TScene1") and (Diamond = FALSE) Then
		If (MovieTimer.Enabled = FALSE) Then
			Clip = 31: PlayClip()
		End If
	Exit Sub
	End If

	If (ModeName = "RScene1") Then
		PlaySound "fx_Dart2", 0.8
		AddScore(1250)
		SceneVal = SceneVal + 2500
	Exit Sub
	End If

	If (LightJONES4.State = BulbBlink) Then
		LightJONES4.State = BulbOn
		AddScore(5000)
		RndGunShot(): RndJungle()
		CheckJONES()
	else
		RndRicochet()
		AddScore(1000)
	End If
	set LastSwitchHit = Target4
End Sub



Sub Target5_Hit()
	If (fpTilted = TRUE) Then Exit Sub

	Bulb28.FlashForMs 300, 100, BulbOn
	Bulb49.FlashForMs 300, 100, BulbOn

	If (ModeName = "RScene4") Then RaidersJP(CP) = RaidersJP(CP) + 1000: RndBulletHit(): RaidersHit(): Exit Sub

	If (LightJONES5.State <> BulbOff) Then
		If (JONESScoring = TRUE) Then JONESHit(): Exit Sub
		If (IJScoring = TRUE) Then IndyJonesHit(): Exit Sub
		If (ModeName = "TScene1") and (Diamond = FALSE) Then GetDiamond(): Exit Sub
		If (ModeName = "RScene2") and (NaziTgt = TRUE) Then NaziKill(): LightJONES5.State = BulbOff: Exit Sub
		If (ModeName = "RScene3") and (NaziTgt = TRUE) Then JONESThrow = TRUE: GuardThrow(): Exit Sub
		If (ModeName = "TScene3") Then MineKill(): LightJONES5.State = BulbOff: Exit Sub
	End If
	If (ModeName = "RScene1") Then
		PlaySound "fx_Dart2", 0.7
		AddScore(1250)
		SceneVal = SceneVal + 2500
	Exit Sub
	End If
	If (LightJONES5.State = BulbBlink) Then
		LightJONES5.State = BulbOn
		AddScore(5000)
		RndGunShot(): RndJungle()
		CheckJONES()
	Else
		RndRicochet()
		AddScore(1000)
	End If
	set LastSwitchHit = Target5
End Sub



Sub CheckJONES()
	If LightJONES1.State = BulbOn and LightJONES2.State = BulbOn and LightJONES3.State = BulbOn and LightJONES4.State = BulbOn and LightJONES5.State = BulbOn then
		If (ModeName = "") Then
			' if INDY Scoring is running, completing JONES will start INDY JONES scoring...
			If (INDYScoring = TRUE) Then StartINDYJONES(): Exit Sub
			JonesComplete = TRUE
			If (IndyComplete = TRUE) and (JonesComplete = TRUE) Then
				StartINDYJONES()
			Exit Sub
			End If
		Else
			AddScore(300000)
			LightJONES1.Set BulbBlink, "01", 125
			LightJONES2.Set BulbBlink, "01", 125
			LightJONES3.Set BulbBlink, "01", 125
			LightJONES4.Set BulbBlink, "01", 125
			LightJONES5.Set BulbBlink, "01", 125
			PlaySound "fx_Whip3"
			LightSeqPF.Play SeqBlinking, , 2, 50
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 300
			If (ScoreUpdate = TRUE) Then
				ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 1000
				DispDMD1.Text = "[edge3][f4][xc][y3]JONES COMPLETE[y17][bf]" & FormatScore(300000*xMarks)
				DispDMD2.Text = "[edge3][f4][xc][y3]JONES COMPLETE[y17][bf]" & FormatScore(300000*xMarks)
			End If
			JHit = 0
		End If
	Else
		JHit = JHit + 1
		If (MovieTimer.Enabled = FALSE) Then
			NoS(): OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100
			Select Case JHit
				Case 1: OverlayLCD.Frame 50: LCD.Frame 50: MovieTimer.Set TRUE, 800 ' show J
				Case 2: OverlayLCD.Frame 50,51,50: LCD.Frame 50,51,50: MovieTimer.Set TRUE, 800 ' show O
				Case 3: OverlayLCD.Frame 51,52,51: LCD.Frame 51,52,51: MovieTimer.Set TRUE, 800 ' show N
				Case 4: OverlayLCD.Frame 52,53,52: LCD.Frame 52,53,52: MovieTimer.Set TRUE, 800 ' show E
				Case else: OverlayLCD.Frame 53,54,53: LCD.Frame 53,54,53: MovieTimer.Set TRUE, 800 ' show S
			End Select
		End If
		Bulb28.FlashForMs 200, 50, BulbOn
		Bulb29.FlashForMs 200, 50, BulbOn
		Bulb30.FlashForMs 200, 50, BulbOn
		Bulb49.FlashForMs 200, 50, BulbOn
		Bulb50.FlashForMs 200, 50, BulbOn
	End If
End Sub


Sub StartJONES()
	If (ModeName = "") and (HurryUpMode = FALSE) Then
		ScoreUpdate = FALSE:	FlushDMDTimer.set TRUE, 2800
		DispDMD1.QueueText "[edge3][bf][f6][xc][yc]JONES SCORING", deNone, 800, FALSE
		DispDMD2.QueueText "[edge3][bf][f6][xc][yc]JONES SCORING", deNone, 800, FALSE
		DispDMD1.QueueText "[edge3][b][f3][xc][y4]TARGETS START AT[f6][y14]55K EACH", deFlip, 2000, TRUE
		DispDMD2.QueueText "[edge3][b][f3][xc][y4]TARGETS START AT[f6][y14]55K EACH", deFlip, 2000, TRUE
		If (QuoteBusy = FALSE) Then
			QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2000
			If (CairoSwordsman = FALSE) Then
				Select Case RandomNumber(2)
					Case 1: PlayMusic 2, "vo_DrJones": PlayMusic 1, "Music_Jones", TRUE, 0.7, 1500
					Case 2: PlayMusic 2, "vo_DrJones3": PlayMusic 1, "Music_Idol", TRUE, 0.7, 800
					'Case 3: PlayMusic 2, "vo_DrJones3": PlayMusic 1, "Music_TheJones", TRUE, 0.7, 800
				End Select
			End If
		Else
			If (CairoSwordsman = FALSE) Then PlayMusic 1, "Music_Jones", TRUE, 0.7
		End If
	End If
	'JonesComplete = FALSE
	JLights = 0
	JONESTotal = 0
	JONES = 0: JonesHitsLeft = 3
	JonesScoring = TRUE
	NoS(): OverlayLCD.Frame 165: LCD.Frame 165

	' save the state of the JONES lights...needed to resume INDY SCORING if necessary....
	TempL5 = LightJONES1.State
	TempL6 = LightJONES2.State
	TempL7 = LightJONES3.State
	TempL8 = LightJONES4.State
	TempL9 = LightJONES5.State

	LightJONES1.State = BulbOn
	LightJONES2.State = BulbOff
	LightJONES3.State = BulbOff
	LightJONES4.State = BulbOff
	LightJONES5.State = BulbOff
	JonesLightsTimer.Set TRUE, 500
End Sub



Sub JonesLightsTimer_Expired()
	LightJONES1.State = BulbOff
	LightJONES2.State = BulbOff
	LightJONES3.State = BulbOff
	LightJONES4.State = BulbOff
	LightJONES5.State = BulbOff
	JLights = JLights + 1
	Select Case JLights
		Case 1:
			LightJONES3.State = BulbOn
		Case 2:
			LightJONES2.State = BulbOn
			LightJONES4.State = BulbOn
		Case 3:
			LightJONES1.State = BulbOn
			LightJONES5.State = BulbOn
		Case 4:
			LightJONES2.State = BulbOn
			LightJONES4.State = BulbOn
			JLights = 0
	End Select

	'If LightJONES5.State = BulbOn then
	'	LightJONES5.State = BulbOff
	'	LightJONES1.State = BulbOn
	'Exit Sub
	'End If
	'If LightJONES4.State = BulbOn then
	'	LightJONES5.State = BulbOn
	'	LightJONES4.State = BulbOff
	'Exit Sub
	'End If
	'If LightJONES3.State = BulbOn then
	'	LightJONES4.State = BulbOn
	'	LightJONES3.State = BulbOff
	'Exit Sub
	'End If
	'If LightJONES2.State = BulbOn then
	'	LightJONES3.State = BulbOn
	'	LightJONES2.State = BulbOff
	'Exit Sub
	'End If
	'If LightJONES1.State = BulbOn then
	'	LightJONES2.State = BulbOn
	'	LightJONES1.State = BulbOff
	'Exit Sub
	'End If
End Sub


Sub JONESHit()
	JONESTotal = JONESTotal + (55000*xMarks)
	JONES = JONES + 55000
	AddScore(JONES)
	JonesHitsLeft = JonesHitsLeft - 1

	If (JonesHitsLeft = 0) Then EndJONES(): Exit Sub

	If (ModeName = "") Then
		LightSeqPF.Play SeqBlinking, , 4,50
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 500
	End If
	ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 1500
	DispDMD1.Text = "[edge3][f4][xc][y3]JONES SCORING[f4][y17][bf]" & formatscore(JONES*xMarks)
	DispDMD2.Text = "[edge3][f4][xc][y3]JONES SCORING[f4][y17][bf]" & formatscore(JONES*xMarks)
	PlaySound "fx_Whip3"
End Sub



' successfully hit the strobling letter 5 times to complete this feature and get 550k

Sub EndJONES()
	JONESTotal = JONESTotal + (JonesFSVal(CP)*xMarks)
	AddScore(JonesFSVal(CP))
	JonesFSVal(CP) = JonesFSVal(CP) + 100000 ' increase the value for next time...

	JonesLightsTimer.Enabled = FALSE
	JonesScoring = FALSE
	ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 1600
	DispDMD1.Text = "[edge3][f2][y4]JONES TOTAL[f6][xc][y13][b]" & Formatscore(JONESTotal)
	DispDMD2.Text = "[edge3][f2][y4]JONES TOTAL[f6][xc][y13][b]" & Formatscore(JONESTotal)
	JonesHitsLeft = 3
	LightJONES1.State = TempL5
	LightJONES2.State = TempL6 
	LightJONES3.State = TempL7
	LightJONES4.State = TempL8
	LightJONES5.State = TempL9
	If (CairoSwordsman = FALSE) and (HurryUpMode = FALSE) and (ModeName = "") Then
		StopMusic 1
		LightSeqPF.Play Seqblinking, , 4, 100
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1200
		If (QuoteBusy = FALSE) Then
			QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1600
			Select Case RandomNumber(4)
				Case 1: PlayMusic 2, "fx_DrJones"
				Case 2: PlayMusic 2, "fx_DrJones2"
				Case 3: PlayMusic 2, "fx_DrJones3"
				Case 4: PlayMusic 2, "fx_DrJones4"
				Case 5: PlayMusic 2, "fx_DrJones5"
			End Select
		Else
			PlayMusic 3, "Music_Cue9"
		End If
		RestartMusic.Set TRUE, 1400
		If (MovieTimer.Enabled = FALSE) Then MovieTimer_Expired()
	End If
End Sub



' ************************************************
' **                                            **
' **            INDY JONES SCORING              **
' **                                            **
' ************************************************

' during normal play, completing INDY and JONES will start INDY JONES Fast Scoring.  All letters are lit for
' 200k each for a limited time.


Sub StartINDYJONES()
	JonesLightsTimer.Enabled = FALSE
	IndyComplete = FALSE
	JonesComplete = FALSE
	HurryUpMode = FALSE
	INDYScoring = FALSE
	JONESScoring = FALSE
	IJScoring = TRUE: IJTotal = 0
	NoS(): OverlayLCD.Frame 166,167,166: LCD.Frame 166,167,166
	LightSeqPF.Play SeqBlinking, , 5, 100
	HU = 24: HUTimer.Set TRUE, 1000
	ScoreUpdate = FALSE:	FlushDMDTimer.set TRUE, 3500
	DispDMD1.QueueText "[edge3][bf][f3][xc][y4]INDIANA JONES[f6][y14]SCORING", deNone, 1600, FALSE
	DispDMD2.QueueText "[edge3][bf][f3][xc][y4]INDIANA JONES[f6][y14]SCORING", deNone, 1600, FALSE
	DispDMD1.QueueText "[edge3][f3][xc][y4]ALL TARGETS[f6][y14]220K EACH", deFlip, 2000, TRUE
	DispDMD2.QueueText "[edge3][f3][xc][y4]ALL TARGETS[f6][y14]220K EACH", deFlip, 2000, TRUE
	PlayMusic 3, "Music_Cue9"
	PlayMusic 1, "Music_IndyJones", TRUE, 0.8, 1500
	' alternate the blink pattern so the player is aware of this feature, even when it's running without the music...
	LightINDY1.Set BulbBlink, "10", 100
	LightINDY2.Set BulbBlink, "10", 100
	LightINDY3.Set BulbBlink, "10", 100
	LightINDY4.Set BulbBlink, "10", 100
	LightJONES1.Set BulbBlink, "01", 100
	LightJONES2.Set BulbBlink, "01", 100
	LightJONES3.Set BulbBlink, "01", 100
	LightJONES4.Set BulbBlink, "01", 100
	LightJONES5.Set BulbBlink, "01", 100
End Sub


Sub HUTimer_Expired()
	HU = HU - 1
	If (HU = 0) Then
		ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 2000
		DispDMD1.FlushQueue: DispDMD2.FlushQueue
		DispDMD1.QueueText "[edge3][f3][xc][y4]TOTAL[f6][y14][b]"&FormatScore(IJTotal), deScrollIn, 2000, TRUE
		DispDMD2.QueueText "[edge3][f3][xc][y4]TOTAL[f6][y14][b]"&FormatScore(IJTotal), deScrollIn, 2000, TRUE
		EndIJScoring()
		MovieTimer_Expired()
		RestartMusic_Expired()
	End If
End Sub


Sub EndIJScoring()
	HUTimer.Enabled = FALSE
	IJScoring = FALSE
	LightINDY1.Set BulbBlink, "10", 125
	LightINDY2.Set BulbBlink, "10", 125
	LightINDY3.Set BulbBlink, "10", 125
	LightINDY4.Set BulbBlink, "10", 125
	LightJONES1.Set BulbBlink, "10", 125
	LightJONES2.Set BulbBlink, "10", 125
	LightJONES3.Set BulbBlink, "10", 125
	LightJONES4.Set BulbBlink, "10", 125
	LightJONES5.Set BulbBlink, "10", 125
End Sub




Sub IndyJonesHit()
	AddScore(220000): IJTotal = IJTotal + (220000*xMarks)
	' player perk - 5 hits award an EXTRA BALL...
	If (PerkIJ(CP) = TRUE) Then
		IJHit(CP) = IJHit(CP) + 1
		If (IJHit(CP) = 5) Then
			ShootAgainLight.State = BulbOn: ExtraBallsAwards(CP) = ExtraBallsAwards(CP) + 1: IJHit(CP) = 0
			MusicFade(1000): PlayMusic 2, "vo_WowHolySmoke"
		End If
	End If
	If (ScoreUpdate = TRUE) Then
		ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 800
		DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc][bf]" & FormatScore(220000*xMarks), deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc][bf]" & FormatScore(220000*xMarks), deNone, 50, FALSE
		DispDMD1.QueueText "[edge3][f6][xc][yc][bf]" & FormatScore(220000*xMarks), deNone, 50, FALSE
		DispDMD2.QueueText "[edge3][f6][xc][yc][bf]" & FormatScore(220000*xMarks), deNone, 50, FALSE
	End If
	PlaySound "fx_Whip2", 0.7
	LightSeqPF.Play SeqBlinking, , 2, 50
	PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 300
End Sub



' **************************************
' **                                  **
' **             BUMPERS              **
' **                                  **
' **************************************

' Super Pop will activate each bumper for each movie. Each hit will then increase the Jackpot value for that movie.
' Jackpot Values for each movie are awarded when any Scene is completed successfully.

' A 10 second timer will reset each time the bumpers are hit until it times out.

' Normal hits will add up to the Super Pops.


Sub BumpLTimer_Expired()
	BumpLTimer.Enabled = FALSE
	BRL.SolenoidPulse 10
End Sub


Sub Bumper1_Hit() ' temple

	' PlaySound "fx_Bumper"
	FF_Sound DV_BC,-1, "fx_Bumper"
	PBL1.SolenoidPulse 
	PBL2.SolenoidPulse 
	PBL3.SolenoidPulse
	PBL4.SolenoidPulse 
	PBL5.SolenoidPulse
	PBL6.SolenoidPulse 
	BRL.PopDown: BumpLTimer.Set TRUE, 150

	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub

	GIFlash1.State = BulbOff: GIFlash2.State = BulbOff: ResetGI.Set TRUE, 150
	LightBumpFlash.FlashForMs 150, 150, BulbOff: LightBumpFlash2.FlashForMs 150, 150, BulbOff: FlasherBump.FlashForMs 150, 100, BulbOff

	If (ModeName = "SScene1") and (LightOrbitR.State = BulbBlink) Then RocketHit(): Exit Sub

	If (ModeName = "RScene4") Then RndBulletHit(): RaidersHit(): Exit Sub

	If (Bumper1.State = BulbBlink) Then ' Super Pops add 25k to the JP value and score 5k for each hit...
		TempleJP(CP) = TempleJP(CP) + (25500*xMarks)
		AddScore(5000)
	Else
		Bumper1.FlashForMs 150, 150, BulbOff
		AddScore(500) ' a regular hit counts towards activating the Super Pops...
		SPop = SPop + 1: CheckSPOPS()
	End If

	PopTimer()

	If (ModeName = "") and (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) and (NoPlay = FALSE) Then
		If (SuperPops = TRUE) Then
			MovieTimer.Set TRUE, 300: NoS(): OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100: OverlayLCD.Frame 125,126,125: LCD.Frame 125,126,125
			Playsound "fx_GunShot3", 0.8
			If (ScoreUpdate = TRUE) Then
				FlushDMDTimer.Set TRUE, 500
				DispDMD1.Text = "[edge3][f2][xc][y4]TEMPLE JACKPOT[y14][f6]" & FormatScore(TempleJP(CP))
				DispDMD2.Text = "[edge3][f2][xc][y4]TEMPLE JACKPOT[y14][f6]" & FormatScore(TempleJP(CP))
			End If
		Else
			If (ScoreUpdate = TRUE) Then
				RndPunch()
				FlushDMDTimer.Set TRUE, 500
				DispDMD1.Text = "[edge3][f2][xc][y5]SUPER POPS IN[y13][f6]" & SPop & " OF " & SPopStart
				DispDMD2.Text = "[edge3][f2][xc][y5]SUPER POPS IN[y13][f6]" & SPop & " OF " & SPopStart
			End If
		End If
	Else
		RndBulletHit()
	End If
End Sub



Sub Bumper2_Hit() ' raiders


	' PlaySound "fx_Bumper"
	FF_Sound DV_BL,-1, "fx_Bumper"
	PBR1.SolenoidPulse
	PBR2.SolenoidPulse 
	PBR3.SolenoidPulse
	PBR4.SolenoidPulse 
	PBR5.SolenoidPulse
	PBR6.SolenoidPulse 
	BRR.PopDown: BumpRTimer.Set TRUE, 150

	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub

	GIFlash1.State = BulbOff: GIFlash2.State = BulbOff: ResetGI.Set TRUE, 150
	LightBumpFlash.FlashForMs 150, 150, BulbOff: LightBumpFlash2.FlashForMs 150, 150, BulbOff: FlasherBump.FlashForMs 150, 100, BulbOff

	If (ModeName = "SScene1") and (LightOrbitR.State = BulbBlink) Then RocketHit(): Exit Sub

	If (ModeName = "RScene4") Then RndBulletHit(): RaidersHit(): Exit Sub

	If (Bumper2.State = BulbBlink) Then
		RaidersJP(CP) = RaidersJP(CP) + (25500*xMarks)
		AddScore(5000)
	Else
		Bumper2.FlashForMs 150, 150, BulbOff
		AddScore(500)
		SPop = SPop + 1: CheckSPOPS()
	End If

	PopTimer()

	If (ModeName = "") and (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) and (NoPlay = FALSE) Then
		If (SuperPops = TRUE) Then
			MovieTimer.Set TRUE, 300: NoS(): OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100: OverlayLCD.Frame 121,122,121: LCD.Frame 121,122,121
			Playsound "fx_GunShot3",0.8			
			If (ScoreUpdate = TRUE) Then
				FlushDMDTimer.Set TRUE, 500
				DispDMD1.Text = "[edge3][f2][xc][y4]TEMPLE JACKPOT[y14][f6]" & FormatScore(RaidersJP(CP))
				DispDMD2.Text = "[edge3][f2][xc][y4]TEMPLE JACKPOT[y14][f6]" & FormatScore(RaidersJP(CP))
			End If
		Else
			If (ScoreUpdate = TRUE) Then
				RndPunch()
				FlushDMDTimer.Set TRUE, 500
				DispDMD1.Text = "[edge3][f2][xc][y5]SUPER POPS IN[y13][f6]" & SPop & " OF " & SPopStart
				DispDMD2.Text = "[edge3][f2][xc][y5]SUPER POPS IN[y13][f6]" & SPop & " OF " & SPopStart
			End If
		End If
	Else
		RndBulletHit()
	End If
End Sub



Sub BumpRTimer_Expired()
	BumpRTimer.Enabled = FALSE
	BRR.SolenoidPulse 10
End Sub



Sub Bumper3_Hit() 'crystal

	' PlaySound "fx_Bumper"
	FF_Sound DV_BL,-1, "fx_Bumper"
	PBR1.SolenoidPulse
	PBR2.SolenoidPulse 
	PBR3.SolenoidPulse
	PBR4.SolenoidPulse 
	PBR5.SolenoidPulse
	PBR6.SolenoidPulse 
	BRR.PopDown: BumpRTimer.Set TRUE, 150

	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub

	GIFlash1.State = BulbOff: GIFlash2.State = BulbOff: ResetGI.Set TRUE, 150
	LightBumpFlash.FlashForMs 150, 150, BulbOff: LightBumpFlash2.FlashForMs 150, 150, BulbOff: FlasherBump.FlashForMs 150, 100, BulbOff

	If (ModeName = "SScene1") and (LightOrbitR.State = BulbBlink) Then RocketHit(): Exit Sub

	If (ModeName = "RScene4") Then RndBulletHit(): RaidersHit(): Exit Sub

	If (Bumper3.State = BulbBlink) Then
		SkullJP(CP) = SkullJP(CP) + (25500*xMarks)
		AddScore(5000)
	Else
		Bumper3.FlashForMs 150, 150, BulbOff
		AddScore(500)
		SPop = SPop + 1: CheckSPOPS()
	End If

	PopTimer()

	If (ModeName = "") and (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) and (NoPlay = FALSE) Then
		If (SuperPops = TRUE) Then	
			MovieTimer.Set TRUE, 300: NoS(): OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100: OverlayLCD.Frame 119,120,119: LCD.Frame 119,120,119
			Playsound "fx_GunShot3",0.8
			If (ScoreUpdate = TRUE) Then
				FlushDMDTimer.Set TRUE, 500
				DispDMD1.Text = "[edge3][f2][xc][y4]TEMPLE JACKPOT[y14][f6]" & FormatScore(SkullJP(CP))
				DispDMD2.Text = "[edge3][f2][xc][y4]TEMPLE JACKPOT[y14][f6]" & FormatScore(SkullJP(CP))
			End If
		Else
			If (ScoreUpdate = TRUE) Then
				RndPunch()
				FlushDMDTimer.Set TRUE, 500
				DispDMD1.Text = "[edge3][f2][xc][y5]SUPER POPS IN[y13][f6]" & SPop & " OF " & SPopStart
				DispDMD2.Text = "[edge3][f2][xc][y5]SUPER POPS IN[y13][f6]" & SPop & " OF " & SPopStart
			End If
		End If
	Else
		RndBulletHit()
	End If
End Sub



Sub BumpCTimer_Expired()
	BumpCTimer.Enabled = FALSE
	BRC.SolenoidPulse 10
End Sub


Sub Bumper4_Hit() 'crusade

	' PlaySound "fx_Bumper"
	FF_Sound DV_BR,-1, "fx_Bumper"
	PBC1.SolenoidPulse 
	PBC2.SolenoidPulse 
	PBC3.SolenoidPulse
	PBC4.SolenoidPulse 
	PBC5.SolenoidPulse
	PBC6.SolenoidPulse
	PBC7.SolenoidPulse 
	BRC.PopDown: BumpCTimer.Set TRUE, 150

	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub

	GIFlash1.State = BulbOff: GIFlash2.State = BulbOff: ResetGI.Set TRUE, 150
	LightBumpFlash.FlashForMs 150, 150, BulbOff: LightBumpFlash2.FlashForMs 150, 150, BulbOff: FlasherBump.FlashForMs 150, 100, BulbOff

	If (ModeName = "SScene1") and (LightOrbitR.State = BulbBlink) Then RocketHit(): Exit Sub

	If (ModeName = "RScene4") Then RndBulletHit(): RaidersHit(): Exit Sub

	If (Bumper4.State = BulbBlink) Then
		CrusadeJP(CP) = CrusadeJP(CP) + (25500*xMarks)
		AddScore(5000)
	Else
		Bumper4.FlashForMs 150, 150, BulbOff
		AddScore(500)
		SPop = SPop + 1: CheckSPOPS()
	End If

	PopTimer()

	If (ModeName = "") and (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) and (NoPlay = FALSE) Then
		If (SuperPops = TRUE) Then	
			MovieTimer.Set TRUE, 300: NoS(): OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100: OverlayLCD.Frame 123,124,123: LCD.Frame 123,124,123
			Playsound "fx_GunShot3",0.8
			If (ScoreUpdate = TRUE) Then
				FlushDMDTimer.Set TRUE, 500
				DispDMD1.Text = "[edge3][f2][xc][y4]TEMPLE JACKPOT[y14][f6]" & FormatScore(CrusadeJP(CP))
				DispDMD2.Text = "[edge3][f2][xc][y4]TEMPLE JACKPOT[y14][f6]" & FormatScore(CrusadeJP(CP))
			End If
		Else
			If (ScoreUpdate = TRUE) Then
				RndPunch()
				FlushDMDTimer.Set TRUE, 500
				DispDMD1.Text = "[edge3][f2][xc][y5]SUPER POPS IN[y13][f6]" & SPop & " OF " & SPopStart
				DispDMD2.Text = "[edge3][f2][xc][y5]SUPER POPS IN[y13][f6]" & SPop & " OF " & SPopStart
			End If
		End If
	Else
		RndBulletHit()
	End If
End Sub



Sub CheckSPOPS()
	If (SPop = SPopStart) Then
		PlaySound "fx_Elephant"
		If (NoPlay = FALSE) Then
			DispDMD1.FlushQueue: DispDMD2.FlushQueue
			ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 800
			DispDMD1.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]SUPER POPS", deNone, 50, FALSE
			DispDMD2.QueueText "[edge3][box3,1,1,126,30][f6][xc][yc]SUPER POPS", deNone, 50, FALSE
			DispDMD1.QueueText "[edge3][f6][xc][yc]SUPER POPS", deNone, 50, FALSE
			DispDMD2.QueueText "[edge3][f6][xc][yc]SUPER POPS", deNone, 50, FALSE
		End If
		SPopStart = SPopStart + 10
		SPop = 0
		SuperPops = TRUE
		Bumper1.Set BulbBlink, "1000", 125
		Bumper4.Set BulbBlink, "0100", 125
		Bumper3.Set BulbBlink, "0010", 125
		Bumper2.Set BulbBlink, "0001", 125
		If (ModeName = "") Then RampDiverter.SolenoidOn ' not during a mode...
	End If
End Sub



Sub PopTimer()
	If (ResetBumpers.Enabled = FALSE) Then
		If (PerkPops(CP) = TRUE) Then
			ResetBumpers.Set TRUE, 17000
		Else	
			ResetBumpers.Set TRUE, 10000
		End If
	End If
End Sub



Sub ResetBumpers_Expired()
	ResetBumpers.Enabled = FALSE
	SuperPops = FALSE
	Bumper1.State = BulbOff
	Bumper2.State = BulbOff
	Bumper3.State = BulbOff
	Bumper4.State = BulbOff
	RampDiverter.SolenoidOff
End Sub



Sub ResetGI_Expired()
	ResetGI.Enabled = FALSE
	GIFlash1.State = BulbOn: GIFlash2.State = BulbOn
End Sub




' **************************************
' **                                  **
' **           THE MAP ROOM           **
' **                                  **
' **************************************

' The Map Room consists of 2 targets sets: M-A-P and R-O-O-M.

' Light MAP and ROOM to advance the end of ball Bonus Multiplier by 2 each time.

' Hitting the Map X Kicker a certain number of times will activate DOUBLE SCORING for a limited time.

' The Map Room resets for each new ball and is deactivated (slings blocked) for Movie Scene intro, drain or tilt.


Sub Tgt_MAP1_Hit()
	If (fpTilted = TRUE) Then Exit Sub
	If (LightMAP1.State = BulbOff) Then
		LightMAP1.State = BulbOn
		AddScore(15000)
		CheckMap()
	Else
		AddScore(1000)
	End If
End Sub



Sub Tgt_MAP2_Hit()
	If (fpTilted = TRUE) Then Exit Sub
	If LightMAP2.State = BulbOff then
		LightMAP2.State = BulbOn
		AddScore(15000)
		checkmap()
	else
		AddScore(1000)
	End If
End Sub



Sub Tgt_MAP3_Hit()
	If (fpTilted = TRUE) Then Exit Sub
	If LightMAP3.State = BulbOff then
		LightMAP3.State = BulbOn
		AddScore(15000)
		checkmap()
	else
		AddScore(1000)
	End If
End Sub



Sub Tgt_R_Hit()
	If (fpTilted = TRUE) Then Exit Sub
	PlaySound "fx_5"
	If (LightROOM1.State = BulbOff) Then
		LightROOM1.State = BulbOn
		AddScore(15000)
		CheckMap()
	Else
		AddScore(1000)
	End If
End Sub



Sub Tgt_O_Hit()
	If (fpTilted = TRUE) Then Exit Sub
	PlaySound "fx_5"
	If LightROOM2.State = BulbOff then
		LightROOM2.State = BulbOn
		AddScore(15000)
		checkmap()
	else
		AddScore(1000)
	End If
End Sub



Sub Tgt_OO_Hit()
	If (fpTilted = TRUE) Then Exit Sub
	PlaySound "fx_5"
	If LightROOM3.State = BulbOff then
		LightROOM3.State = BulbOn
		AddScore(15000)
		checkmap()
	else
		AddScore(1000)
	End If
End Sub



Sub Tgt_M_Hit()
	If (fpTilted = TRUE) Then Exit Sub
	PlaySound "fx_5"
	If LightROOM4.State = BulbOff then
		LightROOM4.State = BulbOn
		AddScore(15000)
		checkmap()
	else
		AddScore(1000)
	End If
End Sub


Dim RoomLit,MapLit


Sub CheckMAP()
	If (LightMAP1.State = BulbOn) and (LightMAP2.State = BulbOn) and (LightMAP3.State = BulbOn) Then
		AddScore(75000)
		MapLit = TRUE
	End If
	If (LightROOM1.State = BulbOn) and (LightROOM2.State = BulbOn) and (LightROOM3.State = BulbOn) and (LightROOM4.State = BulbOn) Then
		AddScore(100000)
		RoomLit = TRUE
	End If
	If (MapLit = TRUE) and (RoomLit = TRUE) Then
		If (PerkX4(CP) = TRUE) Then
			MapMulti = MapMulti + 4
		Else
			MapMulti = MapMulti + 2
		End If
		PlaySound "fx_Trap", 0.7
		MapRoomReset.Set TRUE, 1000
		If (MovieTimer.Enabled = FALSE) Then
			NoS()
			Select Case MapMulti
				Case 2: OverlayLCD.Frame 40: LCD.Frame 40
				Case 4: OverlayLCD.Frame 41: LCD.Frame 41
				Case 6: OverlayLCD.Frame 42: LCD.Frame 42
				Case 8: OverlayLCD.Frame 43: LCD.Frame 43
				Case 10: OverlayLCD.Frame 131: LCD.Frame 131
				Case else: OverlayLCD.Frame 132: LCD.Frame 132
			End Select
			MovieTimer.Set TRUE, 1200
			AddScore(250000)
		End If
	End If
End Sub



Sub MapRoomReset_Expired()
	MapRoomReset.Enabled = FALSE
	LightMAP1.State = BulbOff
	LightMAP2.State = BulbOff
	LightMAP3.State = BulbOff
	LightROOM1.State = BulbOff
	LightROOM2.State = BulbOff
	LightROOM3.State = BulbOff
	LightROOM4.State = BulbOff
	Tgt_R.SolenoidPulse
	Tgt_O.SolenoidPulse
	Tgt_OO.SolenoidPulse
	Tgt_M.SolenoidPulse
	MapLit = FALSE
	RoomLit = FALSE
End Sub



' 3 hits need to this kicker to start Double Scoring...

Sub KickerMapX_Hit()
	PlaySound "fx_ScoopExit"

	If (fpTilted = TRUE) or (BonusBall = TRUE) Then KickerMapX.SolenoidPulse: Exit Sub

	If (DoubleScoreLight.State = BulbOff) Then
		xMarksHits = xMarksHits - 1
		If (ScoreUpdate = TRUE) and (xMarksHits =>1) Then
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1000
			DispDMD1.Text = "[edge3][f4][xc][y3]" & xmarkshits & " MORE FOR" & "[xc][y17]X MARKS THE SPOT"
			DispDMD2.Text = "[edge3][f4][xc][y3]" & xmarkshits & " MORE FOR" & "[xc][y17]X MARKS THE SPOT"
			If (QuoteBusy = FALSE) and (ModeName = "") Then
				QuoteBusy = TRUE
				Select Case xMarksHits
					Case 1: MusicFade(4200): PlayMusic 2, "vo_WellOfSouls"
					Case 2: MusicFade(1700): PlayMusic 2, "vo_DiscoveredTannis"
				End Select
			End If
		End If
		If (xMarksHits <=0) Then
			If (PerkDS(CP) = TRUE) Then
				xMarksTime = 70 ' extra 20 secs with the player perk
			Else
				xMarksTime = 50
			End If
			If (ScoreUpdate = TRUE) Then
				ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 1500
				DispDMD1.Text = "[edge3][f4][xc][y4]X MARKS THE SPOT[xc][y17][bf]DOUBLE SCORING"
				DispDMD2.Text = "[edge3][f4][xc][y4]X MARKS THE SPOT[xc][y17][bf]DOUBLE SCORING"
				MusicFade(1000): PlaySound "fx_Trap3"
				'PlaySound "fx_16"
				If (QuoteBusy = FALSE) Then 
					QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2300
					Select Case RandomNumber(3)
						Case 1: PlayMusic 2, "vo_Marks", FALSE, 1, 700
						Case 2: PlayMusic 2, "vo_XMarks", FALSE, 1, 700
						Case 3: PlayMusic 2, "vo_WellOfSouls2", FALSE, 1, 700
					End Select
					If (ModeName = "") and (CairoSwordsman = FALSE) and (HurryUpMode = FALSE) and (IJScoring = FALSE) and (BOG = FALSE) Then
						PlayMusic 1, "Music_MapRoom2", TRUE, 0.8, 1000 
					End If
				Else
					If (ModeName = "") and (CairoSwordsman = FALSE) and (HurryUpMode = FALSE) and (IJScoring = FALSE) and (BOG = FALSE) Then
						PlayMusic 1, "Music_MapRoom2", TRUE, 0.8
					End If
				End If
			End If
			ExtendX = FALSE
			DoubleScoreLight.FlashForMs 1000, 200, BulbOn
			xMarks = 2
			ResetxMarks.Set TRUE, 1000 ' don't fanny about, you only have 50 seconds...
		End If
	Else
		' Double Scoring is already active, so extend the timer...(1 TIME ONLY)
		If (ExtendX = FALSE) Then
			ExtendX = TRUE
			If (PerkDS(CP) = TRUE) Then
				xMarksTime = xMarksTime + 16
			Else
				xMarksTime = xMarksTime + 10
			End If
			PlaySound "fx_16"
			If (ScoreUpdate = TRUE) Then
				If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_BestDigger", FALSE, 1, 700: QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1800
				ScoreUpdate = FALSE: FlushDMDTimer.set TRUE, 1000
				DispDMD1.Text = "[edge3][f4][xc][y4]DOULBE SCORING[xc][y17][bf]TIME EXTENDED"
				DispDMD2.Text = "[edge3][f4][xc][y4]DOUBLE SCORING[xc][y17][bf]TIME EXTENDED"
			End If
		End If
	End If
	AddScore(25000)
	KickerMapX.SolenoidPulse
End Sub


Dim xMarksTime,NoPlay,ExtendX



Sub ResetxMarks_Expired()
	xMarksTime = xMarksTime - 1
	If (xMarksTime > 10) Then DoubleScoreLight.Set BulbOn, "10", 150
	If (xMarksTime = 10) Then
		DoubleScoreLight.Set BulbBlink, "10", 100
	End If
	If (xMarksTime =< 0) Then
		ResetxMarks.Set FALSE
		xMarks = 1
		xMarksHits = 3
		DoubleScoreLight.Set BulbOff, "10", 150
		If (ModeName = "") and (CairoSwordsman = FALSE) and (HurryUpMode = FALSE) and (IJScoring = FALSE) and (BOG = FALSE) Then
			RestartMusic_Expired()
		End If
	Exit Sub
	End If
	If (ModeName = "") and (CairoSwordsman = FALSE) and (HurryUpMode = FALSE) and (IJScoring = FALSE) and (BOG = FALSE) Then AddScore(0)
End Sub




' **************************************
' **                                  **
' **             LEFT LOOP            **
' **                                  **
' **************************************

' Out of mode, a complete orbit from the RIGHT LOOP advances the Gallop Value (Indy on a horse).

' [trigger is just above the left spinner]


Sub TriggerLeftOrbit_Hit()

	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub

	' a complete loop shot...from the right loop...
	If (FromRightOrbit = TRUE) Then
		FromRightOrbit = FALSE
		If (PerkLoop(CP) = TRUE) Then SpinVal = SpinVal + 200
		If (ModeName = "") Then PlaySound "fx_Gallop", 0.8
		Gallop = Gallop + 25000
		AddScore(Gallop)
		If (ModeName = "RScene3") or (ModeName = "TScene3") Then Exit Sub
		If (CairoSwordsman = FALSE) and (RewardSpin.Enabled = FALSE) and (ModeName = "") and (NoPlay = FALSE) Then
			If (MovieTimer.Enabled = FALSE) Then Clip = 49: PlayClip()
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 800 
			DispDMD1.Text = "[edge3][f4][xc][y4]ORBIT SHOT[xc][y17][bf]" & FormatScore(Gallop*xMarks)
			DispDMD2.Text = "[edge3][f4][xc][y4]ORBIT SHOT[xc][y17][bf]" & FormatScore(Gallop*xMarks)
		End If
	Exit Sub
	End If

	' ignore a double hit...
	If (LastSwitchHit.Name = "TriggerLeftOrbit") or (LastSwitchHit.Name = "TriggerLeftOrbit2") Then Exit Sub
	If (FromLeftOrbit = TRUE) Then FromLeftOrbit = FALSE: Exit Sub

	FromLeftOrbit = TRUE

	' shoot the RIGHT SPINNER, dummy...
	If (Ants = TRUE) Then
		If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: MusicFade(1000): PlayMusic 2, "vo_OtherRight"
		ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1000
		DispDMD1.QueueText "[edge3)[f6][xc][yc]WRONG LOOP", deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][yc]WRONG LOOP", deNone, 1000, TRUE
	Exit Sub
	End If

	If (ModeName = "RScene4") Then
		Select Case RandomNumber(4)
			Case 1: PlaySound "fx_Demon"
			Case 2: PlaySound "fx_Demon4"
			Case 3: PlaySound "fx_Demon5"
			Case 4: PlaySound "fx_Demon6"
		End Select
		If (MovieTimer.Enabled = FALSE) Then
			NoS(): LCD2.UpdateInterval = 68: OverlayMovie.UpdateInterval = 68
			Demon = Demon + 1
			Select Case Demon
				Case 1: Clip = 52: PlayClip()
				Case 2: Clip = 53: PlayClip()
				Case 3: Clip = 54: PlayClip()
				Case 4: Clip = 55: PlayClip()
				Case 5: Clip = 56: PlayClip()
				Case 6: Clip = 1: PlayClip(): Demon = 0
			End Select
		End If
		Flash = 0: FlashPFTimer.Set TRUE, 150
	Exit Sub
	End If

	If (LightOrbitL.State = BulbBlink) Then
		If (HurryUpMode = TRUE) Then
			snakestimer1.set FALSE
			ratstimer1.set FALSE
			antstimer1.set FALSE
			snakestimer2.set FALSE
			snakesEndtimer.set FALSE
			antstimer2.set FALSE
			antsEndtimer.set FALSE
			ratstimer2.set FALSE
			ratsEndtimer.set FALSE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2500
			DispDMD1.QueueText "[edge3][f6][xc][yc][bf]YOU DID IT", deNone, 1000, FALSE
			DispDMD2.QueueText "[edge3][f6][xc][yc][bf]YOU DID IT", deNone, 1000, FALSE
			DispDMD1.QueueText "[edge3][f2][y4]HURRY UP TOTAL[f6][xc][y13][b]" & Formatscore(HurryTotal*xmarks), deFlip, 1500, TRUE
			DispDMD2.QueueText "[edge3][f2][y4]HURRY UP TOTAL[f6][xc][y13][b]" & Formatscore(HurryTotal*xmarks), deFlip, 1500, TRUE
			AddScore(HurryTotal)
			HurryUpMode = FALSE
			StopMusic 1
			PlaySound "fx_RatsShot2"
			If (QuoteBusy = FALSE) Then
				QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2000
				Select Case RandomNumber(2)
					Case 1: PlayMusic 2, "vo_ToldYou2", FALSE, 1, 500
					Case 2: PlayMusic 2, "vo_YouDidIt", FALSE, 1, 500
				End Select
			End If
			RestartMusic.Set TRUE, 1500
			Flash = 2
			FlashPFTimer.Set TRUE, 350
			LightOrbitR.State = BulbOff
			LightOrbitL.State = BulbOff
			Snakes = FALSE
			Ants = FALSE
			Rats = FALSE
			MovieTimer.Set TRUE, 100
			LightSuperSpinL.FlashForMs 500, 100, BulbOn
		Exit Sub
		End If

		If (ModeName = "TScene1") Then
			GetAntidote()
		Exit Sub
		End If

		If (ModeName = "TScene2") Then
			ModeHit = ModeHit + 1

			If (ModeHit = 5) Then
				' open temple for final shot....
				OpenChamber()
				LightCrusade.State = BulbOff
				LightDoom.State = BulbBlink
				LightArk.State = BulbOff
				LightSkull.State = BulbOff
				LightOrbitR.State = BulbOff
				LightOrbitL.State = BulbOff
			Else
				PlayMusic 3, "Music_Cue3"
			End If
		Exit Sub
		End If

		If (ModeName = "RScene3") Then ' hijacking the truck...
			LightOrbitL.State = BulbOff
			LightOrbitR.State = BulbOff
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2500
			DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1000, FALSE
			DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1000, FALSE
			DispDMD1.QueueText "[edge3][f4][xc][y2]SHOOT TARGETS TO[f6][y15]THROW OFF GUARDS", deFlip, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y2]SHOOT TARGETS TO[f6][y15]THROW OFF GUARDS", deFlip, 1500, TRUE
			SceneHit()
			PlayMusic 3, "Music_Cue3"
			NaziTgt = TRUE

			Flash = 0: FlashPFTimer.Set TRUE, 75

			Clip = 16: PlayClip()

			' save the state of the INDY lights, we're going to use them for this mode...
			TempL1 = LightINDY1.State
			TempL2 = LightINDY2.State
			TempL3 = LightINDY3.State
			TempL4 = LightINDY4.State
			TempL5 = LightJONES1.State
			TempL6 = LightJONES2.State
			TempL7 = LightJONES3.State
			TempL8 = LightJONES4.State
			TempL9 = LightJONES5.State

			' and now blink them all...these are the truck guards, throw them from the truck...
			LightINDY1.Set BulbBlink, "10", 100
			LightINDY2.Set BulbBlink, "10", 100
			LightINDY3.Set BulbBlink, "10", 100
			LightINDY4.Set BulbBlink, "10", 100
			LightJONES1.Set BulbBlink, "10", 100
			LightJONES2.Set BulbBlink, "10", 100
			LightJONES3.Set BulbBlink, "10", 100
			LightJONES4.Set BulbBlink, "10", 100
			LightJONES5.Set BulbBlink, "10", 100
		Exit Sub
		End If

		' got to the train...
		If (ModeName = "CScene1") Then
			LightOrbitL.State = BulbOff
			LightOrbitR.State = BulbOff
			LightSkull.State = BulbBlink
			Clip = 22: PlayClip()
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 3200
			DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
			DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
			DispDMD1.QueueText "[edge3][f3][xc][y3]RUN ACROSS TRAIN[f6][y13][bf]SHOOT RAMP", deFlip, 2000
			DispDMD2.QueueText "[edge3][f3][xc][y3]RUN ACROSS TRAIN[f6][y13][bf]SHOOT RAMP", deFlip, 2000
			SceneHit()
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 500
			BulbArkL.FlashForMs 500, 100, BulbOff
			BulbArkR.FlashForMs 500, 100, BulbOff
			FlasherRed.FlashForMs 500, 100, BulbOff
			LightSeqPF.Play SeqBlinking, , 5, 100
		Exit Sub
		End If

		' dogfight CRUSADE SCENE 2...
		If (ModeName = "CScene2") Then
			'LightOrbitL.State = BulbOff
			If (MovieTimer.Enabled = FALSE) Then
				NoS()
				OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100
				LCD.Frame 591,592,591: OverlayLCD.Frame 591,592,591: MovieTimer.Set TRUE, 1000
			End If
			DogFightHit()
			PlaySound "fx_PlaneShoot2"
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1300
			SpotArk.FlashForMs 1300, 75, BulbOff
			FlasherArkSpot.FlashForMs 1300, 75, BulbOff
			SpotSword.FlashForMs 1300, 75, BulbOff
			FlasherSword.FlashForMs 1300, 75, BulbOff
			LightSeqPF.Play SeqBlinking, , 7, 75
		Exit Sub
		End If

		' tank CRUSADE shot...
		If (ModeName = "CScene3") Then
			TankHit()
		Exit Sub
		End If

		' mind control SKULL SCENE 3...
		If (ModeName = "SScene3") Then
			LightOrbitL.State = BulbOff
			SkullPowerHit()
		Exit Sub
		End If

		If (ModeName = "SScene4") Then
			LightOrbitL.State = BulbOff
			ModeHit = ModeHit + 1
			If (ModeHit = 4) Then EndMode(): Exit Sub
			ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
			DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			SceneHit()
			MusicFade(1000): PlayMusic 3, "Music_Cue3"
			LightSeqPF.Play SeqBlinking, , 3, 75
			Flash = 0: FlashPFTimer.Set TRUE, 75
		Exit Sub
		End If

	End If

	' when not lit...

	If (ModeName = "TScene3") Then

		' you took the left tunnel and left the mine...

		If (LightOrbitR.State = BulbBlink) Then
			LightOrbitR.State = BulbOff
			SceneTEMPLEComplete()
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
			DispDMD1.Text = "[edge3][f3][xc][y3]YOU EXITED[f6][y13]THE MINE"
			DispDMD2.Text = "[edge3][f3][xc][y3]YOU EXITED[f6][y13]THE MINE"
			ModeName = ""
			PlayMusic 1, "Music_Cue2"
			RestartMusic.Set TRUE, 1000
			PlaySound "fx_MineCart3", 0.8
			RevertINDYJONES()
			SceneCheck()
		Exit Sub
		End If

		LightSeqPF.Play SeqBlinking, , 2, 100
		BulbArkL.FlashForMs 1500, 1500, BulbOff
		BulbArkR.FlashForMs 1500, 1500, BulbOff
		FlasherRed.FlashForMs 1500, 1500, BulbOff
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 2000

		Select Case RandomNumber(5)
			Case 1: PlaySound "fx_MineCartLR"
			Case 2: PlaySound "fx_MineCartLR2"
			Case 3: 
				If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_WatchOnCurve"
				If (MovieTimer.Enabled = FALSE) Then
					Clip = 35: PlayClip()
				Else
					PlaySound "fx_MineCart2"
				End If
			Case 4: PlaySound "fx_MineCart3"
			Case 5: PlaySound "fx_MineCart5"
		End Select
	Exit Sub
	End If

	If (ModeName = "RScene4") Then RaidersHit(): Exit Sub

	' the deadly blade was out during the Grail Challenge...
	If (BOG = TRUE) and (LightChallenge.State = BulbOff) Then
		GrailChallengeLoss()
	Exit Sub
	End If

	Set LastSwitchHit = TriggerLeftOrbit
End Sub



Sub TriggerLeftOrbit2_Hit()
	If (fpTilted = TRUE) Then Exit Sub
	If (LastSwitchHit.Name = "TriggerRightOrbit2") Then Exit Sub
	If (ModeName = "RScene4") Then
		RaidersHit()
	Exit Sub
	End If
	If (BOG = TRUE)  and (LightChallenge.State = BulbBlink) Then
		GrailChallengeWin()
	End If
	Set LastSwitchHit = TriggerLeftOrbit2
End Sub




' ************************************
' **                                **
' **           RIGHT LOOP           **
' **                                **
' ************************************

' Out of mode, a complete orbit from the LEFT LOOP advances towards a Grail Challenge.

' no mode uses a complete loop shot yet, only left or right lanes.


Sub TriggerRightOrbit_Hit()
	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub
	
	' a complete orbit shot from the left loop...
	If (FromLeftOrbit = TRUE) Then
		FromLeftOrbit = FALSE
		If (PerkLoop(CP) = TRUE) Then SpinVal = SpinVal + 200
		If (ModeName = "RScene3") or (ModeName = "TScene3") Then Exit Sub

		Challenge(CP) = Challenge(CP) - 1

		' nothing else running? Ok to start Grail Challenge...
		If  (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) and (ModeName = "") Then
			If  (Challenge(CP) =< 0) Then
				LightChallenge.FlashForMs 1500, 200, BulbOn
				DispDMD1.QueueText "[edge3][xc][yc][f6][bf]BREATH OF GOD", deNone, 1000, FALSE
				DispDMD2.QueueText "[edge3][xc][yc][f6][bf]BREATH OF GOD", deNone, 1000, FALSE
				DispDMD1.QueueText "[edge3][xc][y2][f6][b]SHOOT LEFT ORBIT[f4][y18]WHEN GRAIL IS LIT", deNone, 1000, TRUE
				DispDMD2.QueueText "[edge3][xc][y2][f6][b]SHOOT LEFT ORBIT[f4][y18]WHEN GRAIL IS LIT", deNone, 1000, TRUE
				FlushDMDTimer.Set TRUE, 2500
				Challenge(CP) = 8 ' reset the value for the orbit shot...
				NoS(): OverlayLCD.Frame 136: LCD.Frame 136: MovieTimer.Set TRUE, 3500
				PlayMusic 2, "vo_BreathOfGod"
				QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1000
				Saw = 0
				BOG = TRUE
				PlayMusic 1, "Music_Challenge", TRUE, 0.8, 100
				BreathOfGodTimer.Set TRUE, 1000
				ChallengeTimer.Set TRUE, 34500
			Else
				' override the Spinner DMD...
				If (ScoreUpdate = TRUE) and (CairoSwordsman = FALSE) and (ModeName = "") Then
					ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1000
					PlaySound "fx_TrapShort"
					DispDMD1.Text = "[edge3][f4][xc][y3]GRAIL CHALLENGE[xc][y17]STARTS IN " & Challenge(CP)
					DispDMD2.Text = "[edge3][f4][xc][y3]GRAIL CHALLENGE[xc][y17]STARTS IN " & Challenge(CP)
				End If
			End If
		Else
			If (ModeName = "SScene1") or (ModeName = "SScene2") Then
				PlaySound "fx_Bike"
			Else
				If (ModeName = "") Then PlaySound "fx_Gallop", 0.8
			End If
		End If
	Exit Sub
	End If

	' ignore the double hit...
	If (LastSwitchHit.Name = "TriggerRightOrbit") or (LastSwitchHit.Name = "TriggerRightOrbit2") Then Exit Sub
	If (FromRightOrbit = TRUE) Then FromRightOrbit = FALSE: Exit Sub

	FromRightOrbit = TRUE

	If (ModeName = "TScene4") Then
		' do nothing...Combo is taken care of further down...
	Else
		If (ComboTimer.Enabled = TRUE) Then
			ComboAward()
		Else
			ComboTimer.Set TRUE, 3000
		End If
	End If

	If (BOG = TRUE) or (Rats = TRUE) Then
		ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1200
		DispDMD1.QueueText "[edge3][f6][xc][yc]WRONG WAY", deNone, 1200, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][yc]WRONG WAY", deNone, 1200, TRUE
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_WrongWay"
	Exit Sub
	End If

	If (ModeName = "RScene4") Then RaidersHit(): Exit Sub
	
	If (LightOrbitR.State = BulbBlink) Then

		If (HurryUpMode = TRUE) Then
			snakestimer1.set FALSE
			ratstimer1.set FALSE
			antstimer1.set FALSE
			snakestimer2.set FALSE
			snakesEndtimer.set FALSE
			antstimer2.set FALSE
			antsEndtimer.set FALSE
			ratstimer2.set FALSE
			ratsEndtimer.set FALSE
			PlayMusic 1, "Music_HurryUpAward", FALSE, 0.8
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 3000
			DispDMD1.QueueText "[edge3][f6][xc][yc][bf]YOU DID IT", deNone, 1000, FALSE
			DispDMD2.QueueText "[edge3][f6][xc][yc][bf]YOU DID IT", deNone, 1000, FALSE
			DispDMD1.QueueText "[edge3][f2][y4]HURRY UP TOTAL[f6][xc][y13][b]" & Formatscore(HurryTotal*xmarks), deFlip, 2000, TRUE
			DispDMD2.QueueText "[edge3][f2][y4]HURRY UP TOTAL[f6][xc][y13][b]" & Formatscore(HurryTotal*xmarks), deFlip, 2000, TRUE
			AddScore(HurryTotal)
			HurryUpMode = FALSE
			Snakes = FALSE
			Ants = FALSE
			Rats = FALSE
			MovieTimer.Set TRUE, 100
			StopMusic 1
			'PlaySound "fx_Whip3"
			PlaySound "fx_RatsShot"
			If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2000: PlayMusic 2, "vo_YouDidIt", FALSE, 1, 800
			Flash = 2
			FlashPFTimer.Set TRUE, 300
			RestartMusic.Set TRUE, 2000
			LightOrbitR.State = BulbOff
			LightOrbitL.State = BulbOff
			LightSuperSpinR.FlashForMs 500, 100, BulbOn
		Exit Sub
		End If

		If (ModeName = "TScene1") Then
			GetAntidote()
		Exit Sub
		End If

		If (ModeName = "TScene2") Then
			ModeHit = ModeHit + 1

			If (ModeHit = 5) Then

				' open temple for final shot....
				OpenChamber()

				LightCrusade.State = BulbOff
				LightDoom.State = BulbBlink
				LightArk.State = BulbOff
				LightSkull.State = BulbOff
				LightOrbitR.State = BulbOff
				LightOrbitL.State = BulbOff
				'EndMode()
			Else
				PlayMusic 3, "Music_Cue3"
			'	Select Case RandomNumber(6)
			'		Case 1: LightCrusade.State = BulbBlink
			'		Case 2: LightDoom.State = BulbBlink
			'		Case 3: LightArk.State = BulbBlink
			'		Case 4: LightSkull.State = BulbBlink
			'		Case 5: LightOrbitR.State = BulbBlink
			'		Case 6: LightOrbitL.State = BulbBlink
			'	End Select
			End If
		Exit Sub
		End If

		If (ModeName = "TScene3") Then ' mine cart chase start "left tunnel!"...
			StartChaseMB()
		Exit Sub
		End If

		' cut the rope bridge...
		If (ModeName = "TScene4") Then
			If (ComboTimer.Enabled = TRUE) Then
				ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
				DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
				DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
				SceneHit()
				Clip = 46: PlayClip(): MusicFade(2000)
				LightOrbitR.State = BulbOff
				LightSkull.State = BulbOff
				LightArk.State = BulbBlink
				BulbFS.State = BulbOff: LightFS.State = BulbOff
				PlayMusic 3, "Music_Cue3"
				Flash = 0: FlashPFTimer.Set TRUE, 100
			Else
				CutRope()
				ComboTimer.Set TRUE, 3000 ' start COMBO Timer...
			End If
		Exit Sub
		End If

		If (ModeName = "RScene3") Then ' hijacking the truck...
			LightOrbitL.State = BulbOff
			LightOrbitR.State = BulbOff
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2500
			DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1000, FALSE
			DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1000, FALSE
			DispDMD1.QueueText "[edge3][f4][xc][y2]SHOOT TARGETS TO[f6][y15]THROW OFF GUARDS", deFlip, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y2]SHOOT TARGETS TO[f6][y15]THROW OFF GUARDS", deFlip, 1500, TRUE
			SceneHit()

			PlayMusic 3, "Music_Cue3"
			NaziTgt = TRUE

			Clip = 36: PlayClip()

			' save the state of the INDY lights, we're going to use them for this mode...
			TempL1 = LightINDY1.State
			TempL2 = LightINDY2.State
			TempL3 = LightINDY3.State
			TempL4 = LightINDY4.State
			TempL5 = LightJONES1.State
			TempL6 = LightJONES2.State
			TempL7 = LightJONES3.State
			TempL8 = LightJONES4.State
			TempL9 = LightJONES5.State

			' and now blink them all...these are the truck guards, throw them from the truck...
			LightINDY1.Set BulbBlink, "10", 100
			LightINDY2.Set BulbBlink, "10", 100
			LightINDY3.Set BulbBlink, "10", 100
			LightINDY4.Set BulbBlink, "10", 100
			LightJONES1.Set BulbBlink, "10", 100
			LightJONES2.Set BulbBlink, "10", 100
			LightJONES3.Set BulbBlink, "10", 100
			LightJONES4.Set BulbBlink, "10", 100
			LightJONES5.Set BulbBlink, "10", 100

			BulbFS.State = BulbOff: LightFS.State = BulbOff ' can no longer use Free Shot...
		Exit Sub
		End If

		' got to the train....
		If (ModeName = "CScene1") Then
			LightOrbitL.State = BulbOff
			LightOrbitR.State = BulbOff
			LightSkull.State = BulbBlink
			Clip = 22: PlayClip()
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 3200
			DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
			DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
			DispDMD1.QueueText "[edge3][f3][xc][y3]RUN ACROSS TRAIN[f6][y13][bf]SHOOT RAMP", deFlip, 2000
			DispDMD2.QueueText "[edge3][f3][xc][y3]RUN ACROSS TRAIN[f6][y13][bf]SHOOT RAMP", deFlip, 2000
			SceneHit()
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 500
			BulbArkL.FlashForMs 500, 100, BulbOff
			BulbArkR.FlashForMs 500, 100, BulbOff
			FlasherRed.FlashForMs 500, 100, BulbOff
			LightSeqPF.Play SeqBlinking, , 5, 100
		Exit Sub
		End If

		' dogfight CRUSADE SCENE 2...
		If (ModeName = "CScene2") Then
			'LightOrbitR.State = BulbOff
			If (MovieTimer.Enabled = FALSE) Then
				NoS()
				OverlayLCD.UpdateInterval = 100: LCD.UpdateInterval = 100
				LCD.Frame 591,592,591: OverlayLCD.Frame 591,592,591: MovieTimer.Set TRUE, 1000
			End If
			DogFightHit()
			PlaySound "fx_PlaneShoot2"
			PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1300
			SpotArk.FlashForMs 1300, 75, BulbOff
			FlasherArkSpot.FlashForMs 1000, 75, BulbOff
			SpotSword.FlashForMs 1300, 75, BulbOff
			FlasherSword.FlashForMs 1300, 75, BulbOff
			LightSeqPF.Play SeqBlinking, , 7, 75
		Exit Sub
		End If

		' tank CRUSADE shot...
		If (ModeName = "CScene3") Then
			TankHit()
		Exit Sub
		End If

		' mind control SKULL SCENE 3...
		If (ModeName = "SScene3") Then
			LightOrbitR.State = BulbOff
			SkullPowerHit()
		Exit Sub
		End If

		If (ModeName = "SScene4") Then
			LightOrbitR.State = BulbOff
			ModeHit = ModeHit + 1
			If (ModeHit = 4) Then EndMode(): Exit Sub
			ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
			DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1500, TRUE
			SceneHit()
			MusicFade(1000): PlayMusic 3, "Music_Cue3"
			LightSeqPF.Play SeqBlinking, , 3, 75
			Flash = 0: FlashPFTimer.Set TRUE, 75
		Exit Sub
		End If

	End If

	If (BOG = TRUE) Then
		BladeBlock2.Collidable = TRUE
		ResetBlade.Set TRUE, 1000
		ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		DispDMD1.QueueText "[edge3][f6][xc][yc]YOU HAVE FAILED", deNone, 1500, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][yc]YOU HAVE FAILED", deNone, 1500, TRUE
		If (ModeName = "") Then
			PlayMusic 1, "Music_Cue2"
			If (QuoteBusy = FALSE) Then
				QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2500
				PlayMusic 2, "vo_WillPass", FALSE, 1, 600
				RestartMusic.Set TRUE, 2500
			Else
				RestartMusic.Set TRUE, 900
			End If
		End If
		BOG = FALSE
		BreathOfGodTimer.Enabled = FALSE
		ChallengeTimer.Enabled = FALSE
		LightChallenge.State = BulbOff
	Exit Sub
	End If

	If (ModeName = "TScene3") Then
		LightSeqPF.Play SeqBlinking, , 2, 100
		BulbArkL.FlashForMs 1500, 1500, BulbOff
		BulbArkR.FlashForMs 1500, 1500, BulbOff
		FlasherRed.FlashForMs 1500, 1500, BulbOff
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 2000

		If (MovieTimer.Enabled = FALSE) Then
			Clip = 35: PlayClip()
		Else
			Select Case RandomNumber(2)
				Case 1: PlaySound "fx_MineCart2"
				Case 2: PlaySound "fx_MineCart3"
			End Select
		End If
	Exit Sub
	End If

	If (ModeName = "CScene4") Then
		If (LightOrbitR.State = BulbBlink) Then
			LightOrbitRExt.SetLitColor 255, 0, 0
			LightOrbitR.State = BulbOn
			CheckChooseLights()
		Else
			ChooseEnd()
		End If
	Exit Sub
	End If

	Set LastSwitchHit = TriggerRightOrbit
End Sub



Sub TriggerRightOrbit2_Hit()
	'FromRightOrbit = TRUE
	Set LastSwitchHit = TriggerRightOrbit2
End Sub




' *************************************
' **                                 **
' **           LEFT SPINNER          **
' **                                 **
' *************************************

' fake spinners for now.

Dim SpinVal,SSpinVal


Sub LeftSpinner_Hit()
	SpinnerLeftTimer.Set TRUE, 100
	
	' ball coming from below (up)
	If (LeftComing=0) Then	
		spinnertoyLeft.Rotateyz (900) ' sets off the fake spinner...
		SlowRight1B.Set FALSE
		SlowRight1.Set TRUE, 1000: SpinA = 0 ' slows it down then stops...
	Exit Sub
	End If

	' ball coming from above (down)
	If (LeftComing=1) Then
		spinnertoyLeft.Rotateyz (-900)
		SlowRight1.Set FALSE
		SlowRight1b.Set TRUE, 1000: SpinB = 0
	Exit Sub
	End If

	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub

	If (ModeName = "RScene1") and (LightOrbitL.State = BulbBlink) Then
		' running from the boulder in Raiders scene 1....
		LightOrbitL.State = BulbBlink
		LightOrbitR.STate = BulbBlink
	Exit Sub
	End If

End Sub


Sub SpinnerLeftTimer_Expired()
	
	If (IgnoreMe = FALSE) and (fpTilted = FALSE) and (BonusBall = FALSE) Then
		SpinFx = SpinFx + 1
		Select Case SpinFx
			Case 1: SpinnerLeftTimer.Set TRUE, 75
			Case 2: SpinnerLeftTimer.Set TRUE, 85
			Case 3: SpinnerLeftTimer.Set TRUE, 95
			Case 4: SpinnerLeftTimer.Set TRUE, 100
			Case 5: SpinnerLeftTimer.Set TRUE, 105
			Case 6: SpinnerLeftTimer.Enabled = FALSE: SpinFx = 0: Exit Sub
		End Select
	End If

	If (IgnoreMe = TRUE) Then IgnoreMe = FALSE: SpinnerLeftTimer.Enabled = FALSE: Exit Sub

	If (fpTilted = TRUE) or (BonusBall = TRUE) Then SpinnerLeftTimer.Enabled = FALSE: Exit Sub

	If (ModeName = "RScene4") Then RaidersHit(): Exit Sub

	If (LightSuperSpinL.State = BulbOn) Then
		SSpinVal = (SpinVal*5)
		AddScore(SSpinVal)
		HurryVal(CP) = HurryVal(CP) + (25000*xMarks)
		PlayMusic 6, "fx_Spinner", FALSE, 0.6
		If (ScoreUpdate = TRUE) and (CairoSwordsman = FALSE) and (bMultiballMode = FALSE) Then
			FlushDMDTimer.Set TRUE, 500
			DispDMD1.Text = "[edge3][box1,26,1,102,13][f4][xc][y2]SUPER SPIN[f2][y16]"&FormatScore(SSpinVal*xMarks)&"[f1][y25]+ HURRY UP = " & FormatScore(HurryVal(CP))
			DispDMD2.Text = "[edge3][box1,26,1,102,13][f4][xc][y2]SUPER SPIN[f2][y16]"&FormatScore(SSpinVal*xMarks)&"[f1][y25]+ HURRY UP = " & FormatScore(HurryVal(CP))
		End If
		' player perk - also increase a random Movie Jackpot each spin....
		If (PerkSS(CP) = TRUE) Then
			Select Case RandomNumber(4)
				Case 1: TempleJP(CP) = TempleJP(CP) + 10000
				Case 2: RaidersJP(CP) = RaidersJP(CP) + 10000
				Case 3: SkullJP(CP) = SkullJP(CP) + 10000
				Case 4: CrusadeJP(CP) = CrusadeJP(CP) + 10000
			End Select
		End If
	Else
		PlayMusic 6, "fx_Spinner3", FALSE, 0.6
		AddScore(SpinVal)
		If (ScoreUpdate = TRUE) and (CairoSwordsman = FALSE) and (bMultiballMode = FALSE) Then
			DispDMD1.Text = "[edge3][f2][xc][y5]RATS SUPER IN[y13][f6]" & SpinsL & " OF 100"
			DispDMD2.Text = "[edge3][f2][xc][y5]RATS SUPER IN[y13][f6]" & SpinsL & " OF 100"
		End If
	End If

	SpinsL = SpinsL + 1

	If (ModeName = "RScene1") and (LightOrbitL.State = BulbBlink) Then
		' running from the boulder in Raiders scene 1..
		LightOrbitL.State = BulbOff
		LightOrbitR.State = BulbOff
		PlayMusic 3, "Music_Cue3"
		LightArk.State = BulbBlink
		BulbFS.State = BulbOff: LightFS.State = BulbOff
		Clip = 8: PlayClip()
		ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
		DispDMD1.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
		DispDMD2.QueueText "[edge3][f4][y3]GREAT SHOT[y17][bf]"&FormatScore(SceneVal*xMarks), deNone, 1200, FALSE
		SceneHit()
	Exit Sub
	End If

	If (ScoreUpdate = TRUE) Then FlushDMDTimer.Set TRUE, 500

	If (SpinsL = 100) Then
		LightSuperSpinL.State = BulbOn
		SpinsL = 0
		PlaySound "fx_Belch", 0.4
	Else
		'PlaySound "fx_1", 0.3
		'If (ScoreUpdate = TRUE) Then
		'	DispDMD1.Text = "[edge3][f2][xc][y4]SUPER SPIN IN[y14][f6]" & Spins & " OF 100"
		'	DispDMD2.Text = "[edge3][f2][xc][y4]SUPER SPIN IN[y14][f6]" & Spins & " OF 100"
		'End If
	End If
End Sub



Sub PreSpin_Hit()
	LeftComing = 0
	FromRightOrbit = FALSE
	FromLeftOrbit = FALSE
	Set LastSwitchHit = PreSpin
End Sub


Sub PostSpin_Hit()
	LeftComing = 1
End Sub


' from above spin...

Sub SlowRight1_Expired()
	Select Case SpinA
		Case 0: SpinnerToyLeft.Rotateyz (800): SpinA = 1
		Case 1: SpinnerToyLeft.Rotateyz (500): SpinA = 2
		Case 2: SpinnerToyLeft.Rotateyz (100), 0: SlowRight1.Set FALSE: SpinA = 0
	End Select
End Sub


Dim SpinA,SpinB


' from below spin...

Sub SlowRight1B_Expired()
	Select Case SpinB
		Case 0: SpinnerToyLeft.Rotateyz (-800): SpinB = 1
		Case 1: SpinnerToyLeft.Rotateyz (-500): SpinB = 2
		Case 2: SpinnerToyLeft.Rotateyz (-100), 0: SlowRight1b.Set FALSE: SpinB = 0
	End Select
End Sub




' *************************************
' **                                 **
' **          RIGHT SPINNER          **
' **                                 **
' *************************************

' 100 spins activates the SUPER SPINNER, yay...original rules...yay
' when Super Spinner is active, it will increase the Hurry Up value


Sub RightSpinPre_Hit()
	RightComing = 0
	FromRightOrbit = FALSE
	FromLeftOrbit = FALSE
	Set LastSwitchHit = RightSpinPre
End Sub


Sub RightSpinPost_Hit()
	RightComing = 1
	Set LastSwitchHit = RightSpinPost
End Sub


Sub RightSpinner_Hit()
	SpinnerRightTimer.Set TRUE, 100

	' ball coming from below (up)
	If (RightComing=0) Then	
		SpinnerToyRight.Rotateyz (900)
		SlowLeft1B.Set FALSE
		SlowLeft1.set TRUE, 1000
	Exit Sub
	End If

	' ball coming from above (down)
	If (RightComing=1) Then
		SpinnerToyRight.Rotateyz (-900)
		SlowLeft1.Set FALSE
		SlowLeft1B.set TRUE, 1000
	Exit Sub
	End If
	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub
End Sub


Sub SpinnerRightTimer_Expired()

	If (fpTilted = FALSE) and (BonusBall = FALSE) Then
		SpinFxR = SpinFxR + 1
		Select Case SpinFxR
			Case 1: SpinnerRightTimer.Set TRUE, 75
			Case 2: SpinnerRightTimer.Set TRUE, 85
			Case 3: SpinnerRightTimer.Set TRUE, 95
			Case 4: SpinnerRightTimer.Set TRUE, 105
			Case 5: SpinnerRightTimer.Set TRUE, 115
			Case 6: SpinnerRightTimer.Set TRUE, 125
			Case 7: SpinnerRightTimer.Set TRUE, 140
			Case 8: SpinnerRightTimer.Set TRUE, 155
			Case 9: SpinnerRightTimer.Enabled = FALSE: SpinFxR = 0: Exit Sub
		End Select
	End If

	If (fpTilted = TRUE) or (BonusBall = TRUE) Then SpinnerRightTimer.Enabled = FALSE: Exit Sub

	If (ModeName = "RScene4") Then RaidersHit(): Exit Sub

	If (LightSuperSpinR.State = BulbOn) Then
		SSpinVal = (SpinVal*5)
		AddScore(SSpinVal)
		HurryVal(CP) = HurryVal(CP) + (25000*xMarks)
		PlayMusic 6, "fx_Spinner", FALSE, 0.6
		If (ScoreUpdate = TRUE) and (CairoSwordsman = FALSE) and (bMultiballMode = FALSE) Then
			FlushDMDTimer.Set TRUE, 500
			DispDMD1.Text = "[edge3][box1,26,1,102,13][f4][xc][y2]SUPER SPIN[f2][y16]"&FormatScore(SSpinVal*xMarks)&"[f1][y25]+ HURRY UP = " & FormatScore(HurryVal(CP))
			DispDMD2.Text = "[edge3][box1,26,1,102,13][f4][xc][y2]SUPER SPIN[f2][y16]"&FormatScore(SSpinVal*xMarks)&"[f1][y25]+ HURRY UP = " & FormatScore(HurryVal(CP))
		End If
		' player perk - also increase a random Movie Jackpot each spin....
		If (PerkSS(CP) = TRUE) Then
			Select Case RandomNumber(4)
				Case 1: TempleJP(CP) = TempleJP(CP) + 10000
				Case 2: RaidersJP(CP) = RaidersJP(CP) + 10000
				Case 3: SkullJP(CP) = SkullJP(CP) + 10000
				Case 4: CrusadeJP(CP) = CrusadeJP(CP) + 10000
			End Select
		End If
	Else
		PlayMusic 6, "fx_Spinner3", FALSE, 0.6
		AddScore(SpinVal)
		If (ScoreUpdate = TRUE)and (CairoSwordsman = FALSE) and (bMultiballMode = FALSE) Then
			DispDMD1.Text = "[edge3][f2][xc][y5]ANTS SUPER IN[y13][f6]" & SpinsR & " OF 100"
			DispDMD2.Text = "[edge3][f2][xc][y5]ANTS SUPER IN[y13][f6]" & SpinsR & " OF 100"
		End If
	End If

	SpinsR = SpinsR + 1

	If (ModeName = "RScene1") and (LightOrbitR.State = BulbBlink) Then
		' running from the boulder in Raiders scene 1..
		LightOrbitL.State = BulbOff
		LightOrbitR.State = BulbOff
		PlayMusic 3, "Music_Cue3"
		LightArk.State = BulbBlink
		BulbFS.State = BulbOff: LightFS.State = BulbOff
		Clip = 9: PlayClip()
		SceneHit()
	Exit Sub
	End If

	If (ScoreUpdate = TRUE) Then FlushDMDTimer.Set TRUE, 500

	If (SpinsR = 100) Then
		PlaySound "fx_Belch", 0.4
		LightSuperSpinR.State = BulbOn
		SpinsR = 0
	End If

	'If (ModeName = "") and (HurryUpMode = FALSE) Then
	'	PlaySound "fx_1", 0.3
	'	ItemSpin = ItemSpin + 1
	'	Select Case ItemSpin
	'		Case 1: NoS(): OverlayLCD.Frame 137
	'		Case 2: NoS(): OverlayLCD.Frame 138
	'		Case 3: NoS(): OverlayLCD.Frame 139
	'		Case 4: NoS(): OverlayLCD.Frame 140
	'		Case 5: NoS(): OverlayLCD.Frame 141
	'		Case 6: NoS(): OverlayLCD.Frame 142
	'		Case 7: NoS(): OverlayLCD.Frame 143
	'		Case 8: NoS(): OverlayLCD.Frame 144
	'		Case 9: NoS(): OverlayLCD.Frame 145
	'		Case 10: NoS(): OverlayLCD.Frame 153
	'		Case 11: NoS(): OverlayLCD.Frame 154
	'		Case 12: NoS(): OverlayLCD.Frame 155
	'		Case 13: NoS(): OverlayLCD.Frame 156
	'		Case 14: NoS(): OverlayLCD.Frame 157
	'		Case 15: NoS(): OverlayLCD.Frame 158
	'		Case 16: NoS(): OverlayLCD.Frame 159
	'		Case 17: NoS(): OverlayLCD.Frame 160: ItemSpin = 0
	'	End Select
	'	MovieTimer.Set TRUE, 1000
	'End If

	'If (ScoreUpdate = TRUE) Then
	'	DispDMD1.Text = "[edge3][f2][xc][y4]SUPER SPIN IN[y14][f6]" & Spins & " OF 100"
	'	DispDMD2.Text = "[edge3][f2][xc][y4]SUPER SPIN IN[y14][f6]" & Spins & " OF 100"
	'End If
End Sub


Dim SpinC,SpinD


Sub SlowLeft1_Expired()
	Select Case SpinC
		Case 0: SpinnerToyRight.Rotateyz (800): SpinC = 1
		Case 1: SpinnerToyRight.Rotateyz (500): SpinC = 2
		Case 2: SpinnerToyRight.Rotateyz (100), 0: SlowLeft1.Set FALSE: SpinC = 0
	End Select
End Sub



Sub SlowLeft1B_Expired()
	Select Case SpinD
		Case 0: SpinnerToyRight.Rotateyz (-800): SpinD = 1
		Case 1: SpinnerToyRight.Rotateyz (-500): SpinD = 2
		Case 2: SpinnerToyRight.Rotateyz (-100), 0: SlowLeft1B.Set FALSE: SpinD = 0
	End Select
End Sub





' ************************************
' **                                **
' **          REWARD BONUS          **
' **                                **
' ************************************

' The player is awarded a movie item as a reward for successfully completing a scene.

' These are perks which will effect certain rules for the remainder of the game.

' The Perks:

' - BALL SAVER increases by 1 second each time it is activated.
' - Player can have 2 EXTRA BALLS per ball rather than the normal 1.
' - Any COMBO will also increase the score value for that shot each time.
' - The SUPER POPS timer is extended.
' - Bonus is held for any ball that drains SDTM.
' - Bonus Muliplier always starts at 2.
' - INDY and JONES scoring values are doubled.
' - Both SUPER SPINNERS are lit at the start of the next ball.
' - A complete orbit shot will increase the SPINNER value each time.
' - The Map Room Multiplier will increase by 4 instead of 2.
' - Double Scoring timer is extended.
' - Super Spinner will also increase Movie Jackpots.
' - A ricochet shot from any INDY target to the GRAIL SCOOP will automatically start the next scene.
' - If any ball drains within 30 secs, the next ball will have an extended BALL SAVER.
' - Hitting any INDY or JONES target 5 times during INDY JONES Scoring will award an EXTRA BALL.
' - Successfully hitting the Cairo Swordsman within 10 seconds awards the highest Movie Jackpot value.

' for now (ver 1.03) items are not remembered for each player...


' Start on a random number each time...

Sub SpinMe_Expired()
	SpinMe.Enabled = FALSE
	SpinStop = 10
	RewardSpin.Set TRUE, RS
	Select Case RandomNumber(15)
		Case 1: ItemSpin = 1
		Case 2: ItemSpin = 2
		Case 3: ItemSpin = 3
		Case 4: ItemSpin = 4
		Case 5: ItemSpin = 5
		Case 6: ItemSpin = 6
		Case 7: ItemSpin = 7
		Case 8: ItemSpin = 8
		Case 9: ItemSpin = 9
		Case 10: ItemSpin = 10
		Case 11: ItemSpin = 11
		Case 12: ItemSpin = 12
		Case 13: ItemSpin = 13
		Case 14: ItemSpin = 14
		Case 15: ItemSpin = 15
	End Select
End Sub


Sub RewardSpin_Expired()
	RewardSpin.Set TRUE, 110
	NoS(): SpinBusy = TRUE
	PlaySound "fx_1", 0.2
	ItemSpin = ItemSpin + 1
	SpinStop = SpinStop - 1
	ScoreUpdate = FALSE
	Select Case ItemSpin
		Case 1: OverlayLCD.Frame 137: LCD.Frame 137
			DispDMD1.Text = "[edge3][f6][xc][yc]SATCHEL"
			DispDMD2.Text = "[edge3][f6][xc][yc]SATCHEL"
		Case 2: OverlayLCD.Frame 138: LCD.Frame 138
			DispDMD1.Text = "[edge3][f6][xc][yc]WHIP"
			DispDMD2.Text = "[edge3][f6][xc][yc]WHIP"
		Case 3: OverlayLCD.Frame 139: LCD.Frame 139
			DispDMD1.Text = "[edge3][f6][xc][yc]MEDALLION"
			DispDMD2.Text = "[edge3][f6][xc][yc]MEDALLION"
		Case 4: OverlayLCD.Frame 140: LCD.Frame 140
			DispDMD1.Text = "[edge3][f6][xc][yc]ARK"
			DispDMD2.Text = "[edge3][f6][xc][yc]ARK"
		Case 5: OverlayLCD.Frame 141: LCD.Frame 141
			DispDMD1.Text = "[edge3][f6][xc][yc]DIARY"
			DispDMD2.Text = "[edge3][f6][xc][yc]DIARY"
		Case 6: OverlayLCD.Frame 142: LCD.Frame 142
			DispDMD1.Text = "[edge3][f6][xc][yc]IDOL"
			DispDMD2.Text = "[edge3][f6][xc][yc]IDOL"
		Case 7: OverlayLCD.Frame 143: LCD.Frame 143
			DispDMD1.Text = "[edge3][f6][xc][yc]GRAIL"
			DispDMD2.Text = "[edge3][f6][xc][yc]GRAIL"
		Case 8: OverlayLCD.Frame 144: LCD.Frame 144
			DispDMD1.Text = "[edge3][f6][xc][yc]STONES"
			DispDMD2.Text = "[edge3][f6][xc][yc]STONES"
		Case 9: OverlayLCD.Frame 145: LCD.Frame 145
			DispDMD1.Text = "[edge3][f6][xc][yc]CROSS"
			DispDMD2.Text = "[edge3][f6][xc][yc]CROSS"
		Case 10: OverlayLCD.Frame 153: LCD.Frame 153
			DispDMD1.Text = "[edge3][f6][xc][yc]SKULL"
			DispDMD2.Text = "[edge3][f6][xc][yc]SKULL"
		Case 11: OverlayLCD.Frame 154: LCD.Frame 154
			DispDMD1.Text = "[edge3][f6][xc][yc]MARKER"
			DispDMD2.Text = "[edge3][f6][xc][yc]MARKER"
		Case 12: OverlayLCD.Frame 155: LCD.Frame 155
			DispDMD1.Text = "[edge3][f6][xc][yc]BRAINS"
			DispDMD2.Text = "[edge3][f6][xc][yc]BRAINS"
		Case 13: OverlayLCD.Frame 156: LCD.Frame 156
			DispDMD1.Text = "[edge3][f6][xc][yc]SHIELD"
			DispDMD2.Text = "[edge3][f6][xc][yc]SHIELD"
		Case 14: OverlayLCD.Frame 157: LCD.Frame 157
			DispDMD1.Text = "[edge3][f6][xc][yc]DOLL"
			DispDMD2.Text = "[edge3][f6][xc][yc]DOLL"
		Case 15: OverlayLCD.Frame 158: LCD.Frame 158
			DispDMD1.Text = "[edge3][f6][xc][yc]SKULL HAT"
			DispDMD2.Text = "[edge3][f6][xc][yc]SKULL HAT"
		Case 16: OverlayLCD.Frame 159: LCD.Frame 159
			DispDMD1.Text = "[edge3][f6][xc][yc]CRATE"
			DispDMD2.Text = "[edge3][f6][xc][yc]CRATE"
		Case 17: OverlayLCD.Frame 160: : LCD.Frame 160: ItemSpin = 0
			DispDMD1.Text = "[edge3][f6][xc][yc]FEDORA"
			DispDMD2.Text = "[edge3][f6][xc][yc]FEDORA"
	End Select
	' stop the spin...
	If (SpinStop = 0) Then
		RewardSpin.Enabled = FALSE
		'If (ItemSpin = ItemReward) Then
		'	MovieTimer.Set TRUE, 1000 ' a duplicate award, do nothing for now...
		'	DispDMD1.Text = "[edge3][f6][xc][yc][bf]DUPLICATE"
		'	DispDMD2.Text = "[edge3][f6][xc][yc][bf]DUPLICATE"
		'	PlaySound "fx_Bad"
		'	SpinBusy = FALSE
		'	FlushDMDTimer.Set TRUE, 1000
		'Exit Sub
		'End If
		EndSpin()
	End If
End Sub


Dim SpinBusy


Sub EndSpin()
	SpinBusy = FALSE
	Select Case ItemSpin
		Case 1: PlaySound "fx_GetItem" ' satchel
		Case 2: PlaySound "fx_Whip5", 0.7 ' whip
		Case 3: 
			If (QuoteBusy = FALSE) Then
				MusicFade(900): QuoteBusy = TRUE: PlayMusic 2, "vo_StaffOfRa" ' medallion
			Else
				PlaySound "fx_StoneCollect2"
			End If
		Case 4: 
			If (QuoteBusy = FALSE) Then
				MusicFade(1000): QuoteBusy = TRUE: PlayMusic 2, "vo_ArkOfCovenent"
			Else
				PlaySound "fx_GrailCue" ' ark
			End If
		Case 5: 
			If (QuoteBusy = FALSE) Then
				MusicFade(1000): QuoteBusy = TRUE 
				Select Case RandomNumber(2)
					Case 1: PlayMusic 2, "vo_GrailDiary"
					Case 2: PlayMusic 2, "vo_GrailDiary2"
				End Select
			Else
				PlaySound "fx_PageTurn", 0.7 ' diary
			End If
		Case 6: PlaySound "fx_Jungle5" ' idol
		Case 7: PlaySound "fx_GrailHit" ' grail
		Case 8: PlaySound "fx_StoneCollect2" ' stones
		Case 9: PlaySound "fx_GetItem" ' cross
		Case 10: PlaySound "fx_Skull2" ' skull
		Case 11: 
			If (QuoteBusy = FALSE) Then
				MusicFade(1200): QuoteBusy = TRUE: PlayMusic 2, "vo_TabletMarkers"
			Else
				PlaySound "fx_IdolMove" ' marker
			End If
		Case 12: PlaySound "fx_Belch", 0.6 ' brains
		Case 13:
			If (QuoteBusy = FALSE) Then
				MusicFade(2600): QuoteBusy = TRUE: PlayMusic 2, "vo_TheShield"
			Else
				PlaySound "fx_6" ' shield
			End If
		Case 14: PlaySound "fx_Mystery" ' doll
		Case 15: ' skullhat
				If (QuoteBusy = FALSE) Then
					PlayMusic 2, "vo_Genargh3"
				Else
					PlaySound "fx_StoneCollect2"
				End If
		Case 16: 
			If (QuoteBusy = FALSE) Then
				MusicFade(800): QuoteBusy = TRUE: PlayMusic 2, "vo_TheLostArk"
			Else
				PlaySound "fx_Mystery" ' crate
			End If
		Case 0: PlaySound "fx_StoneCollect2" ' hat
	End Select
	GivePerk()
	ItemReward = ItemSpin ' save the reward...
	MovieTimer.Set TRUE, 1800
	FlushDMDTimer.Set TRUE, 1800
End Sub



Sub GivePerk()
	' for now, award a random perk (1 of 13)...more to follow...add names possibly?
	Select Case RandomNumber(13)
		Case 1: 
			If (PerkSDTM(CP) = FALSE) Then
				PerkSDTM(CP) = TRUE ' SDTM drain awards a Bonus Held (one use only) "Avenger"
				DispDMD1.Text = "[edge3][f4][xc][y2][bf]SDTM PERK[/bf][f2][y16]BONUS HELD[f1][y25]NEXT SDTM DRAIN"
				DispDMD2.Text = "[edge3][f4][xc][y2][bf]SDTM PERK[/bf][f2][y16]BONUS HELD[f1][y25]NEXT SDTM DRAIN"
			Else
				GivePerk()
			End If
		Case 2: 
			If (PerkX4(CP) = FALSE) Then
				PerkX4(CP) = TRUE ' Map Room Multiplier increases by 4 instead of 2 "Archiologist"
				DispDMD1.Text = "[edge3][f4][xc][y2][bf]X 4 PERK[/bf][f2][y16]MAP ROOM[f1][y25]BONUS ADV TO X 4"
				DispDMD2.Text = "[edge3][f4][xc][y2][bf]X 4 PERK[/bf][f2][y16]MAP ROOM[f1][y25]BONUS ADV TO X 4"
			Else
				GivePerk()
			End If
		Case 3: 
			If (PerkSS(CP) = FALSE) Then
				PerkSS(CP) = TRUE ' Super Spinner also increases a random Movie Jackpot "Hunter"
				DispDMD1.Text = "[edge3][f4][xc][y2][bf]SPIN PERK[/bf][f2][y16]SUPER SPINNER[f1][y25]INCREASE JACKPOTS"
				DispDMD2.Text = "[edge3][f4][xc][y2][bf]SPIN PERK[/bf][f2][y16]SUPER SPINNER[f1][y25]INCREASE JACKPOTS"
			Else
				GivePerk()
			End If
		Case 4: 
			PerkIJ(CP) = TRUE: IJHit(CP) = 0 ' INDY JONES Scoring awards an EXTRA BALL if 5 hits are made "Hero"
			DispDMD1.Text = "[edge3][f4][xc][y2][bf]IJ EB PERK[/bf][f2][y16]INDY JONES[f1][y25]5 HITS AWARDS EB"
			DispDMD2.Text = "[edge3][f4][xc][y2][bf]IJ EB PERK[/bf][f2][y16]INDY JONES[f1][y25]5 HITS AWARDS EB"
		Case 5: 
			If (PerkBS(CP) = FALSE) Then
				PerkBS(CP) = TRUE: ' each time the BALL SAVER is activated, it's timer increases by 1 second "Mileage"
				DispDMD1.Text = "[edge3][f4][xc][y2][bf]BS + 1 PERK[/bf][f2][y16]BALL SAVER[f1][y25]EXTEND BY 1 SEC"
				DispDMD2.Text = "[edge3][f4][xc][y2][bf]BS + 1 PERK[/bf][f2][y16]BALL SAVER[f1][y25]EXTEND BY 1 SEC"
			Else
				GivePerk()
			End If
		Case 6: 
			PerkPops(CP) = TRUE: ' Super Pops timer is extended by 7 seconds "Endurance"
			DispDMD1.Text = "[edge3][f4][xc][y2][bf]POPS PERK[/bf][f2][y16]SUPER POPS[f1][y25]TIME EXTEND 7 SECS"
			DispDMD2.Text = "[edge3][f4][xc][y2][bf]POPS PERK[/bf][f2][y16]SUPER POPS[f1][y25]TIME EXTEND 7 SECS"
		Case 7: 
			If (PerkDS(CP) = FALSE) Then
				PerkDS(CP) = TRUE: ' Double Scoring timer is extended by 20 seconds "Glory"
				DispDMD1.Text = "[edge3][f4][xc][y2][bf]X2 SCORE PERK[/bf][f2][y16]DOUBLE SCORING[f1][y25]TIME EXTEND 20 SECS"
				DispDMD2.Text = "[edge3][f4][xc][y2][bf]X2 SCORE PERK[/bf][f2][y16]DOUBLE SCORING[f1][y25]TIME EXTEND 20 SECS"
			Else
				GivePerk()
			End If
		Case 8: 
			If (PerkLoop(CP) = FALSE) Then
				PerkLoop(CP) = TRUE: ' complete loops increase Spinner value each time "Horseback"
				DispDMD1.Text = "[edge3][f4][xc][y2][bf]LOOP PERK[/bf][f2][y16]LANE LOOPS[f1][y25]INCREASE SPIN VAL"
				DispDMD2.Text = "[edge3][f4][xc][y2][bf]LOOP PERK[/bf][f2][y16]LANE LOOPS[f1][y25]INCREASE SPIN VAL"
			Else
				GivePerk()
			End If
		Case 9: 
			PerkCombo(CP) = TRUE: ' Combo shots will increase ramp value each time "Precision"
			DispDMD1.Text = "[edge3][f4][xc][y2][bf]COMBO PERK[/bf][f2][y16]COMBO SHOTS[f1][y25]INCREASE RAMP VAL"
			DispDMD2.Text = "[edge3][f4][xc][y2][bf]COMBO PERK[/bf][f2][y16]COMBO SHOTS[f1][y25]INCREASE RAMP VAL"
		Case 10: 
			If (PerkSpecial(CP) = FALSE) Then
				PerkSpecial(CP) = TRUE: ' Special lights on both outlanes "Fortune"
				DispDMD1.Text = "[edge3][f4][xc][y2][bf]SPECIAL PERK[/bf][f2][y16]SPECIAL LIGHTS[f1][y25]ON BOTH OUTLANES"
				DispDMD2.Text = "[edge3][f4][xc][y2][bf]SPECIAL PERK[/bf][f2][y16]SPECIAL LIGHTS[f1][y25]ON BOTH OUTLANES"
				If (LightSpecialL.State = BulbOn) or (LightSpecialR.State = BulbOn) Then
					LightSpecialL.State = BulbOn: LightSpecialR.State = BulbOn
				End If
			Else
				GivePerk()
			End If
		Case 11: 
			If (PerkLuck(CP) = FALSE) Then
				PerkLuck(CP) = TRUE: ' Ball Saver grace time increased "Cliffhanger"
				DispDMD1.Text = "[edge3][f4][xc][y2][bf]GRACE PERK[/bf][f2][y16]BALL SAVER[f1][y25]GRACE TIME INCREASED"
				DispDMD2.Text = "[edge3][f4][xc][y2][bf]GRACE PERK[/bf][f2][y16]BALL SAVER[f1][y25]GRACE TIME INCREASED"
			Else
				GivePerk()
			End If
		Case 12: 
			PerkSword(CP) = TRUE: ' Quick hit (within 10 seconds) to Cairo Swordsman awards double the value "Bullseye"
			DispDMD1.Text = "[edge3][f4][xc][y2][bf]SWORDSMAN PERK[/bf][f2][y16]CAIRO SWORDSMAN[f1][y25]QUICK HIT X2 VALUE"
			DispDMD2.Text = "[edge3][f4][xc][y2][bf]SWORDSMAN PERK[/bf][f2][y16]CAIRO SWORDSMAN[f1][y25]QUICK HIT X2 VALUE"
		Case 13: 
			PerkRamp(CP) = TRUE: ' Any ball returning down the ramp SDTM is returned "Defience"
			DispDMD1.Text = "[edge3][f4][xc][y2][bf]RAMP PERK[/bf][f2][y16]RAMP DRAINS[f1][y25]ARE RETURNED"
			DispDMD2.Text = "[edge3][f4][xc][y2][bf]RAMP PERK[/bf][f2][y16]RAMP DRAINS[f1][y25]ARE RETURNED"
	End Select
End Sub


Dim PerkSDTM(4),PerkX4(4),PerkSS(4),PerkIJ(4),PerkBS(4),PerkPops(4),PerkDS(4),PerkLoop(4),PerkCombo(4),PerkSpecial(4),PerkLuck(4),PerkSword(4)
Dim IJHit(4),PerkRamp(4)



' *************************************
' **                                 **
' **          THE SWORDSMAN          **
' **                                 **
' *************************************

' Just like the movie, this guy is annoying when he pops up so to avoid him completely you 
' can just shoot him and move on (press LAUNCH button).  You won't get any points though or
' progress towards winning the Extra Ball....and you will reset the Hurry Up value.

' Fight him to collect the score value.  Beat him 3 times to light the Extra Ball at the ramp.


Sub StartSword()
	LightSwordsman.State = BulbBlink
	Clip = 32: PlayClip()
	SwordScore(CP) = (SwordHUVal(CP)*xMarks)
	ScoreUpdate = FALSE
	DispDMD1.FlushQueue: DispDMD2.FlushQueue
	DispDMD1.QueueText "[edge3][xc][y2][f4][b]FIGHT THE[f6][y15]SWORDSMAN", deNone, 2000, TRUE
	DispDMD2.QueueText "[edge3][xc][y2][f4][b]FIGHT THE[f6][y15]SWORDSMAN", deNone, 2000, TRUE
	CairoSwordsman = TRUE
	SwordTime = 18: SwordModeTimer.Set TRUE, 1000 ' 18 secs overall...
	SwordModeTimer2.Set TRUE, 2000
	PlayMusic 5, "Music_Suprise"
	PlayMusic 1, "Music_Swordsman", FALSE, 0.8, 2200 ' 32 secs...
	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1000
	SwordMove.Set TRUE, 10
	PlasDarkOn(): Flash = 3: FlashPFTimer.Set TRUE, 200
End Sub


Dim SwordTime


Sub TriggerSwordsman_Hit()
	PlaySound "BBHit"

	' immediately stop the sling blocker (enabled if table nudged)...
	SlingBlockTimer.Enabled = FALSE: SlingStop = FALSE

	If (ModeName = "RScene4") Then RaidersHit():	Exit Sub

	' this beats the Swordsman so go no furher...
	If (CairoSwordsman = TRUE) Then SwordsmanHit():	Exit Sub

	If (ModeName <>"") Then	Exit Sub

	SwordHit(CP) = SwordHit(CP) + 1
	If (SwordHit(CP) = SwordNeeded(CP)) Then StartSword(): Exit Sub
	
	If (ScoreUpdate = TRUE) Then
		ScoreUpdate = FALSE:	FlushDMDTimer.set TRUE, 1200
		DispDMD1.Text = "[edge3][f4][xc][y3]" & (SwordNeeded(CP)-Swordhit(CP)) & " MORE FOR" & "[f4][xc][y17]SWORDFIGHT"
		DispDMD2.Text = "[edge3][f4][xc][y3]" & (SwordNeeded(CP)-Swordhit(CP)) & " MORE FOR" & "[f4][xc][y17]SWORDFIGHT"
	End If
End Sub


Sub SwordModeTimer2_Expired()
	SwordModeTimer2.Set TRUE, 50
	If (xMarks = 2) Then
		SwordScore(CP) = SwordScore(CP) - 41040 ' take double the value if Double Scoring is active...
	Else
		SwordScore(CP) = SwordScore(CP) - 20520
	End If
	If (SwordScore(CP) < (1000000*xMarks)) Then
		SwordScore(CP) = (1000000*xMarks)
		Clip = 33: PlayClip()
		SwordModeTimer2.Enabled = FALSE
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_Shoot", FALSE, 1, 500
		DispDMD1.Text = "[edge3][f4][xc][y3][bf]" & formatscore(SwordScore(CP)*xMarks) & "[/bf][f2][xc][y17]FIGHT THE SWORDSMAN[f1][xc][y25]OR JUST SHOOT HIM"
		DispDMD2.Text = "[edge3][f4][xc][y3][bf]" & formatscore(SwordScore(CP)*xMarks) & "[/bf][f2][xc][y17]FIGHT THE SWORDSMAN[f1][xc][y25]OR JUST SHOOT HIM"
	Exit Sub
	End If
	DispDMD1.Text = "[edge3][f4][xc][y3]" & formatscore(SwordScore(CP)*xMarks) & "[f2][xc][y17]FIGHT THE SWORDSMAN[f1][xc][y25]OR JUST SHOOT HIM"
	DispDMD2.Text = "[edge3][f4][xc][y3]" & formatscore(SwordScore(CP)*xMarks) & "[f2][xc][y17]FIGHT THE SWORDSMAN[f1][xc][y25]OR JUST SHOOT HIM"
End Sub



Sub SwordModeTimer_Expired()
	SwordTime = SwordTime - 1
	If (SwordTime = 0) Then
		LightSwordsman.State = BulbOff
		SwordModeTimer2.set FALSE
		CairoSwordsman = FALSE
		MovieTimer.Set TRUE, 100
		If (ScoreUpdate = TRUE) Then
			ScoreUpdate = FALSE
			DispDMD1.Text = "[edge3][f4][xc][y3][b]TOO LATE[xc][y17]HE BEAT YOU"
			DispDMD2.Text = "[edge3][f4][xc][y3][b]TOO LATE[xc][y17]HE BEAT YOU"
		End If
		FlushDMDTimer.Set TRUE, 2000
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_Laugh"
		SwordHit(CP) = 0
		SwordModeTimer.Set FALSE
		If (ModeName = "") Then 
			RestartMusic.Set TRUE, 200
			MovieTimer_Expired()
		End If
		SwordMove.Set TRUE, 500
	End If
End Sub



Sub SwordsmanHit()
	If (Gotcha = TRUE) Then
		SwordModeTimer.set FALSE
		SwordModeTimer2.set FALSE

		' he was hit within 10 secs...nice shot...
		If (PerkSword(CP) = TRUE) and (SwordTime >8) Then
			SwordScore(CP) = (SwordScore(CP)*2)
			PlaySound "fx_Smile"
		End If

		ScoreUpdate = FALSE
		DispDMD1.QueueText "[edge3][f2][y4]SWORDSMAN BEATEN[f6][xc][y13][bf]" & formatscore(SwordScore(CP)*xMarks), deNone, 1500, FALSE
		DispDMD2.QueueText "[edge3][f2][y4]SWORDSMAN BEATEN[f6][xc][y13][bf]" & formatscore(SwordScore(CP)*xMarks), deNone, 1500, FALSE

		EB(CP) = EB(CP) + 1 ' beat him 3 times to light the extra ball at the ramp...

		If (EB(CP) = 3) Then
			LightExtraBall.State = BulbOn
			DispDMD1.QueueText "[edge3][f2][y5][bf]EXTRA BALL[f6][xc][y14]IS LIT", deFlip, 1500, TRUE
			DispDMD2.QueueText "[edge3][f2][y5][bf]EXTRA BALL[f6][xc][y14]IS LIT", deFlip, 1500, TRUE
			FlushDMDTimer.set TRUE, 3000
			EB(CP) = 0
		Else
			DispDMD1.QueueText "[edge3][f2][y5]SWORDSMAN VALUE[f6][xc][y14][bf]INCREASED", deFlip, 1200, TRUE
			DispDMD2.QueueText "[edge3][f2][y5]SWORDSMAN VALUE[f6][xc][y14][bf]INCREASED", deFlip, 1200, TRUE
			FlushDMDTimer.set TRUE, 2700
		End If
		SwordWin(CP) = SwordWin(CP) + 1
		CairoSwordsman = FALSE
		AddScore(SwordScore(CP))
		SwordNeeded(CP) = SwordNeeded(CP) + 1
		SwordHit(CP) = 0
		SwordHUVal(CP) = SwordHUVal(CP) + 1000000 ' increse val by 1m after each win...
		PlaySound "fx_FistFight"
		PlayMusic 2, "vo_Wow", FALSE, 1, 1000
		If (ModeName = "") Then
			MovieTimer.Set TRUE, 100
			PlayMusic 1, "Music_Cue14"
			RestartMusic.Set TRUE, 1500
		End If
		LightSeqPF.Play SeqBlinking, , 5, 50
		PlasDarkOn(): Flash = 0: FlashPFTimer.Set TRUE, 100
		SwordMove.Set TRUE, 500
		LightSwordsman.State = BulbOff
	End If
End Sub


Sub SwordsmanShot()
	LightSwordsman.State = BulbOff
	SwordModeTimer2.set FALSE
	FlushDMDTimer.Set TRUE, 2600
	DispDMD1.QueueText "[edge3] ", deNone, 600, FALSE
	DispDMD2.QueueText "[edge3] ", deNone, 600, FALSE
	DispDMD1.QueueText "[edge3][f6][xc][yc][bf]YOU SHOT HIM", deNone, 800, FALSE
	DispDMD2.QueueText "[edge3][f6][xc][yc][bf]YOU SHOT HIM", deNone, 800, FALSE
	If (SwordWin(CP) > 0) Then
		DispDMD1.QueueText "[edge3][f4][xc][y3]SWORDSMAN[xc][y16]VALUE RESET", deFlip, 1200, TRUE
		DispDMD2.QueueText "[edge3][f4][xc][y3]SWORDSMAN[xc][y16]VALUE RESET", deFlip, 1200, TRUE
	Else
		DispDMD1.QueueText "[edge3][f6][xc][yc]NO POINTS", deFlip, 1200, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][yc]NO POINTS", deFlip, 1200, TRUE
	End If
	StopMusic 1
	If (QuoteBusy = FALSE) Then
		Select Case RandomNumber(2)
			Case 1: PlayMusic 2, "vo_VeryFunny", FALSE, 1, 1100
			Case 2: PlayMusic 2, "vo_SallahLaugh", FALSE, 1, 1100
		End Select
	End If
	Clip = 2: PlayClip()
	SwordHUVal(CP) = 5000000
	SwordNeeded(CP) = 4: SwordWin(CP) = 0
	Swordhit(CP) = 0
	CairoSwordsman = FALSE
	SwordModeTimer.Set FALSE
	RestartMusic.Set TRUE, 500
	PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 1600
	FlasherSword.Set BulbBlink,  "0000010100000000", 75
	SpotSword.Set BulbBlink, "0000010100000000", 75
	LightSeqPF.Play SeqDoNothing, , , 500
	LightSeqPF.Play SeqBlinking, , 1, 500
	SwordMove.Set TRUE, 1000
End Sub


Dim Gotcha


Sub SwordMove_Expired()
	SwordMove.Enabled = FALSE
	' reset the toy...
	If (CairoSwordsman = FALSE) Then
		If (Gotcha = TRUE) Then
			PlaySound "fx_StoneMove"
			Gotcha = FALSE
			Swordsman.RotateXZ -150,245
		End If
		FlasherSword.State = BulbOff: SpotSword.State = BulbOff
	Exit Sub
	End If
	PlaySound "fx_StoneMove"
	If Swordsman.anglexz = 245 then ' he goes away...
		Gotcha = TRUE
		Swordsman.rotatexz 150,335
		FlasherSword.State = BulbOn: SpotSword.State = BulbOn
	End If
	If Swordsman.anglexz = 335 then ' he leaps out...
		Gotcha = FALSE
		Swordsman.RotateXZ -150,245
		FlasherSword.State = BulbOff: SpotSword.State = BulbOff
	End If
	' taunt the player with some fancy moves Mr Swordsman...and giggle like a girl at random times...
	If (CairoSwordsman = TRUE) and (SwordWin(CP) => 1) Then
		Select Case SwordWin(CP)
			Case 1:
				Select Case RandomNumber(4)
					Case 1: SwordMove.Set TRUE, 2000
					Case 2: SwordMove.Set TRUE, 2500
					Case 3: SwordMove.Set TRUE, 3000: If (QuoteBusy = FALSE) and (CairoSwordsman = TRUE) Then QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1000: PlayMusic 2, "vo_Laugh"
					Case 4: SwordMove.Set TRUE, 3500
				End Select
			Case Else:
				' he moves quicker if beaten more than a few times...still can't do naff all with a sword against Indy's gun...
				Select Case RandomNumber(4)
					Case 1: SwordMove.Set TRUE, 1000
					Case 2: SwordMove.Set TRUE, 1500
					Case 3: SwordMove.Set TRUE, 2000: If (QuoteBusy = FALSE) and (CairoSwordsman = TRUE) Then QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1000: PlayMusic 2, "vo_Laugh"
					Case 4: SwordMove.Set TRUE, 2500
				End Select
		End Select
	End If
End Sub



Sub StopSwordsman()
	LightSwordsman.State = BulbOff
	SwordModeTimer2.Set FALSE
	CairoSwordsman = FALSE
	SwordNeeded(CP) = SwordNeeded(CP) + 1
	SwordHit(CP) = 0
	SwordmodeTimer.Set FALSE
	SwordMove.Set TRUE, 100
End Sub



' *******************************
' **                           **
' **          MYSTERY          **
' **                           **
' *******************************

' Standard mystery awarding various goodies but with a slight twist - some of the rewards
' will start a feature such as the 3 Hurry Ups, that cannot be started at any other time.


RandomSpin = 0


Sub StartMystery()
	FlushDMDTimer.Set FALSE: ScoreUpdate = FALSE
	NoS(): OverlayLCD.Frame 67: LCD.Frame 67
	
	' Mystery might award another feature so stop anything else running...
	If (IJScoring = TRUE) Then EndIJScoring()
	
	DispDMD1.QueueText "[edge3][f6][xc][yc]MYSTERY", deNone, 1200, TRUE
	DispDMD2.QueueText "[edge3][f6][xc][yc]MYSTERY", deNone, 1200, TRUE

	MysteryEnd.Set TRUE, 4500
	MysteryChange.Set TRUE, 1000
	PlayMusic 1, "Music_Mystery", FALSE, 0.6
	LightSeqPF.Play Seqblinking, , 10, 50

	' make sure the spin starts at a random point each time...
	Select Case RandomNumber(18)
		Case 1: RandomSpin = 1
		Case 2: RandomSpin = 2
		Case 3: RandomSpin = 3
		Case 4: RandomSpin = 4
		Case 5: RandomSpin = 5
		Case 6: RandomSpin = 6
		Case 7: RandomSpin = 7
		Case 8: RandomSpin = 8
		Case 9: RandomSpin = 9
		Case 10: RandomSpin = 10
		Case 11: RandomSpin = 11
		Case 12: RandomSpin = 12
		Case 13: RandomSpin = 13
		Case 14: RandomSpin = 14
		Case 15: RandomSpin = 15
		Case 16: RandomSpin = 16
		Case 17: RandomSpin = 17
		Case 18: RandomSpin = 18
	End Select
End Sub


Sub MysteryChange_Expired()
	MysteryChange.Set TRUE, 200
	PlaySound "fx_1", 0.4
	Select Case RandomSpin
		case 1: mysterymode = "GRAIL CHALLENGE": RandomSpin = 2: OverlayLCD.Frame 15: LCD.Frame 15
		case 2: mysterymode = "FREE SHOT": RandomSpin = 3: OverlayLCD.Frame 152: LCD.Frame 152
		case 3: mysterymode = "BIG POINTS": RandomSpin = 4: OverlayLCD.Frame 14: LCD.Frame 14
		case 4: mysterymode = "RATS HURRY UP": RandomSpin = 5: OverlayLCD.Frame 19: LCD.Frame 19
		case 5: mysterymode = "SNAKES HURRY UP": RandomSpin = 6: OverlayLCD.Frame 20: LCD.Frame 20
		case 6: mysterymode = "ANTS HURRY UP": RandomSpin = 7: OverlayLCD.Frame 12: LCD.Frame 12
		case 7: mysterymode = "LIGHT SPECIAL": RandomSpin = 8: OverlayLCD.Frame 21: LCD.Frame 21
		case 8: mysterymode = "SWORDSMAN": RandomSpin = 9: OverlayLCD.Frame 22: LCD.Frame 22
		case 9: mysterymode = "FREE SHOT": RandomSpin = 10: OverlayLCD.Frame 152: LCD.Frame 152
		case 10: mysterymode = "EXTRA BALL": RandomSpin = 11: OverlayLCD.Frame 16: LCD.Frame 16
		case 11: mysterymode = "GRAIL CHALLENGE": RandomSpin = 12: OverlayLCD.Frame 15: LCD.Frame 15
		case 12: mysterymode = "RATS HURRY UP": RandomSpin = 13: OverlayLCD.Frame 19: LCD.Frame 19
		case 13: mysterymode = "BIG POINTS": RandomSpin = 14: OverlayLCD.Frame 14: LCD.Frame 14
		case 14: mysterymode = "BALL SAVER": RandomSpin = 15: OverlayLCD.Frame 13: LCD.Frame 13
		case 15: mysterymode = "MONKEY BRAINS": RandomSpin = 16: OverlayLCD.Frame 133: LCD.Frame 133
		case 16: mysterymode = "EXTRA BALL": RandomSpin = 17: OverlayLCD.Frame 16: LCD.Frame 16
		case 17: mysterymode = "SPIDERS": RandomSpin = 18: OverlayLCD.Frame 547: LCD.Frame 547
		case 18: mysterymode = "ADVANCE SCENE": RandomSpin = 19: OverlayLCD.Frame 18: LCD.Frame 18
		case 19: mysterymode = "BONUS X": RandomSpin = 1: OverlayLCD.Frame 548: LCD.Frame 548
	End Select
	DispDMD1.Text = "[edge3][f6][xc][yc]" & MysteryMode
	DispDMD2.Text = "[edge3][f6][xc][yc]" & MysteryMode
End Sub


Sub MysteryEnd_Expired()
	MysteryChange.set FALSE
	MysteryEnd.Set FALSE
	FlushDMDTimer.set TRUE, 2000

	If (MysteryMode = "SWORDSMAN") Then
		If (CairoSwordsman = TRUE) Then 
			SwordModeTimer.Set TRUE, 20000
			SwordScore(CP) = 10000000
			GrailKickertimer_Expired()
		Exit Sub
		End If
		StartSword()
		Flash = 0
		FlashPFTimer.Set TRUE, 100
		GrailKickertimer.Set TRUE, 500
	Exit Sub
	End If

	If (MysteryMode = "LIGHT SPECIAL") Then
		NoS(): OverlayLCD.Frame 65: LCD.Frame 65: MovieTimer.Set TRUE, 2000
		LightSpecialL.State = BulbOn
		PlaySound "fx_Whip6"
		PlayMusic 2, "vo_BargainedFor", FALSE, 1, 600
		GrailKickertimer.Set TRUE, 1500
		If (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) Then RestartMusic.Set TRUE, 1500
	Exit Sub
	End If

	' a random award within a random award....clever, or just stupid, you decide...
	If (MysteryMode = "MONKEY BRAINS") Then
		FlushDMDTimer.Set TRUE, 2000
		GrailKickertimer.Set TRUE, 1500
		PlayMusic 2, "vo_ChilledBrains"
		Select Case RandomNumber(2)
			Case 1:
				' automaticallly qualify for the end of game BONUS BALL...
				DispDMD1.Text = "[edge3][box1,8,6,120,25][xc][yc][f6][b]BONUS BALL"
				DispDMD2.Text = "[edge3][box1,8,6,120,25][xc][yc][f6][b]BONUS BALL"
				BBArk(CP) = TRUE: BBTemple(CP) = TRUE: BBGrail(CP) = TRUE: BBSkull(CP) = TRUE
				NoS(): OverlayLCD.Frame 134,135,134: LCD.Frame 134,135,134: MovieTimer.Set TRUE, 2000
			Case 2:
				' instant EXTRA BALL, no ramp shot needed...
				DispDMD1.Text = "[edge3][box1,8,6,120,25][xc][yc][f6][b]EXTRA BALL"
				DispDMD2.Text = "[edge3][box1,8,6,120,25][xc][yc][f6][b]EXTRA BALL"
				NoS(): OverlayLCD.Frame 176, 177, 176: LCD.Frame 176, 177, 176: MovieTimer.Set TRUE, 2000
				ExtraBallsAwards(CP) = ExtraBallsAwards(CP) + 1
				ShootagainLight.State = BulbOn
			'Case 3:
				'DispDMD1.Text = "[edge3][box1,8,6,120,25][xc][yc][f6][b]INDY JONES"
				'DispDMD2.Text = "[edge3][box1,8,6,120,25][xc][yc][f6][b]INDY JONES"
				'StartINDYJONES()
		End Select
		If (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) and (IJScoring = FALSE) Then RestartMusic.set TRUE, 1500
	Exit Sub
	End If

	If (MysteryMode = "ADVANCE SCENE") Then
		DispDMD1.Text = "[edge3][xc][y3][f3][bf]NEXT SCENE[xc][y13][f6]IS READY"
		DispDMD2.Text = "[edge3][xc][y3][f3][bf]NEXT SCENE[xc][y13][f6]IS READY" 
		FlushDMDTimer.Set TRUE, 2000
		GrailKickertimer.Set TRUE, 500
		PlaySound "fx_MovieScene", 0.8
		NoS(): OverlayLCD.UpdateInterval = 150: LCD.UpdateInterval = 150
		OverlayLCD.Frame 29, 30, 29: LCD.Frame 29,30,29: MovieTimer.Set TRUE, 2500
		NextScene()
		If (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) Then RestartMusic.set TRUE, 1500
	Exit Sub
	End If

	MovieTimer.Set TRUE, 100
	
	If (MysteryMode = "EXTRA BALL") Then
		DispDMD1.Text = "[edge3][xc][y4][f3][bf]EXTRA BALL[xc][y14][f6]IS LIT"
		DispDMD2.Text = "[edge3][xc][y4][f3][bf]EXTRA BALL[xc][y14][f6]IS LIT" 
		LightExtraBall.State = BulbOn
		PlaySound "fx_Whip6"
		PlayMusic 2, "vo_EternalLife2", FALSE, 1, 800: GrailKickertimer.Set TRUE, 1200
		If (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) Then RestartMusic.set TRUE, 2000
	Exit Sub
	End If

	If (MysteryMode = "SPIDERS") Then
		DispDMD1.Text = "[edge3][xc][y4][f3]SPIDERS" & "[bf][xc][y14][f6]" & FormatScore(50000*xMarks)
		DispDMD2.Text = "[edge3][xc][y4][f3]SPIDERS" & "[bf][xc][y14][f6]" & FormatScore(50000*xMarks) 
		AddScore(50000)
		FlushDMDTimer.Set TRUE, 2500
		PlasDarkOn()
		LightSeqPF.Play SeqRandom, 30, 1, 2500
		PlayMusic 2, "Music_CueSpiders"
		PlayMusic 3, "vo_Nasty", FALSE, 1, 1600
		If (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) Then RestartMusic.set TRUE, 2500
		GrailKickertimer.Set TRUE, 2500
	Exit Sub
	End If

	If (MysteryMode = "BIG POINTS") Then
		Select Case RandomNumber(3)
			Case 1:
				DispDMD1.Text = "[edge3][xc][y4][f3]BIG POINTS" & "[bf][xc][y14][f6]"  & formatscore(750000*xMarks)
				DispDMD2.Text = "[edge3][xc][y4][f3]BIG POINTS" & "[bf][xc][y14][f6]"  & formatscore(750000*xMarks)
				AddScore(750000)
			Case 2:
				DispDMD1.Text = "[edge3][xc][y4][f3]BIG POINTS" & "[bf][xc][y14][f6]"  & formatscore(1000000*xMarks)
				DispDMD2.Text = "[edge3][xc][y4][f3]BIG POINTS" & "[bf][xc][y14][f6]"  & formatscore(1000000*xMarks)
				AddScore(1000000)
			Case 3:
				DispDMD1.Text = "[edge3][xc][y4][f3]BIG POINTS" & "[bf][xc][y14][f6]"  & formatscore(500000*xMarks)
				DispDMD2.Text = "[edge3][xc][y4][f3]BIG POINTS" & "[bf][xc][y14][f6]"  & formatscore(500000*xMarks)
				AddScore(500000)
		End Select
		FlushDMDTimer.set TRUE, 2000
		Select Case RandomNumber(4)
			Case 1: PlayMusic 2, "vo_FortuneAndGlory2": GrailKickerTimer.Set TRUE, 1000
			Case 2: PlayMusic 2, "vo_VeryImpressive": GrailKickerTimer.Set TRUE, 500
			Case 3: PlayMusic 2, "vo_InterestYou": GrailKickerTimer.Set TRUE, 1500
			Case 4: PlayMusic 2, "vo_FortuneAndGlory3": GrailKickertimer.Set TRUE, 1000
		End Select
		If (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) Then RestartMusic.set TRUE, 1000
	Exit Sub
	End If

	If (MysteryMode = "GRAIL CHALLENGE") Then StartBOG():	Exit Sub

	If (MysteryMode = "FREE SHOT") Then
		FreeShot(CP) = FreeShot(CP) + 1: BulbFS.FlashForMs 400, 100, BulbOff: LightFS.FlashForMs 400,100, BulbOff
		DispDMD1.Text = "[edge3][box1,8,6,120,25][xc][yc][f6][b]FREE SHOT"
		DispDMD2.Text = "[edge3][box1,8,6,120,25][xc][yc][f6][b]FREE SHOT" 
		FlushDMDTimer.Set TRUE, 2000
		PlayMusic 2, "vo_InterestYou"
		GrailKickertimer.Set TRUE, 1200
		If (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) Then RestartMusic.set TRUE, 1500
	Exit Sub
	End If

	If (MysteryMode = "BALL SAVER") Then
		DispDMD1.Text = "[edge3][box1,8,6,120,25][xc][yc][f6][b]BALL SAVER"
		DispDMD2.Text = "[edge3][box1,8,6,120,25][xc][yc][f6][b]BALL SAVER" 
		FlushDMDTimer.set TRUE, 2000
		PlayMusic 2, "vo_SafeThanSorry"
		GrailKickertimer.Set TRUE, 1200
		bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, BSTime(CP)
		ShootAgainLight.State = BulbBlink
		If (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) Then RestartMusic.set TRUE, 1500
	Exit Sub
	End If

	If (MysteryMode = "RATS HURRY UP") Then
		If (HurryUpMode = TRUE) Then GrailKickertimer_Expired(): Exit Sub
		StartRats()
	Exit Sub
	End If
	If mysterymode = "ANTS HURRY UP" then
		If (HurryUpMode = TRUE) Then GrailKickertimer_Expired(): Exit Sub
		StartAnts()
	Exit Sub
	End If
	If mysterymode = "SNAKES HURRY UP" then
		If (HurryUpMode = TRUE) Then GrailKickertimer_Expired(): Exit Sub
		StartSnakes()
	Exit Sub
	End If

	If (MysteryMode = "BONUS X") Then
		If (PerkX4(CP) = TRUE) Then
			MapMulti = MapMulti + 4
		Else
			MapMulti = MapMulti + 2
		End If
		MapRoomReset.Set TRUE, 1000
		DispDMD1.Text = "[edge3][box1,8,6,120,25][xc][yc][f6][b]BONUS X " & MapMulti
		DispDMD2.Text = "[edge3][box1,8,6,120,25][xc][yc][f6][b]BONUS X " & MapMulti
		FlushDMDTimer.set TRUE, 2000
		PlayMusic 2, "vo_WrongPlace"
		GrailKickertimer.Set TRUE, 1200
		If (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) Then RestartMusic.set TRUE, 1500
	Exit Sub
	End If

	Flash = 0
	FlashPFTimer.Set TRUE, 100
	GrailKickerTimer_Expired()
	FlushDMDTimer.set TRUE, 100
	If (HurryUpMode = FALSE) and (CairoSwordsman = FALSE) Then RestartMusic.set TRUE, 1000
End Sub






' ***********************************
' **                               **
' **         BREATH OF GOD         **
' **                               **
' ***********************************

' One of 3 challenges - Breath of God, Word of God, Leap of God.

' Get through the LEFT LOOP and avoid the spinning blade trap.
' A one shot wonder. Make the shot and Indy will annouce 'I'm through' much to the relief
' of everyone waiting at the entrance (apart from the NAZI scum).

' Starts as a MYSTERY feature or when the LEFT LOOP is shot 10 times.

' The value is set at a very tidy 5 MILLION.


' ** MEDIA NEEDED **

' short movie clip of Indy standing at the entrance of the cave holding the diary (intro only)


Sub StartBOG()
	LightChallenge.FlashForMs 1500, 200, BulbOn
	DispDMD1.QueueText "[edge3][xc][yc][f6][bf]BREATH OF GOD", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][xc][yc][f6][bf]BREATH OF GOD", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][xc][y2][f6][b]SHOOT LEFT ORBIT[f4][y18]WHEN GRAIL IS LIT", deNone, 1000, TRUE
	DispDMD2.QueueText "[edge3][xc][y2][f6][b]SHOOT LEFT ORBIT[f4][y18]WHEN GRAIL IS LIT", deNone, 1000, TRUE
	FlushDMDTimer.Set TRUE, 2500

	Challenge(CP) = 8 ' reset the value for the orbit shot...

	' ** ADD MOVIE CLIP HERE **

	NoS(): OverlayLCD.Frame 136: LCD.Frame 136: MovieTimer.Set TRUE, 3500 ' NEED A BETTER GRAPHIC HERE...

	'Select Case RandomNumber(2)
	'	Case 1: PlayMusic 2, "vo_WordOfGod"
	'	Case 3: PlayMusic 2, "vo_Leap"
	'End Select

	PlayMusic 2, "vo_BreathOfGod"
	QuoteBusy = TRUE: QuoteTimer.Set TRUE, 1000

	Saw = 0
	BOG = TRUE
	PlayMusic 1, "Music_Challenge", TRUE, 0.8, 100
	GrailKickerTimer.Set TRUE, 1500
	BreathOfGodTimer.Set TRUE, 3000
	ChallengeTimer.Set TRUE, 36000
End Sub


Sub ChallengeTimer_Expired()
	ChallengeTimer.Enabled = FALSE
	ResetBlade.Set TRUE, 200
	BOG = FALSE
	If (ModeName = "") Then
		PlayMusic 1, "Music_Fail"
		RestartMusic.Set TRUE, 1200
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_Challenge"
		ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		DispDMD1.Text = "[edge3][xc][y2][f6]YOU FAILED"
		DispDMD2.Text = "[edge3][xc][y2][f6]YOU FAILED"
	End If
	LightChallenge.State = BulbOff
	BreathOfGodTimer.Enabled = FALSE
End Sub


Sub BreathOfGodTimer_Expired()

	' the blade will come out for a random amount of time...
	Select Case RandomNumber(4)
		Case 1: BreathOfGodTimer.Set TRUE, 3000
		Case 2: BreathOfGodTimer.Set TRUE, 4000
		Case 3: BreathOfGodTimer.Set TRUE, 5000
		Case 4: BreathOfGodTimer.Set TRUE, 6000
	End Select

	Saw = Saw + 1
	Select Case Saw
		Case 1: LightChallenge.State = BulbOff
			Blade.moveto Blade.tx +25, Blade.ty, Blade.tz +40, 800
			Blade.rotatexz 250: PlaySound "fx_Blade5"
		Case 2: LightChallenge.State = BulbBlink
			Blade.moveto Blade.tx -25, Blade.ty, Blade.tz -40, 150
			Blade.rotatexz 0: PlaySound "fx_BladeBack"
			Saw = 0
	End Select
End Sub


Sub ResetBlade_Expired()
	ResetBlade.Enabled = FALSE
	Blade.moveto Blade.tx -25, Blade.ty, Blade.tz -40, 150: Saw = 0
	Blade.rotatexz 0: PlaySound "fx_BladeBack"
	BladeBlock.Collidable = FALSE
	BladeBlock2.Collidable = FALSE
End Sub


Sub GrailChallengeWin()
	LightChallenge.State = BulbOff
	BreathOfGodTimer.Enabled = FALSE
	ChallengeTimer.Enabled = FALSE
	BOG = FALSE
	MovieTimer.Set TRUE, 10
	PlayMusic 2, "vo_Through"
	ScoreUpdate = FALSE:	FlushDMDTimer.Set TRUE, 1500
	DispDMD1.Text = "[edge3][f4][y3]YOU PASSED[y17][bf]"&FormatScore(ChallengeVal(CP)*xMarks)
	DispDMD2.Text = "[edge3][f4][y3]YOU PASSED[y17][bf]"&FormatScore(ChallengeVal(CP)*xMarks)
	If (ModeName = "") Then StopMusic 1: RestartMusic.Set TRUE, 1700
	PlayMusic 3, "Music_Cue14", FALSE, 1, 700
	LightSeqPF.Play SeqDoNothing, , , 700
	LightSeqPF.Play SeqBlinking, , 4, 100
	PlasDarkOff(): Flash = 5: FlashPFTimer.Set TRUE, 1700
	BulbArkL.FlashForMs 700, 700, BulbOff
	BulbArkR.FlashForMs 700, 700, BulbOff
	FlasherRed.FlashForMs 700, 700, BulbOff
	AddScore(ChallengeVal(CP))
	ChallengeVal(CP) = ChallengeVal(CP) + 2000000
End Sub



Sub GrailChallengeLoss()
	BladeBlock.Collidable = TRUE
	ResetBlade.Set TRUE, 2000
	ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2000
	DispDMD1.QueueText "[edge3][f6][xc][yc]YOU HAVE FAILED", deNone, 1000, TRUE
	DispDMD2.QueueText "[edge3][f6][xc][yc]YOU HAVE FAILED", deNone, 1000, TRUE
	If (ModeName = "") Then
		PlaySound "fx_BladeOut"
		LightSeqPF.Play SeqBlinking, , 1, 150
		Flash = 5: FlashPFTimer.Set TRUE, 150
		BulbArkL.FlashForMs 150, 150, BulbOff
		BulbArkR.FlashForMs 150, 150, BulbOff
		FlasherRed.FlashForMs 150, 150, BulbOff
		PlayMusic 1, "Music_Cue2"
		' ** NEED FX OF BLADE CUTTING INTO MAN **
		' ** ADD CLIP OF BLADE CUTTING HEAD OFF **
		RestartMusic.Set TRUE, 2400
		QuoteBusy = TRUE: QuoteTimer.Set TRUE, 2600
		PlayMusic 2, "vo_WillPass", FALSE, 1, 900
	End If
	BOG = FALSE
	BreathOfGodTimer.Enabled = FALSE
	ChallengeTimer.Enabled = FALSE
	LightChallenge.State = BulbOff
	MovieTimer_Expired()
End Sub




' ****************************
' **                        **
' **          RATS          **
' **                        **
' ****************************

' A one hit wonder hurry up with a value starting at 2m, which quickly drops the more
' you faff about.

' Shoot LEFT SPINNER which has a rat image on it.


' ** MEDIA NEEDED **

' short movie clip of the rats in the sewer from Last Crusade (intro only)


Sub StartRATS()
	PlayMusic 1, "Music_Ants" , TRUE, 0.8, 100
	HurryTime = 35
	RatsEndTimer.Set TRUE, 21500
	GrailKickerTimer.Set TRUE, 1500
	NoS(): OverlayLCD.Frame 84,85,84: LCD.Frame 84,85,84: MovieTimer.Set TRUE, 2000
	Select Case RandomNumber(2)
		Case 1: PlayMusic 2, "vo_Rats2"
		Case 2: PlayMusic 2, "vo_Catacombs"
	End Select
	HurryUpMode = TRUE: Rats = TRUE
	HurryTotal = HurryVal(CP)
	FlushDMDTimer.set FALSE: ScoreUpdate = FALSE
	DispDMD1.Text = "[edge3][f3][xc][y4][bf]SHOOT LEFT LOOP[/bf]" & "[f4][xc][y16]" & FormatScore(HurryTotal)
	DispDMD2.Text = "[edge3][f3][xc][y4][bf]SHOOT LEFT LOOP[/bf]" & "[f4][xc][y16]" & FormatScore(HurryTotal)
	LightOrbitL.Set BulbBlink, "10", 125
	RatsTimer1.Set TRUE, 8000 ' for the first 8 seconds the value is set, then quickly counts down...
End Sub



Sub RatsTimer1_Expired()
	RatsTimer1.Enabled = FALSE
	RatsTimer2.Set TRUE, 70
End Sub


Sub RatsTimer2_Expired()
	HurryTotal = HurryTotal - 10020
	If (HurryTotal < 500000) Then
		RatsTimer2.Enabled = FALSE
		If (QuoteBusy = FALSE) Then
			Select Case RandomNumber(3)
				Case 1,2: PlayMusic 2, "vo_ThisWay"
					FlasherSword.FlashForMs 800, 100, BulbOff
					SpotSword.FlashForMs 800, 100, BulbOff
					PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 800
				Case 3: PlayMusic 2, "vo_Remember"
			End Select
		End If
		HurryTotal = 500000
		DispDMD1.Text = "[edge3][f3][xc][y4]SHOOT LEFT LOOP" & "[f4][xc][y16][bf]" & FormatScore(HurryTotal)
		DispDMD2.Text = "[edge3][f3][xc][y4]SHOOT LEFT LOOP" & "[f4][xc][y16][bf]" & FormatScore(HurryTotal)
		LightOrbitL.Set BulbBlink, "10", 75
	Exit Sub
	End If
	DispDMD1.Text = "[edge3][f3][xc][y4]SHOOT LEFT LOOP" & "[f4][xc][y16]" & formatscore(HurryTotal)
	DispDMD2.Text = "[edge3][f3][xc][y4]SHOOT LEFT LOOP" & "[f4][xc][y16]" & formatscore(HurryTotal)
End Sub


Sub RatsEndTimer_Expired()
	LightOrbitL.Set BulbOff, "10", 125
	RatsEndTimer.Set FALSE
	RatsTimer2.Set FALSE
	If (ModeName = "") Then ' make sure another mode hasn't started during the rats mode...
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_TooBad"
		ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1200
		DispDMD1.QueueText "[edge3][f6][xc][yc][b]OUT OF TIME", deNone, 1200, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][yc][b]OUT OF TIME", deNone, 1200, TRUE
		RestartMusic.Set TRUE, 200
		ScoreUpdate = TRUE: FlushDMDTimer.set TRUE, 200
	End If
	HurryUpMode = FALSE
	Snakes = FALSE
	Ants = FALSE
	Rats = FALSE
	MovieTimer.Set TRUE, 100
End Sub




' ****************************
' **                        **
' **          ANTS          **
' **                        **
' ****************************

' Same as Rats but with Ants.

' ** MEDIA NEEDED **

' short movie clip of the ants from Crystal Skull (intro only)


Sub StartANTS()
	PlayMusic 1, "Music_Ants" , TRUE, 0.8, 100
	antsEndtimer.set TRUE, 21500
	GrailKickertimer.Set TRUE, 1500
	NoS(): OverlayLCD.Frame 82,83,82: LCD.Frame 82,83,82: MovieTimer.Set TRUE, 2000
	PlayMusic 2, "vo_GotCompany"
	HurryUpMode = TRUE: Ants = TRUE
	HurryTotal = HurryVal(CP)
	FlushDMDTimer.Set FALSE: ScoreUpdate = FALSE
	DispDMD1.Text = "[edge3][f3][xc][y5][bf]SHOOT RIGHT LOOP[/bf]" & "[f4][xc][y16]" & formatscore(HurryTotal)
	DispDMD2.Text = "[edge3][f3][xc][y5][bf]SHOOT RIGHT LOOP[/bf]" & "[f4][xc][y16]" & formatscore(HurryTotal)
	LightOrbitR.Set BulbBlink, "10", 125
	AntsTimer1.Set TRUE, 8000
End Sub



Sub AntsTimer1_Expired()
	AntsTimer1.Set FALSE
	AntsTimer2.Set TRUE, 70
End Sub



Sub AntsTimer2_Expired()
	HurryTotal = HurryTotal - 10020
	If (HurryTotal < 500000) Then
		AntsTimer2.Enabled = FALSE
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_ThisWay"
		HurryTotal = 500000
		DispDMD1.Text = "[edge3][f3][xc][y5]SHOOT RIGHT LOOP" & "[f4][xc][y16][bf]" & formatscore(HurryTotal)
		DispDMD2.Text = "[edge3][f3][xc][y5]SHOOT RIGHT LOOP" & "[f4][xc][y16][bf]" & formatscore(HurryTotal)
		LightOrbitR.Set BulbBlink, "10", 75
		PlayMusic 2, "vo_ThisWay"
		FlasherArkSpot.FlashForMs 800, 100, BulbOff
		SpotArk.FlashForMs 800, 100, BulbOff
		PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, 800
	Exit Sub
	End If
	DispDMD1.Text = "[edge3][f3][xc][y5]SHOOT RIGHT LOOP" & "[f4][xc][y16]" & formatscore(HurryTotal)
	DispDMD2.Text = "[edge3][f3][xc][y5]SHOOT RIGHT LOOP" & "[f4][xc][y16]" & formatscore(HurryTotal)
End Sub



Sub AntsEndtimer_expired()
	LightOrbitR.Set BulbOff, "10", 125
	antsEndtimer.set FALSE
	antstimer2.set FALSE
	If (ModeName = "") Then
		ScoreUpdate = TRUE: FlushDMDTimer.Set TRUE, 200
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_Stupid"
		RestartMusic.Set TRUE , 500
	End If
	HurryUpMode = FALSE
	Snakes = FALSE
	Ants = FALSE
	Rats = FALSE
	MovieTimer.Set TRUE, 100
End Sub




' ******************************
' **                          **
' **          SNAKES          **
' **                          **
' ******************************

' Same as Rat and Ants but for a complete LOOP shot.


' ** MEDIA NEEDED **

' short movie clip of the Cobra Indy comes face to face with in Raiders (intro only)


Sub StartSnakes()
	PlayMusic 1, "Music_Snakes", FALSE, 0.8, 100
	SnakesEndTimer.Set TRUE, 20200
	GrailKickertimer.Set TRUE, 1200
	NoS(): OverlayLCD.Frame 86,87,86: LCD.Frame 86,87,86: MovieTimer.Set TRUE, 2000
	PlayMusic 2, "vo_Hate"
	'ModeName = "snakes"
	HurryUpMode = TRUE: Snakes = TRUE
	HurryTotal = HurryVal(CP)
	FlushDMDTimer.set FALSE: ScoreUpdate = FALSE
	DispDMD1.Text = "[edge3][f3][xc][y5][bf]SHOOT ANY LOOP[/bf]" & "[f4][xc][y16]" & formatscore(HurryTotal)
	DispDMD2.Text = "[edge3][f3][xc][y5][bf]SHOOT ANY LOOP[/bf]" & "[f4][xc][y16]" & formatscore(HurryTotal)
	LightOrbitR.State = BulbBlink
	LightOrbitL.State = BulbBlink
	SnakesTimer1.Set TRUE, 8000
End Sub



Sub SnakesTimer1_Expired()
	SnakesTimer1.Set FALSE
	SnakesTimer2.Set TRUE, 70
End Sub



Sub SnakesTimer2_Expired()
	HurryTotal = HurryTotal - 20010
	If (HurryTotal < 500000) Then
		SnakesTimer2.Enabled = FALSE
		If (QuoteBusy = FALSE) Then QuoteBusy = TRUE: QuoteTimer.Set TRUE, 4500: PlayMusic 2, "vo_DoItFaster"
		HurryTotal = 500000
		DispDMD1.Text = "[edge3][f3][xc][y5]SHOOT LOOPS NOW!" & "[f4][xc][y16][bf]" & formatscore(HurryTotal)
		DispDMD2.Text = "[edge3][f3][xc][y5]SHOOT LOOPS NOW!" & "[f4][xc][y16][bf]" & formatscore(HurryTotal)
	Exit Sub
	End If
	DispDMD1.Text = "[edge3][f3][xc][y5]SHOOT ANY LOOP" & "[f4][xc][y16]" & formatscore(HurryTotal)
	DispDMD2.Text = "[edge3][f3][xc][y5]SHOOT ANY LOOP" & "[f4][xc][y16]" & formatscore(HurryTotal)
End Sub



Sub SnakesEndTimer_Expired()
	LightOrbitR.State = BulbOff
	LightOrbitL.State = BulbOff
	snakesEndtimer.set FALSE
	snakestimer2.set FALSE
	If (ModeName = "") Then
		ScoreUpdate = TRUE: FlushDMDTimer.set TRUE, 500
		ModeName = ""
		If (QuoteBusy = FALSE) Then PlayMusic 2, "vo_TooBad"
		ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1200
		DispDMD1.QueueText "[edge3][f6][xc][yc][b]OUT OF TIME", deNone, 1200, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][yc][b]OUT OF TIME", deNone, 1200, TRUE
		RestartMusic.set TRUE , 200
	End If
	HurryUpMode = FALSE
	Snakes = FALSE
	Ants = FALSE
	Rats = FALSE
	MovieTimer.Set TRUE, 100
End Sub




Sub StopHurryUps()
	SnakesTimer1.Set FALSE
	RatsTimer1.Set FALSE
	AntsTimer1.Set FALSE
	SnakesTimer2.set FALSE
	SnakesEndtimer.set FALSE
	LightOrbitR.Set BulbOff, "10", 125
	LightOrbitL.Set BulbOff, "10", 125
	RatsEndtimer.set FALSE
	RatsTimer2.set FALSE
	AntsTimer2.set FALSE
	AntsEndTimer.set FALSE
	ScoreUpdate = TRUE
	HurryUpMode = FALSE
	Snakes = FALSE
	Ants = FALSE
	Rats = FALSE
	If (BOG = TRUE) Then
		BOG = FALSE
		ResetBlade.Set TRUE, 1000
		BreathOfGodTimer.Enabled = FALSE
		ChallengeTimer.Enabled = FALSE
		LightChallenge.State = BulbOff
	End If
End Sub



Sub StopFastScoring()
	IJScoring = FALSE
	HUTimer.Enabled = FALSE
	IndyLightsTimer.Set FALSE
	If (IndyScoring = TRUE) Then
		IndyScoring = FALSE
		LightINDY1.State = TempL1 
		LightINDY2.State = TempL2 
		LightINDY3.State = TempL3 
		LightINDY4.State = TempL4 
		IndyHitsLeft = 3
	End If
	JonesLightstimer.Enabled = FALSE
	If (JonesScoring = TRUE) Then
		JonesScoring = FALSE
		LightJONES1.State = TempL5
		LightJONES2.State = TempL6 
		LightJONES3.State = TempL7
		LightJONES4.State = TempL8
		LightJONES5.State = TempL9
		JonesHitsLeft = 3
	End If
End Sub




' **********************************
' **                              **
' **          EXTRA BALL          **
' **                              **
' **********************************

' Awarded for:

' - Beating the Cairo Swordsman 3 times
' - Collecting the SPECIAL
' - A random Mystery award
' - Completing any movie (all 4 scenes)
' - Getting 15 Million or 40 Million score
' - Player Perk: (5 hits during INDY JONES scoring) 


' ** MEDIA NEEDED **

' short movie clip of Willie during the 'Anything Goes' dance in Temple of Doom (close up of her face and smile)


Sub GetExtra()
	If (ModeName = "") Then
		BallHeld = TRUE: EBPlay = TRUE
		PopUpLane.SolenoidPulse(3500)
		EffectMusic 1, SetVolume, 0, 100
		QuoteBusy = FALSE: ResumeVol.Enabled = FALSE
		FlashPFTimer.Enabled = FALSE
		PlayMusic 2, "Music_EB"
		OverlayLCD.UpdateInterval = 125
		NoS(): OverlayLCD.Frame 117, 118, 117: LCD.Frame 117,118,117: MovieTimer.Set TRUE, 2200
		PauseTimers(): ResumeTimers.Set TRUE, 3500
		ClearSeq()
		PlasDarkOn()
		LightSeqJP.Play SeqBlinking, , 10, 100
		LightSeqPF.Play SeqBlinking, , 10, 100
		SpotFlashTimer.Set TRUE, 100
	End If
	ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2000
	DispDMD1.QueueText "[edge3][f6][xc][yc][bf]EXTRA BALL", deNone, 1000, TRUE
	DispDMD2.QueueText "[edge3][f6][xc][yc][bf]EXTRA BALL", deNone, 1000, TRUE
	LightExtraBall.State = BulbOff
	ExtraBallsAwards(CP) = ExtraBallsAwards(CP) + 1
	ShootAgainLight.State = BulbOn
End Sub



' SPECIAL awards a BALL SAVER, an EXTRA BALL and the combined value of all movie JACKPOTS...pretty damn special if you ask me

' Collected only from the outlanes when lit, and can only be lit from the Mystery and when a 4-way Combo is made.

' Lost when the ball drains.


' ** MEDIA NEEDED **

' short movie clip of Indy smiling from any movie


Sub GetSpecial()
	dim SpecialVal
	LightSpecialL.State = BulbOff
	LightSpecialR.State = BulbOff

	' ** NEED FX HERE **

	PlayMusic 3, "Music_Special", FALSE, 0.7
	EffectMusic 1, SetVolume, 0, 0: ResumeVol.Set TRUE, 2000
	PlayMusic 2, "vo_Wow"
	LightExtraBall.State = BulbOff
	PauseTimers()
	SpecialPlay = TRUE ' tell the game to restart any timers when the ball exits the plunger lane...
	SpecialVal = RaidersJP(CP)+TempleJP(CP)+SkullJP(CP)+CrusadeJP(CP)
	AddScore(SpecialVal)
	ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 2500
	DispDMD1.QueueText "[edge3][box1,8,6,120,25][f6][xc][yc][bf]S P E C I A L", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][box1,8,6,120,25][f6][xc][yc][bf]S P E C I A L", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][f7][xc][yc][bf]" & FormatScore(SpecialVal*xMarks), deNone, 1500, TRUE
	DispDMD2.QueueText "[edge3][f7][xc][yc][bf]" & FormatScore(SpecialVal*xMarks), deNone, 1500, TRUE
	bBallSaverActive = TRUE: BallSaverTimer.Set TRUE, BSTime(CP) + 5000
	ExtraBallsAwards(CP) = ExtraBallsAwards(CP) + 1
	ShootAgainLight.State = BulbOn
	PlasDarkOn()
	LightSeqJP.Play SeqBlinking, , 3, 75
	LightSeqPF.Play SeqBlinking, , 3, 75
	If (bMultiballMode = FALSE) Then
		PlungerKicker.CreateBall: AddTrackedBall(PlungerKicker)
		PlungerKicker.SolenoidPulse
		IgnoreMe = TRUE
		PlungerTimer.Set TRUE, 1000
	End If
End Sub




' Pause and resume any out of mode hurry up timers to free up the DMD for a sec...

Sub PauseTimers()
	If (Snakes = TRUE) Then SnakesTimer2.Enabled = FALSE
	If (Rats = TRUE) Then RatsTimer2.Enabled = FALSE
	If (Ants = TRUE) Then AntsTimer2.Enabled = FALSE
	If (IJScoring = TRUE) Then HUTimer.Enabled = FALSE
	If (CairoSwordsman = TRUE) Then SwordModeTimer.Enabled = FALSE: SwordModeTimer2.Enabled = FALSE
End Sub


Sub ResumeTimers_Expired()
	ResumeTimers.Enabled = FALSE
	If (Snakes = TRUE) Then SnakesTimer2.Set TRUE, 70
	If (Rats = TRUE) Then RatsTimer2.Set TRUE, 70
	If (Ants = TRUE) Then AntsTimer2.Set TRUE, 70
	If (IJScoring = TRUE) Then HUTimer.Set TRUE, 1000
	If (CairoSwordsman = TRUE) Then SwordModeTimer.Set TRUE, 1000: SwordModeTimer2.Set TRUE, 50
	If (EBPlay = TRUE) Then
		PlasDarkOff()
		LightSeqJP.StopPlay
		LightSeqPF.StopPlay
		SpotFlashTimer.Enabled = FALSE: SpotOn(0)
		EBPlay = FALSE
		EffectMusic 2, FadeOutAndStop, 0, 500
		ResumeVol_Expired()
	End If
End Sub




' ************************************
' **                                **
' **          MOVIE SCENES          **
' **                                **
' ************************************

' Activated as a Skill Shot or Mystery award.

' The next scene in order will be ready to start.  All scene 1's first, then scene 2's and so on...

Sub NextScene()

	' all scene 1's first (if not already completed)...
	If (LightRaidS1.State <> BulbOn) Then ' Raiders Scene 1...
		LightRaidS1.State = BulbBlink
		' turn off any other blinking light...
		If (LightRaidS2.State = BulbBlink) Then LightRaidS2.State = BulbOff
		If (LightRaidS3.State = BulbBlink) Then LightRaidS3.State = BulbOff
		If (LightRaidS4.State = BulbBlink) Then LightRaidS4.State = BulbOff
		ArkHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]RAIDERS[f5][xc][y17]SCENE 1 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]RAIDERS[f5][xc][y17]SCENE 1 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightRaidersArk.State = BulbBlink
	Exit Sub
	End If
	If (LightDoomS1.State <> BulbOn) Then ' Doom Scene 1...
		If (TempleOpen = FALSE) Then OpenChamber()
		LightDoomS1.State = BulbBlink
		If (LightDoomS2.State = BulbBlink) Then LightDoomS2.State = BulbOff
		If (LightDoomS3.State = BulbBlink) Then LightDoomS3.State = BulbOff
		If (LightDoomS4.State = BulbBlink) Then LightDoomS4.State = BulbOff
		StoneHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]TEMPLE[f5][xc][y17]SCENE 1 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]TEMPLE[f5][xc][y17]SCENE 1 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightTempleOfDoom.State = BulbBlink
	Exit Sub
	End If
	If (LightCrusadeS1.State <> BulbOn) Then ' Last Crusade Scene 1...
		LightCrusadeS1.State = BulbBlink
		If (LightCrusadeS2.State = BulbBlink) Then LightCrusadeS2.State = BulbOff
		If (LightCrusadeS3.State = BulbBlink) Then LightCrusadeS3.State = BulbOff
		If (LightCrusadeS4.State = BulbBlink) Then LightCrusadeS4.State = BulbOff
		GrailHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]LAST CRUSADE[f5][xc][y17]SCENE 1 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]LAST CRUSADE[f5][xc][y17]SCENE 1 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightLastCrusade.State = BulbBlink
	Exit Sub
	End If
	If (LightSkullS1.State <> BulbOn) Then ' Crystal Skull Scene 1...
		LightSkullS1.State = BulbBlink
		If (LightSkullS2.State = BulbBlink) Then LightSkullS2.State = BulbOff
		If (LightSkullS3.State = BulbBlink) Then LightSkullS3.State = BulbOff
		If (LightSkullS4.State = BulbBlink) Then LightSkullS4.State = BulbOff
		SkullHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]CRYSTAL SKULL[f5][xc][y17]SCENE 1 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]CRYSTAL SKULL[f5][xc][y17]SCENE 1 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightCrystalSkull.State = BulbBlink
	Exit Sub
	End If

	' all scene 1's are complete, move on to scene 2's...
	If (LightRaidS2.State <> BulbOn) Then 
		LightRaidS2.State = BulbBlink
		If (LightRaidS3.State = BulbBlink) Then LightRaidS3.State = BulbOff
		If (LightRaidS4.State = BulbBlink) Then LightRaidS4.State = BulbOff
		ArkHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]RAIDERS[f5][xc][y17]SCENE 2 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]RAIDERS[f5][xc][y17]SCENE 2 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightRaidersArk.State = BulbBlink
	Exit Sub
	End If
	If (LightDoomS2.State <> BulbOn) Then
		LightDoomS2.State = BulbBlink
		If (LightDoomS3.State = BulbBlink) Then LightDoomS3.State = BulbOff
		If (LightDoomS4.State = BulbBlink) Then LightDoomS4.State = BulbOff
		If (TempleOpen = FALSE) Then OpenChamber()
		StoneHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]TEMPLE[f5][xc][y17]SCENE 2 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]TEMPLE[f5][xc][y17]SCENE 2 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightTempleOfDoom.State = BulbBlink
	Exit Sub
	End If
	If (LightCrusadeS2.State <> BulbOn) Then
		LightCrusadeS2.State = BulbBlink
		If (LightCrusadeS3.State = BulbBlink) Then LightCrusadeS3.State = BulbOff
		If (LightCrusadeS4.State = BulbBlink) Then LightCrusadeS4.State = BulbOff
		GrailHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]LAST CRUSADE[f5][xc][y17]SCENE 2 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]LAST CRUSADE[f5][xc][y17]SCENE 2 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightLastCrusade.State = BulbBlink
	Exit Sub
	End If
	If (LightSkullS2.State <> BulbOn) Then
		LightSkullS2.State = BulbBlink
		If (LightSkullS3.State = BulbBlink) Then LightSkullS3.State = BulbOff
		If (LightSkullS4.State = BulbBlink) Then LightSkullS4.State = BulbOff
		SkullHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]CRYSTAL SKULL[f5][xc][y17]SCENE 2 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]CRYSTAL SKULL[f5][xc][y17]SCENE 2 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightCrystalSkull.State = BulbBlink
	Exit Sub
	End If

	' all scene 2's are complete, move on to scene 3's...
	If (LightRaidS3.State <> BulbOn) Then
		LightRaidS3.State = BulbBlink
		If (LightRaidS4.State = BulbBlink) Then LightRaidS4.State = BulbOff
		ArkHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]RAIDERS[f5][xc][y17]SCENE 3 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]RAIDERS[f5][xc][y17]SCENE 3 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightRaidersArk.State = BulbBlink
	Exit Sub
	End If
	If (LightDoomS3.State <> BulbOn) Then
		If (TempleOpen = FALSE) Then OpenChamber()
		LightDoomS3.State = BulbBlink
		If (LightDoomS4.State = BulbBlink) Then LightDoomS4.State = BulbOff
		StoneHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]TEMPLE[f5][xc][y17]SCENE 3 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]TEMPLE[f5][xc][y17]SCENE 3 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightTempleOfDoom.State = BulbBlink
	Exit Sub
	End If
	If (LightCrusadeS3.State <> BulbOn) Then
		LightCrusadeS3.State = BulbBlink
		If (LightCrusadeS4.State = BulbBlink) Then LightCrusadeS4.State = BulbOff
		GrailHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]LAST CRUSADE[f5][xc][y17]SCENE 3 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]LAST CRUSADE[f5][xc][y17]SCENE 3 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightLastCrusade.State = BulbBlink
	Exit Sub
	End If
	If (LightSkullS3.State <> BulbOn) Then
		LightSkullS3.State = BulbBlink
		If (LightSkullS4.State = BulbBlink) Then LightSkullS4.State = BulbOff
		SkullHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]CRYSTAL SKULL[f5][xc][y17]SCENE 3 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]CRYSTAL SKULL[f5][xc][y17]SCENE 3 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightCrystalSkull.State = BulbBlink
	Exit Sub
	End If

	' all scene 3's are complete, move on to scene 4's...
	If (LightRaidS4.State <> BulbOn) Then
		LightRaidS4.State = BulbBlink
		ArkHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]RAIDERS[f5][xc][y17]SCENE 4 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]RAIDERS[f5][xc][y17]SCENE 4 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightRaidersArk.State = BulbBlink
	Exit Sub
	End If
	If (LightDoomS4.State <> BulbOn) Then 
		If (TempleOpen = FALSE) Then OpenChamber()
		LightDoomS4.State = BulbBlink
		StoneHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]TEMPLE[f5][xc][y17]SCENE 4 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]TEMPLE[f5][xc][y17]SCENE 4 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightTempleOfDoom.State = BulbBlink
	Exit Sub
	End If
	If (LightCrusadeS4.State <> BulbOn) Then
		LightCrusadeS4.State = BulbBlink
		GrailHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]LAST CRUSADE[f5][xc][y17]SCENE 4 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]LAST CRUSADE[f5][xc][y17]SCENE 4 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightLastCrusade.State = BulbBlink
	Exit Sub
	End If
	If (LightSkullS4.State <> BulbOn) Then 
		LightSkullS4.State = BulbBlink
		SkullHitsRemain(CP) = 1
		If (ScoreUpdate = TRUE) Then
			DispDMD1.QueueText "[edge3][f4][xc][y4][bf]CRYSTAL SKULL[f5][xc][y17]SCENE 4 READY", deScrollIn, 1500, TRUE
			DispDMD2.QueueText "[edge3][f4][xc][y4][bf]CRYSTAL SKULL[f5][xc][y17]SCENE 4 READY", deScrollIn, 1500, TRUE
			ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1500
		End If
		LightCrystalSkull.State = BulbBlink
	Exit Sub
	End If
End Sub




Sub RaidersSceneSwap() ' player controlled...

	If (ModeName <> "") Then Exit Sub
	If (LightRaidersArk.State = BulbBlink) Then Exit Sub

	If (LightRaidS1.State = BulbBlink) Then ' if scene 1 is blinking, move to...
		If (LightRaidS2.State = BulbOff) Then ' ...scene 2 if unlit (unplayed)...
			LightRaidS2.State = BulbBlink
			LightRaidS1.State = BulbOff
		Exit Sub
		End If
		If (LightRaidS3.State = BulbOff) Then ' ...scene 3 if unlit....
			LightRaidS3.State = BulbBlink
			LightRaidS1.State = BulbOff
		Exit Sub
		End If
		If (LightRaidS4.State = BulbOff) Then ' ...scene 4 if unlit....
			LightRaidS4.State = BulbBlink
			LightRaidS1.State = BulbOff
		Exit Sub
		End If
		' if scene 2, 3 and 4 are already lit (played) then stay on scene 1...
	Exit Sub
	End If
	If (LightRaidS2.State = BulbBlink) Then ' if scene 2 is blinking, move to...
		If (LightRaidS3.State = BulbOff) Then ' ...scene 3 if unlit (unplayed)...
			LightRaidS3.State = BulbBlink
			LightRaidS2.State = BulbOff
		Exit Sub
		End If
		If (LightRaidS4.State = BulbOff) Then ' ...scene 4 if unlit....
			LightRaidS4.State = BulbBlink
			LightRaidS2.State = BulbOff
		Exit Sub
		End If
		If (LightRaidS1.State = BulbOff) Then ' ...scene 1 if unlit....
			LightRaidS1.State = BulbBlink
			LightRaidS2.State = BulbOff
		Exit Sub
		End If
	Exit Sub
	End If
	If (LightRaidS3.State = BulbBlink) Then ' if scene 3 is blinking, move to...
		If (LightRaidS4.State = BulbOff) Then ' ...scene 4 if unlit (unplayed)...
			LightRaidS4.State = BulbBlink
			LightRaidS3.State = BulbOff
		Exit Sub
		End If
		If (LightRaidS1.State = BulbOff) Then ' ...scene 1 if unlit....
			LightRaidS1.State = BulbBlink
			LightRaidS3.State = BulbOff
		Exit Sub
		End If
		If (LightRaidS2.State = BulbOff) Then ' ...scene 2 if unlit....
			LightRaidS2.State = BulbBlink
			LightRaidS3.State = BulbOff
		Exit Sub
		End If
	Exit Sub
	End If
	If (LightRaidS4.State = BulbBlink) Then ' if scene 4 is blinking, move to...
		If (LightRaidS1.State = BulbOff) Then ' ...scene 1 if unlit (unplayed)...
			LightRaidS1.State = BulbBlink
			LightRaidS4.State = BulbOff
		Exit Sub
		End If
		If (LightRaidS2.State = BulbOff) Then ' ...scene 2 if unlit....
			LightRaidS2.State = BulbBlink
			LightRaidS4.State = BulbOff
		Exit Sub
		End If
		If (LightRaidS3.State = BulbOff) Then ' ...scene 3 if unlit....
			LightRaidS3.State = BulbBlink
			LightRaidS4.State = BulbOff
		Exit Sub
		End If
	Exit Sub
	End If
End Sub


' when a scene is finished, win or lose, it's main insert is lit and we move on to the next one.
' you only get 1 chance to win the Movie Jackpot for each scene.

Sub SceneRAIDERSComplete()
	' first light the scene just played...
	If (LightRaidS1.State = BulbBlink) Then
		LightRaidS1.State = BulbOn
		' now move to the next one in order...
		If (LightRaidS2.State = BulbOff) Then 
			LightRaidS2.State = BulbBlink
		Exit Sub
		End If
		If (LightRaidS3.State = BulbOff) Then 
			LightRaidS3.State = BulbBlink
		Exit Sub
		End If
		If (LightRaidS4.State = BulbOff) Then
			LightRaidS4.State = BulbBlink
		Exit Sub
		End If
		' all scenes have been completed, light the main Movie insert and check if the others are done...
		LightRaidersMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
	If (LightRaidS2.State = BulbBlink) Then
		LightRaidS2.State = BulbOn
		If (LightRaidS3.State = BulbOff) Then 
			LightRaidS3.State = BulbBlink
		Exit Sub
		End If
		If (LightRaidS4.State = BulbOff) Then 
			LightRaidS4.State = BulbBlink
		Exit Sub
		End If
		If (LightRaidS1.State = BulbOff) Then
			LightRaidS1.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightRaidersMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
	If (LightRaidS3.State = BulbBlink) Then
		LightRaidS3.State = BulbOn
		If (LightRaidS4.State = BulbOff) Then 
			LightRaidS4.State = BulbBlink
		Exit Sub
		End If
		If (LightRaidS1.State = BulbOff) Then 
			LightRaidS1.State = BulbBlink
		Exit Sub
		End If
		If (LightRaidS2.State = BulbOff) Then
			LightRaidS2.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightRaidersMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
	If (LightRaidS4.State = BulbBlink) Then
		LightRaidS4.State = BulbOn
		If (LightRaidS1.State = BulbOff) Then 
			LightRaidS1.State = BulbBlink
		Exit Sub
		End If
		If (LightRaidS2.State = BulbOff) Then 
			LightRaidS2.State = BulbBlink
		Exit Sub
		End If
		If (LightRaidS3.State = BulbOff) Then
			LightRaidS3.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightRaidersMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
End Sub




Sub TempleSceneSwap() ' player controlled with the Special 1 Key, when FREE SHOTS are awarded...

	If (ModeName <> "") Then Exit Sub
	If (LightTempleOfDoom.State = BulbBlink) Then Exit Sub

	If (LightDoomS1.State = BulbBlink) Then ' if scene 1 is blinking, move to...
		If (LightDoomS2.State = BulbOff) Then ' ...scene 2 if unlit (unplayed)...
			LightDoomS2.State = BulbBlink
			LightDoomS1.State = BulbOff
		Exit Sub
		End If
		If (LightDoomS3.State = BulbOff) Then ' ...scene 3 if unlit....
			LightDoomS3.State = BulbBlink
			LightDoomS1.State = BulbOff
		Exit Sub
		End If
		If (LightDoomS4.State = BulbOff) Then ' ...scene 4 if unlit....
			LightDoomS4.State = BulbBlink
			LightDoomS1.State = BulbOff
		Exit Sub
		End If
		' if scene 2, 3 and 4 are already lit (played) then stay on scene 1...
	Exit Sub
	End If
	If (LightDoomS2.State = BulbBlink) Then ' if scene 2 is blinking, move to...
		If (LightDoomS3.State = BulbOff) Then ' ...scene 3 if unlit (unplayed)...
			LightDoomS3.State = BulbBlink
			LightDoomS2.State = BulbOff
		Exit Sub
		End If
		If (LightDoomS4.State = BulbOff) Then ' ...scene 4 if unlit....
			LightDoomS4.State = BulbBlink
			LightDoomS2.State = BulbOff
		Exit Sub
		End If
		If (LightDoomS1.State = BulbOff) Then ' ...scene 1 if unlit....
			LightDoomS1.State = BulbBlink
			LightDoomS2.State = BulbOff
		Exit Sub
		End If
	Exit Sub
	End If
	If (LightDoomS3.State = BulbBlink) Then ' if scene 3 is blinking, move to...
		If (LightDoomS4.State = BulbOff) Then ' ...scene 4 if unlit (unplayed)...
			LightDoomS4.State = BulbBlink
			LightDoomS3.State = BulbOff
		Exit Sub
		End If
		If (LightDoomS1.State = BulbOff) Then ' ...scene 1 if unlit....
			LightDoomS1.State = BulbBlink
			LightDoomS3.State = BulbOff
		Exit Sub
		End If
		If (LightDoomS2.State = BulbOff) Then ' ...scene 2 if unlit....
			LightDoomS2.State = BulbBlink
			LightDoomS3.State = BulbOff
		Exit Sub
		End If
	Exit Sub
	End If
	If (LightDoomS4.State = BulbBlink) Then ' if scene 4 is blinking, move to...
		If (LightDoomS1.State = BulbOff) Then ' ...scene 1 if unlit (unplayed)...
			LightDoomS1.State = BulbBlink
			LightDoomS4.State = BulbOff
		Exit Sub
		End If
		If (LightDoomS2.State = BulbOff) Then ' ...scene 2 if unlit....
			LightDoomS2.State = BulbBlink
			LightDoomS4.State = BulbOff
		Exit Sub
		End If
		If (LightDoomS3.State = BulbOff) Then ' ...scene 3 if unlit....
			LightDoomS3.State = BulbBlink
			LightDoomS4.State = BulbOff
		Exit Sub
		End If
	Exit Sub
	End If
End Sub



Sub SceneTEMPLEComplete()
	If (LightDoomS1.State = BulbBlink) Then
		LightDoomS1.State = BulbOn
		If (LightDoomS2.State = BulbOff) Then 
			LightDoomS2.State = BulbBlink
		Exit Sub
		End If
		If (LightDoomS3.State = BulbOff) Then 
			LightDoomS3.State = BulbBlink
		Exit Sub
		End If
		If (LightDoomS4.State = BulbOff) Then
			LightDoomS4.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightDoomMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
	If (LightDoomS2.State = BulbBlink) Then
		LightDoomS2.State = BulbOn
		If (LightDoomS3.State = BulbOff) Then 
			LightDoomS3.State = BulbBlink
		Exit Sub
		End If
		If (LightDoomS4.State = BulbOff) Then 
			LightDoomS4.State = BulbBlink
		Exit Sub
		End If
		If (LightDoomS1.State = BulbOff) Then
			LightDoomS1.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightDoomMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
	If (LightDoomS3.State = BulbBlink) Then
		LightDoomS3.State = BulbOn
		If (LightDoomS4.State = BulbOff) Then 
			LightDoomS4.State = BulbBlink
		Exit Sub
		End If
		If (LightDoomS1.State = BulbOff) Then 
			LightDoomS1.State = BulbBlink
		Exit Sub
		End If
		If (LightDoomS2.State = BulbOff) Then
			LightDoomS2.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightDoomMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
	If (LightDoomS4.State = BulbBlink) Then
		LightDoomS4.State = BulbOn
		If (LightDoomS1.State = BulbOff) Then 
			LightDoomS1.State = BulbBlink
		Exit Sub
		End If
		If (LightDoomS2.State = BulbOff) Then 
			LightDoomS2.State = BulbBlink
		Exit Sub
		End If
		If (LightDoomS3.State = BulbOff) Then
			LightDoomS3.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightDoomMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
End Sub



Sub CrusadeSceneSwap() ' needs to be player controlled...

	If (ModeName <> "") Then Exit Sub
	If (LightLastCrusade.State = BulbBlink) Then Exit Sub

	If (LightCrusadeS1.State = BulbBlink) Then ' if scene 1 is blinking, move to...
		If (LightCrusadeS2.State = BulbOff) Then ' ...scene 2 if unlit (unplayed)...
			LightCrusadeS2.State = BulbBlink
			LightCrusadeS1.State = BulbOff
		Exit Sub
		End If
		If (LightCrusadeS3.State = BulbOff) Then ' ...scene 3 if unlit....
			LightCrusadeS3.State = BulbBlink
			LightCrusadeS1.State = BulbOff
		Exit Sub
		End If
		If (LightCrusadeS4.State = BulbOff) Then ' ...scene 4 if unlit....
			LightCrusadeS4.State = BulbBlink
			LightCrusadeS1.State = BulbOff
		Exit Sub
		End If
		' if scene 2, 3 and 4 are already lit (played) then stay on scene 1...
	Exit Sub
	End If
	If (LightCrusadeS2.State = BulbBlink) Then ' if scene 2 is blinking, move to...
		If (LightCrusadeS3.State = BulbOff) Then ' ...scene 3 if unlit (unplayed)...
			LightCrusadeS3.State = BulbBlink
			LightCrusadeS2.State = BulbOff
		Exit Sub
		End If
		If (LightCrusadeS4.State = BulbOff) Then ' ...scene 4 if unlit....
			LightCrusadeS4.State = BulbBlink
			LightCrusadeS2.State = BulbOff
		Exit Sub
		End If
		If (LightCrusadeS1.State = BulbOff) Then ' ...scene 1 if unlit....
			LightCrusadeS1.State = BulbBlink
			LightCrusadeS2.State = BulbOff
		Exit Sub
		End If
	Exit Sub
	End If
	If (LightCrusadeS3.State = BulbBlink) Then ' if scene 3 is blinking, move to...
		If (LightCrusadeS4.State = BulbOff) Then ' ...scene 4 if unlit (unplayed)...
			LightCrusadeS4.State = BulbBlink
			LightCrusadeS3.State = BulbOff
		Exit Sub
		End If
		If (LightCrusadeS1.State = BulbOff) Then ' ...scene 1 if unlit....
			LightCrusadeS1.State = BulbBlink
			LightCrusadeS3.State = BulbOff
		Exit Sub
		End If
		If (LightCrusadeS2.State = BulbOff) Then ' ...scene 2 if unlit....
			LightCrusadeS2.State = BulbBlink
			LightCrusadeS3.State = BulbOff
		Exit Sub
		End If
	Exit Sub
	End If
	If (LightCrusadeS4.State = BulbBlink) Then ' if scene 4 is blinking, move to...
		If (LightCrusadeS1.State = BulbOff) Then ' ...scene 1 if unlit (unplayed)...
			LightCrusadeS1.State = BulbBlink
			LightCrusadeS4.State = BulbOff
		Exit Sub
		End If
		If (LightCrusadeS2.State = BulbOff) Then ' ...scene 2 if unlit....
			LightCrusadeS2.State = BulbBlink
			LightCrusadeS4.State = BulbOff
		Exit Sub
		End If
		If (LightCrusadeS3.State = BulbOff) Then ' ...scene 3 if unlit....
			LightCrusadeS3.State = BulbBlink
			LightCrusadeS4.State = BulbOff
		Exit Sub
		End If
	Exit Sub
	End If
End Sub



Sub SceneCRUSADEComplete()
	If (LightCrusadeS1.State = BulbBlink) Then
		LightCrusadeS1.State = BulbOn
		If (LightCrusadeS2.State = BulbOff) Then 
			LightCrusadeS2.State = BulbBlink
		Exit Sub
		End If
		If (LightCrusadeS3.State = BulbOff) Then 
			LightCrusadeS3.State = BulbBlink
		Exit Sub
		End If
		If (LightCrusadeS4.State = BulbOff) Then
			LightCrusadeS4.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightCrusadeMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
	If (LightCrusadeS2.State = BulbBlink) Then
		LightCrusadeS2.State = BulbOn
		If (LightCrusadeS3.State = BulbOff) Then 
			LightCrusadeS3.State = BulbBlink
		Exit Sub
		End If
		If (LightCrusadeS4.State = BulbOff) Then 
			LightCrusadeS4.State = BulbBlink
		Exit Sub
		End If
		If (LightCrusadeS1.State = BulbOff) Then
			LightCrusadeS1.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightCrusadeMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
	If (LightCrusadeS3.State = BulbBlink) Then
		LightCrusadeS3.State = BulbOn
		If (LightCrusadeS4.State = BulbOff) Then 
			LightCrusadeS4.State = BulbBlink
		Exit Sub
		End If
		If (LightCrusadeS1.State = BulbOff) Then 
			LightCrusadeS1.State = BulbBlink
		Exit Sub
		End If
		If (LightCrusadeS2.State = BulbOff) Then
			LightCrusadeS2.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightCrusadeMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
	If (LightCrusadeS4.State = BulbBlink) Then
		LightCrusadeS4.State = BulbOn
		If (LightCrusadeS1.State = BulbOff) Then 
			LightCrusadeS1.State = BulbBlink
		Exit Sub
		End If
		If (LightCrusadeS2.State = BulbOff) Then 
			LightCrusadeS2.State = BulbBlink
		Exit Sub
		End If
		If (LightCrusadeS3.State = BulbOff) Then
			LightCrusadeS3.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightCrusadeMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
End Sub


Sub SkullSceneSwap()

	If (ModeName <> "") Then Exit Sub
	If (LightCrystalSkull.State = BulbBlink) Then Exit Sub ' the scene is ready...

	If (LightSkullS1.State = BulbBlink) Then ' if scene 1 is blinking, move to...
		If (LightSkullS2.State = BulbOff) Then ' ...scene 2 if unlit (unplayed)...
			LightSkullS2.State = BulbBlink
			LightSkullS1.State = BulbOff
		Exit Sub
		End If
		If (LightSkullS3.State = BulbOff) Then ' ...scene 3 if unlit....
			LightSkullS3.State = BulbBlink
			LightSkullS1.State = BulbOff
		Exit Sub
		End If
		If (LightSkullS4.State = BulbOff) Then ' ...scene 4 if unlit....
			LightSkullS4.State = BulbBlink
			LightSkullS1.State = BulbOff
		Exit Sub
		End If
		' if scene 2, 3 and 4 are already lit (played) then stay on scene 1...
	Exit Sub
	End If
	If (LightSkullS2.State = BulbBlink) Then ' if scene 2 is blinking, move to...
		If (LightSkullS3.State = BulbOff) Then ' ...scene 3 if unlit (unplayed)...
			LightSkullS3.State = BulbBlink
			LightSkullS2.State = BulbOff
		Exit Sub
		End If
		If (LightSkullS4.State = BulbOff) Then ' ...scene 4 if unlit....
			LightSkullS4.State = BulbBlink
			LightSkullS2.State = BulbOff
		Exit Sub
		End If
		If (LightSkullS1.State = BulbOff) Then ' ...scene 1 if unlit....
			LightSkullS1.State = BulbBlink
			LightSkullS2.State = BulbOff
		Exit Sub
		End If
	Exit Sub
	End If
	If (LightSkullS3.State = BulbBlink) Then ' if scene 3 is blinking, move to...
		If (LightSkullS4.State = BulbOff) Then ' ...scene 4 if unlit (unplayed)...
			LightSkullS4.State = BulbBlink
			LightSkullS3.State = BulbOff
		Exit Sub
		End If
		If (LightSkullS1.State = BulbOff) Then ' ...scene 1 if unlit....
			LightSkullS1.State = BulbBlink
			LightSkullS3.State = BulbOff
		Exit Sub
		End If
		If (LightSkullS2.State = BulbOff) Then ' ...scene 2 if unlit....
			LightSkullS2.State = BulbBlink
			LightSkullS3.State = BulbOff
		Exit Sub
		End If
	Exit Sub
	End If
	If (LightSkullS4.State = BulbBlink) Then ' if scene 4 is blinking, move to...
		If (LightSkullS1.State = BulbOff) Then ' ...scene 1 if unlit (unplayed)...
			LightSkullS1.State = BulbBlink
			LightSkullS4.State = BulbOff
		Exit Sub
		End If
		If (LightSkullS2.State = BulbOff) Then ' ...scene 2 if unlit....
			LightSkullS2.State = BulbBlink
			LightSkullS4.State = BulbOff
		Exit Sub
		End If
		If (LightSkullS3.State = BulbOff) Then ' ...scene 3 if unlit....
			LightSkullS3.State = BulbBlink
			LightSkullS4.State = BulbOff
		Exit Sub
		End If
	Exit Sub
	End If
End Sub


Sub SceneSKULLComplete()
	If (LightSkullS1.State = BulbBlink) Then
		LightSkullS1.State = BulbOn
		If (LightSkullS2.State = BulbOff) Then 
			LightSkullS2.State = BulbBlink
		Exit Sub
		End If
		If (LightSkullS3.State = BulbOff) Then 
			LightSkullS3.State = BulbBlink
		Exit Sub
		End If
		If (LightSkullS4.State = BulbOff) Then
			LightSkullS4.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightSkullMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
	If (LightSkullS2.State = BulbBlink) Then
		LightSkullS2.State = BulbOn
		If (LightSkullS3.State = BulbOff) Then 
			LightSkullS3.State = BulbBlink
		Exit Sub
		End If
		If (LightSkullS4.State = BulbOff) Then 
			LightSkullS4.State = BulbBlink
		Exit Sub
		End If
		If (LightSkullS1.State = BulbOff) Then
			LightSkullS1.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightSkullMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
	If (LightSkullS3.State = BulbBlink) Then
		LightSkullS3.State = BulbOn
		If (LightSkullS4.State = BulbOff) Then 
			LightSkullS4.State = BulbBlink
		Exit Sub
		End If
		If (LightSkullS1.State = BulbOff) Then 
			LightSkullS1.State = BulbBlink
		Exit Sub
		End If
		If (LightSkullS2.State = BulbOff) Then
			LightSkullS2.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightSkullMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
	If (LightSkullS4.State = BulbBlink) Then
		LightSkullS4.State = BulbOn
		If (LightSkullS1.State = BulbOff) Then 
			LightSkullS1.State = BulbBlink
		Exit Sub
		End If
		If (LightSkullS2.State = BulbOff) Then 
			LightSkullS2.State = BulbBlink
		Exit Sub
		End If
		If (LightSkullS3.State = BulbOff) Then
			LightSkullS3.State = BulbBlink
		Exit Sub
		End If
		' all scenes complete...
		LightSkullMain.State = BulbOn: CheckWizard()
	Exit Sub
	End If
End Sub


' complete all the movies - 16 scenes, to start the wizard mode. Never gonna happen, so why spend hours and hours on a wizard mode that no one will play?
' in a real machine that people have paid good money for then yes, it's necessary.  Maybe in a future update.

Sub CheckWizard()
	If (LightRaidersMain.State = BulbOn) and (LightDoomMain.State = BulbOn) and (LightCrusadeMain.State = BulbOn) and (LightSkullMain.State = BulbOn) Then
		' start the super duper wizard mode...or just reset the game and award 10 points (as I will do for now)...
		AddScore(10)
		PlayMusic 1, "Music_EBWin" 
		StopMusic 2: StopMusic 3: StopMusic 4
		RestartMusic.Set TRUE, 4000
		ScoreUpdate = FALSE
		DispDMD1.FlushQueue: DispDMD2.FlushQueue
		DispDMD1.QueueText "[edge3][f6][xc][yc][bf]GAME COMPLETED", deNone, 1000, FALSE
		DispDMD2.QueueText "[edge3][f6][xc][yc][bf]GAME COMPLETED", deNone, 1000, FALSE
		DispDMD1.QueueText "[edge3][f6][xc][yc]GAME COMPLETED", deNone, 1000, TRUE
		DispDMD2.QueueText "[edge3][f6][xc][yc]GAME COMPLETED", deNone, 1000, TRUE
		BigReward()
		' reset all the lights, now do it all over again but more effort this time...
		LightRaidersMain.Set BulbOff, "10", 150
		LightRaidS4.Set BulbOff, "10", 150
		LightRaidS3.Set BulbOff, "10", 150
		LightRaidS2.Set BulbOff, "10", 150
		LightRaidS1.Set BulbBlink, "10", 150
		LightDoomMain.Set BulbOff, "10", 150
		LightDoomS4.Set BulbOff, "10", 150
		LightDoomS3.Set BulbOff, "10", 150
		LightDoomS2.Set BulbOff, "10", 150
		LightDoomS1.Set BulbBlink, "10", 150
		LightCrusadeMain.Set BulbOff, "10", 150
		LightCrusadeS4.Set BulbOff, "10", 150
		LightCrusadeS3.Set BulbOff, "10", 150
		LightCrusadeS2.Set BulbOff, "10", 150
		LightCrusadeS1.Set BulbBlink, "10", 150
		LightSkullMain.Set BulbOff, "10", 150
		LightSkullS4.Set BulbOff, "10", 150
		LightSkullS3.Set BulbOff, "10", 150
		LightSkullS2.Set BulbOff, "10", 150
		LightSkullS1.Set BulbBlink, "10", 150
	Else
		' go on, have an EXTRA BALL on me...
		LightExtraBall.State = BulbOn
	End If
End Sub





' ****************************
' **                        **
' **          MISC          **
' **                        **
' ****************************


Sub OpenChamber()

	If (DropTimer.Enabled = TRUE) or (TempleOpen = TRUE) Then Exit Sub

	' nothing is running, so play the Temple of Doom music to create tension - the temple will close after a limited time...
	If (CairoSwordsman=FALSE) and (HurryUpMode=FALSE) and (JonesScoring=FALSE) and (IndyScoring=FALSE) and (IJScoring = FALSE) and (ModeName="") Then
		RestartMusic.Enabled = FALSE: PlayMusic 1, "Music_Temple", TRUE, 0.7, 800
		DoomTime = 41: DoomTimer.Set TRUE, 1000 ' open the chamber for 41 seconds...
	End If
	StoneFlash()
	LightDoom.State = BulbOff
	PlaySound "fx_IdolMove"
	TempleOpen = TRUE: Captive.Rotateyz 30,20
	DropTimer.Set TRUE, 800 ' block the chamber as it opens...
End Sub



Sub CloseChamber()

	If (DropTimer.Enabled = TRUE) or (TempleOpen = FALSE) Then Exit Sub

	DoomTimer.Enabled = FALSE
	StoneLightsOff()
	BulbDoom.State = BulbOff
	StoneTarget.Collidable = TRUE ' immediately block the temple...
	TempleOpen = FALSE: Captive.Rotateyz -25,0 ' or -30
	PlaySound "fx_Trap2"
	LightTempleOfDoom.State = BulbOff
End Sub


Sub DropTimer_Expired()
	DropTimer.Set FALSE
	StoneTarget.Collidable = FALSE
	BulbDoom.State = BulbBlink
End Sub



Sub StoneFlash()
	StoneBulb8.State = BulbOn ' the toy...
	stonebulb.Set BulbBlink, 		"1111111111111111", 25: 'FlasherFade1.Set BulbBlink,  	"1000000000000001", 25
	stonebulb2.Set BulbBlink, 		"0111111111111110", 25: 'FlasherFade2.Set BulbBlink,  	"0100000000000010", 25
	stonebulb3.Set BulbBlink, 		"0011111111111100", 25: 'FlasherFade3.Set BulbBlink,  	"0010000000000100", 25
	stonebulb4.Set BulbBlink, 		"0001111111111000", 25: 'FlasherFade4.Set BulbBlink,  	"0001000000001000", 25
	stonebulb5.Set BulbBlink, 		"0000111111110000", 25: 'FlasherFade5.Set BulbBlink,  	"0000100000010000", 25
	stonebulb6.Set BulbBlink, 		"0000011111100000", 25: 'FlasherFade6.Set BulbBlink,  	"0000010000100000", 25
	stonebulb7.Set BulbBlink,  	"0000001111000000", 25: 'FlasherStone.Set BulbBlink,  	"0011111111111100", 25
End Sub


Sub StoneLightsOff()
	StoneBulb.State = BulbOff
	StoneBulb2.State = BulbOff
	StoneBulb3.State = BulbOff
	StoneBulb4.State = BulbOff
	StoneBulb5.State = BulbOff
	StoneBulb6.State = BulbOff
	StoneBulb7.State = BulbOff
	StoneBulb8.State = BulbOff
	FlasherStone.State = BulbOff
End Sub



captive.ty = captive.ty-35




Sub DoomTimer_Expired()
	DoomTime = DoomTime - 1
	If (DoomTime =<0) Then
		CloseChamber()
		' close the chamber with a fearful laugh when timed out...
		If (Drained.Enabled = FALSE) and (MysteryEnd.Enabled = FALSE) Then 
			If (HurryUpMode = FALSE) and (ModeName = "") and (IJScoring = FALSE) and (MysteryChange.Enabled = FALSE) Then StopMusic 1: RestartMusic.Set TRUE, 1000
			PlaySound "fx_DoomClose"
		End If
	Exit Sub
	End If
	AddScore(0)
End Sub



Sub Plungertimer_expired()
	Plunger.SolenoidPulse
	LightSeqPF.Play SeqBlinking, , 2, 100
	Flash = 3: FlashPFTimer.Set TRUE, 100
	' PlaySound "fx_BallLaunch"
	FF_Sound DV_RS,-1, "fx_BallLaunch"	
	playsound "fx_GunShot2"
	PlungerTimer.Set FALSE
End Sub




' *****************************
' **                         **
' **          MATCH          **
' **                         **
' *****************************

' match to win an EXTRA BALL and keep playing...

' to make this slightly less pointless, you don't have a 1 in 10 chance, you have a 1 in 6....

Sub MatchGame()
	MatchPlayed = TRUE

	Select Case RandomNumber(2)
		Case 1: PlayMusic 2, "fx_JungleLong1"
		Case 2: PlayMusic 2, "fx_JungleLong2"
	End Select

	' old way - a 1 in 10 chance based on the last 2 digits of your score....boring...
	' PlayerMatch = right(nvScore(CP),2) ' last 2 digits of players score...

	' new way - a 1 in 6 chance based on 2 random numbers...slightly less boring...
	Select Case RandomNumber(6)
		Case 1: RndMatch = "10"
		Case 2: RndMatch = "20"
		Case 3: RndMatch = "30"
		Case 4: RndMatch = "50"
		Case 5: RndMatch = "70"
		Case 6: RndMatch = "90"
	End Select
	DispDMD1.FlushQueue: DispDMD2.FlushQueue
	DispDMD1.QueueText "[edge3][box1,8,6,26,25][f6][x10][yc][b]" & RndMatch & "[/b][x44][yc]MATCH[box1,103,6,121,25]", deNone, 1000, FALSE
	DispDMD2.QueueText "[edge3][box1,8,6,26,25][f6][x10][yc][b]" & RndMatch & "[/b][x44][yc]MATCH[box1,103,6,121,25]", deNone, 1000, FALSE
	DispDMD1.QueueText "[edge3][box1,8,6,26,25][f6][x10][yc]" & RndMatch & "[x44][yc]MATCH[box1,103,6,121,25]", deNone, 1500, TRUE
	DispDMD2.QueueText "[edge3][box1,8,6,26,25][f6][x10][yc]" & RndMatch & "[x44][yc]MATCH[box1,103,6,121,25]", deNone, 1500, TRUE
	Select Case RandomNumber(6)
		Case 1: Indymatch = "10"
		Case 2: Indymatch = "20"
		Case 3: Indymatch = "30"
		Case 4: Indymatch = "50"
		Case 5: Indymatch = "70"
		Case 6: Indymatch = "90"
	End Select
	EndMatchDelay.Set TRUE, 1800
End Sub



Sub EndOfGameDelay_Expired()
	EndofGameDelay.Set FALSE
	If (MatchWin = TRUE) Then
		MatchWin = FALSE
		BallsRemaining(CP) = 1
		ResetForNewPlayerBall()
		CreateNewBall()
	Else
		EndOfGame()
	End If
End Sub



Sub EndMatchDelay_Expired()
	EndMatchDelay.Enabled = FALSE
	StopMusic 2
	DispDMD1.Text = "[edge3][box1,8,6,26,25][f6][x10][yc]" & RndMatch & "[x44][yc]MATCH[box1,103,6,121,25][x106][yc][bf]" & IndyMatch
	DispDMD2.Text = "[edge3][box1,8,6,26,25][f6][x10][yc]" & RndMatch & "[x44][yc]MATCH[box1,103,6,121,25][x106][yc][bf]" & IndyMatch
	ArkFlash(300)
	If (RndMatch = IndyMatch) Then 
		PlaySound "fx_StoneCollect"
		MatchWin = TRUE
		PlayMusic 2, "vo_Persistance", FALSE, 1, 700
		EndOfGameDelay.set TRUE, 2700
	Else
		PlaySound "fx_Punch6"
		Select Case RandomNumber(8)
			Case 1: PlayMusic 2, "vo_WrongThisTime", FALSe, 1, 500: EndofGameDelay.set TRUE, 1800
			Case 2: PlayMusic 2, "vo_Jesus", FALSE, 1, 500: EndofGameDelay.set TRUE, 1700
			Case 3: PlayMusic 2, "vo_TooBad", FALSE, 1, 500: EndofGameDelay.set TRUE, 1800
			Case 4: PlayMusic 2, "vo_NeverDoubted", FALSE, 1, 500: EndofGameDelay.set TRUE, 3700
			Case 5: PlayMusic 2, "vo_Goodbye", FALSE, 1, 500: EndofGameDelay.set TRUE, 3900
			Case 6: PlayMusic 2, "vo_LocalSewer": EndOfGameDelay.Set TRUE, 4800
			Case 7: PlayMusic 2, "vo_MustBeGoing", FALSE, 1, 500: EndOfGameDelay.Set TRUE, 2500
			Case 8: PlayMusic 2, "vo_Take", FALSE, 1, 500: EndOfGameDelay.Set TRUE, 4000
		End Select
	End If
End Sub






Sub balldropsound_expired()
	balldropsound.Enabled = FALSE
	PlaySound "fx_BallDrops2"
End Sub




Sub Trigger9_Hit()
	PlaySound "fx_GateHitR"
	If not fakegate2.Dropped then
		fakegate2.popdown
	Exit Sub
	End If
	If fakegate2.Dropped then
		fakegate2.SolenoidPulse 
	Exit Sub
	End If
End Sub



Sub Guide12_Hit()
	PlaySound "MetalHitLowL"
End Sub



Sub Rubber22_Hit(): PlaySound "fx_RubberHitLeft": End Sub
Sub Rubber24_Hit(): PlaySound "fx_RubberHitLeft": End Sub
Sub Rubber25_Hit(): PlaySound "fx_RubberHitLeft": End Sub



Sub PropSlow_Expired()
	propspeed = propspeed - 100
	If (Propspeed = 100) Then
		PropStop.Set TRUE, 100
		PropSlow.set FALSE
	Exit Sub
	End If
	Planeprop1.rotatexy propspeed
	PropSlow.Set TRUE, 100
End Sub



Sub PropStop_Expired()
	Planeprop1.rotatexy 0
	PropStop.Set FALSE
	StopMusic 5
End Sub



' the Music List.  Music will resume in priority of what is still active...

Sub RestartMusic_Expired()
	RestartMusic.Enabled = FALSE
	If (ModeName = "RScene3") Then PlayMusic 1, "Music_TruckLong" , TRUE, 0.8: Exit Sub
	If (ModeName = "TScene1") Then PlayMusic 1, "Music_AnythingGoes" , TRUE, 0.8: Exit Sub
	If (ModeName = "TScene2") Then PlayMusic 1, "Music_PlaneJump", TRUE, 0.8: Exit Sub
	If (ModeName = "TScene3") Then PlayMusic 1, "Music_MineCart", TRUE, 0.8: Exit Sub
	If (ModeName = "TScene4") Then PlayMusic 1, "Music_Final" , TRUE, 0.8: Exit Sub
	If (ModeName = "CScene1") Then PlayMusic 1, "Music_YoungIndy", TRUE, 0.8: Exit Sub
	If (ModeName = "CScene4") Then PlayMusic 1, "Music_Choose", TRUE, 0.8: Exit Sub
	If (ModeName = "SScene2") Then PlayMusic 1, "Music_NukeTown" , TRUE, 0.8: Exit Sub
	If (BOG = TRUE) Then PlayMusic 1, "Music_Challenge", TRUE, 0.8: Exit Sub
	If (HurryUpMode = TRUE) Then PlayMusic 1, "Music_Ants", TRUE, 0.8: Exit Sub
	If (IJScoring = TRUE) Then PlayMusic 1, "Music_IndyJones", TRUE, 0.8: Exit Sub
	If (IndyScoring = TRUE) Then PlayMusic 1, "Music_Streets", TRUE, 0.8: Exit Sub
	If (JonesScoring = TRUE) Then	PlayMusic 1, "Music_Jones", TRUE, 0.8: Exit Sub
	If (TempleOpen = TRUE) Then PlayMusic 1, "Music_Temple", TRUE, 0.8: Exit Sub
	'If (xMarks = 2) Then PlayMusic 1, "Music_MapRoom2", TRUE, 0.8: Exit Sub
	If (ModeName = "") Then
		If (BallsRemaining(CP) = 1) Then
			PlayMusic 1, "Music_RaidersTheme", TRUE, 0.8
		Else
			PlayMusic 1, "Music_ThemeDoom", TRUE, 0.8
		End If
	End If
End Sub



Sub QuoteTimer_Expired()
	QuoteTimer.Enabled = FALSE
	QuoteBusy = FALSE
End Sub



' turn off these slings when a mode first starts...

Sub SlingUpperL_Hit()
	If (BallsOnPlayfield = 0) or (SlingStop = TRUE) Then
		SlingUpperL.SolenoidOff
	End If
End Sub


Sub SlingUpperR_Hit()
	If (BallsOnPlayfield = 0) or (SlingStop = TRUE) Then
		SlingUpperR.SolenoidOff
	End If
End Sub



Sub FuturePinball_EndPlay()
End Sub





' ********************************
' **                            **
' **          LIGHTING          **
' **                            **
' ********************************

' So important and so often overlooked, lighting adds a TON of atmosphere to a game of pinball.
' Combined with a killer audio package, it's a win, win situation for the player.

' I learn everything from the masters of Cinema....which is why my games are so....cinematic!  Now you know.


Dim SpotMe,SpotFlash


' individual spot lamps can be controlled here...

Sub SpotOn(SpotMe)
	SpotBulbLS.Set BulbOff, "10", 150
	FlasherAmb1.Set BulbOff, "10", 150
	SpotBulbRS.Set BulbOff, "10", 150
	FlasherAmb2.Set BulbOff, "10", 150
	SpotArk.Set BulbOff, "10", 150
	FlasherArkSpot.Set BulbOff, "10", 150
	SpotSword.Set BulbOff, "10", 150
	FlasherSword.Set BulbOff, "10", 150
	Select Case SpotMe
		Case 0:
			SpotBulbLS.State = BulbOff
			FlasherAmb1.State = BulbOff
			SpotBulbRS.State = BulbOff
			FlasherAmb2.State = BulbOff
			SpotArk.State = BulbOff
			FlasherArkSpot.State = BulbOff
			SpotSword.State = BulbOff
			FlasherSword.State = BulbOff
		Case 1: ' sling left only
			SpotBulbLS.State = BulbOn
			FlasherAmb1.State = BulbOn
		Case 2: ' sling right only
			SpotBulbRS.State = BulbOn
			FlasherAmb2.State = BulbOn
		Case 3: ' both slings only
			SpotBulbLS.State = BulbOn
			FlasherAmb1.State = BulbOn
			SpotBulbRS.State = BulbOn
			FlasherAmb2.State = BulbOn
		Case 4: ' ark spot only
			SpotArk.State = BulbOn
			FlasherArkSpot.State = BulbOn
		Case 5: ' swordsman spot only
			SpotSword.State = BulbOn
			FlasherSword.State = BulbOn
		Case 6: ' ark and swordsman only
			SpotArk.State = BulbOn
			FlasherArkSpot.State = BulbOn
			SpotSword.State = BulbOn
			FlasherSword.State = BulbOn
		Case 7: ' both slings only blink
			SpotBulbLS.Set BulbBlink, "10", 75
			FlasherAmb1.Set BulbBlink, "10", 75
			SpotBulbRS.Set BulbBlink, "10", 75
			FlasherAmb2.Set BulbBlink, "10", 75
		Case 8: ' ark and sword only blink
			SpotArk.Set BulbBlink, "10", 75
			FlasherArkSpot.Set BulbBlink, "10", 75
			SpotSword.Set BulbBlink, "10", 75
			FlasherSword.Set BulbBlink, "10", 75
	End Select
End Sub


' rotate all the spot lamps in order, used for big rewards...

Sub SpotFlashTimer_Expired()
	SpotFlash = SpotFlash + 1
	Select Case SpotFlash
		Case 1: SpotOn(1)
		Case 2: SpotOn(2)
		Case 3: SpotOn(3)
		Case 4: SpotOn(4)
		Case 5: SpotOn(5)
		Case 6: SpotOn(6): SpotFlash = 0
	End Select
End Sub



Sub FlasherOff_Expired()
	FlasherOff.Enabled = FALSE
	LightSeqPF.StopPlay
	LightSeqJP.StopPlay
	bulb5.State = BulbOff
	bulb6.State = BulbOff
	bulb7.State = BulbOff
	bulb8.State = BulbOff
	bulb9.State = BulbOff
	bulb10.State = BulbOff
	BulbArkL.State = BulbOff
	bulb12.State = BulbOff
	bulb13.State = BulbOff
	bulb14.State = BulbOff
	bulb15.State = BulbOff
	bulb16.State = BulbOff
	bulb17.State = BulbOff
	bulb18.State = BulbOff
	BulbArkR.State = BulbOff
	Bulb4.State = BulbOff
	FlasherRed.State = BulbOff
	SpotFlashTimer.Enabled = FALSE: SpotOn(0)
End Sub


' What this do?  Well I'll tell you...it simply turns all GI lights on and off very quickly
' mimicking what a real table does.

' Adding a time to the sub routine determins the quickness of the flashing, for exmaple: 
' 'FlashFPTimer.Set TRUE, 100' - the flash is 100ms long.

Sub FlashPFTimer_Expired()
	Flash = Flash + 1
	Select Case Flash
		Case 1,3,5: PlasDarkOn()
		Case 2,4: PlasDarkOff()
		Case 6: PlasDarkOff()
				FlashPFTimer.Enabled = FALSE
				BulbArkL.Set BulbOff, "10", 125
				BulbArkR.Set BulbOff, "10", 125
				FlasherRed.Set BulbOff,	"10", 125
	End Select
End Sub


' All GI off. I also have to swap all plastic textures to dark versions.

Sub PlasDarkOn()
	LightSeqGI.Play SeqAllOff
	'APFArk.Render = TRUE
	FlipLaneL.Render = TRUE
	FlipLaneR.Render = TRUE
	MapPlas.Render = TRUE
	ArkPlas1.Render = TRUE
	LSDark.Render = TRUE
	RSDark.Render = TRUE
	RightMid.Render = TRUE
	LeftMid.Render = TRUE
	TopPlas.Render = TRUE
	TopLeftPlas.Render = TRUE
	Surface48.Render = TRUE
	Surface3.Render = FALSE
	Surface4.Render = FALSE
	Surface6.Render = FALSE
	Surface8.Render = FALSE
	Surface10.Render = FALSE
	Surface11.Render = FALSE
	Surface12.Render = FALSE
	Surface16.Render = FALSE
	Surface17.Render = FALSE
	LeftSlingShotSurface.Render = FALSE
	RightSlingShotSurface.Render = FALSE
	xBAM.SetPlayfieldTexture "APFDArk"
End Sub


' All GI on. Everything back to normal.

Sub PlasDarkOff()
	LightSeqGI.StopPlay
	'APFArk.Render = FALSE
	FlipLaneL.Render = FALSE
	FlipLaneR.Render = FALSE
	MapPlas.Render = FALSE
	ArkPlas1.Render = FALSE
	LSDark.Render = FALSE
	RSDark.Render = FALSE
	RightMid.Render = FALSE
	LeftMid.Render = FALSE
	TopPlas.Render = FALSE
	TopLeftPlas.Render = FALSE
	Surface48.Render = FALSE
	Surface3.Render = TRUE
	Surface4.Render = TRUE
	Surface6.Render = TRUE
	Surface8.Render = TRUE
	Surface10.Render = TRUE
	Surface11.Render = TRUE
	Surface12.Render = TRUE
	Surface16.Render = TRUE
	Surface17.Render = TRUE
	LeftSlingShotSurface.Render = TRUE
	RightSlingShotSurface.Render = TRUE
	xBAM.SetPlayfieldTexture "PFMain"
End Sub


' The 2 red flashers above the Ark.  Just flash 'em quick.
' The 2 flashers are actually bulbs, FP has a bug where flasher
' halos travel through solid objects, which I hate, so I have to
' use a hidden flasher for the hardware lighting effect.

Sub ArkFlash(FlashTime)
	BulbArkL.FlashForMs FlashTime, 75, BulbOff
	BulbArkR.FlashForMs FlashTime, 75, BulbOff
	FlasherRed.FlashForMs FlashTime, 75, BulbOff
	PlasDarkOn(): Flash = 5: FlashPFTimer.Set TRUE, FlashTime
End Sub



Dim FlashTime


' To set the mood, I light all the torches for the end of ball routine, just 'cause it looks cool.  

Sub TorchesOn()
	' ark torches...
	TorchFlameL.Frame 1, 40, 1: TorchFlameL.FadeIn
	TorchFlameR.Frame 1, 40, 1: TorchFlameR.FadeIn
	BulbFlameL.State = BulbBlink
	BulbFlameR.State = BulbBlink
	FlasherFlame.State = BulbBlink
	GIFlash1.State = BulbOff
	GIFlash2.State = BulbOff
	' skull ramp torches...
	TorchFlameL2.Frame 1, 40, 1: TorchFlameL2.FadeIn
	TorchFlameR2.Frame 1, 40, 1: TorchFlameR2.FadeIn
	BulbFlameL2.State = BulbBlink
	BulbFlameR2.State = BulbBlink
	'APFArk.Render = TRUE
	xBAM.SetPlayfieldTexture "APFDArk"
End Sub



Sub TorchesOff()
	TorchFlameL.Frame 41: TorchFlameL.FadeOut
	TorchFlameR.Frame 41: TorchFlameR.FadeOut
	BulbFlameL.State = BulbOff
	BulbFlameR.State = BulbOff
	FlasherFlame.State = BulbOff
	RampSkullOff()
	'APFArk.Render = FALSE
	xBAM.SetPlayfieldTexture "PFMain"
	PlasDarkOff()
	GIFlash1.State = BulbOn
	GIFlash2.State = BulbOn
End Sub



Sub RampSkullOff()
	SkullBulb.State = BulbOff
	TorchFlameL2.Frame 41: TorchFlameL2.FadeOut
	TorchFlameR2.Frame 41: TorchFlameR2.FadeOut
	BulbFlameL2.State = BulbOff
	BulbFlameR2.State = BulbOff
End Sub




' ****************************************
' **                                    **
' **        RAMP STAND UP TARGETS       **
' **                                    **
' ****************************************


Sub TgtRampL_Hit()
	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub

	If (ModeName = "RScene4") Then RndBulletHit(): RaidersHit(): Exit Sub

	If (ModeName = "SScene3") Then RndBulletHit(): Exit Sub

	If (ModeName <> "") Then Exit Sub
	If (LROn(CP) = FALSE) Then
		LROn(CP) = TRUE
		LightSeqPF.Play SeqBlinking, , 2, 50
		TorchFlameL2.Frame 1, 40, 1: TorchFlameL2.FadeIn: BulbFlameL2.State = BulbBlink: PlaySound "fx_FlameOnR", 0.8
		CheckSKULLRAMP()
	Else
		If (ModeName = "RScene1") Then PlaySound "fx_Dart2", 0.7: Exit Sub
		If (ModeName = "RScene2") Then PlaySound "fx_GunShot8": Exit Sub
		PlaySound "fx_Ricochet2"
	End If
End Sub



Sub TgtRampR_Hit()
	If (fpTilted = TRUE) or (BonusBall = TRUE) Then Exit Sub

	If (ModeName = "RScene4") Then RndBulletHit(): RaidersHit(): Exit Sub

	If (ModeName = "SScene3") Then RndBulletHit(): Exit Sub

	If (ModeName <> "") Then Exit Sub
	If (RROn(CP) = FALSE) Then
		RROn(CP) = TRUE
		LightSeqPF.Play SeqBlinking, , 2, 50
		TorchFlameR2.Frame 1, 40, 1: TorchFlameR2.FadeIn: BulbFlameR2.State = BulbBlink: PlaySound "fx_FlameOnR", 0.8
		CheckSKULLRAMP()
	Else
		If (ModeName = "RScene1") Then PlaySound "fx_Dart2", 0.7: Exit Sub
		If (ModeName = "RScene2") Then PlaySound "fx_GunShot8": Exit Sub
		PlaySound "fx_Ricochet2"
	End If
End Sub




Sub CheckSKULLRAMP()
	If (RROn(CP) = TRUE) and (LROn(CP) = TRUE) Then
		SkullBulb.FlashForMs 800, 150, BulbOn
		If (ModeName = "") Then
			'PlayMusic 3, "Music_Cue3"
			PlaySound "fx_Skull2"
			If (ScoreUpdate = TRUE) Then
				ScoreUpdate = FALSE: FlushDMDTimer.Set TRUE, 1200
				DispDMD1.Text = "[edge3][f3][xc][y4][b]CRYSTAL SKULL[f6][xc][y14]RAMP READY"
				DispDMD2.Text = "[edge3][f3][xc][y4][b]CRYSTAL SKULL[f6][xc][y14]RAMP READY"
			End If
			' next shot to ramp will start movie...
			If (SkullHitsRemain(CP) = 1) Then
				If (QuoteBusy = FALSE) Then
					QuoteBusy = TRUE
					Select Case RandomNumber(7)
						Case 1: MusicFade(2700): PlayMusic 2, "vo_BeCareful"
						Case 2: MusicFade(2000): PlayMusic 2, "vo_HelpUs"
						Case 3: MusicFade(1000): PlayMusic 2, "vo_DrJones4"
						Case 4: MusicFade(2000): PlayMusic 2, "vo_PowerMind"
						Case 5: MusicFade(1400): PlayMusic 2, "vo_LeadUs"
						Case 6: MusicFade(2300): PlayMusic 2, "vo_OldFashionedWay"
						Case 7: MusicFade(1500): PlayMusic 2, "vo_NotFamiliar"
					End Select
				End If
				If (MovieTimer.Enabled = FALSE) Then NoS(): OverlayLCD.UpdateInterval = 150: LCD.UpdateInterval = 150: OverlayLCD.Frame 170,171,170: LCD.Frame 170,171,170: MovieTimer.Set TRUE, 1200
				LightCrystalSkull.State = BulbBlink
			End If
		Else
			PlaySound "fx_Whip7"
		End If
	Else
		PlaySound "fx_Ricochet5"
	End If
End Sub




' *************************************
' **                                 **
' **          MISCELLANEOUS          **
' **                                 **
' *************************************

' I didn't code this formula, I'm not smart enough...


function FormatScore(num)
    Dim n, f, s
    n = CStr(num)
    f = ""
        
    do while len(n)>3
        If len(f)>0 then 
            f = Right(n, 3) & "," & f
        else 
            f = Right(n, 3)
        End If
        n = Left(n, Len(n)-3)
    loop
    If len(n)>0 then
        If len(f) > 0 then
            f = n & "," & f
        else
            f = n
        End If
    End If
    FormatScore = f
End Function


function RandomNumber(ByVal max)
	RandomNumber = Int(max * Rnd + 1)
End function


Sub TrigRampStart_Hit()
	PlaySound "fx_RampStartR", 0.7
	' the ball didn't make it and is rolling back down...
	If (LastSwitchHit.Name = "TrigRampStart") and (bMultiballMode = FALSE) and (PerkRamp(CP) = TRUE) Then RampRtn = TRUE
	set LastSwitchHit = TrigRampStart
End Sub


Dim RampRtn


Sub BallStopper_Hit(): PlaySound "fx_BallDropL", 0.6: End Sub


Sub FlushDMDTimer_Expired()
	ScoreUpdate = TRUE: FlushDMDTimer.set FALSE
	NoPlay = FALSE
	AddScore(0)
End Sub


Sub MusicFade(FadeTime)
	EffectMusic 1, SetVolume, 0.3, 200
	ResumeVol.Set TRUE, FadeTime
End Sub


Sub ResumeVol_Expired()
	ResumeVol.Set FALSE
	EffectMusic 1, SetVolume, 0.8, 100
	QuoteBusy = FALSE
End Sub



' a delightful collection of short clips from the movies.  Keep 'em very short, we're not watching a movie here,
' so quickly show the player what's going on and get back to the action.

' ** AT NO TIME SHOULD THE LCD BE PLAYING CLIPS CONTINUOUSLY OR FOR LONG PERIODS ** 

' This is very important. I hate what Jersey Jack and Stern are doing with their LCDs when it comes to playing movie
' clips.  It kills the atmosphere, the tension, the excitement and ultimately the gameplay.

' Imagine the movie Jaws with added scenes showing more shark!  Less is always more, the masters of cinema taught me that.

' Short and rare clips are like mini rewards for the player - they make the shot, they get a cool clip to watch.
' Having a game saturated with movie clips and fancy animations is a TERRIBLE idea.  Looks amazing to a spectator,
' but I don't give 2 shits about spectators, I only care about offering the player the best possible experience.

' And this is JJ and Stern's mistake.  People are gathering round to watch a TV screen!  Not the action on the
' playfield.

 

' The system I use to play clips uses individual image files that move very quickly creating a clip.
' Future Pinball only allows 1000 image files for each library which is a tremenous pain in my arse, so
' I have to use 3 overlays at the same time, each one on top of the other.  How I manage these overlays
' can be complicated as I have to instantly disable 1 overlay to play the other.

' The audio for each clip is also captured seperatly and in most cases edited, so it's not always as it was
' in the movie.  I have to edit out unwanted music in the background, shorten dialogue or add more 'ooompth'
' to sound effects.  Both clip and audio are then matched perfectly to play in sync.

' It is tempting to always add more clips, but too many takes too much away from the action on the playfield,
' which is the highest priority.  Remember: Pinball is 95% what happens on the playfield and only 5% what you see
' on any display....unless you're Jersey Jack, then it's 50/50.


' ** NEED TO ADD A FEW MORE **


Sub PlayClip()
	
	If (SpinBusy = TRUE) Then Exit Sub ' the reward spinner is doing it's thing...
	
	NoS()

	OverlayMovie.UpdateInterval = 68: OverlayMovie2.UpdateInterval = 68
	LCD2.UpdateInterval = 68: LCD3.UpdateInterval = 68

	Select Case Clip
		Case 1: LCD2.Frame 342,354: OverlayMovie.Frame 342,354: MovieTimer.Set TRUE, 1000: PlaySound "fx_MaleScream"
		Case 2: LCD2.Frame 578,612: OverlayMovie.Frame 578,612: MovieTimer.Set TRUE, 2500: PlaySound "fx_GunShotDelay"
		Case 3: LCD2.Frame 240,258: OverlayMovie.Frame 240,258: MovieTimer.Set TRUE, 2000: PlaySound "fx_ArkLid"
		Case 4: LCD2.Frame 2,174: OverlayMovie.Frame 2,174: MovieTimer.Set TRUE, 13600: PlaySound "fx_ArkOpen"
		Case 5: LCD2.Frame 455,520: OverlayMovie.Frame 455,520: MovieTimer.Set TRUE, 5300 ' boulder escape
		Case 6: LCD3.Frame 160,181: OverlayMovie2.Frame 160,181: MovieTimer.Set TRUE, 1700: PlayMusic 2, "vo_GetHerUp" ' runaway
		Case 7: LCD3.Frame 182,199: OverlayMovie2.Frame 182,199: MovieTimer.Set TRUE, 1500: PlaySound "vfx_Monkey" ' monkey
		Case 8: LCD3.Frame 224,241: OverlayMovie2.Frame 224,241: MovieTimer.Set TRUE, 1500: PlaySound "vfx_DartL" ' darts left
		Case 9: LCD3.Frame 242,261: OverlayMovie2.Frame 242,261: MovieTimer.Set TRUE, 1500: PlaySound "vfx_DartR" ' darts right
		Case 10: LCD3.Frame 262,298: OverlayMovie2.Frame 262,298: MovieTimer.Set TRUE, 3000: PlaySound "fx_Plane2", 0.8 ' plane escape
		Case 11: LCD3.Frame 299,325: OverlayMovie2.Frame 299, 325: MovieTimer.Set TRUE, 2000: PlayMusic 2, "vo_IndianaJones": ' Indy intro
		Case 12:	LCD2.Frame 721,755: OverlayMovie.Frame 721,755: MovieTimer.Set TRUE, 2800: PlayMusic 2, "vo_HowToFly"
		Case 13: LCD2.Frame 259,295: OverlayMovie.Frame 259,295: MovieTimer.Set TRUE, 3000 ' bar shootout start
		Case 14: LCD2.Frame 775,830: OverlayMovie.Frame 775,830: MovieTimer.Set TRUE, 4500 ' truck chase start
		Case 15: LCD2.Frame 613,677: OverlayMovie.Frame 613,677: MovieTimer.Set TRUE, 4800 ' anitidote start
		Case 16: LCD2.Frame 831,858: OverlayMovie.Frame 831,858: MovieTimer.Set TRUE, 2000: PlaySound "fx_Gallop", 0.8
		Case 17: LCD2.Frame 756,774: OverlayMovie.Frame 756,774: MovieTimer.Set TRUE, 1500: PlayMusic 2, "vo_BigProblem"
		Case 18: LCD2.Frame 368,454: OverlayMovie.Frame 368,454: MovieTimer.Set TRUE, 7000: PlaySound "fx_Trap", 0.8: PlaySound "fx_Ball", 0.7
		Case 19: LCD2.Frame 953,977: OverlayMovie.Frame 953, 977: MovieTimer.Set TRUE, 2000: PlaySound "fx_ManThrow2" 
		Case 20: LCD2.Frame 613,677: OverlayMovie.Frame 613,677: MovieTimer.Set TRUE, 4800: PlayMusic 2, "vo_Antidote"
		Case 21: LCD3.Frame 326,353: OverlayMovie2.Frame 326,353: MovieTimer.Set TRUE, 1900 ' plane start
		Case 22: LCD3.Frame 383,410: OverlayMovie2.Frame 383,410: MovieTimer.Set TRUE, 2100: PlaySound "vfx_TrainChase", 0.8 ' train chase
		Case 23: LCD3.Frame 354,382: OverlayMovie2.Frame 354,382: MovieTimer.Set TRUE, 2200: PlaySound "fx_Train", 0.8 ' train roof
		Case 24: LCD3.Frame 411,482: OverlayMovie2.Frame 411,432: MovieTimer.Set TRUE, 1800: PlaySound "vfx_PlaneHit" ' plane hit
		Case 25: LCD3.Frame 433,484: OverlayMovie2.Frame 433,484: MovieTimer.Set TRUE, 4200: PlaySound "vfx_PlaneJump" ' plane jump
		Case 26: LCD3.Frame 485,502: OverlayMovie2.Frame 485,502: MovieTimer.Set TRUE, 1500 ' bar shoot
		Case 27: LCD3.Frame 200,223: OverlayMovie2.Frame 200,223: MovieTimer.Set TRUE, 1700: PlaySound "fx_Monkey" ' basket found
		Case 28: LCD2.Frame 678,720: OverlayMovie.Frame 678,720: MovieTimer.Set TRUE, 3200: PlayMusic 2, "vo_Cross"
		Case 29: LCD3.Frame 69,110: OverlayMovie2.Frame 69,110: MovieTimer.Set TRUE, 3500: PlaySound "fx_Derail"
		Case 30: LCD3.Frame 2,34: OverlayMovie2.Frame 2,34: MovieTimer.Set TRUE, 2400 ' mine cart enemy detrail
		Case 31: LCD3.Frame 131,159: OverlayMovie2.Frame 131,159: MovieTimer.Set TRUE, 2400: PlaySound "fx_DiamondMiss"
		Case 32: LCD2.Frame 521,546: OverlayMovie.Frame 521,546: MovieTimer.Set TRUE, 2000 ' swordsman start
		Case 33: LCD2.Frame 547,577: OverlayMovie.Frame 547,577: MovieTimer.Set TRUE, 2000: PlaySound "fx_Sword2"
		Case 34: OverlayMovie.UpdateInterval = 75: LCD2.UpdateInterval = 75: LCD2.Frame 978,996: OverlayMovie.Frame 978,996: MovieTimer.Set TRUE, 1500: PlaySound "fx_MineCart5"
		Case 35:	OverlayMovie2.UpdateInterval = 76: LCD3.UpdateInterval = 76: LCD3.Frame 35,68: OverlayMovie2.Frame 35,68: MovieTimer.Set TRUE, 2800: PlaySound "fx_MineCurve"
		Case 36: LCD2.Frame 831,858: OverlayMovie.Frame 831,858: MovieTimer.Set TRUE, 2000: PlaySound "fx_Gallop", 0.8
		Case 37: LCD3.Frame 111,130: OverlayMovie2.Frame 111,130: MovieTimer.Set TRUE, 1600: PlaySound "vfx_AntidoteFall"
		Case 38: LCD2.Frame 859,952: OverlayMovie.Frame 859,952: MovieTimer.Set TRUE, 7500: PlaySound "fx_MineStart"
		Case 39: LCD3.Frame 503,528: OverlayMovie2.Frame 503,528: MovieTimer.Set TRUE, 2200: PlaySound "vfx_IndyShoot"
		Case 40: LCD3.Frame 529,586: OverlayMovie2.Frame 529,586: MovieTimer.Set TRUE, 4300: PlaySound "vfx_TrunkEscape"
		Case 41: LCD3.Frame 587,615: OverlayMovie2.Frame 587,615: MovieTimer.Set TRUE, 2400 ' nuke start
		Case 42: LCD3.Frame 616,646: OverlayMovie2.Frame 616,646: MovieTimer.Set TRUE, 2500: PlayMusic 2, "vfx_NukeFridge" ' Indy gets in fridge
		Case 43: LCD3.Frame 647,778: OverlayMovie2.Frame 647,778: MovieTimer.Set TRUE, 10500: PlayMusic 2, "vfx_NukeEnd" ' nuke win
		Case 44: LCD3.Frame 682,714: OverlayMovie2.Frame 682,714: MovieTimer.Set TRUE, 2500: PlayMusic 2, "vfx_NukeEnd2" ' nuke loss
		Case 45: LCD3.Frame 779,810: OverlayMovie2.Frame 779,810: MovieTimer.Set TRUE, 2600: PlaySound "vfx_BridgeStart"
		Case 46: LCD3.Frame 811,835: OverlayMovie2.Frame 811,835: MovieTimer.Set TRUE, 2000: PlaySound "vfx_RopeCut"
		Case 47: LCD3.Frame 836,894: OverlayMovie2.Frame 836,894: MovieTimer.Set TRUE, 4800: PlaySound "vfx_BridgeFall"
		Case 48: LCD3.Frame 895,927: OverlayMovie2.Frame 895,927: MovieTimer.Set TRUE, 2800 ' bridge win
		Case 49: OverlayMovie2.UpdateInterval = 73: LCD3.UpdateInterval = 73: LCD3.Frame 928,945: OverlayMovie2.Frame 928,945: MovieTimer.Set TRUE, 1500 ' Indy on horse
		Case 50: LCD3.Frame 946,1016: OverlayMovie2.Frame 946,1016: MovieTimer.Set TRUE, 5300: PlayMusic 2, "vo_FlyYesLandNo" ' dogfight start
		Case 51: OverlayLCD.UpdateInterval = 68: LCD.UpdateInterval = 68: LCD.Frame 217,260: OverlayLCD.Frame 217,260: MovieTimer.Set TRUE, 3500: PlayMusic 2, "vo_BellyOfBeast" ' tank start
		Case 52: LCD2.Frame 296, 310: OverlayMovie.Frame 296, 310: MovieTimer.Set TRUE, 1200
		Case 53: LCD2.Frame 311, 324: OverlayMovie.Frame 311, 324: MovieTimer.Set TRUE, 1000
		Case 54: LCD2.Frame 325, 341: OverlayMovie.Frame 325, 341: MovieTimer.Set TRUE, 1300
		Case 55: LCD2.Frame 175, 239: OverlayMovie.Frame 175, 239: MovieTimer.Set TRUE, 4200: PlayMusic 5, "fx_Demon2"
		Case 56: LCD2.Frame 355, 367: OverlayMovie.Frame 355, 367: MovieTimer.Set TRUE, 1000: PlaySound "fx_MaleScream2"
		Case 57: OverlayLCD.UpdateInterval = 68: LCD.UpdateInterval = 68: LCD.Frame 269, 294: OverlayLCD.Frame 269, 294: MovieTimer.Set TRUE, 2100: ' grab idol
		Case 58: OverlayLCD.UpdateInterval = 68: LCD.UpdateInterval = 68: LCD.Frame 295, 317: OverlayLCD.Frame 295, 317: MovieTimer.Set TRUE, 1500: ' gun turret
		Case 59: OverlayLCD.UpdateInterval = 70: LCD.UpdateInterval = 70: LCD.Frame 318, 333: OverlayLCD.Frame 318, 333: MovieTimer.Set TRUE, 1200 ' Mola Ram
		Case 60: OverlayLCD.UpdateInterval = 68: LCD.UpdateInterval = 68: LCD.Frame 334, 370: OverlayLCD.Frame 334, 370: MovieTimer.Set TRUE, 3000: PlaySound "vfx_RocketStart" ' Rocket Car start
		Case 61: OverlayLCD.UpdateInterval = 68: LCD.UpdateInterval = 68: LCD.Frame 375, 411: OverlayLCD.Frame 375, 411: MovieTimer.Set TRUE, 3000: PlaySound "vfx_Thruster2" ' thrust
		Case 62: OverlayLCD.UpdateInterval = 68: LCD.UpdateInterval = 68: LCD.Frame 412, 480: OverlayLCD.Frame 412, 480: MovieTimer.Set TRUE, 5600: PlaySound "vfx_RocketLaunch" ' rocket car launch
		Case 63: OverlayLCD.UpdateInterval = 70: LCD.UpdateInterval = 70: LCD.Frame 481, 510: OverlayLCD.Frame 481, 510: MovieTimer.Set TRUE, 2500: ' choose start
		Case 64: OverlayLCD.UpdateInterval = 68: LCD.UpdateInterval = 68: LCD.Frame 511, 538: OverlayLCD.Frame 511, 538: MovieTimer.Set TRUE, 2300: PlaySound "vfx_Poorly" ' choose poorly
		Case 65: OverlayLCD.UpdateInterval = 68: LCD.UpdateInterval = 68: LCD.Frame 551, 590: OverlayLCD.Frame 551, 590: MovieTimer.Set TRUE, 3000: PlaySound "fx_Fire" ' tank fire
		Case 66: OverlayLCD.UpdateInterval = 68: LCD.UpdateInterval = 68: LCD.Frame 593, 639: OverlayLCD.Frame 593, 639: MovieTimer.Set TRUE, 3400: PlaySound "fx_Fire" ' tank fire
		Case 67: OverlayLCD.UpdateInterval = 68: LCD.UpdateInterval = 68: LCD.Frame 643, 696: OverlayLCD.Frame 643, 696: MovieTimer.Set TRUE, 4200 ' mind control start
		Case 68: OverlayLCD.UpdateInterval = 68: LCD.UpdateInterval = 68: LCD.Frame 697, 775: OverlayLCD.Frame 697, 775: MovieTimer.Set TRUE, 6600: PlaySound "vfx_TruckEnd2" ' truck end
		Case 69: OverlayLCD.UpdateInterval = 68: LCD.UpdateInterval = 68: LCD.Frame 778, 802: OverlayLCD.Frame 778, 802: MovieTimer.Set TRUE, 2100 ' skull end
	End Select
End Sub



' who else does this? adds fun to the attract sequence....just me it seems...

Sub PlayClipAttract()
	NoS()

	' slow down the speed to stretch the very short clips to at least 2 seconds...
	OverlayMovie.UpdateInterval = 96: OverlayMovie2.UpdateInterval = 96
	LCD2.UpdateInterval = 96: LCD3.UpdateInterval = 96
	LCD.UpdateInterval = 96: OverlayLCD.UpdateInterval = 96

	Select Case MoviePick
		Case 1:
			Select Case RandomNumber(10)
				Case 1: LCD2.Frame 521,546: OverlayMovie.Frame 521,546 ' swordsman start
				Case 2: LCD2.Frame 2,174: OverlayMovie.Frame 2,174 ' Ark open
				Case 3: LCD3.Frame 160,181: OverlayMovie2.Frame 160,181 ' run from tribe
				Case 4: LCD3.Frame 299,325: OverlayMovie2.Frame 299, 325 ' Indy intro
				Case 5: LCD2.Frame 259,295: OverlayMovie.Frame 259,295 ' bar shootout start
				Case 6: LCD2.Frame 831,858: OverlayMovie.Frame 831,858 ' indy on horse
				Case 7: LCD2.Frame 680,720: OverlayMovie.Frame 680,720 ' cross start
				Case 8: LCD.Frame 269, 294: OverlayLCD.Frame 269, 294 ' grab idol
				Case 9: LCD.Frame 697, 722: OverlayLCD.Frame 697, 722 ' truck end
				Case 10: LCD.Frame 723, 775: OverlayLCD.Frame 723, 775 ' truck end 2
			End Select
		Case 2:
			Select Case RandomNumber(8)
				Case 1: LCD2.Frame 756,774: OverlayMovie.Frame 756,774 ' big problem
				Case 2: LCD2.Frame 368,454: OverlayMovie.Frame 368,454 ' boulder run
				Case 3: LCD2.Frame 953,977: OverlayMovie.Frame 953, 977 ' truck through
				Case 4: LCD3.Frame 383,410: OverlayMovie2.Frame 383,410 ' train chase
				Case 5: LCD3.Frame 354,382: OverlayMovie2.Frame 354,382 ' train roof
				Case 6: LCD3.Frame 200,223: OverlayMovie2.Frame 200,223 ' basket found
				Case 7: LCD3.Frame 2,34: OverlayMovie2.Frame 2,34 ' mine cart enemy detrail
				Case 8: LCD.Frame 511, 538: OverlayLCD.Frame 511, 538 ' choose poorly
			End Select
		Case 3:
			Select Case RandomNumber(9)
				Case 1: LCD2.Frame 578,612: OverlayMovie.Frame 578,612 ' shoot swordsman
				Case 2: LCD2.Frame 547,577: OverlayMovie.Frame 547,577 ' swordman showoff
				Case 3: LCD3.Frame 35,68: OverlayMovie2.Frame 35,68 ' mine cart track
				Case 4: LCD2.Frame 864,952: OverlayMovie.Frame 864,952 ' start mine cart chase
				Case 5: LCD3.Frame 587,615: OverlayMovie2.Frame 587,615 ' nuke start
				Case 6: LCD3.Frame 785,810: OverlayMovie2.Frame 785,810 ' bridge start
				Case 7: LCD3.Frame 895,927: OverlayMovie2.Frame 895,927 ' bridge win
				Case 8: LCD.Frame 481, 510: OverlayLCD.Frame 481, 510 ' choose start
				Case 9: LCD.Frame 217,260: OverlayLCD.Frame 217,260 ' tank start
			End Select
		Case 4:
			Select Case RandomNumber(9)
				Case 1: LCD2.Frame 100,174: OverlayMovie.Frame 100,174 ' Ark open 2
				Case 2: LCD3.Frame 242,261: OverlayMovie2.Frame 242,261 ' darts right
				Case 3: LCD2.Frame 615,677: OverlayMovie.Frame 615,677 ' start anitdote
				Case 4: LCD2.Frame 775,830: OverlayMovie.Frame 775,830 ' start truck hijack
				Case 5: LCD3.Frame 111,130: OverlayMovie2.Frame 111,130 ' Anitode knocks off table...
				Case 6: LCD3.Frame 682,714: OverlayMovie2.Frame 682,714 ' nuke fail
				Case 7: LCD.Frame 345, 370: OverlayLCD.Frame 345, 370 ' Rocket Car start
				Case 8: LCD.Frame 375, 411: OverlayLCD.Frame 375, 411 ' thrust
				Case 9: LCD.Frame 643, 696: OverlayLCD.Frame 643, 696 ' mind control start
			End Select
		Case 5:
			Select Case RandomNumber(10)
				Case 1: LCD3.Frame 946,1016: OverlayMovie2.Frame 946,1016 ' dogfight start
				Case 2: LCD2.Frame 721,755: OverlayMovie.Frame 721,755 ' plane jump start
				Case 3: LCD2.Frame 175, 239: OverlayMovie.Frame 175, 239 ' Ark demon
				Case 4: LCD3.Frame 815,835: OverlayMovie2.Frame 815,835 ' rope cut
				Case 5: LCD.Frame 295, 317: OverlayLCD.Frame 295, 317 ' gun turret
				Case 6: LCD3.Frame 836,894: OverlayMovie2.Frame 836,894 ' bridge fall
				Case 7: LCD3.Frame 131,159: OverlayMovie2.Frame 131,159 ' dimond miss
				Case 8: LCD.Frame 414, 480: OverlayLCD.Frame 414, 480 ' rocket launch
				Case 9: LCD.Frame 551, 590: OverlayLCD.Frame 551, 590 ' tank fire
				Case 10: LCD.Frame 598, 639: OverlayLCD.Frame 598, 639 ' tank fire 2
			End Select
	End Select
End Sub




Sub NoS()
	OverlayLCD.Frame 1: LCD.Frame 1
	OverlayMovie.Frame 997: LCD2.Frame 997
	OverlayMovie2.Frame 1: LCD3.Frame 1
End Sub



' LCD Prompts - during modes and active features, tell the player what to do...

Sub MovieTimer_Expired()
	MovieTimer.Enabled = FALSE

	If (SpinBusy = TRUE) Then Exit Sub

	OverlayLCD.UpdateInterval = 250: LCD.UpdateInterval = 250
	OverlayMovie.UpdateInterval = 68: LCD2.UpdateInterval = 68
	OverlayMovie2.UpdateInterval = 68: LCD3.UpdateInterval = 68

	NoS()

	' the boulder run...
	If (ModeName = "RScene1") Then 
		If (LightArk.State = BulbBlink) Then
			OverlayLCD.UpdateInterval = 125: LCD.UpdateInterval = 125
			OverlayLCD.Frame 129, 130, 129: LCD.Frame 129, 130, 129 ' shoot the ark...
		Else
			If (LightSkull.State = BulbBlink) Then
				OverlayLCD.Frame 146: LCD.Frame 146 ' shoot ramp, get to plane...
			Else
				OverlayLCD.UpdateInterval = 200: LCD.UpdateInterval = 200
				OverlayLCD.Frame 209,210,209: LCD.Frame 209,210,209 ' run away...
			End If
		End If
	Exit Sub
	End If

	' the bar...
	If (ModeName = "RScene2") Then
		If (LightArk.State = BulbBlink) Then OverlayLCD.Frame 192,193,192: LCD.Frame 192,193,192: Exit Sub
		OverlayLCD.Frame 194,195,194: LCD.Frame 194,195,194: Exit Sub
	End If

	' the truck...
	If (ModeName = "RScene3") Then 
		If (LightOrbitR.State = BulbBlink) Then OverlayLCD.Frame 196: LCD.Frame 196: Exit Sub ' shoot orbit
		If (LightArk.State = BulbBlink) Then OverlayLCD.Frame 776,777,776: LCD.Frame 776,777,776: Exit Sub ' shoot ark
		OverlayLCD.Frame 197,198,197: LCD.Frame 197,198,197: Exit Sub ' shoot INDY JONES
	End If
	
	' opening the Ark...
 	If (ModeName = "RScene4") Then
		If (LightArk.State = BulbBlink) Then OverlayLCD.Frame 539,540,539: LCD.Frame 539,540,539: Exit Sub
		OverlayLCD.Frame 541: LCD.Frame 541: Exit Sub
	End If

	' the antidote...
	If (ModeName = "TScene1") Then
		If (Antidote = FALSE) and (Diamond = FALSE) Then OverlayLCD.Frame 95,96,95: LCD.Frame 95,96,95: Exit Sub ' show collect antidote...
		If (Antidote = FALSE) and (Diamond = TRUE) Then OverlayLCD.Frame 95,96,95: LCD.Frame 95,96,95: Exit Sub ' show collect antidote (diamond collected)
		If (Antidote = TRUE) and (Diamond = FALSE) Then OverlayLCD.Frame 115,116,115: LCD.Frame 115,116,115: Exit Sub ' show collect diamond (antidode collected)
		If (LightSkull.State = BulbBlink) and (Diamond = TRUE) and (Antidote = TRUE) Then OverlayLCD.Frame 93,94,93: LCD.Frame 93,94,93: Exit Sub ' show diamond collected, shoot ramp...
		OverlayLCD.Frame 103: LCD.Frame 103
	Exit Sub
	End If

	' no one's flying the plane...
 	If (ModeName = "TScene2") Then
		If (LightArk.State = BulbBlink) Then OverlayLCD.Frame 172,173,172: LCD.Frame 172,173,172: Exit Sub
		OverlayLCD.Frame 545,546,545: LCD.Frame 545,546,545
	Exit Sub
	End If

	' we got company...
	If (ModeName = "TScene3") Then
		If (LightOrbitR.State = BulbBlink) Then OverlayLCD.Frame 161, 162, 161: LCD.Frame 161,162,161: Exit Sub ' the first shot...
		OverlayLCD.Frame 163,164,163: LCD.Frame 163,164,163 
	Exit Sub
	End If

	' the rope bridge...
 	If (ModeName = "TScene4") Then 
		If (LightOrbitR.State = BulbBlink) Then OverlayLCD.Frame 185, 186, 185: LCD.Frame 185,186,185: Exit Sub
		If (LightArk.State = BulbBlink) Then OverlayLCD.Frame 187, 188, 187: LCD.Frame 187,188,187: Exit Sub
		OverlayLCD.Frame 189,190,189: LCD.Frame 189,190,189
	Exit Sub
	End If

	' grab the cross...
	If (ModeName = "CScene1") Then
		If (LightArk.State = BulbBlink) Then OverlayLCD.Frame 127,128,127: LCD.Frame 127,128,127: Exit Sub ' shoot the Ark...
		If (LightOrbitL.State = BulbBlink) or (LightOrbitR.State = BulbBlink) Then OverlayLCD.Frame 89: LCD.Frame 89: Exit Sub ' got the cross, shoot the orbit...
		If (LightSkull.State = BulbBlink) Then OverlayLCD.Frame 211,212,211: LCD.Frame 211,212,211: Exit Sub ' shoot the ramp...
		If (LightCrusade.State = BulbBlink) Then OverlayLCD.Frame 213,214,213: LCD.Frame 213,214,213: Exit Sub ' shoot the Grail Sccop... 
	Exit Sub
	End If

	' fly yes, land no...
 	If (ModeName = "CScene2") Then OverlayLCD.Frame 215: LCD.Frame 215: Exit Sub
	
	' belly of beast...
	If (ModeName = "CScene3") Then OverlayLCD.Frame 216: LCD.Frame 216: Exit Sub
 	
	' choose wisely...
	If (ModeName = "CScene4") Then OverlayLCD.Frame 191: LCD.Frame 191: Exit Sub
	
	' rocket car...
	If (ModeName = "SScene1") Then
		If (LightSkull.State = BulbBlink) Then OverlayLCD.Frame 371,372,371: LCD.Frame 371,372,371: Exit Sub
		OverlayLCD.Frame 373,374,373: LCD.Frame 373,374,373
	Exit Sub
	End If

	' get in the fridge...
 	If (ModeName = "SScene2") Then OverlayLCD.Frame 168,169,168: LCD.Frame 168,169,168: Exit Sub

	' mind control...
	If (ModeName = "SScene3") Then OverlayLCD.Frame 640: LCD.Frame 640: Exit Sub

	' return the skull...
 	If (ModeName = "SScene4") Then OverlayLCD.Frame 641: LCD.Frame 641: Exit Sub
	
	' just shoot him...
	If (CairoSwordsman = TRUE) Then OverlayLCD.Frame 28: LCD.Frame 28: Exit Sub

	' rats, snakes, ants...
	If (HurryUpMode = TRUE) Then
		If (Ants = TRUE) Then OverlayLCD.Frame 82,83,82: LCD.Frame 82,83,82: Exit Sub ' ants
		If (Snakes = TRUE) Then OverlayLCD.Frame 86,87,86: LCD.Frame 86,87,86: Exit Sub ' snakes
		If (Rats = TRUE) Then OverlayLCD.Frame 84,85,84: LCD.Frame 84,85,84: Exit Sub ' rats
	Exit Sub
	End If

	' breath of god...
	If (BOG = TRUE) Then OverlayLCD.Frame 136: LCD.Frame 136: Exit Sub

	' find Marion...she's a basket case...
	If (INDYScoring = TRUE) Then OverlayLCD.Frame 148: LCD.Frame 148: Exit Sub
	
	' Jones scroing...
	If (JONESScoring = TRUE) Then OverlayLCD.Frame 165: LCD.Frame 165: Exit Sub

	' Indy Jones scroing...
	If (IJScoring = TRUE) Then OverlayLCD.Frame 166,167,166: LCD.Frame 166,167,166: Exit Sub

	' nothing is active, basic display...
	If (ModeName = "") Then OverlayLCD.Frame 184: LCD.Frame 184: Exit Sub ' main logo display only...
End Sub


